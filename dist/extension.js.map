{"version":3,"sources":["../webpack/bootstrap","../external \"vscode\"","../external \"fs\"","../external \"path\"",".././node_modules/vscode-debugadapter/lib/debugSession.js",".././node_modules/vscode-debugadapter/lib/messages.js",".././src/mumps-language-token.ts",".././src/mumpsLineParser.ts","../external \"events\"","../external \"net\"",".././node_modules/vscode-debugadapter/lib/logger.js",".././src/mumps-documenter.ts",".././src/extension.ts",".././src/mumpsDebug.ts",".././node_modules/vscode-debugadapter/lib/main.js",".././node_modules/vscode-debugadapter/lib/protocol.js","../external \"url\"",".././node_modules/vscode-debugadapter/lib/loggingDebugSession.js",".././node_modules/mkdirp/index.js",".././node_modules/vscode-debugadapter/lib/handles.js",".././node_modules/await-notify/index.js",".././src/mconnect.ts",".././src/mumps-hover-provider.ts",".././src/mumps-label-lookup.ts",".././src/mumps-definition-provider.ts",".././src/mumps-signature-help-provider.ts",".././src/mumps-document.ts",".././src/parser/parser.ts",".././src/parser/tokenizer.ts",".././src/mumps-completion-item-provider.ts",".././src/mumps-autospace.ts",".././node_modules/emcellent/index.js",".././node_modules/emcellent/lib/parse.js",".././node_modules/emcellent/lib/render.js",".././src/mumps-render.ts",".././src/mumps-highlighter.ts",".././src/mumpsCompExp.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","protocol_1","messages_1","Net","url_1","Source","path","id","origin","data","this","sourceReference","adapterData","Scope","reference","expensive","variablesReference","StackFrame","nm","src","ln","col","source","line","column","Thread","Variable","ref","indexedVariables","namedVariables","Breakpoint","verified","e","Module","CompletionItem","label","start","length","StoppedEvent","Event","reason","threadId","exceptionText","super","body","text","ContinuedEvent","allThreadsContinued","InitializedEvent","TerminatedEvent","restart","OutputEvent","output","category","undefined","ThreadEvent","BreakpointEvent","breakpoint","ModuleEvent","LoadedSourceEvent","CapabilitiesEvent","capabilities","ErrorDestination","DebugSession","ProtocolServer","obsolete_debuggerLinesAndColumnsStartAt1","obsolete_isServer","linesAndColumnsStartAt1","_debuggerLinesStartAt1","_debuggerColumnsStartAt1","_debuggerPathsAreURIs","_clientLinesStartAt1","_clientColumnsStartAt1","_clientPathsAreURIs","_isServer","on","shutdown","error","format","enable","debugSession","port","process","argv","slice","forEach","val","index","array","portMatch","exec","parseInt","console","createServer","socket","session","setRunAsServer","listen","stdin","stdout","_isRunningInline","setTimeout","exit","response","codeOrMessage","variables","dest","User","msg","showUser","Telemetry","sendTelemetry","success","message","formatPII","sendResponse","args","timeout","cb","sendRequest","request","Response","command","arguments","linesStartAt1","columnsStartAt1","pathFormat","sendErrorResponse","initializeResponse","initializeRequest","launchRequest","attachRequest","disconnectRequest","terminateRequest","restartRequest","setBreakPointsRequest","setFunctionBreakPointsRequest","setExceptionBreakPointsRequest","configurationDoneRequest","continueRequest","nextRequest","stepInRequest","stepOutRequest","stepBackRequest","reverseContinueRequest","restartFrameRequest","gotoRequest","pauseRequest","stackTraceRequest","scopesRequest","variablesRequest","setVariableRequest","setExpressionRequest","sourceRequest","threadsRequest","terminateThreadsRequest","evaluateRequest","stepInTargetsRequest","gotoTargetsRequest","completionsRequest","exceptionInfoRequest","loadedSourcesRequest","dataBreakpointInfoRequest","setDataBreakpointsRequest","readMemoryRequest","disassembleRequest","cancelRequest","breakpointLocationsRequest","customRequest","_exception","_stack","stack","supportsConditionalBreakpoints","supportsHitConditionalBreakpoints","supportsFunctionBreakpoints","supportsConfigurationDoneRequest","supportsEvaluateForHovers","supportsStepBack","supportsSetVariable","supportsRestartFrame","supportsStepInTargetsRequest","supportsGotoTargetsRequest","supportsCompletionsRequest","supportsRestartRequest","supportsExceptionOptions","supportsValueFormattingOptions","supportsExceptionInfoRequest","supportTerminateDebuggee","supportsDelayedStackTraceLoading","supportsLoadedSourcesRequest","supportsLogPoints","supportsTerminateThreadsRequest","supportsSetExpression","supportsTerminateRequest","supportsDataBreakpoints","supportsReadMemoryRequest","supportsDisassembleRequest","supportsCancelRequest","supportsBreakpointLocationsRequest","clientPath","uri2path","path2uri","debuggerPath","platform","test","toLowerCase","substr","replace","encodeURI","uri","URL","pathname","toString","sourceUri","decodeURIComponent","excludePII","_formatPIIRegexp","match","paramName","Message","type","seq","request_seq","event","definitionsArray","definitions","isWhitespace","char","withoutFirstCharacter","string","substring","formatParameter","parameter","first","optional","addDefinition","definition","push","MumpsToken","document","position","range","getWordRangeAtPosition","word","getText","surroundWord","character","vscode","Position","end","Range","charAt","extendedWord","getWordWithSurrounds","isIntrinsic","lastChar","_isLabelReference","lineAt","RegExp","fullLabel","parts","labelOffset","Number","labelProgram","referredToLabel","lookupLabelReference","_definition","matches","toUpperCase","isFunctionCall","isLabelReference","createDefinitionForLabelReference","functionSignature","signature","parameters","returns","formatFunctionSignature","abbreviation","fs","renderer","TokenType","lvn","gvn","isv","ifunction","nonMfunction","entryref","routineref","numlit","strlit","binoperator","unaryoperator","patcode","repititionCount","openkeywords","usekeywords","closekeywords","jobkeywords","tstartkeywords","cmdExpansions","funcExpansions","isvExpansions","cmdParams","funcParams","expressiontype","tokens","linePosition","level","result","patternComplete","evaluateExpression","repCount","_evaluatePattern","exType","expressionComplete","startposition","lastExpression","subExType","evalString","localname","local","operator","provResult","_checkVar","_checkEntryRef","functionname","longName","_checkFunction","specialvarname","sysvariable","numericliteral","number","stringlit","inputObject","lineLabel","inputLine","lineExpression","errorText","errorPosition","lineLeadSpace","expressionPosition","search","isInsideString","lineComment","comment","lineIndentationArray","lineIndentation","spacer","tmpFunction","tmpFunctionArray","splitLine","_splitCommandsAndArguments","mCommand","mPostCondition","mArguments","cmdPosition","argPosition","pcPosition","ii","splice","postConditionFunctionArray","_extractPostConditional","lineRoutines","lineCommands","tmpCursor","tmpObject","tmpIndex","indexOf","inputString","_extractLabel","_extractComment","_extractIndentation","_extractCommands","filename","content","errlist","readFileSync","err","lines","split","info","checkLine","input","linetokens","labelparts","labeltext","parameterVars","appendLabel","appendIndentation","appendRoutines","appendComment","doExpand","expandCompressLine","lineText","join","cmdCompressions","keys","shortCommand","funcCompressions","shortFunction","isvCompressions","shortIsv","outline","errorinfo","outText","posCorrector","token","checkName","keyword","parsed","parseLine","_splitLabelAndParameters","code","cmd","longcmd","_checkCommand","withParams","isUserfunction","tokentype","exfunction","merkpos","routine","globalOk","indexOk","indexFound","globalFound","indirectionFound","varFound","global","keywords","braceComplete","_checkKeyword","_isEndOfArgument","argNumber","_checkJobKeyword","isLock","mat","starDetected","isBraced","_checkWriteSocket","fname","maxparams","paramCount","para","postcondPossible","postcondition","argFormat","argCount","_checkBreak","_checkOUC","_checkEntryRefAndPostcondition","_checkFor","_checkJob","_checkKill","_checkLock","_checkMerge","_checkNew","_checkRead","_checkSet","_checkTstart","_checkView","_checkWrite","_checkXecute","_checkZbreak","_checkZprint","_checkZstep","longfunc","params","minArguments","minparams","formats","isEndOfArgument","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","then","apply","mkdirp","debugSession_1","LogLevel","Logger","_pendingLogQ","Log","_write","log","Verbose","Warn","Error","_currentLogger","disposeP","dispose","consoleMinLogLevel","_logFilePath","prependTimestamp","logFilePath","_logFilePathFromInit","options","setup","logQ","item","logCallback","logToConsole","InternalLogger","logger","isServer","beforeExitCallback","_logCallback","_logToConsole","_minLogLevel","disposeCallback","signal","_prependTimestamp","isAbsolute","handleError","sendLog","folder","dirname","_logFileStream","createWriteStream","logDateTime","setupShutdownListeners","Date","timeAndDateStamp","getUTCFullYear","getUTCMonth","getUTCDate","getFormattedTimeString","addListener","removeListener","removeShutdownListeners","Stop","logFn","warn","trimLastNewline","write","endsInNewline","LogOutputEvent","str","_padZeroes","String","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","minDesiredLength","numberToPad","repeat","lineIsFunctionSig","makeSignature","labelLine","Signature","element","DocumentFunction","editor","window","activeTextEditor","InsertPosition","selection","with","lineCount","translate","txt","edit","editBuilder","insert","getSigInfo","referredTo","parametersByName","description","param","paramDescription","parser","MumpsLineParser","context","MUMPS_MODE","language","scheme","mumpsDiagnostics","languages","createDiagnosticCollection","subscriptions","commands","registerCommand","showInputBox","placeHolder","storage","storageUri","fsPath","existsSync","mkdirSync","dbFile","wsState","workspaceState","AutospaceFunction","autoSpaceEnter","autoSpaceTab","expandCompress","registerHoverProvider","MumpsHoverProvider","registerDefinitionProvider","MumpsDefinitionProvider","registerSignatureHelpProvider","MumpsSignatureHelpProvider","registerDocumentSymbolProvider","MumpsDocumentSymbolProvider","registerCompletionItemProvider","CompletionItemProvider","registerDocumentSemanticTokensProvider","MumpsHighlighter","SemanticTokens","registerDocumentFormattingEditProvider","provideDocumentFormattingEdits","textEdits","formatDocumentLine","registerDocumentRangeFormattingEditProvider","provideDocumentRangeFormattingEdits","debug","registerDebugConfigurationProvider","MumpsConfigurationProvider","registerDebugAdapterDescriptorFactory","InlineDebugAdapterFactory","onDidChangeActiveTextEditor","triggerUpdateDiagnostics","workspace","onDidChangeTextDocument","registerEvaluatableExpressionProvider","diags","find","diag","contains","lineContent","expression","EvaluatableExpression","config","languageId","program","stopOnEntry","hostname","localRoutinesPath","showInformationMessage","_","_session","DebugAdapterInlineImplementation","MumpsDebugSession","lineNumber","TextEdit","endsWith","startsWith","endSpace","collection","clearTimeout","clear","severity","DiagnosticSeverity","set","updateDiagnostics","Subject","MUMPSDIAGNOSTICS","LoggingDebugSession","_variableHandles","Handles","_configurationDone","setDebuggerLinesStartAt1","setDebuggerColumnsStartAt1","_program","_mconnect","MConnect","sendEvent","THREAD_ID","errortext","bp","filePath","createSource","convertDebuggerLineToClient","convertDebuggerColumnToClient","completionTriggerCharacters","notify","trace","wait","init","refreshDiagnostics","catch","showErrorMessage","clientLines","clearBreakpoints","actualBreakpoints","map","setBreakPoint","convertClientLineToDebugger","breakpoints","requestBreakpoints","threads","startFrame","endFrame","levels","stk","stackFrames","frames","f","file","totalFrames","count","scopes","insertVariable","varId","varObject","getVariables","varname","varparts","indexCount","pop","varBase","lastVar","firstTime","lastRef","actualVar","varAnalyze","checkVars","bases","dummyVar","returnVar","actualReference","continue","getSingleVar","varReply","sourceLines","checkRoutine","errorLines","disconnect","basename","convertDebuggerPathToClient","indexcount","klammerpos","countKomma","doc","diagnostics","lineIndex","lineOfText","errLines","errData","isNaN","endColumn","diagnostic","Diagnostic","loggingDebugSession_1","handles_1","ee","Emitter","_event","listener","_listener","_this","EventEmitter","_sendMessage","_pendingRequests","Map","onDidSendMessage","dispatchRequest","clb","delete","hasListener","inStream","outStream","_sequence","_writableStream","_rawData","Buffer","_handleData","_emitEvent","resume","_send","timer","emit","typ","json","JSON","stringify","byteLength","fire","concat","_contentLength","parse","handleMessage","idx","TWO_CRLF","pair","obsolete_logFilePath","objectToLog","doNotLogOutput","assign","verbose","_0777","mkdirP","opts","made","xfs","umask","mkdir","er","stat","er2","isDirectory","sync","err0","statSync","err1","startHandle","START_HANDLE","_handleMap","_nextHandle","handle","dflt","waiters","self","waiter","promise","resolved","noRemove","pos","isFinite","notifyAll","_currentLine","_breakpointId","_logging","_singleVar","_singleVarContent","_commandQueue","_socket","Socket","_connectState","_readedData","_mVars","_mStack","_activeBreakpoints","_breakPoints","_errorLines","_hints","internals","checkEvents","_localRoutinesPath","_hostname","_port","connect","_log","chunk","processLine","vartype","verifyBreakpoints","writable","shift","onOff","writeln","stopAtStart","sendBreakpoint","mumpsposition","mumpsstatus","loadSource","startlabel","offset","_sourceLines","filter","_sourceFile","Array","fileposition","convertMumpsPosition","Math","min","bps","findIndex","merk","internalBp","part","HintsReceived","hints","ErrorreportReceived","reply","SingleVarReceived","singleVar","singleVarContent","positionstring","filecontent","Hover","mayBeCommand","snippet","Uri","EXTENSIONS","cache","siblingUri","fileName","siblingPath","extension","extendedPath","commentText","j","findReferredToLabel","autoDoc","Location","ParameterInformation","SignatureHelp","SignatureInformation","depth","getFunctionToken","documentation","createSignatureInformation","help","signatures","activeSignature","activeParameter","parametersStartIndex","insertIndex","active","calculateActiveParameter","parsedDoc","parseText","symbols","methods","method","kind","SymbolKind","Function","startPosition","endPostionLine","endLine","endPosition","methodRange","SymbolInformation","MemberClass","Method","declarations","memberClass","Parameter","sourceText","Parser","parseDocument","tokenizer","activeToken","documentText","getTokens","isAlphanumeric","parseMethod","activeMethod","isTab","isSpace","tokenBuffer","loadTokenBuffer","nextLine","checkForDocumentation","isNewLine","throwAwayTokensTil","isLineCommentInit","isLineComment","isOpenParen","processed","processParameters","prevLine","isCloseParen","closeParen","open","isComma","documentContents","Tokenizer","charType","getType","tokenType","parseCharacter","finalizedToken","finalizeToken","Token","documentLine","documentColumn","tokenValue","tokenPosition","stringOpen","firstSlash","asterisk","updateTokenAndAdvanceCursor","newType","charCode","charCodeAt","Type","labeldb","_labelsReady","_dbfile","_refreshLabelDB","status","lineStatus","lookPosition","lastCommand","startstring","isInsidePostcond","isWhiteSpace","isBeginOfVariable","isAlphaChar","getLineStatus","clean","replaceRange","_findLabel","db","labels","routines","writeFileSync","readFile","_labelDB","dbChanged","findFiles","files","_filesToCheck","stats","_checkReady","ms","mtimeMs","size","_refreshFileLabels","writeFile","list","hitlist","sortText","suchstring","routinepart","detail","em","currentLine","newLine","render","cmds","mRoutine","lineContainsNoParamDo","eb","extractLabel","extractComment","extractIndentation","extractRoutines","renderLine","tmpLine","inputArray","returnArray","tmpLineObject","parseArray","isArray","splitRoutinesAndArguments","extractPostConditional","mPostConditional","tmpPosStart","tmpPosEnd","tmpIndentation","tokentypes","values","SemanticTokensLegend","analyzeLines","tokensBuilder","SemanticTokensBuilder","tokenId","build","state","update","lastLineLength"],"mappings":"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A7tB,SAAS9O,KAAKw8B,aAAcx8B,KAAKy8B,iBAI5D,SAASP,EAAQv+B,GAChB,IAAIs/B,EAAmBt/B,EAAEu/B,WAAW,GACpC,OAAID,GAAY,IAAMA,GAAY,IAAMA,GAAY,IAAMA,GAAY,KAAoB,KAAbA,EACrE,EACGA,GAAY,IAAMA,GAAY,GACjC,EACgB,KAAbA,EACH,EACgB,IAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GAGgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,MAAbA,EACH,IACgB,MAAbA,EACH,IACgB,MAAbA,EACH,IACgB,MAAbA,EACH,KAIC,GAIV,SAAkBE,GACjB,mCACA,yBACA,iCACA,mCACA,uBACA,yCACA,mCAEA,kBACA,0BACA,sBAEA,0CACA,gCACA,gCACA,8BACA,kCACA,8BACA,gCACA,4BACA,4BACA,sBACA,8BACA,wBACA,sBACA,8BACA,4BACA,8BACA,kCACA,oCACA,4BACA,kCACA,8BACA,oCACA,sBACA,gCACA,8BACA,+BACA,qBACA,iCACA,uBAEA,8BA3CD,CAAkB,EAAAA,OAAA,EAAAA,KAAI,M,8EC5RtB,aACMvsB,EAAK,EAAQ,GAiBnB,+BAaC,YAAYwsB,GACXp9B,KAAKq9B,cAAe,EACpBr9B,KAAKs9B,QAAUF,EACfp9B,KAAKu9B,kBAEN,uBAAuBlvB,EAA+BC,EAA2BsK,GAEhF,IACI4kB,EAsI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","file":"extension.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","module.exports = require(\"vscode\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst protocol_1 = require(\"./protocol\");\nconst messages_1 = require(\"./messages\");\nconst Net = require(\"net\");\nconst url_1 = require(\"url\");\nclass Source {\n    constructor(name, path, id = 0, origin, data) {\n        this.name = name;\n        this.path = path;\n        this.sourceReference = id;\n        if (origin) {\n            this.origin = origin;\n        }\n        if (data) {\n            this.adapterData = data;\n        }\n    }\n}\nexports.Source = Source;\nclass Scope {\n    constructor(name, reference, expensive = false) {\n        this.name = name;\n        this.variablesReference = reference;\n        this.expensive = expensive;\n    }\n}\nexports.Scope = Scope;\nclass StackFrame {\n    constructor(i, nm, src, ln = 0, col = 0) {\n        this.id = i;\n        this.source = src;\n        this.line = ln;\n        this.column = col;\n        this.name = nm;\n    }\n}\nexports.StackFrame = StackFrame;\nclass Thread {\n    constructor(id, name) {\n        this.id = id;\n        if (name) {\n            this.name = name;\n        }\n        else {\n            this.name = 'Thread #' + id;\n        }\n    }\n}\nexports.Thread = Thread;\nclass Variable {\n    constructor(name, value, ref = 0, indexedVariables, namedVariables) {\n        this.name = name;\n        this.value = value;\n        this.variablesReference = ref;\n        if (typeof namedVariables === 'number') {\n            this.namedVariables = namedVariables;\n        }\n        if (typeof indexedVariables === 'number') {\n            this.indexedVariables = indexedVariables;\n        }\n    }\n}\nexports.Variable = Variable;\nclass Breakpoint {\n    constructor(verified, line, column, source) {\n        this.verified = verified;\n        const e = this;\n        if (typeof line === 'number') {\n            e.line = line;\n        }\n        if (typeof column === 'number') {\n            e.column = column;\n        }\n        if (source) {\n            e.source = source;\n        }\n    }\n}\nexports.Breakpoint = Breakpoint;\nclass Module {\n    constructor(id, name) {\n        this.id = id;\n        this.name = name;\n    }\n}\nexports.Module = Module;\nclass CompletionItem {\n    constructor(label, start, length = 0) {\n        this.label = label;\n        this.start = start;\n        this.length = length;\n    }\n}\nexports.CompletionItem = CompletionItem;\nclass StoppedEvent extends messages_1.Event {\n    constructor(reason, threadId, exceptionText) {\n        super('stopped');\n        this.body = {\n            reason: reason\n        };\n        if (typeof threadId === 'number') {\n            this.body.threadId = threadId;\n        }\n        if (typeof exceptionText === 'string') {\n            this.body.text = exceptionText;\n        }\n    }\n}\nexports.StoppedEvent = StoppedEvent;\nclass ContinuedEvent extends messages_1.Event {\n    constructor(threadId, allThreadsContinued) {\n        super('continued');\n        this.body = {\n            threadId: threadId\n        };\n        if (typeof allThreadsContinued === 'boolean') {\n            this.body.allThreadsContinued = allThreadsContinued;\n        }\n    }\n}\nexports.ContinuedEvent = ContinuedEvent;\nclass InitializedEvent extends messages_1.Event {\n    constructor() {\n        super('initialized');\n    }\n}\nexports.InitializedEvent = InitializedEvent;\nclass TerminatedEvent extends messages_1.Event {\n    constructor(restart) {\n        super('terminated');\n        if (typeof restart === 'boolean' || restart) {\n            const e = this;\n            e.body = {\n                restart: restart\n            };\n        }\n    }\n}\nexports.TerminatedEvent = TerminatedEvent;\nclass OutputEvent extends messages_1.Event {\n    constructor(output, category = 'console', data) {\n        super('output');\n        this.body = {\n            category: category,\n            output: output\n        };\n        if (data !== undefined) {\n            this.body.data = data;\n        }\n    }\n}\nexports.OutputEvent = OutputEvent;\nclass ThreadEvent extends messages_1.Event {\n    constructor(reason, threadId) {\n        super('thread');\n        this.body = {\n            reason: reason,\n            threadId: threadId\n        };\n    }\n}\nexports.ThreadEvent = ThreadEvent;\nclass BreakpointEvent extends messages_1.Event {\n    constructor(reason, breakpoint) {\n        super('breakpoint');\n        this.body = {\n            reason: reason,\n            breakpoint: breakpoint\n        };\n    }\n}\nexports.BreakpointEvent = BreakpointEvent;\nclass ModuleEvent extends messages_1.Event {\n    constructor(reason, module) {\n        super('module');\n        this.body = {\n            reason: reason,\n            module: module\n        };\n    }\n}\nexports.ModuleEvent = ModuleEvent;\nclass LoadedSourceEvent extends messages_1.Event {\n    constructor(reason, source) {\n        super('loadedSource');\n        this.body = {\n            reason: reason,\n            source: source\n        };\n    }\n}\nexports.LoadedSourceEvent = LoadedSourceEvent;\nclass CapabilitiesEvent extends messages_1.Event {\n    constructor(capabilities) {\n        super('capabilities');\n        this.body = {\n            capabilities: capabilities\n        };\n    }\n}\nexports.CapabilitiesEvent = CapabilitiesEvent;\nvar ErrorDestination;\n(function (ErrorDestination) {\n    ErrorDestination[ErrorDestination[\"User\"] = 1] = \"User\";\n    ErrorDestination[ErrorDestination[\"Telemetry\"] = 2] = \"Telemetry\";\n})(ErrorDestination = exports.ErrorDestination || (exports.ErrorDestination = {}));\n;\nclass DebugSession extends protocol_1.ProtocolServer {\n    constructor(obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer) {\n        super();\n        const linesAndColumnsStartAt1 = typeof obsolete_debuggerLinesAndColumnsStartAt1 === 'boolean' ? obsolete_debuggerLinesAndColumnsStartAt1 : false;\n        this._debuggerLinesStartAt1 = linesAndColumnsStartAt1;\n        this._debuggerColumnsStartAt1 = linesAndColumnsStartAt1;\n        this._debuggerPathsAreURIs = false;\n        this._clientLinesStartAt1 = true;\n        this._clientColumnsStartAt1 = true;\n        this._clientPathsAreURIs = false;\n        this._isServer = typeof obsolete_isServer === 'boolean' ? obsolete_isServer : false;\n        this.on('close', () => {\n            this.shutdown();\n        });\n        this.on('error', (error) => {\n            this.shutdown();\n        });\n    }\n    setDebuggerPathFormat(format) {\n        this._debuggerPathsAreURIs = format !== 'path';\n    }\n    setDebuggerLinesStartAt1(enable) {\n        this._debuggerLinesStartAt1 = enable;\n    }\n    setDebuggerColumnsStartAt1(enable) {\n        this._debuggerColumnsStartAt1 = enable;\n    }\n    setRunAsServer(enable) {\n        this._isServer = enable;\n    }\n    /**\n     * A virtual constructor...\n     */\n    static run(debugSession) {\n        // parse arguments\n        let port = 0;\n        const args = process.argv.slice(2);\n        args.forEach(function (val, index, array) {\n            const portMatch = /^--server=(\\d{4,5})$/.exec(val);\n            if (portMatch) {\n                port = parseInt(portMatch[1], 10);\n            }\n        });\n        if (port > 0) {\n            // start as a server\n            console.error(`waiting for debug protocol on port ${port}`);\n            Net.createServer((socket) => {\n                console.error('>> accepted connection from client');\n                socket.on('end', () => {\n                    console.error('>> client connection closed\\n');\n                });\n                const session = new debugSession(false, true);\n                session.setRunAsServer(true);\n                session.start(socket, socket);\n            }).listen(port);\n        }\n        else {\n            // start a session\n            //console.error('waiting for debug protocol on stdin/stdout');\n            const session = new debugSession(false);\n            process.on('SIGTERM', () => {\n                session.shutdown();\n            });\n            session.start(process.stdin, process.stdout);\n        }\n    }\n    shutdown() {\n        if (this._isServer || this._isRunningInline()) {\n            // shutdown ignored in server mode\n        }\n        else {\n            // wait a bit before shutting down\n            setTimeout(() => {\n                process.exit(0);\n            }, 100);\n        }\n    }\n    sendErrorResponse(response, codeOrMessage, format, variables, dest = ErrorDestination.User) {\n        let msg;\n        if (typeof codeOrMessage === 'number') {\n            msg = {\n                id: codeOrMessage,\n                format: format\n            };\n            if (variables) {\n                msg.variables = variables;\n            }\n            if (dest & ErrorDestination.User) {\n                msg.showUser = true;\n            }\n            if (dest & ErrorDestination.Telemetry) {\n                msg.sendTelemetry = true;\n            }\n        }\n        else {\n            msg = codeOrMessage;\n        }\n        response.success = false;\n        response.message = DebugSession.formatPII(msg.format, true, msg.variables);\n        if (!response.body) {\n            response.body = {};\n        }\n        response.body.error = msg;\n        this.sendResponse(response);\n    }\n    runInTerminalRequest(args, timeout, cb) {\n        this.sendRequest('runInTerminal', args, timeout, cb);\n    }\n    dispatchRequest(request) {\n        const response = new messages_1.Response(request);\n        try {\n            if (request.command === 'initialize') {\n                var args = request.arguments;\n                if (typeof args.linesStartAt1 === 'boolean') {\n                    this._clientLinesStartAt1 = args.linesStartAt1;\n                }\n                if (typeof args.columnsStartAt1 === 'boolean') {\n                    this._clientColumnsStartAt1 = args.columnsStartAt1;\n                }\n                if (args.pathFormat !== 'path') {\n                    this.sendErrorResponse(response, 2018, 'debug adapter only supports native paths', null, ErrorDestination.Telemetry);\n                }\n                else {\n                    const initializeResponse = response;\n                    initializeResponse.body = {};\n                    this.initializeRequest(initializeResponse, args);\n                }\n            }\n            else if (request.command === 'launch') {\n                this.launchRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'attach') {\n                this.attachRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'disconnect') {\n                this.disconnectRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'terminate') {\n                this.terminateRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'restart') {\n                this.restartRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setBreakpoints') {\n                this.setBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setFunctionBreakpoints') {\n                this.setFunctionBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setExceptionBreakpoints') {\n                this.setExceptionBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'configurationDone') {\n                this.configurationDoneRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'continue') {\n                this.continueRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'next') {\n                this.nextRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepIn') {\n                this.stepInRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepOut') {\n                this.stepOutRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepBack') {\n                this.stepBackRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'reverseContinue') {\n                this.reverseContinueRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'restartFrame') {\n                this.restartFrameRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'goto') {\n                this.gotoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'pause') {\n                this.pauseRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stackTrace') {\n                this.stackTraceRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'scopes') {\n                this.scopesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'variables') {\n                this.variablesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setVariable') {\n                this.setVariableRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setExpression') {\n                this.setExpressionRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'source') {\n                this.sourceRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'threads') {\n                this.threadsRequest(response, request);\n            }\n            else if (request.command === 'terminateThreads') {\n                this.terminateThreadsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'evaluate') {\n                this.evaluateRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepInTargets') {\n                this.stepInTargetsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'gotoTargets') {\n                this.gotoTargetsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'completions') {\n                this.completionsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'exceptionInfo') {\n                this.exceptionInfoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'loadedSources') {\n                this.loadedSourcesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'dataBreakpointInfo') {\n                this.dataBreakpointInfoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setDataBreakpoints') {\n                this.setDataBreakpointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'readMemory') {\n                this.readMemoryRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'disassemble') {\n                this.disassembleRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'cancel') {\n                this.cancelRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'breakpointLocations') {\n                this.breakpointLocationsRequest(response, request.arguments, request);\n            }\n            else {\n                this.customRequest(request.command, response, request.arguments, request);\n            }\n        }\n        catch (e) {\n            this.sendErrorResponse(response, 1104, '{_stack}', { _exception: e.message, _stack: e.stack }, ErrorDestination.Telemetry);\n        }\n    }\n    initializeRequest(response, args) {\n        // This default debug adapter does not support conditional breakpoints.\n        response.body.supportsConditionalBreakpoints = false;\n        // This default debug adapter does not support hit conditional breakpoints.\n        response.body.supportsHitConditionalBreakpoints = false;\n        // This default debug adapter does not support function breakpoints.\n        response.body.supportsFunctionBreakpoints = false;\n        // This default debug adapter implements the 'configurationDone' request.\n        response.body.supportsConfigurationDoneRequest = true;\n        // This default debug adapter does not support hovers based on the 'evaluate' request.\n        response.body.supportsEvaluateForHovers = false;\n        // This default debug adapter does not support the 'stepBack' request.\n        response.body.supportsStepBack = false;\n        // This default debug adapter does not support the 'setVariable' request.\n        response.body.supportsSetVariable = false;\n        // This default debug adapter does not support the 'restartFrame' request.\n        response.body.supportsRestartFrame = false;\n        // This default debug adapter does not support the 'stepInTargets' request.\n        response.body.supportsStepInTargetsRequest = false;\n        // This default debug adapter does not support the 'gotoTargets' request.\n        response.body.supportsGotoTargetsRequest = false;\n        // This default debug adapter does not support the 'completions' request.\n        response.body.supportsCompletionsRequest = false;\n        // This default debug adapter does not support the 'restart' request.\n        response.body.supportsRestartRequest = false;\n        // This default debug adapter does not support the 'exceptionOptions' attribute on the 'setExceptionBreakpoints' request.\n        response.body.supportsExceptionOptions = false;\n        // This default debug adapter does not support the 'format' attribute on the 'variables', 'evaluate', and 'stackTrace' request.\n        response.body.supportsValueFormattingOptions = false;\n        // This debug adapter does not support the 'exceptionInfo' request.\n        response.body.supportsExceptionInfoRequest = false;\n        // This debug adapter does not support the 'TerminateDebuggee' attribute on the 'disconnect' request.\n        response.body.supportTerminateDebuggee = false;\n        // This debug adapter does not support delayed loading of stack frames.\n        response.body.supportsDelayedStackTraceLoading = false;\n        // This debug adapter does not support the 'loadedSources' request.\n        response.body.supportsLoadedSourcesRequest = false;\n        // This debug adapter does not support the 'logMessage' attribute of the SourceBreakpoint.\n        response.body.supportsLogPoints = false;\n        // This debug adapter does not support the 'terminateThreads' request.\n        response.body.supportsTerminateThreadsRequest = false;\n        // This debug adapter does not support the 'setExpression' request.\n        response.body.supportsSetExpression = false;\n        // This debug adapter does not support the 'terminate' request.\n        response.body.supportsTerminateRequest = false;\n        // This debug adapter does not support data breakpoints.\n        response.body.supportsDataBreakpoints = false;\n        /** This debug adapter does not support the 'readMemory' request. */\n        response.body.supportsReadMemoryRequest = false;\n        /** The debug adapter does not support the 'disassemble' request. */\n        response.body.supportsDisassembleRequest = false;\n        /** The debug adapter does not support the 'cancel' request. */\n        response.body.supportsCancelRequest = false;\n        /** The debug adapter does not support the 'breakpointLocations' request. */\n        response.body.supportsBreakpointLocationsRequest = false;\n        this.sendResponse(response);\n    }\n    disconnectRequest(response, args, request) {\n        this.sendResponse(response);\n        this.shutdown();\n    }\n    launchRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    attachRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    terminateRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    restartRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setFunctionBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setExceptionBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    configurationDoneRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    continueRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    nextRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepInRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepOutRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepBackRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    reverseContinueRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    restartFrameRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    gotoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    pauseRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    sourceRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    threadsRequest(response, request) {\n        this.sendResponse(response);\n    }\n    terminateThreadsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stackTraceRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    scopesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    variablesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setVariableRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setExpressionRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    evaluateRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepInTargetsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    gotoTargetsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    completionsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    exceptionInfoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    loadedSourcesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    dataBreakpointInfoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setDataBreakpointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    readMemoryRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    disassembleRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    cancelRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    breakpointLocationsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    /**\n     * Override this hook to implement custom requests.\n     */\n    customRequest(command, response, args, request) {\n        this.sendErrorResponse(response, 1014, 'unrecognized request', null, ErrorDestination.Telemetry);\n    }\n    //---- protected -------------------------------------------------------------------------------------------------\n    convertClientLineToDebugger(line) {\n        if (this._debuggerLinesStartAt1) {\n            return this._clientLinesStartAt1 ? line : line + 1;\n        }\n        return this._clientLinesStartAt1 ? line - 1 : line;\n    }\n    convertDebuggerLineToClient(line) {\n        if (this._debuggerLinesStartAt1) {\n            return this._clientLinesStartAt1 ? line : line - 1;\n        }\n        return this._clientLinesStartAt1 ? line + 1 : line;\n    }\n    convertClientColumnToDebugger(column) {\n        if (this._debuggerColumnsStartAt1) {\n            return this._clientColumnsStartAt1 ? column : column + 1;\n        }\n        return this._clientColumnsStartAt1 ? column - 1 : column;\n    }\n    convertDebuggerColumnToClient(column) {\n        if (this._debuggerColumnsStartAt1) {\n            return this._clientColumnsStartAt1 ? column : column - 1;\n        }\n        return this._clientColumnsStartAt1 ? column + 1 : column;\n    }\n    convertClientPathToDebugger(clientPath) {\n        if (this._clientPathsAreURIs !== this._debuggerPathsAreURIs) {\n            if (this._clientPathsAreURIs) {\n                return DebugSession.uri2path(clientPath);\n            }\n            else {\n                return DebugSession.path2uri(clientPath);\n            }\n        }\n        return clientPath;\n    }\n    convertDebuggerPathToClient(debuggerPath) {\n        if (this._debuggerPathsAreURIs !== this._clientPathsAreURIs) {\n            if (this._debuggerPathsAreURIs) {\n                return DebugSession.uri2path(debuggerPath);\n            }\n            else {\n                return DebugSession.path2uri(debuggerPath);\n            }\n        }\n        return debuggerPath;\n    }\n    //---- private -------------------------------------------------------------------------------\n    static path2uri(path) {\n        if (process.platform === 'win32') {\n            if (/^[A-Z]:/.test(path)) {\n                path = path[0].toLowerCase() + path.substr(1);\n            }\n            path = path.replace(/\\\\/g, '/');\n        }\n        path = encodeURI(path);\n        let uri = new url_1.URL(`file:`); // ignore 'path' for now\n        uri.pathname = path; // now use 'path' to get the correct percent encoding (see https://url.spec.whatwg.org)\n        return uri.toString();\n    }\n    static uri2path(sourceUri) {\n        let uri = new url_1.URL(sourceUri);\n        let s = decodeURIComponent(uri.pathname);\n        if (process.platform === 'win32') {\n            if (/^\\/[a-zA-Z]:/.test(s)) {\n                s = s[1].toLowerCase() + s.substr(2);\n            }\n            s = s.replace(/\\//g, '\\\\');\n        }\n        return s;\n    }\n    /*\n    * If argument starts with '_' it is OK to send its value to telemetry.\n    */\n    static formatPII(format, excludePII, args) {\n        return format.replace(DebugSession._formatPIIRegexp, function (match, paramName) {\n            if (excludePII && paramName.length > 0 && paramName[0] !== '_') {\n                return match;\n            }\n            return args[paramName] && args.hasOwnProperty(paramName) ?\n                args[paramName] :\n                match;\n        });\n    }\n}\nDebugSession._formatPIIRegexp = /{([^}]+)}/g;\nexports.DebugSession = DebugSession;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWdTZXNzaW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2RlYnVnU2Vzc2lvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OztnR0FHZ0c7O0FBR2hHLHlDQUEwQztBQUMxQyx5Q0FBMkM7QUFDM0MsMkJBQTJCO0FBQzNCLDZCQUF3QjtBQUd4QixNQUFhLE1BQU07SUFLbEIsWUFBbUIsSUFBWSxFQUFFLElBQWEsRUFBRSxLQUFhLENBQUMsRUFBRSxNQUFlLEVBQUUsSUFBVTtRQUMxRixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsZUFBZSxHQUFHLEVBQUUsQ0FBQztRQUMxQixJQUFJLE1BQU0sRUFBRTtZQUNMLElBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1NBQzVCO1FBQ0QsSUFBSSxJQUFJLEVBQUU7WUFDSCxJQUFLLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztTQUMvQjtJQUNGLENBQUM7Q0FDRDtBQWhCRCx3QkFnQkM7QUFFRCxNQUFhLEtBQUs7SUFLakIsWUFBbUIsSUFBWSxFQUFFLFNBQWlCLEVBQUUsWUFBcUIsS0FBSztRQUM3RSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsU0FBUyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO0lBQzVCLENBQUM7Q0FDRDtBQVZELHNCQVVDO0FBRUQsTUFBYSxVQUFVO0lBT3RCLFlBQW1CLENBQVMsRUFBRSxFQUFVLEVBQUUsR0FBWSxFQUFFLEtBQWEsQ0FBQyxFQUFFLE1BQWMsQ0FBQztRQUN0RixJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNaLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxD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SSxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxFQUFFO2dCQUMvRCxPQUFPLEtBQUssQ0FBQzthQUNiO1lBQ0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2dCQUN6RCxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztnQkFDakIsS0FBSyxDQUFDO1FBQ1IsQ0FBQyxDQUFDLENBQUE7SUFDSCxDQUFDOztBQWRjLDZCQUFnQixHQUFHLFlBQVksQ0FBQztBQWhtQmhELG9DQSttQkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHtEZWJ1Z1Byb3RvY29sfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5pbXBvcnQge1Byb3RvY29sU2VydmVyfSBmcm9tICcuL3Byb3RvY29sJztcbmltcG9ydCB7UmVzcG9uc2UsIEV2ZW50fSBmcm9tICcuL21lc3NhZ2VzJztcbmltcG9ydCAqIGFzIE5ldCBmcm9tICduZXQnO1xuaW1wb3J0IHtVUkx9IGZyb20gJ3VybCc7XG5cblxuZXhwb3J0IGNsYXNzIFNvdXJjZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU291cmNlIHtcblx0bmFtZTogc3RyaW5nO1xuXHRwYXRoOiBzdHJpbmc7XG5cdHNvdXJjZVJlZmVyZW5jZTogbnVtYmVyO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHBhdGg/OiBzdHJpbmcsIGlkOiBudW1iZXIgPSAwLCBvcmlnaW4/OiBzdHJpbmcsIGRhdGE/OiBhbnkpIHtcblx0XHR0aGlzLm5hbWUgPSBuYW1lO1xuXHRcdHRoaXMucGF0aCA9IHBhdGg7XG5cdFx0dGhpcy5zb3VyY2VSZWZlcmVuY2UgPSBpZDtcblx0XHRpZiAob3JpZ2luKSB7XG5cdFx0XHQoPGFueT50aGlzKS5vcmlnaW4gPSBvcmlnaW47XG5cdFx0fVxuXHRcdGlmIChkYXRhKSB7XG5cdFx0XHQoPGFueT50aGlzKS5hZGFwdGVyRGF0YSA9IGRhdGE7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBTY29wZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU2NvcGUge1xuXHRuYW1lOiBzdHJpbmc7XG5cdHZhcmlhYmxlc1JlZmVyZW5jZTogbnVtYmVyO1xuXHRleHBlbnNpdmU6IGJvb2xlYW47XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgcmVmZXJlbmNlOiBudW1iZXIsIGV4cGVuc2l2ZTogYm9vbGVhbiA9IGZhbHNlKSB7XG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcblx0XHR0aGlzLnZhcmlhYmxlc1JlZmVyZW5jZSA9IHJlZmVyZW5jZTtcblx0XHR0aGlzLmV4cGVuc2l2ZSA9IGV4cGVuc2l2ZTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgU3RhY2tGcmFtZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU3RhY2tGcmFtZSB7XG5cdGlkOiBudW1iZXI7XG5cdHNvdXJjZTogU291cmNlO1xuXHRsaW5lOiBudW1iZXI7XG5cdGNvbHVtbjogbnVtYmVyO1xuXHRuYW1lOiBzdHJpbmc7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGk6IG51bWJlciwgbm06IHN0cmluZywgc3JjPzogU291cmNlLCBsbjogbnVtYmVyID0gMCwgY29sOiBudW1iZXIgPSAwKSB7XG5cdFx0dGhpcy5pZCA9IGk7XG5cdFx0dGhpcy5zb3VyY2UgPSBzcmM7XG5cdFx0dGhpcy5saW5lID0gbG47XG5cdFx0dGhpcy5jb2x1bW4gPSBjb2w7XG5cdFx0dGhpcy5uYW1lID0gbm07XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFRocmVhZCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuVGhyZWFkIHtcblx0aWQ6IG51bWJlcjtcblx0bmFtZTogc3RyaW5nO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCBuYW1lOiBzdHJpbmcpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0aWYgKG5hbWUpIHtcblx0XHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMubmFtZSA9ICdUaHJlYWQgIycgKyBpZDtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlIGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5WYXJpYWJsZSB7XG5cdG5hbWU6IHN0cmluZztcblx0dmFsdWU6IHN0cmluZztcblx0dmFyaWFibGVzUmVmZXJlbmNlOiBudW1iZXI7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgcmVmOiBudW1iZXIgPSAwLCBpbmRleGVkVmFyaWFibGVzPzogbnVtYmVyLCBuYW1lZFZhcmlhYmxlcz86IG51bWJlcikge1xuXHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdFx0dGhpcy52YWx1ZSA9IHZhbHVlO1xuXHRcdHRoaXMudmFyaWFibGVzUmVmZXJlbmNlID0gcmVmO1xuXHRcdGlmICh0eXBlb2YgbmFtZWRWYXJpYWJsZXMgPT09ICdudW1iZXInKSB7XG5cdFx0XHQoPERlYnVnUHJvdG9jb2wuVmFyaWFibGU+dGhpcykubmFtZWRWYXJpYWJsZXMgPSBuYW1lZFZhcmlhYmxlcztcblx0XHR9XG5cdFx0aWYgKHR5cGVvZiBpbmRleGVkVmFyaWFibGVzID09PSAnbnVtYmVyJykge1xuXHRcdFx0KDxEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlPnRoaXMpLmluZGV4ZWRWYXJpYWJsZXMgPSBpbmRleGVkVmFyaWFibGVzO1xuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQnJlYWtwb2ludCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuQnJlYWtwb2ludCB7XG5cdHZlcmlmaWVkOiBib29sZWFuO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3Rvcih2ZXJpZmllZDogYm9vbGVhbiwgbGluZT86IG51bWJlciwgY29sdW1uPzogbnVtYmVyLCBzb3VyY2U/OiBTb3VyY2UpIHtcblx0XHR0aGlzLnZlcmlmaWVkID0gdmVyaWZpZWQ7XG5cdFx0Y29uc3QgZTogRGVidWdQcm90b2NvbC5CcmVha3BvaW50ID0gdGhpcztcblx0XHRpZiAodHlwZW9mIGxpbmUgPT09ICdudW1iZXInKSB7XG5cdFx0XHRlLmxpbmUgPSBsaW5lO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGNvbHVtbiA9PT0gJ251bWJlcicpIHtcblx0XHRcdGUuY29sdW1uID0gY29sdW1uO1xuXHRcdH1cblx0XHRpZiAoc291cmNlKSB7XG5cdFx0XHRlLnNvdXJjZSA9IHNvdXJjZTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vZHVsZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuTW9kdWxlIHtcblx0aWQ6IG51bWJlciB8IHN0cmluZztcblx0bmFtZTogc3RyaW5nO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihpZDogbnVtYmVyIHwgc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQ29tcGxldGlvbkl0ZW0gaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkNvbXBsZXRpb25JdGVtIHtcblx0bGFiZWw6IHN0cmluZztcblx0c3RhcnQ6IG51bWJlcjtcblx0bGVuZ3RoOiBudW1iZXI7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGxhYmVsOiBzdHJpbmcsIHN0YXJ0OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyID0gMCkge1xuXHRcdHRoaXMubGFiZWwgPSBsYWJlbDtcblx0XHR0aGlzLnN0YXJ0ID0gc3RhcnQ7XG5cdFx0dGhpcy5sZW5ndGggPSBsZW5ndGg7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0b3BwZWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5TdG9wcGVkRXZlbnQge1xuXHRib2R5OiB7XG5cdFx0cmVhc29uOiBzdHJpbmc7XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCB0aHJlYWRJZD86IG51bWJlciwgZXhjZXB0aW9uVGV4dD86IHN0cmluZykge1xuXHRcdHN1cGVyKCdzdG9wcGVkJyk7XG5cdFx0dGhpcy5ib2R5ID0ge1xuXHRcdFx0cmVhc29uOiByZWFzb25cblx0XHR9O1xuXHRcdGlmICh0eXBlb2YgdGhyZWFkSWQgPT09ICdudW1iZXInKSB7XG5cdFx0XHQodGhpcyBhcyBEZWJ1Z1Byb3RvY29sLlN0b3BwZWRFdmVudCkuYm9keS50aHJlYWRJZCA9IHRocmVhZElkO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGV4Y2VwdGlvblRleHQgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHQodGhpcyBhcyBEZWJ1Z1Byb3RvY29sLlN0b3BwZWRFdmVudCkuYm9keS50ZXh0ID0gZXhjZXB0aW9uVGV4dDtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbnRpbnVlZEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlZEV2ZW50IHtcblx0Ym9keToge1xuXHRcdHRocmVhZElkOiBudW1iZXI7XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHRocmVhZElkOiBudW1iZXIsIGFsbFRocmVhZHNDb250aW51ZWQ/OiBib29sZWFuKSB7XG5cdFx0c3VwZXIoJ2NvbnRpbnVlZCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHRocmVhZElkOiB0aHJlYWRJZFxuXHRcdH07XG5cblx0XHRpZiAodHlwZW9mIGFsbFRocmVhZHNDb250aW51ZWQgPT09ICdib29sZWFuJykge1xuXHRcdFx0KDxEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlZEV2ZW50PnRoaXMpLmJvZHkuYWxsVGhyZWFkc0NvbnRpbnVlZCA9IGFsbFRocmVhZHNDb250aW51ZWQ7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBJbml0aWFsaXplZEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkluaXRpYWxpemVkRXZlbnQge1xuXHRwdWJsaWMgY29uc3RydWN0b3IoKSB7XG5cdFx0c3VwZXIoJ2luaXRpYWxpemVkJyk7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFRlcm1pbmF0ZWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5UZXJtaW5hdGVkRXZlbnQge1xuXHRwdWJsaWMgY29uc3RydWN0b3IocmVzdGFydD86IGFueSkge1xuXHRcdHN1cGVyKCd0ZXJtaW5hdGVkJyk7XG5cdFx0aWYgKHR5cGVvZiByZXN0YXJ0ID09PSAnYm9vbGVhbicgfHwgcmVzdGFydCkge1xuXHRcdFx0Y29uc3QgZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVkRXZlbnQgPSB0aGlzO1xuXHRcdFx0ZS5ib2R5ID0ge1xuXHRcdFx0XHRyZXN0YXJ0OiByZXN0YXJ0XG5cdFx0XHR9O1xuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgY2xhc3MgT3V0cHV0RXZlbnQgZXh0ZW5kcyBFdmVudCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuT3V0cHV0RXZlbnQge1xuXHRib2R5OiB7XG5cdFx0Y2F0ZWdvcnk6IHN0cmluZyxcblx0XHRvdXRwdXQ6IHN0cmluZyxcblx0XHRkYXRhPzogYW55XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG91dHB1dDogc3RyaW5nLCBjYXRlZ29yeTogc3RyaW5nID0gJ2NvbnNvbGUnLCBkYXRhPzogYW55KSB7XG5cdFx0c3VwZXIoJ291dHB1dCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdGNhdGVnb3J5OiBjYXRlZ29yeSxcblx0XHRcdG91dHB1dDogb3V0cHV0XG5cdFx0fTtcblx0XHRpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHR0aGlzLmJvZHkuZGF0YSA9IGRhdGE7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBUaHJlYWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5UaHJlYWRFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246IHN0cmluZyxcblx0XHR0aHJlYWRJZDogbnVtYmVyXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCB0aHJlYWRJZDogbnVtYmVyKSB7XG5cdFx0c3VwZXIoJ3RocmVhZCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0dGhyZWFkSWQ6IHRocmVhZElkXG5cdFx0fTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQnJlYWtwb2ludEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkJyZWFrcG9pbnRFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246IHN0cmluZyxcblx0XHRicmVha3BvaW50OiBCcmVha3BvaW50XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCBicmVha3BvaW50OiBCcmVha3BvaW50KSB7XG5cdFx0c3VwZXIoJ2JyZWFrcG9pbnQnKTtcblx0XHR0aGlzLmJvZHkgPSB7XG5cdFx0XHRyZWFzb246IHJlYXNvbixcblx0XHRcdGJyZWFrcG9pbnQ6IGJyZWFrcG9pbnRcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBNb2R1bGVFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5Nb2R1bGVFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246ICduZXcnIHwgJ2NoYW5nZWQnIHwgJ3JlbW92ZWQnLFxuXHRcdG1vZHVsZTogTW9kdWxlXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogJ25ldycgfCAnY2hhbmdlZCcgfCAncmVtb3ZlZCcsIG1vZHVsZTogTW9kdWxlKSB7XG5cdFx0c3VwZXIoJ21vZHVsZScpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0bW9kdWxlOiBtb2R1bGVcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBMb2FkZWRTb3VyY2VFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246ICduZXcnIHwgJ2NoYW5nZWQnIHwgJ3JlbW92ZWQnLFxuXHRcdHNvdXJjZTogU291cmNlXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogJ25ldycgfCAnY2hhbmdlZCcgfCAncmVtb3ZlZCcsIHNvdXJjZTogU291cmNlKSB7XG5cdFx0c3VwZXIoJ2xvYWRlZFNvdXJjZScpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0c291cmNlOiBzb3VyY2Vcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBDYXBhYmlsaXRpZXNFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5DYXBhYmlsaXRpZXNFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRjYXBhYmlsaXRpZXM6IERlYnVnUHJvdG9jb2wuQ2FwYWJpbGl0aWVzXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGNhcGFiaWxpdGllczogRGVidWdQcm90b2NvbC5DYXBhYmlsaXRpZXMpIHtcblx0XHRzdXBlcignY2FwYWJpbGl0aWVzJyk7XG5cdFx0dGhpcy5ib2R5ID0ge1xuXHRcdFx0Y2FwYWJpbGl0aWVzOiBjYXBhYmlsaXRpZXNcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBlbnVtIEVycm9yRGVzdGluYXRpb24ge1xuXHRVc2VyID0gMSxcblx0VGVsZW1ldHJ5ID0gMlxufTtcblxuZXhwb3J0IGNsYXNzIERlYnVnU2Vzc2lvbiBleHRlbmRzIFByb3RvY29sU2VydmVyIHtcblxuXHRwcml2YXRlIF9kZWJ1Z2dlckxpbmVzU3RhcnRBdDE6IGJvb2xlYW47XG5cdHByaXZhdGUgX2RlYnVnZ2VyQ29sdW1uc1N0YXJ0QXQxOiBib29sZWFuO1xuXHRwcml2YXRlIF9kZWJ1Z2dlclBhdGhzQXJlVVJJczogYm9vbGVhbjtcblxuXHRwcml2YXRlIF9jbGllbnRMaW5lc1N0YXJ0QXQxOiBib29sZWFuO1xuXHRwcml2YXRlIF9jbGllbnRDb2x1bW5zU3RhcnRBdDE6IGJvb2xlYW47XG5cdHByaXZhdGUgX2NsaWVudFBhdGhzQXJlVVJJczogYm9vbGVhbjtcblxuXHRwcm90ZWN0ZWQgX2lzU2VydmVyOiBib29sZWFuO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihvYnNvbGV0ZV9kZWJ1Z2dlckxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxPzogYm9vbGVhbiwgb2Jzb2xldGVfaXNTZXJ2ZXI/OiBib29sZWFuKSB7XG5cdFx0c3VwZXIoKTtcblxuXHRcdGNvbnN0IGxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxID0gdHlwZW9mIG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDEgPT09ICdib29sZWFuJyA/IG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDEgOiBmYWxzZTtcblx0XHR0aGlzLl9kZWJ1Z2dlckxpbmVzU3RhcnRBdDEgPSBsaW5lc0FuZENvbHVtbnNTdGFydEF0MTtcblx0XHR0aGlzLl9kZWJ1Z2dlckNvbHVtbnNTdGFydEF0MSA9IGxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxO1xuXHRcdHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzID0gZmFsc2U7XG5cblx0XHR0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID0gdHJ1ZTtcblx0XHR0aGlzLl9jbGllbnRDb2x1bW5zU3RhcnRBdDEgPSB0cnVlO1xuXHRcdHRoaXMuX2NsaWVudFBhdGhzQXJlVVJJcyA9IGZhbHNlO1xuXG5cdFx0dGhpcy5faXNTZXJ2ZXIgPSB0eXBlb2Ygb2Jzb2xldGVfaXNTZXJ2ZXIgPT09ICdib29sZWFuJyA/IG9ic29sZXRlX2lzU2VydmVyIDogZmFsc2U7XG5cblx0XHR0aGlzLm9uKCdjbG9zZScsICgpID0+IHtcblx0XHRcdHRoaXMuc2h1dGRvd24oKTtcblx0XHR9KTtcblx0XHR0aGlzLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuXHRcdFx0dGhpcy5zaHV0ZG93bigpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIHNldERlYnVnZ2VyUGF0aEZvcm1hdChmb3JtYXQ6IHN0cmluZykge1xuXHRcdHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzID0gZm9ybWF0ICE9PSAncGF0aCc7XG5cdH1cblxuXHRwdWJsaWMgc2V0RGVidWdnZXJMaW5lc1N0YXJ0QXQxKGVuYWJsZTogYm9vbGVhbikge1xuXHRcdHRoaXMuX2RlYnVnZ2VyTGluZXNTdGFydEF0MSA9IGVuYWJsZTtcblx0fVxuXG5cdHB1YmxpYyBzZXREZWJ1Z2dlckNvbHVtbnNTdGFydEF0MShlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9kZWJ1Z2dlckNvbHVtbnNTdGFydEF0MSA9IGVuYWJsZTtcblx0fVxuXG5cdHB1YmxpYyBzZXRSdW5Bc1NlcnZlcihlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9pc1NlcnZlciA9IGVuYWJsZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBBIHZpcnR1YWwgY29uc3RydWN0b3IuLi5cblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgcnVuKGRlYnVnU2Vzc2lvbjogdHlwZW9mIERlYnVnU2Vzc2lvbikge1xuXG5cdFx0Ly8gcGFyc2UgYXJndW1lbnRzXG5cdFx0bGV0IHBvcnQgPSAwO1xuXHRcdGNvbnN0IGFyZ3MgPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMik7XG5cdFx0YXJncy5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGluZGV4LCBhcnJheSkge1xuXHRcdFx0Y29uc3QgcG9ydE1hdGNoID0gL14tLXNlcnZlcj0oXFxkezQsNX0pJC8uZXhlYyh2YWwpO1xuXHRcdFx0aWYgKHBvcnRNYXRjaCkge1xuXHRcdFx0XHRwb3J0ID0gcGFyc2VJbnQocG9ydE1hdGNoWzFdLCAxMCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAocG9ydCA+IDApIHtcblx0XHRcdC8vIHN0YXJ0IGFzIGEgc2VydmVyXG5cdFx0XHRjb25zb2xlLmVycm9yKGB3YWl0aW5nIGZvciBkZWJ1ZyBwcm90b2NvbCBvbiBwb3J0ICR7cG9ydH1gKTtcblx0XHRcdE5ldC5jcmVhdGVTZXJ2ZXIoKHNvY2tldCkgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCc+PiBhY2NlcHRlZCBjb25uZWN0aW9uIGZyb20gY2xpZW50Jyk7XG5cdFx0XHRcdHNvY2tldC5vbignZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoJz4+IGNsaWVudCBjb25uZWN0aW9uIGNsb3NlZFxcbicpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0Y29uc3Qgc2Vzc2lvbiA9IG5ldyBkZWJ1Z1Nlc3Npb24oZmFsc2UsIHRydWUpO1xuXHRcdFx0XHRzZXNzaW9uLnNldFJ1bkFzU2VydmVyKHRydWUpO1xuXHRcdFx0XHRzZXNzaW9uLnN0YXJ0KHNvY2tldCwgc29ja2V0KTtcblx0XHRcdH0pLmxpc3Rlbihwb3J0KTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvLyBzdGFydCBhIHNlc3Npb25cblx0XHRcdC8vY29uc29sZS5lcnJvcignd2FpdGluZyBmb3IgZGVidWcgcHJvdG9jb2wgb24gc3RkaW4vc3Rkb3V0Jyk7XG5cdFx0XHRjb25zdCBzZXNzaW9uID0gbmV3IGRlYnVnU2Vzc2lvbihmYWxzZSk7XG5cdFx0XHRwcm9jZXNzLm9uKCdTSUdURVJNJywgKCkgPT4ge1xuXHRcdFx0XHRzZXNzaW9uLnNodXRkb3duKCk7XG5cdFx0XHR9KTtcblx0XHRcdHNlc3Npb24uc3RhcnQocHJvY2Vzcy5zdGRpbiwgcHJvY2Vzcy5zdGRvdXQpO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBzaHV0ZG93bigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5faXNTZXJ2ZXIgfHwgdGhpcy5faXNSdW5uaW5nSW5saW5lKCkpIHtcblx0XHRcdC8vIHNodXRkb3duIGlnbm9yZWQgaW4gc2VydmVyIG1vZGVcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gd2FpdCBhIGJpdCBiZWZvcmUgc2h1dHRpbmcgZG93blxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHByb2Nlc3MuZXhpdCgwKTtcblx0XHRcdH0sIDEwMCk7XG5cdFx0fVxuXHR9XG5cblx0cHJvdGVjdGVkIHNlbmRFcnJvclJlc3BvbnNlKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlLCBjb2RlT3JNZXNzYWdlOiBudW1iZXIgfCBEZWJ1Z1Byb3RvY29sLk1lc3NhZ2UsIGZvcm1hdD86IHN0cmluZywgdmFyaWFibGVzPzogYW55LCBkZXN0OiBFcnJvckRlc3RpbmF0aW9uID0gRXJyb3JEZXN0aW5hdGlvbi5Vc2VyKTogdm9pZCB7XG5cblx0XHRsZXQgbXNnIDogRGVidWdQcm90b2NvbC5NZXNzYWdlO1xuXHRcdGlmICh0eXBlb2YgY29kZU9yTWVzc2FnZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdG1zZyA9IDxEZWJ1Z1Byb3RvY29sLk1lc3NhZ2U+IHtcblx0XHRcdFx0aWQ6IDxudW1iZXI+IGNvZGVPck1lc3NhZ2UsXG5cdFx0XHRcdGZvcm1hdDogZm9ybWF0XG5cdFx0XHR9O1xuXHRcdFx0aWYgKHZhcmlhYmxlcykge1xuXHRcdFx0XHRtc2cudmFyaWFibGVzID0gdmFyaWFibGVzO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGRlc3QgJiBFcnJvckRlc3RpbmF0aW9uLlVzZXIpIHtcblx0XHRcdFx0bXNnLnNob3dVc2VyID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGlmIChkZXN0ICYgRXJyb3JEZXN0aW5hdGlvbi5UZWxlbWV0cnkpIHtcblx0XHRcdFx0bXNnLnNlbmRUZWxlbWV0cnkgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRtc2cgPSBjb2RlT3JNZXNzYWdlO1xuXHRcdH1cblxuXHRcdHJlc3BvbnNlLnN1Y2Nlc3MgPSBmYWxzZTtcblx0XHRyZXNwb25zZS5tZXNzYWdlID0gRGVidWdTZXNzaW9uLmZvcm1hdFBJSShtc2cuZm9ybWF0LCB0cnVlLCBtc2cudmFyaWFibGVzKTtcblx0XHRpZiAoIXJlc3BvbnNlLmJvZHkpIHtcblx0XHRcdHJlc3BvbnNlLmJvZHkgPSB7IH07XG5cdFx0fVxuXHRcdHJlc3BvbnNlLmJvZHkuZXJyb3IgPSBtc2c7XG5cblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwdWJsaWMgcnVuSW5UZXJtaW5hbFJlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5SdW5JblRlcm1pbmFsUmVxdWVzdEFyZ3VtZW50cywgdGltZW91dDogbnVtYmVyLCBjYjogKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJ1bkluVGVybWluYWxSZXNwb25zZSkgPT4gdm9pZCkge1xuXHRcdHRoaXMuc2VuZFJlcXVlc3QoJ3J1bkluVGVybWluYWwnLCBhcmdzLCB0aW1lb3V0LCBjYik7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZGlzcGF0Y2hSZXF1ZXN0KHJlcXVlc3Q6IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBuZXcgUmVzcG9uc2UocmVxdWVzdCk7XG5cblx0XHR0cnkge1xuXHRcdFx0aWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2luaXRpYWxpemUnKSB7XG5cdFx0XHRcdHZhciBhcmdzID0gPERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlcXVlc3RBcmd1bWVudHM+IHJlcXVlc3QuYXJndW1lbnRzO1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgYXJncy5saW5lc1N0YXJ0QXQxID09PSAnYm9vbGVhbicpIHtcblx0XHRcdFx0XHR0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID0gYXJncy5saW5lc1N0YXJ0QXQxO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0eXBlb2YgYXJncy5jb2x1bW5zU3RhcnRBdDEgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRcdHRoaXMuX2NsaWVudENvbHVtbnNTdGFydEF0MSA9IGFyZ3MuY29sdW1uc1N0YXJ0QXQxO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGFyZ3MucGF0aEZvcm1hdCAhPT0gJ3BhdGgnKSB7XG5cdFx0XHRcdFx0dGhpcy5zZW5kRXJyb3JSZXNwb25zZShyZXNwb25zZSwgMjAxOCwgJ2RlYnVnIGFkYXB0ZXIgb25seSBzdXBwb3J0cyBuYXRpdmUgcGF0aHMnLCBudWxsLCBFcnJvckRlc3RpbmF0aW9uLlRlbGVtZXRyeSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc3QgaW5pdGlhbGl6ZVJlc3BvbnNlID0gPERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlc3BvbnNlPiByZXNwb25zZTtcblx0XHRcdFx0XHRpbml0aWFsaXplUmVzcG9uc2UuYm9keSA9IHt9O1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZVJlcXVlc3QoaW5pdGlhbGl6ZVJlc3BvbnNlLCBhcmdzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2xhdW5jaCcpIHtcblx0XHRcdFx0dGhpcy5sYXVuY2hSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkxhdW5jaFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2F0dGFjaCcpIHtcblx0XHRcdFx0dGhpcy5hdHRhY2hSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2Rpc2Nvbm5lY3QnKSB7XG5cdFx0XHRcdHRoaXMuZGlzY29ubmVjdFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuRGlzY29ubmVjdFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Rlcm1pbmF0ZScpIHtcblx0XHRcdFx0dGhpcy50ZXJtaW5hdGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlRlcm1pbmF0ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Jlc3RhcnQnKSB7XG5cdFx0XHRcdHRoaXMucmVzdGFydFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuUmVzdGFydFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldEJyZWFrUG9pbnRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRCcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEZ1bmN0aW9uQnJlYWtwb2ludHMnKSB7XG5cdFx0XHRcdHRoaXMuc2V0RnVuY3Rpb25CcmVha1BvaW50c1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RnVuY3Rpb25CcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEV4Y2VwdGlvbkJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldEV4Y2VwdGlvbkJyZWFrUG9pbnRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRFeGNlcHRpb25CcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2NvbmZpZ3VyYXRpb25Eb25lJykge1xuXHRcdFx0XHR0aGlzLmNvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Db25maWd1cmF0aW9uRG9uZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2NvbnRpbnVlJykge1xuXHRcdFx0XHR0aGlzLmNvbnRpbnVlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Db250aW51ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ25leHQnKSB7XG5cdFx0XHRcdHRoaXMubmV4dFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuTmV4dFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBJbicpIHtcblx0XHRcdFx0dGhpcy5zdGVwSW5SZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlN0ZXBJblJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBPdXQnKSB7XG5cdFx0XHRcdHRoaXMuc3RlcE91dFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU3RlcE91dFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBCYWNrJykge1xuXHRcdFx0XHR0aGlzLnN0ZXBCYWNrUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TdGVwQmFja1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3JldmVyc2VDb250aW51ZScpIHtcblx0XHRcdFx0dGhpcy5yZXZlcnNlQ29udGludWVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Jlc3RhcnRGcmFtZScpIHtcblx0XHRcdFx0dGhpcy5yZXN0YXJ0RnJhbWVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlJlc3RhcnRGcmFtZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2dvdG8nKSB7XG5cdFx0XHRcdHRoaXMuZ290b1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuR290b1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3BhdXNlJykge1xuXHRcdFx0XHR0aGlzLnBhdXNlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5QYXVzZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0YWNrVHJhY2UnKSB7XG5cdFx0XHRcdHRoaXMuc3RhY2tUcmFjZVJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU3RhY2tUcmFjZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Njb3BlcycpIHtcblx0XHRcdFx0dGhpcy5zY29wZXNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlNjb3Blc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3ZhcmlhYmxlcycpIHtcblx0XHRcdFx0dGhpcy52YXJpYWJsZXNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldFZhcmlhYmxlJykge1xuXHRcdFx0XHR0aGlzLnNldFZhcmlhYmxlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRWYXJpYWJsZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEV4cHJlc3Npb24nKSB7XG5cdFx0XHRcdHRoaXMuc2V0RXhwcmVzc2lvblJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RXhwcmVzc2lvblJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NvdXJjZScpIHtcblx0XHRcdFx0dGhpcy5zb3VyY2VSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlNvdXJjZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3RocmVhZHMnKSB7XG5cdFx0XHRcdHRoaXMudGhyZWFkc1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuVGhyZWFkc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAndGVybWluYXRlVGhyZWFkcycpIHtcblx0XHRcdFx0dGhpcy50ZXJtaW5hdGVUaHJlYWRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5UZXJtaW5hdGVUaHJlYWRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZXZhbHVhdGUnKSB7XG5cdFx0XHRcdHRoaXMuZXZhbHVhdGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkV2YWx1YXRlUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnc3RlcEluVGFyZ2V0cycpIHtcblx0XHRcdFx0dGhpcy5zdGVwSW5UYXJnZXRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TdGVwSW5UYXJnZXRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZ290b1RhcmdldHMnKSB7XG5cdFx0XHRcdHRoaXMuZ290b1RhcmdldHNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkdvdG9UYXJnZXRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnY29tcGxldGlvbnMnKSB7XG5cdFx0XHRcdHRoaXMuY29tcGxldGlvbnNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkNvbXBsZXRpb25zUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZXhjZXB0aW9uSW5mbycpIHtcblx0XHRcdFx0dGhpcy5leGNlcHRpb25JbmZvUmVxdWVzdCg8RGVidWdQcm90b2NvbC5FeGNlcHRpb25JbmZvUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnbG9hZGVkU291cmNlcycpIHtcblx0XHRcdFx0dGhpcy5sb2FkZWRTb3VyY2VzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZGF0YUJyZWFrcG9pbnRJbmZvJykge1xuXHRcdFx0XHR0aGlzLmRhdGFCcmVha3BvaW50SW5mb1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuRGF0YUJyZWFrcG9pbnRJbmZvUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnc2V0RGF0YUJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldERhdGFCcmVha3BvaW50c1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RGF0YUJyZWFrcG9pbnRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAncmVhZE1lbW9yeScpIHtcblx0XHRcdFx0dGhpcy5yZWFkTWVtb3J5UmVxdWVzdCg8RGVidWdQcm90b2NvbC5SZWFkTWVtb3J5UmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZGlzYXNzZW1ibGUnKSB7XG5cdFx0XHRcdHRoaXMuZGlzYXNzZW1ibGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkRpc2Fzc2VtYmxlUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnY2FuY2VsJykge1xuXHRcdFx0XHR0aGlzLmNhbmNlbFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuQ2FuY2VsUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnYnJlYWtwb2ludExvY2F0aW9ucycpIHtcblx0XHRcdFx0dGhpcy5icmVha3BvaW50TG9jYXRpb25zUmVxdWVzdCg8RGVidWdQcm90b2NvbC5CcmVha3BvaW50TG9jYXRpb25zUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY3VzdG9tUmVxdWVzdChyZXF1ZXN0LmNvbW1hbmQsIDxEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdHRoaXMuc2VuZEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDExMDQsICd7X3N0YWNrfScsIHsgX2V4Y2VwdGlvbjogZS5tZXNzYWdlLCBfc3RhY2s6IGUuc3RhY2sgfSwgRXJyb3JEZXN0aW5hdGlvbi5UZWxlbWV0cnkpO1xuXHRcdH1cblx0fVxuXG5cdHByb3RlY3RlZCBpbml0aWFsaXplUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Jbml0aWFsaXplUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlcXVlc3RBcmd1bWVudHMpOiB2b2lkIHtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgY29uZGl0aW9uYWwgYnJlYWtwb2ludHMuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbmRpdGlvbmFsQnJlYWtwb2ludHMgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgaGl0IGNvbmRpdGlvbmFsIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNIaXRDb25kaXRpb25hbEJyZWFrcG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IGZ1bmN0aW9uIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNGdW5jdGlvbkJyZWFrcG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBpbXBsZW1lbnRzIHRoZSAnY29uZmlndXJhdGlvbkRvbmUnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCA9IHRydWU7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IGhvdmVycyBiYXNlZCBvbiB0aGUgJ2V2YWx1YXRlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNFdmFsdWF0ZUZvckhvdmVycyA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3N0ZXBCYWNrJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNTdGVwQmFjayA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3NldFZhcmlhYmxlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNTZXRWYXJpYWJsZSA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Jlc3RhcnRGcmFtZScgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzUmVzdGFydEZyYW1lID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnc3RlcEluVGFyZ2V0cycgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzU3RlcEluVGFyZ2V0c1JlcXVlc3QgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdnb3RvVGFyZ2V0cycgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzR290b1RhcmdldHNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnY29tcGxldGlvbnMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbXBsZXRpb25zUmVxdWVzdCA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Jlc3RhcnQnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1Jlc3RhcnRSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnZXhjZXB0aW9uT3B0aW9ucycgYXR0cmlidXRlIG9uIHRoZSAnc2V0RXhjZXB0aW9uQnJlYWtwb2ludHMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0V4Y2VwdGlvbk9wdGlvbnMgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdmb3JtYXQnIGF0dHJpYnV0ZSBvbiB0aGUgJ3ZhcmlhYmxlcycsICdldmFsdWF0ZScsIGFuZCAnc3RhY2tUcmFjZScgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzVmFsdWVGb3JtYXR0aW5nT3B0aW9ucyA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdleGNlcHRpb25JbmZvJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNFeGNlcHRpb25JbmZvUmVxdWVzdCA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdUZXJtaW5hdGVEZWJ1Z2dlZScgYXR0cmlidXRlIG9uIHRoZSAnZGlzY29ubmVjdCcgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRUZXJtaW5hdGVEZWJ1Z2dlZSA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgZGVsYXllZCBsb2FkaW5nIG9mIHN0YWNrIGZyYW1lcy5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzRGVsYXllZFN0YWNrVHJhY2VMb2FkaW5nID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2xvYWRlZFNvdXJjZXMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0xvYWRlZFNvdXJjZXNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2xvZ01lc3NhZ2UnIGF0dHJpYnV0ZSBvZiB0aGUgU291cmNlQnJlYWtwb2ludC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzTG9nUG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Rlcm1pbmF0ZVRocmVhZHMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1Rlcm1pbmF0ZVRocmVhZHNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3NldEV4cHJlc3Npb24nIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1NldEV4cHJlc3Npb24gPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAndGVybWluYXRlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNUZXJtaW5hdGVSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCBkYXRhIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNEYXRhQnJlYWtwb2ludHMgPSBmYWxzZTtcblxuXHRcdC8qKiBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3JlYWRNZW1vcnknIHJlcXVlc3QuICovXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1JlYWRNZW1vcnlSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvKiogVGhlIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2Rpc2Fzc2VtYmxlJyByZXF1ZXN0LiAqL1xuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNEaXNhc3NlbWJsZVJlcXVlc3QgPSBmYWxzZTtcblxuXHRcdC8qKiBUaGUgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnY2FuY2VsJyByZXF1ZXN0LiAqL1xuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNDYW5jZWxSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvKiogVGhlIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2JyZWFrcG9pbnRMb2NhdGlvbnMnIHJlcXVlc3QuICovXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0JyZWFrcG9pbnRMb2NhdGlvbnNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZGlzY29ubmVjdFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRGlzY29ubmVjdFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkRpc2Nvbm5lY3RBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdFx0dGhpcy5zaHV0ZG93bigpO1xuXHR9XG5cblx0cHJvdGVjdGVkIGxhdW5jaFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuTGF1bmNoUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuTGF1bmNoUmVxdWVzdEFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBhdHRhY2hSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlcXVlc3RBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgdGVybWluYXRlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcmVzdGFydFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzdGFydFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlJlc3RhcnRBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0QnJlYWtQb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldEJyZWFrcG9pbnRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0QnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0RnVuY3Rpb25CcmVha1BvaW50c1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU2V0RnVuY3Rpb25CcmVha3BvaW50c1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldEZ1bmN0aW9uQnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0RXhjZXB0aW9uQnJlYWtQb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldEV4Y2VwdGlvbkJyZWFrcG9pbnRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RXhjZXB0aW9uQnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29uZmlndXJhdGlvbkRvbmVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNvbmZpZ3VyYXRpb25Eb25lUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQ29uZmlndXJhdGlvbkRvbmVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udGludWVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQ29udGludWVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIG5leHRSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLk5leHRSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5OZXh0QXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGVwSW5SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlN0ZXBJblJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBJbkFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc3RlcE91dFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU3RlcE91dFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBPdXRBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHN0ZXBCYWNrUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGVwQmFja1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBCYWNrQXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCByZXZlcnNlQ29udGludWVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZVJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcmVzdGFydEZyYW1lUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXN0YXJ0RnJhbWVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5SZXN0YXJ0RnJhbWVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIGdvdG9SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkdvdG9SZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Hb3RvQXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBwYXVzZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUGF1c2VSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5QYXVzZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc291cmNlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Tb3VyY2VSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Tb3VyY2VBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHRocmVhZHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlRocmVhZHNSZXNwb25zZSwgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCB0ZXJtaW5hdGVUaHJlYWRzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVUaHJlYWRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuVGVybWluYXRlVGhyZWFkc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGFja1RyYWNlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGFja1RyYWNlUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU3RhY2tUcmFjZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzY29wZXNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNjb3Blc1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNjb3Blc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCB2YXJpYWJsZXNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXRWYXJpYWJsZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU2V0VmFyaWFibGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5TZXRWYXJpYWJsZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXRFeHByZXNzaW9uUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TZXRFeHByZXNzaW9uUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RXhwcmVzc2lvbkFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBldmFsdWF0ZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRXZhbHVhdGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5FdmFsdWF0ZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGVwSW5UYXJnZXRzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGVwSW5UYXJnZXRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU3RlcEluVGFyZ2V0c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBnb3RvVGFyZ2V0c1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuR290b1RhcmdldHNSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Hb3RvVGFyZ2V0c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBjb21wbGV0aW9uc1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuQ29tcGxldGlvbnNSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Db21wbGV0aW9uc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBleGNlcHRpb25JbmZvUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5FeGNlcHRpb25JbmZvUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuRXhjZXB0aW9uSW5mb0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBsb2FkZWRTb3VyY2VzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuTG9hZGVkU291cmNlc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkYXRhQnJlYWtwb2ludEluZm9SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkRhdGFCcmVha3BvaW50SW5mb1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkRhdGFCcmVha3BvaW50SW5mb0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXREYXRhQnJlYWtwb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldERhdGFCcmVha3BvaW50c1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldERhdGFCcmVha3BvaW50c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCByZWFkTWVtb3J5UmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZWFkTWVtb3J5UmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuUmVhZE1lbW9yeUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkaXNhc3NlbWJsZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRGlzYXNzZW1ibGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5EaXNhc3NlbWJsZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBjYW5jZWxSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNhbmNlbFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkNhbmNlbEFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBicmVha3BvaW50TG9jYXRpb25zUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5CcmVha3BvaW50TG9jYXRpb25zUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQnJlYWtwb2ludExvY2F0aW9uc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBPdmVycmlkZSB0aGlzIGhvb2sgdG8gaW1wbGVtZW50IGN1c3RvbSByZXF1ZXN0cy5cblx0ICovXG5cdHByb3RlY3RlZCBjdXN0b21SZXF1ZXN0KGNvbW1hbmQ6IHN0cmluZywgcmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzcG9uc2UsIGFyZ3M6IGFueSwgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDEwMTQsICd1bnJlY29nbml6ZWQgcmVxdWVzdCcsIG51bGwsIEVycm9yRGVzdGluYXRpb24uVGVsZW1ldHJ5KTtcblx0fVxuXG5cdC8vLS0tLSBwcm90ZWN0ZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHByb3RlY3RlZCBjb252ZXJ0Q2xpZW50TGluZVRvRGVidWdnZXIobGluZTogbnVtYmVyKTogbnVtYmVyIHtcblx0XHRpZiAodGhpcy5fZGVidWdnZXJMaW5lc1N0YXJ0QXQxKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2xpZW50TGluZXNTdGFydEF0MSA/IGxpbmUgOiBsaW5lICsgMTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuX2NsaWVudExpbmVzU3RhcnRBdDEgPyBsaW5lIC0gMSA6IGxpbmU7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udmVydERlYnVnZ2VyTGluZVRvQ2xpZW50KGxpbmU6IG51bWJlcik6IG51bWJlciB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyTGluZXNTdGFydEF0MSkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2NsaWVudExpbmVzU3RhcnRBdDEgPyBsaW5lIDogbGluZSAtIDE7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID8gbGluZSArIDEgOiBsaW5lO1xuXHR9XG5cblx0cHJvdGVjdGVkIGNvbnZlcnRDbGllbnRDb2x1bW5Ub0RlYnVnZ2VyKGNvbHVtbjogbnVtYmVyKTogbnVtYmVyIHtcblx0XHRpZiAodGhpcy5fZGVidWdnZXJDb2x1bW5zU3RhcnRBdDEpIHtcblx0XHRcdHJldHVybiB0aGlzLl9jbGllbnRDb2x1bW5zU3RhcnRBdDEgPyBjb2x1bW4gOiBjb2x1bW4gKyAxO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5fY2xpZW50Q29sdW1uc1N0YXJ0QXQxID8gY29sdW1uIC0gMSA6IGNvbHVtbjtcblx0fVxuXG5cdHByb3RlY3RlZCBjb252ZXJ0RGVidWdnZXJDb2x1bW5Ub0NsaWVudChjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyQ29sdW1uc1N0YXJ0QXQxKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2xpZW50Q29sdW1uc1N0YXJ0QXQxID8gY29sdW1uIDogY29sdW1uIC0gMTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuX2NsaWVudENvbHVtbnNTdGFydEF0MSA/IGNvbHVtbiArIDEgOiBjb2x1bW47XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udmVydENsaWVudFBhdGhUb0RlYnVnZ2VyKGNsaWVudFBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMuX2NsaWVudFBhdGhzQXJlVVJJcyAhPT0gdGhpcy5fZGVidWdnZXJQYXRoc0FyZVVSSXMpIHtcblx0XHRcdGlmICh0aGlzLl9jbGllbnRQYXRoc0FyZVVSSXMpIHtcblx0XHRcdFx0cmV0dXJuIERlYnVnU2Vzc2lvbi51cmkycGF0aChjbGllbnRQYXRoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBEZWJ1Z1Nlc3Npb24ucGF0aDJ1cmkoY2xpZW50UGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBjbGllbnRQYXRoO1xuXHR9XG5cblx0cHJvdGVjdGVkIGNvbnZlcnREZWJ1Z2dlclBhdGhUb0NsaWVudChkZWJ1Z2dlclBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzICE9PSB0aGlzLl9jbGllbnRQYXRoc0FyZVVSSXMpIHtcblx0XHRcdGlmICh0aGlzLl9kZWJ1Z2dlclBhdGhzQXJlVVJJcykge1xuXHRcdFx0XHRyZXR1cm4gRGVidWdTZXNzaW9uLnVyaTJwYXRoKGRlYnVnZ2VyUGF0aCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gRGVidWdTZXNzaW9uLnBhdGgydXJpKGRlYnVnZ2VyUGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBkZWJ1Z2dlclBhdGg7XG5cdH1cblxuXHQvLy0tLS0gcHJpdmF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHJpdmF0ZSBzdGF0aWMgcGF0aDJ1cmkocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcblxuXHRcdGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XG5cdFx0XHRpZiAoL15bQS1aXTovLnRlc3QocGF0aCkpIHtcblx0XHRcdFx0cGF0aCA9IHBhdGhbMF0udG9Mb3dlckNhc2UoKSArIHBhdGguc3Vic3RyKDEpO1xuXHRcdFx0fVxuXHRcdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFxcXC9nLCAnLycpO1xuXHRcdH1cblx0XHRwYXRoID0gZW5jb2RlVVJJKHBhdGgpO1xuXG5cdFx0bGV0IHVyaSA9IG5ldyBVUkwoYGZpbGU6YCk7XHQvLyBpZ25vcmUgJ3BhdGgnIGZvciBub3dcblx0XHR1cmkucGF0aG5hbWUgPSBwYXRoO1x0Ly8gbm93IHVzZSAncGF0aCcgdG8gZ2V0IHRoZSBjb3JyZWN0IHBlcmNlbnQgZW5jb2RpbmcgKHNlZSBodHRwczovL3VybC5zcGVjLndoYXR3Zy5vcmcpXG5cdFx0cmV0dXJuIHVyaS50b1N0cmluZygpO1xuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgdXJpMnBhdGgoc291cmNlVXJpOiBzdHJpbmcpOiBzdHJpbmcge1xuXG5cdFx0bGV0IHVyaSA9IG5ldyBVUkwoc291cmNlVXJpKTtcblx0XHRsZXQgcyA9IGRlY29kZVVSSUNvbXBvbmVudCh1cmkucGF0aG5hbWUpO1xuXHRcdGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XG5cdFx0XHRpZiAoL15cXC9bYS16QS1aXTovLnRlc3QocykpIHtcblx0XHRcdFx0cyA9IHNbMV0udG9Mb3dlckNhc2UoKSArIHMuc3Vic3RyKDIpO1xuXHRcdFx0fVxuXHRcdFx0cyA9IHMucmVwbGFjZSgvXFwvL2csICdcXFxcJyk7XG5cdFx0fVxuXHRcdHJldHVybiBzO1xuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgX2Zvcm1hdFBJSVJlZ2V4cCA9IC97KFtefV0rKX0vZztcblxuXHQvKlxuXHQqIElmIGFyZ3VtZW50IHN0YXJ0cyB3aXRoICdfJyBpdCBpcyBPSyB0byBzZW5kIGl0cyB2YWx1ZSB0byB0ZWxlbWV0cnkuXG5cdCovXG5cdHByaXZhdGUgc3RhdGljIGZvcm1hdFBJSShmb3JtYXQ6c3RyaW5nLCBleGNsdWRlUElJOiBib29sZWFuLCBhcmdzOiB7W2tleTogc3RyaW5nXTogc3RyaW5nfSk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIGZvcm1hdC5yZXBsYWNlKERlYnVnU2Vzc2lvbi5fZm9ybWF0UElJUmVnZXhwLCBmdW5jdGlvbihtYXRjaCwgcGFyYW1OYW1lKSB7XG5cdFx0XHRpZiAoZXhjbHVkZVBJSSAmJiBwYXJhbU5hbWUubGVuZ3RoID4gMCAmJiBwYXJhbU5hbWVbMF0gIT09ICdfJykge1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gYXJnc1twYXJhbU5hbWVdICYmIGFyZ3MuaGFzT3duUHJvcGVydHkocGFyYW1OYW1lKSA/XG5cdFx0XHRcdGFyZ3NbcGFyYW1OYW1lXSA6XG5cdFx0XHRcdG1hdGNoO1xuXHRcdH0pXG5cdH1cbn1cbiJdfQ==","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Message {\n    constructor(type) {\n        this.seq = 0;\n        this.type = type;\n    }\n}\nexports.Message = Message;\nclass Response extends Message {\n    constructor(request, message) {\n        super('response');\n        this.request_seq = request.seq;\n        this.command = request.command;\n        if (message) {\n            this.success = false;\n            this.message = message;\n        }\n        else {\n            this.success = true;\n        }\n    }\n}\nexports.Response = Response;\nclass Event extends Message {\n    constructor(event, body) {\n        super('event');\n        this.event = event;\n        if (body) {\n            this.body = body;\n        }\n    }\n}\nexports.Event = Event;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvbWVzc2FnZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Z0dBR2dHOztBQUtoRyxNQUFhLE9BQU87SUFJbkIsWUFBbUIsSUFBWTtRQUM5QixJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztRQUNiLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ2xCLENBQUM7Q0FDRDtBQVJELDBCQVFDO0FBRUQsTUFBYSxRQUFTLFNBQVEsT0FBTztJQUtwQyxZQUFtQixPQUE4QixFQUFFLE9BQWdCO1FBQ2xFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNsQixJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDL0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQy9CLElBQUksT0FBTyxFQUFFO1lBQ1osSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDZixJQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztTQUM5QjthQUFNO1lBQ04sSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7U0FDcEI7SUFDRixDQUFDO0NBQ0Q7QUFoQkQsNEJBZ0JDO0FBRUQsTUFBYSxLQUFNLFNBQVEsT0FBTztJQUdqQyxZQUFtQixLQUFhLEVBQUUsSUFBVTtRQUMzQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLElBQUksRUFBRTtZQUNILElBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1NBQ3hCO0lBQ0YsQ0FBQztDQUNEO0FBVkQsc0JBVUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHsgRGVidWdQcm90b2NvbCB9IGZyb20gJ3ZzY29kZS1kZWJ1Z3Byb3RvY29sJztcblxuXG5leHBvcnQgY2xhc3MgTWVzc2FnZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuUHJvdG9jb2xNZXNzYWdlIHtcblx0c2VxOiBudW1iZXI7XG5cdHR5cGU6IHN0cmluZztcblxuXHRwdWJsaWMgY29uc3RydWN0b3IodHlwZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5zZXEgPSAwO1xuXHRcdHRoaXMudHlwZSA9IHR5cGU7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlc3BvbnNlIGV4dGVuZHMgTWVzc2FnZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuUmVzcG9uc2Uge1xuXHRyZXF1ZXN0X3NlcTogbnVtYmVyO1xuXHRzdWNjZXNzOiBib29sZWFuO1xuXHRjb21tYW5kOiBzdHJpbmc7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlcXVlc3Q6IERlYnVnUHJvdG9jb2wuUmVxdWVzdCwgbWVzc2FnZT86IHN0cmluZykge1xuXHRcdHN1cGVyKCdyZXNwb25zZScpO1xuXHRcdHRoaXMucmVxdWVzdF9zZXEgPSByZXF1ZXN0LnNlcTtcblx0XHR0aGlzLmNvbW1hbmQgPSByZXF1ZXN0LmNvbW1hbmQ7XG5cdFx0aWYgKG1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuc3VjY2VzcyA9IGZhbHNlO1xuXHRcdFx0KDxhbnk+dGhpcykubWVzc2FnZSA9IG1lc3NhZ2U7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc3VjY2VzcyA9IHRydWU7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBFdmVudCBleHRlbmRzIE1lc3NhZ2UgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkV2ZW50IHtcblx0ZXZlbnQ6IHN0cmluZztcblxuXHRwdWJsaWMgY29uc3RydWN0b3IoZXZlbnQ6IHN0cmluZywgYm9keT86IGFueSkge1xuXHRcdHN1cGVyKCdldmVudCcpO1xuXHRcdHRoaXMuZXZlbnQgPSBldmVudDtcblx0XHRpZiAoYm9keSkge1xuXHRcdFx0KDxhbnk+dGhpcykuYm9keSA9IGJvZHk7XG5cdFx0fVxuXHR9XG59XG4iXX0=","import * as vscode from 'vscode';\r\nimport { lookupLabelReference, createDefinitionForLabelReference, MumpsLabel } from './mumps-label-lookup';\r\nconst definitionsArray = require('./../language-definitions.json');\r\n\r\nconst definitions = {};\r\nexports.definitions = definitions;\r\n\r\nclass MumpsToken {\r\n    _definition: any;\r\n    referredToLabel:MumpsLabel;\r\n    labelProgram: String;\r\n    labelOffset: number;\r\n    label: string;\r\n    _isLabelReference: Boolean;\r\n    document: vscode.TextDocument;\r\n    position:vscode.Position;\r\n    range:vscode.Range;\r\n    word:String;\r\n    surroundWord:String;\r\n\r\n    constructor(document, position) {\r\n        this.document = document;\r\n        this.position = position;\r\n\r\n        this.range = document.getWordRangeAtPosition(position);\r\n        if (!this.range) {\r\n            return;\r\n        }\r\n\r\n        this.word = document.getText(this.range);\r\n        if (!this.word) {\r\n            return;\r\n        }\r\n\r\n        this.surroundWord = getWordWithSurrounds(document, this.range) || this.word;\r\n\r\n        if (this.isIntrinsic) {\r\n            this.word = '$' + this.word;\r\n        }\r\n    }\r\n\r\n    get mayBeCommand() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        let lastChar = this.surroundWord.charAt(this.surroundWord.length - 1);\r\n        return (isWhitespace(this.surroundWord.charAt(0)) ||this.surroundWord.charAt(0)===\".\") &&\r\n            (lastChar === ':' ||\r\n                isWhitespace(lastChar) ||\r\n                this.surroundWord.length === this.word.length + 1);   // end-of-line\r\n    }\r\n\r\n    get isIntrinsic() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        return this.surroundWord.charAt(0) === '$' && this.surroundWord.charAt(1) !== '$';\r\n    }\r\n\r\n    get isFunctionCall() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        return this.surroundWord.charAt(this.surroundWord.length - 1) === '(';\r\n    }\r\n\r\n    get isLabelReference() {\r\n        if (this._isLabelReference === undefined) {\r\n            let line = this.document.lineAt(this.range.start);\r\n            let word = this.isIntrinsic ? this.word.substring(1) : this.word;\r\n            let regex = new RegExp('(([ \\t](D|DO|G|GOTO)[ \\t]+)|\\\\$\\\\$)([%\\\\^\\\\+A-Z0-9]*' + word + '[%\\\\^\\\\+A-Z0-9]*)', 'i');\r\n            let match = regex.exec(line.text);\r\n            this._isLabelReference = match !== null;\r\n            if (match) {\r\n                let fullLabel = match[4];\r\n                let partsRegex = /([%A-Z][%A-Z0-9]*)?(\\+\\d+)?(\\^[%A-Z][%A-Z0-9]*)?/gi;\r\n\t\t\t\t\t\t\t\tlet parts = partsRegex.exec(fullLabel);\r\n\t\t\t\t\t\t\t\tif (parts) {\r\n\t\t\t\t\t\t\t\t\tthis.label = parts[1];\r\n\t\t\t\t\t\t\t\t\tthis.labelOffset = Number(withoutFirstCharacter(parts[2]));\r\n\t\t\t\t\t\t\t\t\tthis.labelProgram = withoutFirstCharacter(parts[3]);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n                this.referredToLabel = lookupLabelReference(this);\r\n            }\r\n        }\r\n        return this._isLabelReference;\r\n    }\r\n\r\n    get definition() {\r\n        if (this._definition === undefined) {\r\n            this._definition = false;\r\n            let matches = definitions[this.word.toUpperCase()];\r\n            if (matches) {\r\n                for (let definition of matches) {\r\n                    if (this.isFunctionCall && definition.type !== 'function') {\r\n                        continue;\r\n                    }\r\n                    this._definition = definition;\r\n                    break;\r\n                }\r\n            } else if (this.isLabelReference) {\r\n                this._definition = createDefinitionForLabelReference(this.referredToLabel);\r\n            }\r\n            if (this._definition && this._definition.type === 'function') {\r\n                this._definition.functionSignature = formatFunctionSignature(this._definition);\r\n            }\r\n        }\r\n        return this._definition;\r\n    }\r\n}\r\n\r\n\r\nfunction getWordWithSurrounds(document, range) {\r\n    if (range.start.character <= 0) {\r\n        return;\r\n    }\r\n    let start = new vscode.Position(range.start.line, range.start.character - 1);\r\n    let end = new vscode.Position(range.end.line, range.end.character + 1);\r\n    let surroundWord = document.getText(new vscode.Range(start, end));\r\n\r\n    // check for two dollar signs\r\n    if (surroundWord.charAt(0) === '$') {\r\n        start = new vscode.Position(start.line, start.character - 1);\r\n        let extendedWord = document.getText(new vscode.Range(start, end));\r\n        if (extendedWord.charAt(0) === '$') {\r\n            surroundWord = extendedWord;\r\n        }\r\n    }\r\n    return surroundWord;\r\n}\r\n\r\nfunction isWhitespace(char) {\r\n    return /\\s+/.test(char);\r\n}\r\n\r\nfunction withoutFirstCharacter(string) {\r\n    return string ? string.substring(1) : string;\r\n}\r\n\r\nfunction formatFunctionSignature(definition) {\r\n    let signature = definition.name + '(';\r\n    if (definition.parameters) {\r\n        for (let i = 0; i < definition.parameters.length; i++) {\r\n            signature += formatParameter(definition.parameters[i], i === 0);\r\n        }\r\n    }\r\n    signature += ')';\r\n    if (definition.returns) {\r\n        signature += ':' + definition.returns.type;\r\n    }\r\n    return signature;\r\n}\r\n\r\nfunction formatParameter(parameter, first) {\r\n    let s = (first ? '' : ',');\r\n    s += parameter.name;\r\n    s += ':' + parameter.type;\r\n    if (parameter.optional) {\r\n        s = '[' + s + ']';\r\n    }\r\n    return s;\r\n}\r\n\r\nfunction addDefinition(name, definition) {\r\n    if (!definitions[name]) {\r\n        definitions[name] = [definition];\r\n    } else {\r\n        definitions[name].push(definition);\r\n    }\r\n}\r\n\r\nfor (let definition of definitionsArray) {\r\n    addDefinition(definition.name, definition);\r\n    if (definition.abbreviation) {\r\n        addDefinition(definition.abbreviation, definition);\r\n    }\r\n}\r\nexport {MumpsToken};","\r\nlet fs = require('fs');\r\nlet renderer = require('./mumps-render');\r\ninterface ErrorInformation {\r\n\ttext: string,\r\n\tposition: number,\r\n\tline?: number,\r\n\tindexFound?: boolean,\r\n\tglobalFound?: boolean,\r\n\tindirectionFound?: boolean\r\n}\r\nexport enum TokenType {\r\n\t\"global\" = \"global\", \"local\" = \"local\", \"exfunction\" = \"exfunction\", \"nonMfunction\" = \"nonMfunction\", \"entryref\" = \"entryref\",\r\n\t\"operator\" = \"operator\", \"keyword\" = \"keyword\", \"ifunction\" = \"ifunction\", \"label\" = \"label\", \"comment\" = \"comment\",\r\n\t\"sysvariable\" = \"sysvariable\", \"string\" = \"string\", \"number\" = \"number\"\r\n}\r\ninterface LineToken {\r\n\ttype: TokenType,\r\n\tname: string,\r\n\tlongName?: string,\r\n\tposition: number\r\n}\r\ninterface LineComand {\r\n\tcommand: string,\r\n\tposition: number\r\n}\r\ninterface LineComment {\r\n\tcomment: string,\r\n\tposition: number\r\n}\r\ninterface LineObject {\r\n\tlineComment?: LineComment;\r\n\tlineIndentationArray?: string[];\r\n\tlineRoutines?: TmpFunction[];\r\n\tlineLeadSpace?: string,\r\n\tlineLabel?: string,\r\n\tlineExpression: string,\r\n\terrorText?: string,\r\n\terrorPosition?: number,\r\n\texpressionPosition: number\r\n}\r\ninterface TmpFunction {\r\n\tmCommand: string,\r\n\tmArguments: string,\r\n\tmPostCondition: string,\r\n\tcmdPosition: number,\r\n\targPosition: number,\r\n\tpcPosition: number\r\n}\r\ninterface ModifiedLine {\r\n\tlineText: string,\r\n\terrorText: string\r\n}\r\n\r\nconst label = /^[A-Za-z%][A-Za-z0-9]*(\\([A-Za-z%][A-Za-z0-9]*(,[A-Za-z%][A-Za-z0-9]*)*\\))?/\r\nconst lvn = /^[A-Za-z%][A-Za-z0-9]*/\r\nconst gvn = /^\\^[A-Za-z%][A-Za-z0-9]*/\r\nconst isv = /^\\$(DEVICE|ECODE|EC|ESTACK|ES|ETRAP|ET|HALT|HOROLOG|H|IO|I|JOB|J|KEY|K|NAMESPACE|PRINCIPAL|P|QUIT|Q|REFERENCE|R|STACK|ST|STORAGE|S|SYSTEM|TEST|THIS|TLEVEL|TL|T|USERNAME|X|Y|ZALLOCSTOR|ZA|ZB|ZCHSET|ZCLOSE|ZCMDLINE|ZCM|ZCOMPILE|ZCO|ZCSTATUS|ZCH[A-Z]*|ZC|ZDATEFORM|ZDA|ZDIRECTORY|ZD|ZEDITOR|ZED|ZEOF|ZEO|ZE[A-Z]*|ZGBLDIR|ZG|ZHRORLOG|ZH|ZININTERRUPT|ZINI|ZINTERRUPT|ZINT|ZIO|ZJOB|ZJ|ZKEY|ZLEVEL|ZL|ZMAXTPTIME|ZMAXTPTI|ZMODE|ZMO|ZONLNRLBK|ZPATNUMERIC|ZPATN|ZPIN|ZPOSITION|ZPOS|ZPOUT|ZPROMPT|ZQUIT|ZREALSTOR|ZRELDATE|ZRO[A-Z]*|ZSOURCE|ZSO|ZSTA[A-Z]*|ZSTEP|ZSTRP|ZSTRPLLIM|ZST|ZSYSTEM|ZSY|ZS|ZTEXIT|ZTE|ZTIMEOUT|ZTIM|ZTRAP|ZT|ZUSEDSTOR|ZUT|ZVERSION|ZV[A-Z]*|ZYERROR|ZYRELEASE|ZTDATA|ZTDELIM|ZTLEVEL|ZTNAME|ZTOLDVAL|ZTRIGGEROP|ZTSLATE|ZTUPDATE|ZTVALUE|ZTWORMHOLE)/i\r\nconst ifunction = /^\\$(ASCII|A|CHAR|C|DATA|D|EXTRACT|E|FIND|F|FNUMBER|FN|GET|G|INCREMENT|INCR|I|JUSTIFY|J|LENGTH|L|NAME|NA|NEXT|N|ORDER|O|PIECE|P|QLENGTH|QL|QSUBSCRIPT|QS|QUERY|Q|RANDOM|R|REVERSE|RE|SELECT|S|STACK|ST|TEXT|T|TRANSLATE|TR|VIEW|V|ZAHANDLE|ZAH|ZASCII|ZATRANSFORM|ZAT|ZBITAND|ZBITCOUNT|ZBITFIND|ZBITGET|ZBITLEN|ZBITNOT|ZBITOR|ZBITSET|ZBITSTR|ZBITXOR|ZCHAR|ZCH|ZCOLLATE|ZCONVERT|ZCO|ZDATE|ZDATA|ZD|ZEXTRACT|ZE|ZFIND|ZF|ZGETJPI|ZG|ZINCREMENT|ZINCR|ZJOBEXAM|ZJUSTIFY|ZJ|ZLENGTH|ZL|ZMESSAGE|ZPARSE|ZPEEK|ZPIECE|ZPI|ZPREVIOUS|ZP|ZQGBLMOD|ZSEARCH|ZSIGPROC|ZSOCKET|ZSUBSTR|ZSUB|ZSYSLOG|ZTRANSLATE|ZTRIGGER|ZTRI|ZTRNLNM|ZTR|ZWIDTH|ZWRITE|ZW)(?=\\()/i;\r\nconst nonMfunction = /^\\$\\&([A-Za-z%0-9][A-Za-z0-9]*.)?([A-Za-z%0-9][A-Za-z0-9]*)?(\\^[A-Za-z%][A-Za-z0-9]*)?/\r\nconst entryref = /^(\\&[A-Za-z0-9]*\\.?)?@?([A-Za-z%0-9][A-Za-z0-9]*)?(\\^@?[A-Za-z%][A-Za-z0-9]*)?/\r\nconst routineref = /^\\^@?[A-Za-z%][A-Za-z0-9]*/\r\nconst numlit = /^(\\d*\\.?\\d*(E-?\\d+)?)/\r\nconst strlit = /^\"([^\"]*(\"\")*)*\"/\r\nconst command = /^[B|BREAK|C|CLOSE|D|DO|E|ELSE|F|FOR|G|GOTO|H|HALT|HANG|I|IF|J|JOB|K|KILL|L|LOCK|M|MERGE|N|NEW|O|OPEN|Q|QUIT|R|READ|S|SET|U|USE|V|VIEW|W|WRITE|X|XECUTE|ZA|ZALLOCATE|ZBR|ZBREAK|ZC|ZCONTINUE|ZD|ZDEALLOCATE|ZE|ZEDIT|ZG|ZGOTO|ZHALT|ZH|ZHELP|ZK|ZKILL|ZL|ZLINK|ZM|ZMESSAGE|ZP|ZPRINT|ZRUPDATE|ZSH|ZSHOW|ZST|ZSTEP|ZSY|ZSYSTEM|ZTC|ZTCOMMIT|ZTR|ZTRIGGER|ZTS|ZTSTART|ZWI|ZWITHDRAW|ZWR|ZWRITE]/i\r\nconst binoperator = /^('=|'>|'<|<=|>=|'&|'!|'\\?|'\\[|'\\]|\\*\\*|\\+|\\-|\\*|\\/|\\\\|#|'|&|!|_|<|>|=|\\[|\\]|\\?|@)/\r\nconst unaryoperator = /(\\-|'|\\+|@)/\r\nconst patcode = /^([A|C|E|L|N|P|U]|^(\"([^\"](\"\")*)*\"))+/i\r\nconst repititionCount = /^\\d*\\.?\\d*/\r\nconst openkeywords = /^APPEND|ATTACH=|BLOCK(SIZE)?=|COMMAND=|CONNECT=|(NO)?DELIM(ITER)?=?|EXC(EPTION)?=|FIFO|(NO)?FIXED|GROUP=|[IO]?CHSET=|KEY|IKEY|INDEPENDANT|IOERROR=|NEW[A-Z]*|MOREREADTIME=|OKEY|OWNER=|(NO)?RCHK|(NO)?READ(ONLY)?|RECORD(SIZE)?=|(NO)?RETRY|REWIND|SEEK=|SHELL=|STDERR=|(NO)?STREAM|SYSTEM=|(NO)?TRUNCATE|UIC=|VARIABLE|WORLD=|Z?(NO)?WRAP|WRITE(ONLY)?|ZBFSIZE|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE|Z?LISTEN=/i\r\nconst usekeywords = /^ATTACH|(NO)?CENABLE|[IO]?CHSET=|CLEAR(SCREEN)?|CONNECT|(NO)?CONVERT|CTRAP=|(NO)?DELIM(ITER)?=?|DETACH|DOWNSCROLL|(NO)?ECHO|(NO)?EDITING|ERASELINE|(NO)?ESC(APE)?|EXC(EPTION)?=|(NO)?FILTER=?|FLUSH|GROUP=|KEY|IKEY|IOERROR=|OKEY|OWNER=|(NO)?PASTHRU|(NO)?RCHK|(NO)?RETRY|REWIND|SEEK=|SKIPFILE=|SOCKET=|SPACE=|TERM(INATOR)?=|(NO)?TRUNCATE|(NO)?TTSNYC|(NO)?TYPEAHEAD|UPSCROLL|Z?LENGTH=|Z?WIDTH=|Z?(NO)?WRAP|WRITELB=|X=|Y=|ZBFSIZE|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE|LISTEN=/i\r\nconst closekeywords = /^DELETE|(NO)?DESTROY|EXCEPTION=|GROUP=|OWNER=|RENAME=|SOCKET=|TIMEOUT=|UIC=|WORLD=/i\r\nconst jobkeywords = /^CMD=|CMDLINE=|DEF=|DEFAULT=|ERR=|ERROR=|GBL=|GBLDIR=|IN=|INPUT=|OUT=|OUTPUT=|PASS|PASSCURLVN|STA=|STARTUP=/i\r\nconst tstartkeywords = /^SERIAL|S|T=|TRANSACTIONID=/i\r\nconst cmdExpansions = {\r\n\t'B': 'BREAK', 'C': 'CLOSE', 'D': 'DO', 'E': 'ELSE', 'F': 'FOR', 'G': 'GOTO', 'H': 'HALT', 'I': 'IF', 'J': 'JOB', 'K': 'KILL', 'L': 'LOCK', 'M': 'MERGE', 'N': 'NEW',\r\n\t'O': 'OPEN', 'Q': 'QUIT', 'R': 'READ', 'S': 'SET', 'U': 'USE', 'V': 'VIEW', 'W': 'WRITE', 'X': 'XECUTE', 'ZA': 'ZALLOCATE', 'ZB': 'ZBREAK', 'ZC': 'ZCONTINUE',\r\n\t'ZD': 'ZDEALLOCATE', 'ZED': 'ZEDIT', 'ZG': 'ZGOTO', 'ZH': 'ZHELP', 'ZK': 'ZKILL', 'ZL': 'ZLINK', 'ZM': 'ZMESSAGE', 'ZP': 'ZPRINT', 'ZSH': 'ZSHOW',\r\n\t'ZST': 'ZSTEP', 'ZSY': 'ZSYSTEM', 'ZTC': 'ZTCOMMIT', 'ZTR': 'ZTRIGGER', 'ZTS': 'ZTSTART', 'ZWI': 'ZWITHDRAW', 'ZWR': 'ZWRITE'\r\n}\r\nconst funcExpansions = {\r\n\t'A': 'ASCII', 'C': 'CHAR', 'D': 'DATA', 'E': 'EXTRACT', 'F': 'FIND', 'FN': 'FNUMBER', 'G': 'GET', 'I': 'INCREMENT', 'J': 'JUSTIFY', 'L': 'LENGTH', 'NA': 'NAME', 'N': 'NEXT', 'O': 'ORDER',\r\n\t'P': 'PIECE', 'QL': 'QLENGTH', 'QS': 'QSUBSCRIPT', 'Q': 'QUERY', 'R': 'RANDOM', 'RE': 'REVERSE', 'S': 'SELECT', 'ST': 'STACK', 'T': 'TEXT', 'TR': 'TRANSLATE', 'V': 'VIEW',\r\n\t'ZA': 'ZASCII', 'ZAH': 'ZAHANDLE', 'ZCO': 'ZCONVERT', 'ZD': 'ZDATE', 'ZE': 'ZEXTRACT', 'ZF': 'ZFIND', 'ZG': 'ZGETJPI', 'ZJ': 'ZJUSTIFY', 'ZL': 'ZLENGTH', 'ZM': 'ZMESSAGE', 'ZPI': 'ZPIECE', 'ZP': 'ZPREVIOUS',\r\n\t'ZSUB': 'ZSUBSTR', 'ZTR': 'ZTRANSLATE', 'ZTRI': 'ZTRIGGER', 'ZW': 'ZWIDTH'\r\n}\r\nconst isvExpansions = {\r\n\t'D': 'DEVICE', 'EC': 'ECODE', 'ES': 'ESTACK', 'ET': 'ETRAP', 'H': 'HOROLOG', 'I': 'IO', 'J': 'JOB', 'K': 'KEY', 'P': 'PRINCIPAL', 'Q': 'QUIT', 'R': 'REFERENCE', 'ST': 'STACK',\r\n\t'S': 'STORAGE', 'SY': 'SYSTEM', 'T': 'TEST', 'TL': 'TLEVEL', 'TR': 'TRESTART', 'ZC': 'ZCSTATUS', 'ZDA': 'ZDATEFORM', 'ZD': 'ZDIRECTORY', 'ZED': 'ZEDITOR', 'ZEO': 'ZEOF', 'ZE': 'ZERROR',\r\n\t'ZG': 'ZGBLDIR', 'ZH': 'ZHRORLOG', 'ZINI': 'ZININTERRUPT', 'ZINT': 'ZINTERRUPT', 'ZJ': 'ZJOB', 'ZL': 'ZLEVEL', 'ZMAXPTI': 'ZMAXTPTIME', 'ZMO': 'ZMODE', 'ZPOS': 'ZPOSITION',\r\n\t'ZPROM': 'ZPROMPT', 'ZRO': 'ZROUTINES', 'ZSO': 'ZSOURCE', 'ZS': 'ZSTATUS', 'ZST': 'ZSTEP', 'ZSTRP': 'ZSTRPLLIM', 'ZSY': 'ZSYSTEM', 'ZTE': 'ZTEXIT', 'ZTIM': 'ZTIMEOUT', 'ZT': 'ZTRAP',\r\n\t'ZV': 'ZVERSION', 'ZYER': 'ZYERROR', 'ZYRE': 'ZYRELEASE', 'ZTDE': 'ZTDELIM'\r\n\r\n}\r\nconst cmdParams = {\r\n\t'BREAK': {\r\n\t\t'abbreviation': 'B',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr[:tvexpr][,...]]'\r\n\t},\r\n\t'CLOSE': {\r\n\t\t'abbreviation': 'C',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:(keyword[=expr][:...])][,...]'\r\n\t},\r\n\t'DO': {\r\n\t\t'abbreviation': 'D',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[entryref[(expr:.lvn[,...])][:tvexpr][,...]]'\r\n\t},\r\n\t'ELSE':\r\n\t{\r\n\t\t'abbreviation': 'E',\r\n\t\t'postcondition': false,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'FOR': {\r\n\t\t'abbreviation': 'F',\r\n\t\t'postcondition': false,\r\n\t\t'parameter': '[lvn=expr[:numexpr1[:numexpr2]][,...]]]'\r\n\t},\r\n\t'GOTO': {\r\n\t\t'abbreviation': 'G',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'entryref[:tvexpr][,...]'\r\n\t},\r\n\t'HALT': {\r\n\t\t'abbreviation': 'H',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'HANG': {\r\n\t\t'abbreviation': 'H',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'numexpr[,...]'\r\n\t},\r\n\t'IF': {\r\n\t\t'abbreviation': 'I',\r\n\t\t'postcondition': false,\r\n\t\t'parameter': '[tvexpr[,...]]'\r\n\t},\r\n\t'JOB': {\r\n\t\t'abbreviation': 'J',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'entryref[(expr[,...])][:[(keyword[=value][:...])][:numexpr]][,...]'\r\n\t},\r\n\t'KILL': {\r\n\t\t'abbreviation': 'K',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[glvn | (lvn[,...]) | *lname | *lvn ]'\r\n\t},\r\n\t'LOCK': {\r\n\t\t'abbreviation': 'L',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[[-|+]nref|(nref[,...])[:numexpr] [,...]]'\r\n\t},\r\n\t'MERGE': {\r\n\t\t'abbreviation': 'M',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'glvn=glvn[,...]'\r\n\t},\r\n\t'NEW': {\r\n\t\t'abbreviation': 'N',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[[(]lvn[,...][)][,...]]'\r\n\t},\r\n\t'OPEN': {\r\n\t\t'abbreviation': 'O',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:[(keyword[=expr][:...])] [:numexpr]][,...]'\r\n\t},\r\n\t'QUIT': {\r\n\t\t'abbreviation': 'Q',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr | *lname | *lvn]'\r\n\t},\r\n\t'READ': {\r\n\t\t'abbreviation': 'R',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '(glvn|*glvn|glvn#intexpr)[:numexpr]|strlit|fcc[,...]'\r\n\t},\r\n\t'SET': {\r\n\t\t'abbreviation': 'S',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'setleft=expr | (setleft[,...])=expr | *lvn=lname | aliascontainer[,...]'\r\n\t},\r\n\t'TCOMMIT': {\r\n\t\t'abbreviation': 'TC',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'TRESTART': {\r\n\t\t'abbreviation': 'TRE',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'TROLLBACK': {\r\n\t\t'abbreviation': 'TRO',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[intexpr]'\r\n\t},\r\n\t'TSTART': {\r\n\t\t'abbreviation': 'TS',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[([lvn...])|lvn|*|][:keyword|(keyword...)]'\r\n\t},\r\n\t'USE': {\r\n\t\t'abbreviation': 'U',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:(keyword[=expr][:...])][,...]'\r\n\t},\r\n\t'VIEW': {\r\n\t\t'abbreviation': 'V',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'keyword[:expr[:...]][,...]'\r\n\t},\r\n\t'WRITE': {\r\n\t\t'abbreviation': 'W',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr|*intexpr|fcc[,...]'\r\n\t},\r\n\t'XECUTE': {\r\n\t\t'abbreviation': 'X',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:tvexpr][,...]'\r\n\t},\r\n\t'ZALLOCATE': {\r\n\t\t'abbreviation': 'ZA',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[(]nref[,...][)][:intexpr][,...]'\r\n\t},\r\n\t'ZBREAK': {\r\n\t\t'abbreviation': 'ZB',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[-]entryref[:[expr][:intexpr]][,...]'\r\n\t},\r\n\t'ZCOMPILE': {\r\n\t\t'abbreviation': 'ZCOM',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[,...]'\r\n\t},\r\n\t'ZCONTINUE': {\r\n\t\t'abbreviation': 'ZC',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'ZDEALLOCATE': {\r\n\t\t'abbreviation': 'ZD',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[nref[,...]]'\r\n\t},\r\n\t'ZEDIT': {\r\n\t\t'abbreviation': 'ZED',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr[,...]]'\r\n\t},\r\n\t'ZGOTO': {\r\n\t\t'abbreviation': 'ZG',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[[intexpr][:entryref[:tvexpr]],...]'\r\n\t},\r\n\t'ZHALT': {\r\n\t\t'abbreviation': 'ZHALT',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[intexpr]'\r\n\t},\r\n\t'ZHELP': {\r\n\t\t'abbreviation': 'ZH',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr1[:expr2],...]'\r\n\t},\r\n\t'ZKILL': {\r\n\t\t'abbreviation': 'ZK',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'glvn'\r\n\t},\r\n\t'ZLINK': {\r\n\t\t'abbreviation': 'ZL',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr1[:expr2][,...]]'\r\n\t},\r\n\t'ZMESSAGE': {\r\n\t\t'abbreviation': 'ZM',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'intexpr[:expr2][:...]'\r\n\t},\r\n\t'ZPRINT': {\r\n\t\t'abbreviation': 'ZP',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[entryref[:label[+intexpr]][,...]'\r\n\t},\r\n\t'ZRUPDATE': {\r\n\t\t'abbreviation': 'ZRUP',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[,...]'\r\n\t},\r\n\t'ZSHOW': {\r\n\t\t'abbreviation': 'ZSH',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr[:glvn][,...]]'\r\n\t},\r\n\t'ZSTEP': {\r\n\t\t'abbreviation': 'ZST',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[keyword[:expr]][,...]'\r\n\t},\r\n\t'ZSYSTEM': {\r\n\t\t'abbreviation': 'ZSY',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr][,...]]'\r\n\t},\r\n\t'ZTCOMMIT': {\r\n\t\t'abbreviation': 'ZTC',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[intexpr]'\r\n\t},\r\n\t'ZTRIGGER': {\r\n\t\t'abbreviation': 'ZTR',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'gvn'\r\n\t},\r\n\t'ZTSTART': {\r\n\t\t'abbreviation': 'ZTS',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'ZWITHDRAW': {\r\n\t\t'abbreviation': 'ZWI',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'glvn'\r\n\t},\r\n\t'ZWRITE': {\r\n\t\t'abbreviation': 'ZWR',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[zwrglvn[,...]]'\r\n\t}\r\n}\r\nconst funcParams = {\r\n\t'ASCII': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'CHAR': {\r\n\t\t'maxparams': 99\r\n\t},\r\n\t'DATA': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn'\r\n\t},\r\n\t'EXTRACT': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'FIND': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'FNUMBER': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'GET': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'INCREMENT': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'JUSTIFY': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'LENGTH': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'NAME': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'NEXT': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn('\r\n\t},\r\n\t'ORDER': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'PIECE': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'QLENGTH': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'expr'\r\n\t},\r\n\t'QSUBSCRIPT': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'expr,expr'\r\n\t},\r\n\t'QUERY': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn'\r\n\t},\r\n\t'RANDOM': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'REVERSE': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'SELECT': {\r\n\t\t'maxparams': 99,\r\n\t\t'format': 'special'\r\n\t},\r\n\t'STACK': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'TEXT': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'entryref'\r\n\t},\r\n\t'TRANSLATE': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'VIEW': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZASCII': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZATRANSFORM': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 4,\r\n\t\t'format': 'expr,expr,bool,bool'\r\n\t},\r\n\t'ZBITAND': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITCOUNT': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZBITFIND': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZBITGET': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITLEN': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZBITNOT': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZBITOR': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITSET': {\r\n\t\t'minparams': 3,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZBITSTR': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITXOR': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZCHAR': {\r\n\t\t'maxparams': 99\r\n\t},\r\n\t'ZCOLLATE': {\r\n\t\t'maxparams': 3,\r\n\t\t'format': 'glvn,expr,bool'\r\n\t},\r\n\t'ZCONVERT': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZDATA': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'lvn'\r\n\t},\r\n\t'ZDATE': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZEXTRACT': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZFIND': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZGETJPI': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZJOBEXAM': {\r\n\t\t'minparams': 0,\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZJUSTIFY': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZLENGTH': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZMESSAGE': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZPARSE': {\r\n\t\t'maxparams': 5\r\n\t},\r\n\t'ZPEEK': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZPIECE': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZPREVIOUS': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn'\r\n\t},\r\n\t'ZQGBLMOD': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'gvn'\r\n\t},\r\n\t'ZSEARCH': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZSIGPROC': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZSOCKET': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZSUBSTR': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZSYSLOG': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZTRANSLATE': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZTRIGGER': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZTRNLNM': {\r\n\t\t'maxparams': 6\r\n\t},\r\n\t'ZWIDTH': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZWRITE': {\r\n\t\t'maxparams': 2\r\n\t}\r\n}\r\nconst expressiontype = {\r\n\t\"Standard\": 0,\r\n\t\"Index\": 1,\r\n\t\"eArgument\": 2,\r\n\t\"iArgument\": 3,\r\n\t\"Atom\": 4\r\n}\r\n\r\nexport class MumpsLineParser {\r\n\tprivate tokens: LineToken[] = [];\r\n\tprivate cmdCompressions: object;\r\n\tprivate funcCompressions: object;\r\n\tprivate isvCompressions: object;\r\n\tprivate linePosition: number = 0;\r\n\tprivate _evaluatePattern(line: string, position: number, level?: number): ErrorInformation {\r\n\t\tlet result = { text: '', position }\r\n\t\tlet patternComplete = false;\r\n\t\tif (level === undefined) {\r\n\t\t\tlevel = 0;\r\n\t\t}\r\n\t\tdo {\r\n\t\t\tif (line[position] === '@') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++position);\r\n\t\t\t\tpatternComplete = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (line.substring(result.position).match(repititionCount)) {\r\n\t\t\t\tlet repCount = line.substring(result.position).match(repititionCount)![0];\r\n\t\t\t\tif (repCount !== '') {\r\n\t\t\t\t\tpatternComplete = false;\r\n\t\t\t\t\tresult.position += repCount.length;\r\n\t\t\t\t\tif (line.substring(result.position).match(patcode)) {\r\n\t\t\t\t\t\tpatternComplete = true;\r\n\t\t\t\t\t\tresult.position += line.substring(result.position).match(patcode)![0].length;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else if (line[result.position] === '(') {\r\n\t\t\t\t\t\tresult = this._evaluatePattern(line, ++result.position, level + 1);\r\n\t\t\t\t\t\tpatternComplete = true;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (line[result.position] === ')') {\r\n\t\t\t\t\tif (!patternComplete) {\r\n\t\t\t\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (level > 0) {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else if (line[result.position] === ',' && level > 0) {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else if (line[result.position] === ')') {\r\n\t\t\t\tif (!patternComplete) {\r\n\t\t\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t} else if (line[result.position] === ',' && level > 0) {\r\n\t\t\t\tif (!patternComplete) {\r\n\t\t\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} while (position < line.length)\r\n\t\tif (!patternComplete) {\r\n\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tif (level > 0) {\r\n\t\t\tresult.text = 'Missing \")\"';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\r\n\t}\r\n\tpublic evaluateExpression(exType: number, line: string, position: number, level?: number | undefined): ErrorInformation {\r\n\t\tlet expressionComplete = false;\r\n\t\tlet startposition = position;\r\n\t\tif (level === undefined) {\r\n\t\t\tlevel = 0;\r\n\t\t}\r\n\t\tlet lastExpression = '';\r\n\t\twhile (position < line.length) {\r\n\t\t\tlet char = line.charAt(position);\r\n\t\t\tif (char === '(') {\r\n\t\t\t\tlet subExType = expressiontype.Standard\r\n\t\t\t\tswitch (lastExpression) {\r\n\t\t\t\t\tcase 'ifunction':\r\n\t\t\t\t\t\tsubExType = expressiontype.iArgument;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'exfunction':\r\n\t\t\t\t\t\tsubExType = expressiontype.eArgument;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'pattern':\r\n\t\t\t\t\t\tthrow { text: 'Unecpected \"(\"', position };\r\n\t\t\t\t}\r\n\t\t\t\tlet result = this.evaluateExpression(subExType, line, ++position, level + 1);\r\n\t\t\t\tif (exType === expressiontype.Atom) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t\texpressionComplete = true;\r\n\t\t\t\tposition = result.position;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tlastExpression = '';\r\n\t\t\tif (char === ')') {\r\n\t\t\t\tif (!expressionComplete) {\r\n\t\t\t\t\tif (position === startposition && exType === expressiontype.eArgument) {\r\n\t\t\t\t\t\treturn { text: '', position: ++position }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthrow { text: 'Incomplete Expression', position };\r\n\t\t\t\t}\r\n\t\t\t\tif (level > 0) {\r\n\t\t\t\t\tposition++;\r\n\t\t\t\t}\r\n\t\t\t\treturn { text: '', position: position };\r\n\t\t\t}\r\n\t\t\tif (char === '.' && exType === expressiontype.eArgument) {\r\n\t\t\t\tposition++;\r\n\t\t\t\tlet evalString = line.substring(position);\r\n\t\t\t\tif (evalString.match(lvn)) {\r\n\t\t\t\t\tlet localname = evalString.match(lvn)![0];\r\n\t\t\t\t\tthis.tokens.push({ type: TokenType.local, name: localname, position: position + this.linePosition });\r\n\t\t\t\t\tposition += localname.length;\r\n\t\t\t\t\tchar = line.charAt(position);\r\n\t\t\t\t\tif (char !== ',' && char !== ')') {\r\n\t\t\t\t\t\tthrow { text: 'Variablereference must stand alone', position }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (char === ',') {\r\n\t\t\t\tif (!expressionComplete) {\r\n\t\t\t\t\tif (position === startposition && exType === expressiontype.eArgument) {\r\n\t\t\t\t\t\tif (level === 0) {\r\n\t\t\t\t\t\t\treturn { text: '', position: ++position }\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tposition++\r\n\t\t\t\t\t\t\texpressionComplete = false;\r\n\t\t\t\t\t\t\tstartposition = position;\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthrow { text: 'Incomplete Expression', position };\r\n\t\t\t\t}\r\n\t\t\t\tif (exType === expressiontype.Standard || exType === expressiontype.Atom) {\r\n\t\t\t\t\treturn { text: '', position }\r\n\t\t\t\t}\r\n\t\t\t\tposition++\r\n\t\t\t\texpressionComplete = false;\r\n\t\t\t\tstartposition = position;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (expressionComplete) {\r\n\t\t\t\tif (exType === expressiontype.Atom) {\r\n\t\t\t\t\treturn { text: '', position }\r\n\t\t\t\t}\r\n\t\t\t\tif (line.substring(position).match(binoperator)) {\r\n\t\t\t\t\tlet operator = line.substring(position).match(binoperator)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: operator, position: position + this.linePosition, type: TokenType.operator });\r\n\t\t\t\t\tposition += operator.length;\r\n\t\t\t\t\texpressionComplete = false;\r\n\t\t\t\t\tif (operator === '?' || operator === \"'?\") {\r\n\t\t\t\t\t\tlet result = this._evaluatePattern(line, position);\r\n\t\t\t\t\t\tposition = result.position;\r\n\t\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t\t\tlastExpression = 'pattern';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn { text: '', position }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet evalString = line.substring(position);\r\n\t\t\ttry {\r\n\t\t\t\tlet provResult = this._checkVar(line, position);\r\n\t\t\t\texpressionComplete = true;\r\n\t\t\t\tposition = provResult.position;\r\n\t\t\t} catch (provResult) {\r\n\t\t\t\tif (evalString.substring(0, 2) === '$$') {\r\n\t\t\t\t\tposition += 2;\r\n\t\t\t\t\tprovResult = this._checkEntryRef(line, position, true, true);\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t\tposition = provResult.position;\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(nonMfunction)) {\r\n\t\t\t\t\tlet functionname = evalString.match(nonMfunction)![0];\r\n\t\t\t\t\tthis.tokens.push({ type: TokenType.nonMfunction, name: functionname, position });\r\n\t\t\t\t\tposition += functionname.length;\r\n\t\t\t\t\tlastExpression = 'exfunction'\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(ifunction)) {\r\n\t\t\t\t\tlet functionname = evalString.match(ifunction)![0].substring(1).toUpperCase();\r\n\t\t\t\t\tposition += functionname.length + 2\r\n\t\t\t\t\tlet longName = functionname;\r\n\t\t\t\t\tif (funcExpansions[functionname] !== undefined) {\r\n\t\t\t\t\t\tlongName = funcExpansions[functionname];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.tokens.push({ name: \"$\" + functionname, position: position - functionname.length - 2, type: TokenType.ifunction, longName: \"$\" + longName });\r\n\t\t\t\t\tlet result = this._checkFunction(longName, line, position);\r\n\t\t\t\t\tposition = result.position;\r\n\t\t\t\t\tlastExpression = '';\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(isv)) {\r\n\t\t\t\t\tlet specialvarname = evalString.match(isv)![0];\r\n\t\t\t\t\tlet longName = specialvarname.toUpperCase();\r\n\t\t\t\t\tif (isvExpansions[longName.substring(1)] !== undefined) {\r\n\t\t\t\t\t\tlongName = \"$\" + isvExpansions[longName.substring(1)];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.tokens.push({ name: specialvarname, position: position + this.linePosition, type: TokenType.sysvariable, longName });\r\n\t\t\t\t\tposition += specialvarname.length\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(numlit) && evalString.match(numlit)![0] !== '') {\r\n\t\t\t\t\tlet numericliteral = evalString.match(numlit)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: numericliteral, type: TokenType.number, position: position + this.linePosition });\r\n\t\t\t\t\tposition += numericliteral.length;\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(strlit)) {\r\n\t\t\t\t\tlet stringlit = evalString.match(strlit)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: stringlit, type: TokenType.string, position: position + this.linePosition });\r\n\t\t\t\t\tposition += stringlit.length;\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (char.match(unaryoperator)) {\r\n\t\t\t\t\tthis.tokens.push({ name: char, type: TokenType.operator, position: position + this.linePosition });\r\n\t\t\t\t\tposition++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow { text: 'Unexpected Character ' + char, position }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (expressionComplete) {\r\n\t\t\tif (level > 0) {\r\n\t\t\t\tthrow { text: 'Missing \")\"', position }\r\n\t\t\t}\r\n\t\t\treturn { text: '', position }\r\n\t\t} else {\r\n\t\t\tthrow { text: 'Incomplete Expression', position };\r\n\t\t}\r\n\t}\r\n\tprivate _extractLabel(inputObject: LineObject): LineObject {\r\n\t\tinputObject.lineLabel = '';\r\n\t\tlet inputLine = inputObject.lineExpression;\r\n\t\tinputObject.lineExpression = '';\r\n\t\tif (inputLine.match(label)) {\r\n\t\t\tinputObject.lineLabel = inputLine.match(label)![0];\r\n\t\t}\r\n\t\tlet position = inputObject.lineLabel.length;\r\n\t\tif (position === inputLine.length) {\r\n\t\t\treturn inputObject\r\n\t\t}\r\n\t\tif (!inputLine.charAt(position).match(/[\\s|;]/)) {\r\n\t\t\tinputObject.errorText = 'Unexpected Character' + inputLine.charAt(position);\r\n\t\t\tinputObject.errorPosition = position;\r\n\t\t\treturn inputObject;\r\n\t\t}\r\n\t\tlet i = 0;\r\n\t\tfor (i = position; i <= inputLine.length; i++) {\r\n\t\t\tif (inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tinputObject.lineLeadSpace = inputLine.substring(position, i);\r\n\t\tif (i !== (inputLine.length - 1)) {\r\n\t\t\tinputObject.lineExpression = inputLine.substring(i);\r\n\t\t\tinputObject.expressionPosition = i;\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\r\n\t//Extract Comments.\r\n\tprivate _extractComment(inputObject: LineObject): LineObject {\r\n\t\tlet inputLine = inputObject.lineExpression!;\r\n\t\t//Semicolon identifies comments.\r\n\t\tif (inputLine.search(\";\") >= 0) {\r\n\t\t\tlet isInsideString = false;\r\n\t\t\tfor (let i = 0; i < inputLine.length; i++) {\r\n\t\t\t\tif (inputLine[i] === \";\") {\r\n\t\t\t\t\tif (!isInsideString) {\r\n\t\t\t\t\t\tinputObject.lineExpression = inputLine.substring(0, i);\r\n\t\t\t\t\t\tinputObject.lineComment = { comment: inputLine.substring(i).substring(1), position: i + inputObject.expressionPosition };\r\n\t\t\t\t\t\treturn inputObject;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (inputLine[i] === '\"') {\r\n\t\t\t\t\tisInsideString = !isInsideString;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\r\n\t//Extract Indentation.\r\n\t//Assumes inputLine has extracted comments/spacing.\r\n\tprivate _extractIndentation(inputObject: LineObject): LineObject {\r\n\r\n\t\tlet lineIndentationArray: string[] = [];\r\n\t\tlet lineIndentation = 0;\r\n\t\tlet inputLine = inputObject.lineExpression!;\r\n\t\tlet spacer = '';\r\n\t\tlet i = 0;\r\n\t\tfor (i = 0; i <= inputLine.length; i++) {\r\n\t\t\tlet char = inputLine[i];\r\n\t\t\tif (char === \".\") {\r\n\t\t\t\tif (lineIndentation > 0) {\r\n\t\t\t\t\tlineIndentationArray.push(spacer);\r\n\t\t\t\t}\r\n\t\t\t\tlineIndentation++;\r\n\t\t\t\tspacer = '';\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (char === \" \" || char === \"\\t\") {\r\n\t\t\t\tspacer += char;\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (lineIndentation > 0) {\r\n\t\t\tlineIndentationArray.push(spacer);\r\n\t\t\tinputObject.lineExpression = inputLine.substring(i);\r\n\t\t\tinputObject.expressionPosition! += i;\r\n\t\t\tinputObject.lineIndentationArray = lineIndentationArray;\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\r\n\t//Extract M-Commands.\r\n\t//Assumes inputLine has extracted comments/spacing/indentation.\r\n\tprivate _extractCommands(inputObject: LineObject): LineObject {\r\n\r\n\t\tlet tmpFunction: TmpFunction;\r\n\t\tlet tmpFunctionArray: Array<TmpFunction> = [];\r\n\t\t//Divide Routines and Arguments.\r\n\t\tlet splitLine = this._splitCommandsAndArguments(inputObject);\r\n\t\t//Loop, even is function, odd is arguments.\r\n\t\tlet i = 0;\r\n\t\ttmpFunction = { mCommand: '', mPostCondition: '', mArguments: '', cmdPosition: 0, argPosition: 0, pcPosition: 0 }\r\n\t\twhile (i < splitLine.length) {\r\n\t\t\tif (i % 2 === 0) {\r\n\t\t\t\ttmpFunction.mCommand = splitLine[i].command;\r\n\t\t\t\ttmpFunction.cmdPosition = splitLine[i].position;\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttmpFunction.mArguments = splitLine[i].command;\r\n\t\t\t\ttmpFunction.argPosition = splitLine[i].position;\r\n\r\n\t\t\t\t//Custom handler for trailing argument spacing.\r\n\t\t\t\t//Go until splitline hits a non empty val.\r\n\t\t\t\tlet ii = i + 1;\r\n\t\t\t\twhile (ii < splitLine.length) {\r\n\t\t\t\t\tif (splitLine[ii].command === \"\") {\r\n\t\t\t\t\t\tsplitLine.splice(ii, 1);\r\n\t\t\t\t\t\t//tmpFunction.mArguments = tmpFunction.mArguments + \" \";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttmpFunctionArray.push(tmpFunction);\r\n\t\t\t\ttmpFunction = { mCommand: '', mPostCondition: '', mArguments: '', cmdPosition: 0, argPosition: 0, pcPosition: 0 }\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t\t//Last command doesn't always require parameter, so if odd number of pairs, push it.\r\n\t\tif (splitLine.length % 2 !== 0) {\r\n\t\t\ttmpFunction.mCommand = splitLine[splitLine.length - 1].command;\r\n\t\t\ttmpFunction.cmdPosition = splitLine[splitLine.length - 1].position;\r\n\t\t\ttmpFunction.mArguments = '';\r\n\t\t\ttmpFunction.argPosition = inputObject.lineExpression!.length;\r\n\t\t\ttmpFunctionArray.push(tmpFunction);\r\n\t\t}\r\n\r\n\r\n\t\t//Extract and output Post Conditionals.\r\n\t\tlet postConditionFunctionArray = this._extractPostConditional(tmpFunctionArray);\r\n\t\tif (postConditionFunctionArray.length > 0) {\r\n\t\t\tinputObject.lineRoutines = postConditionFunctionArray;\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\t//Divide commands and arguments into array, used by extractRoutines.\r\n\tprivate _splitCommandsAndArguments(inputObject: LineObject): LineComand[] {\r\n\r\n\t\tlet lineCommands: LineComand[] = [];\r\n\t\tlet tmpCursor = 0;\r\n\t\tlet isInsideString = false;\r\n\t\tlet inputLine = inputObject.lineExpression!;\r\n\t\tlet start = inputObject.expressionPosition!;\r\n\t\tfor (let i = 0; i < inputLine.length; i++) {\r\n\r\n\t\t\t//Ensure space isn't quoted.\r\n\t\t\tif (inputLine[i] === '\"') {\r\n\t\t\t\tisInsideString = !isInsideString;\r\n\t\t\t}\r\n\t\t\t//Flag spaces/tabs as dividers.\r\n\t\t\tif ((inputLine[i] === \" \" || inputLine[i] === \"\\t\") && !isInsideString) {\r\n\t\t\t\t//If has content, push.\r\n\t\t\t\tif (inputLine.substring(tmpCursor, i).length > 0) {\r\n\t\t\t\t\tlineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n\t\t\t\t\t//Otherwise, push empty commands.\r\n\t\t\t\t} else if (inputLine.substring(tmpCursor, i).length === 0 && (inputLine.substring(tmpCursor - 1, tmpCursor) === \" \" || inputLine.substring(tmpCursor - 1, tmpCursor) === \"\\t\")) {\r\n\t\t\t\t\tlineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n\t\t\t\t}\r\n\t\t\t\ttmpCursor = i + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet i = inputLine.length;\r\n\t\tif (inputLine.substring(tmpCursor, i).length > 0) {\r\n\t\t\tlineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n\t\t\t//Gather empty commands from end of line.\r\n\t\t} else if (i === tmpCursor && (inputLine.substring(i - 1, i) === \" \" || inputLine.substring(i - 1, i) === \"/t\")) {\r\n\t\t\tlineCommands.push({ command: '', position: start + tmpCursor });\r\n\t\t}\r\n\t\treturn lineCommands;\r\n\t}\r\n\t//Extracts Post-Conditionals from Routines, used by extractRoutines.\r\n\tprivate _extractPostConditional(tmpFunctionArray: TmpFunction[]): TmpFunction[] {\r\n\r\n\t\t//Assign to new variable to truncate Routines.\r\n\t\tlet tmpObject = tmpFunctionArray;\r\n\t\tfor (let i = 0; i < tmpObject.length; i++) {\r\n\t\t\t//Colon indicates Post-Conditionals.\r\n\t\t\tlet tmpIndex = tmpObject[i].mCommand!.indexOf(\":\");\r\n\t\t\tif (tmpIndex > -1) {\r\n\t\t\t\ttmpObject[i].mPostCondition = tmpObject[i].mCommand.substring(tmpIndex + 1);\r\n\t\t\t\ttmpObject[i].mCommand = tmpObject[i].mCommand.substring(0, tmpIndex);\r\n\t\t\t\ttmpObject[i].pcPosition = tmpObject[i].cmdPosition + tmpIndex + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn tmpObject;\r\n\t}\r\n\tpublic parseLine(inputString): LineObject {\r\n\r\n\t\tlet tmpObject: LineObject = { lineExpression: inputString, expressionPosition: 0 };\r\n\r\n\t\t//Parsing must be performed sequentially.\r\n\t\ttmpObject = this._extractLabel(tmpObject);\r\n\t\tif (tmpObject.errorText) {\r\n\t\t\treturn tmpObject;\r\n\t\t}\r\n\t\ttmpObject = this._extractComment(tmpObject);\r\n\t\ttmpObject = this._extractIndentation(tmpObject);\r\n\t\ttmpObject = this._extractCommands(tmpObject);\r\n\r\n\t\t//Line Expression is no longer needed.\r\n\t\ttmpObject.lineExpression = '';\r\n\t\treturn tmpObject;\r\n\t}\r\n\tpublic checkFile(filename: string): ErrorInformation[] {\r\n\t\tlet errlist: ErrorInformation[] = [];\r\n\t\tlet content: string;\r\n\t\ttry {\r\n\t\t\tcontent = fs.readFileSync(filename, \"utf8\");\r\n\t\t} catch (err) {\r\n\t\t\terrlist.push({ text: 'File read error: ' + filename, position: 0, line: 0 });\r\n\t\t\treturn errlist;\r\n\t\t}\r\n\t\tlet lines = content.split('\\n');\r\n\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\tlines[i] = lines[i].replace('\\r', '');\r\n\t\t\tlet info = this.checkLine(lines[i]);\r\n\t\t\tif (info.text !== '') {\r\n\t\t\t\tinfo.line = i + 1;\r\n\t\t\t\terrlist.push(info);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn errlist;\r\n\t}\r\n\tpublic analyzeLines(input: string): Array<Array<LineToken>> {\r\n\t\tlet lines = input.split('\\n');\r\n\t\tlet linetokens: Array<Array<LineToken>> = [];\r\n\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\tlines[i] = lines[i].replace('\\r', '');\r\n\t\t\tthis.checkLine(lines[i]);\r\n\t\t\tlinetokens[i] = this.tokens;\r\n\t\t}\r\n\t\treturn linetokens;\r\n\t}\r\n\tprivate _splitLabelAndParameters(label: string) {\r\n\t\tif (label.indexOf('(') === -1) {\r\n\t\t\tthis.tokens.push({ name: label, position: 0, type: TokenType.label });\r\n\t\t} else {\r\n\t\t\tlet labelparts = label.split('(');\r\n\t\t\tlet labeltext = labelparts[0];\r\n\t\t\tthis.tokens.push({ name: labeltext, position: 0, type: TokenType.label });\r\n\t\t\tlet parameters = labelparts[1].split(')')[0];\r\n\t\t\tlet parameterVars = parameters.split(',');\r\n\t\t\tlet position = labeltext.length + 1\t\t// Position = lengths of Label + trailing \"(\"\r\n\t\t\tfor (let i = 0; i < parameterVars.length; i++) {\r\n\t\t\t\tthis.tokens.push({ name: parameterVars[i], position, type: TokenType.local });\r\n\t\t\t\tposition += parameterVars[i].length + 1\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tpublic constructLine(inputObject: LineObject): string {\r\n\t\tlet line: string = \"\";\r\n\t\tline = renderer.appendLabel(inputObject, line);\r\n\t\tline = renderer.appendIndentation(inputObject, line);\r\n\t\tline = renderer.appendRoutines(inputObject, line);\r\n\t\tline = renderer.appendComment(inputObject, line);\r\n\t\treturn line;\r\n\t}\r\n\tpublic expandCompressFile(filename: string, doExpand: boolean): string {\r\n\t\tif (doExpand === undefined) { doExpand = false; }\r\n\t\tlet content: string;\r\n\t\tlet lines: string[] = [];\r\n\t\ttry {\r\n\t\t\tcontent = fs.readFileSync(filename, \"utf8\");\r\n\t\t} catch (err) {\r\n\t\t\tlines[0] = 'File read error: ';\r\n\t\t\treturn lines[0];\r\n\t\t}\r\n\t\tlines = content.split('\\n');\r\n\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\tlines[i] = lines[i].replace('\\r', '');\r\n\t\t\tlet info = this.expandCompressLine(lines[i], doExpand);\r\n\t\t\tif (info.errorText !== '') {\r\n\t\t\t\tlines = [];\r\n\t\t\t\tlines[0] = \"Error in Line \" + i + \" : \" + info.errorText;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tlines[i] = info.lineText;\r\n\t\t}\r\n\t\treturn lines.join(\"\\n\");\r\n\t}\r\n\tpublic expandCompressLine(line: string, doExpand: boolean): ModifiedLine {\r\n\t\tif (doExpand === false && this.cmdCompressions === undefined) {\r\n\t\t\tthis.cmdCompressions = {};\r\n\t\t\tObject.keys(cmdExpansions).forEach(shortCommand => {\r\n\t\t\t\tthis.cmdCompressions[cmdExpansions[shortCommand]] = shortCommand;\r\n\t\t\t});\r\n\t\t\tthis.funcCompressions = {};\r\n\t\t\tObject.keys(funcExpansions).forEach(shortFunction => {\r\n\t\t\t\tthis.funcCompressions[funcExpansions[shortFunction]] = shortFunction;\r\n\t\t\t});\r\n\t\t\tthis.isvCompressions = {};\r\n\t\t\tObject.keys(isvExpansions).forEach(shortIsv => {\r\n\t\t\t\tthis.isvCompressions[isvExpansions[shortIsv]] = shortIsv;\r\n\t\t\t});\r\n\t\t}\r\n\t\tlet outline: ModifiedLine = { lineText: line, errorText: '' }\r\n\t\tlet errorinfo = this.checkLine(line);\r\n\t\tlet outText = line;\r\n\t\tif (errorinfo.text !== \"\") {\r\n\t\t\toutline.errorText = errorinfo.text;\r\n\t\t} else {\r\n\t\t\tlet posCorrector = 0;\r\n\t\t\tfor (let i = 0; i < this.tokens.length; i++) {\r\n\t\t\t\tlet token = this.tokens[i];\r\n\t\t\t\tif (token.hasOwnProperty(\"longName\")) {\r\n\t\t\t\t\tlet name = token.name;\r\n\t\t\t\t\tlet longName = name;\r\n\t\t\t\t\tlet position = token.position;\r\n\t\t\t\t\tif (doExpand) {\r\n\t\t\t\t\t\tlongName = token.longName!.toLowerCase();\r\n\t\t\t\t\t\tif (longName[0] === \"$\") {\r\n\t\t\t\t\t\t\tlongName = \"$\" + longName[1].toUpperCase() + longName.substring(2);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlongName = longName[0].toUpperCase() + longName.substring(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet checkName = name.toUpperCase();\r\n\t\t\t\t\t\tif (name[0] === \"$\") { checkName = name.substring(1); }\r\n\t\t\t\t\t\tif (token.type === TokenType.keyword) {\r\n\t\t\t\t\t\t\tif (this.cmdCompressions[checkName] !== undefined) {\r\n\t\t\t\t\t\t\t\tlongName = this.cmdCompressions[checkName];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (token.type === TokenType.ifunction) {\r\n\t\t\t\t\t\t\tif (this.funcCompressions[checkName] !== undefined) {\r\n\t\t\t\t\t\t\t\tlongName = \"$\" + this.funcCompressions[checkName];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (token.type === TokenType.sysvariable) {\r\n\t\t\t\t\t\t\tif (this.isvCompressions[checkName] !== undefined) {\r\n\t\t\t\t\t\t\t\tlongName = \"$\" + this.isvCompressions[checkName];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name.length !== longName.length) {\r\n\t\t\t\t\t\toutText = outText.substring(0, posCorrector + position) + longName + outText.substring(posCorrector + position + name.length);\r\n\t\t\t\t\t\tposCorrector += longName.length - name.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\toutline.lineText = outText;\r\n\t\treturn outline;\r\n\t}\r\n\tpublic checkLine(line: string): ErrorInformation {\r\n\t\tthis.tokens = [];\r\n\t\tthis.linePosition = 0;\r\n\t\tlet parsed = this.parseLine(line);\r\n\t\tif (parsed.lineLabel) {\r\n\t\t\tthis._splitLabelAndParameters(parsed.lineLabel);\r\n\t\t}\r\n\t\tif (parsed.lineComment) {\r\n\t\t\tthis.tokens.push({ name: parsed.lineComment.comment, position: parsed.lineComment.position, type: TokenType.comment });\r\n\t\t}\r\n\t\tlet result: ErrorInformation = { text: '', position: 0 }\r\n\t\tif (parsed.lineRoutines) {\r\n\t\t\tfor (let i = 0; i < parsed.lineRoutines.length; i++) {\r\n\t\t\t\tlet code = parsed.lineRoutines[i];\r\n\t\t\t\tif (code.mCommand.length > 0) {\r\n\t\t\t\t\tlet cmd = code.mCommand.toUpperCase();\r\n\t\t\t\t\tif (cmd === 'H') {\r\n\t\t\t\t\t\tif (code.mArguments === '') {\r\n\t\t\t\t\t\t\tcmd = 'HALT';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcmd = 'HANG';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (cmd.match(command)) {\r\n\t\t\t\t\t\tlet longcmd = cmd;\r\n\t\t\t\t\t\tif (cmdParams[cmd] === undefined) {\r\n\t\t\t\t\t\t\tlongcmd = cmdExpansions[cmd];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.tokens.push({ name: code.mCommand, type: TokenType.keyword, position: code.cmdPosition, longName: longcmd });\r\n\r\n\t\t\t\t\t\tif (longcmd === undefined) {\r\n\t\t\t\t\t\t\tresult.text = 'Unknown Command';\r\n\t\t\t\t\t\t\tresult.position = code.cmdPosition;\r\n\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tresult = this._checkCommand(line, longcmd, code);\r\n\t\t\t\t\t\t} catch (result) {\r\n\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn { text: 'Invalid Command', position: code.cmdPosition }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkEntryRefAndPostcondition(line: string, position: number, withParams: boolean): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this._checkEntryRef(line, result.position, withParams);\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkEntryRef(line: string, position: number, withParams: boolean, isUserfunction?: boolean): ErrorInformation {\r\n\t\tif (isUserfunction === undefined) {\r\n\t\t\tisUserfunction = false;\r\n\t\t}\r\n\t\tlet tokentype: TokenType = TokenType.entryref;\r\n\t\tif (isUserfunction) {\r\n\t\t\ttokentype = TokenType.exfunction;\r\n\t\t}\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (line[result.position] === '@') { //Check Indirection\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Atom, line, ++result.position);\r\n\t\t\tif (line[result.position] === '+') { //Check Label+Offset\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t}\r\n\t\t\tif (line[result.position] === '^') { //Check if it's a Label like xxx^yyy\r\n\t\t\t\tif (line[result.position + 1] === '@') { // or a Label xxx^@expr\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Atom, line, ++result.position);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (line.substring(result.position).match(entryref)) {\r\n\t\t\t\t\t\tlet ref = line.substring(result.position).match(entryref)![0];\r\n\t\t\t\t\t\tresult.position += ref.length;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.text = 'Invalid EntryRef';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (line.substring(result.position, result.position + 2) === '@(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t} else if (line.substring(result.position).match(entryref)) { //No Indirection and a valid entryref\r\n\t\t\tlet ref = line.substring(result.position).match(entryref)![0];\r\n\t\t\tlet merkpos = result.position;\r\n\t\t\tresult.position += ref.length;\r\n\t\t\tlet char = line[result.position];\r\n\t\t\tif (result.position >= line.length) {\r\n\t\t\t\tif (ref.length > 0) {\r\n\t\t\t\t\tif (ref[0] === '&') {\r\n\t\t\t\t\t\ttokentype = TokenType.nonMfunction;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.tokens.push({ 'type': tokentype, name: ref, position: merkpos + this.linePosition });\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.text = 'Missing Entryref';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (ref.indexOf('^') === -1 && char === '+') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\t//ref += \"+X\";\r\n\t\t\t\tif (result.position >= line.length) {\r\n\t\t\t\t\tthis.tokens.push({ 'type': tokentype, name: ref, position: merkpos + this.linePosition });\r\n\t\t\t\t\treturn result\r\n\t\t\t\t}\r\n\t\t\t\tif (line.substring(result.position).match(routineref)) {\r\n\t\t\t\t\tlet routine = line.substring(result.position).match(routineref)![0];\r\n\t\t\t\t\tref += routine;\r\n\t\t\t\t\tresult.position += routine.length;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.tokens.push({ 'type': tokentype, name: ref, position: merkpos + this.linePosition });\r\n\t\t} else {\r\n\t\t\tresult.text = 'Invalid Entryref';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tif (line[result.position] === '(' && withParams) {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.eArgument, line, ++result.position, 1);\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\tprivate _checkVar(line: string, position: number, globalOk?: boolean, indexOk?: boolean): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position, indexFound: false, globalFound: false, indirectionFound: false };\r\n\t\tlet varFound = false;\r\n\t\tif (globalOk === undefined) {\r\n\t\t\tglobalOk = true;\r\n\t\t}\r\n\t\tif (indexOk === undefined) {\r\n\t\t\tindexOk = true;\r\n\t\t}\r\n\t\tif (line[result.position] === '@') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Atom, line, ++result.position);\r\n\t\t\tresult.indirectionFound = true;\r\n\t\t\tvarFound = true;\r\n\t\t\tif (line.substring(result.position, result.position + 2) === '@(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (line.substring(result.position).match(gvn) || line.substring(result.position, result.position + 2) === '^|') {\r\n\t\t\t\tif (!globalOk) {\r\n\t\t\t\t\tresult.text = 'Global not allowed here';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tresult.globalFound = true;\r\n\t\t\t\tif (line.substring(result.position, result.position + 2) === '^|') {\r\n\t\t\t\t\tresult.position += 2\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tresult.globalFound = true;\r\n\t\t\t\t\tif (line[result.position] === ',') {\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\t\t\tresult.globalFound = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line[result.position] !== '|') {\r\n\t\t\t\t\t\tresult.text = 'Missing \"|\"';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tif (line.substring(result.position).match(lvn)) {\r\n\t\t\t\t\t\tlet global = line.substring(result.position).match(lvn)![0];\r\n\t\t\t\t\t\tthis.tokens.push({ name: global, type: TokenType.global, position: result.position + this.linePosition });\r\n\t\t\t\t\t\tvarFound = true;\r\n\t\t\t\t\t\tresult.position += global.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet global = line.substring(result.position).match(gvn)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: global, type: TokenType.global, position: result.position + this.linePosition });\r\n\t\t\t\t\tvarFound = true;\r\n\t\t\t\t\tresult.position += global.length;\r\n\t\t\t\t}\r\n\t\t\t} else if (line.substring(result.position).match(lvn)) {\r\n\t\t\t\tlet local = line.substring(result.position).match(lvn)![0];\r\n\t\t\t\tthis.tokens.push({ name: local, type: TokenType.local, position: result.position + this.linePosition });\r\n\t\t\t\tvarFound = true;\r\n\t\t\t\tresult.position += local.length;\r\n\t\t\t} else if (line.substring(result.position, result.position + 2) === '^(') {\r\n\t\t\t\tresult.globalFound = true;\r\n\t\t\t\tif (!globalOk) {\r\n\t\t\t\t\tresult.text = 'Global not allowed here';\r\n\t\t\t\t\tvarFound = false;\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tvarFound = true;\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (varFound && line[result.position] === '(') {\r\n\t\t\tif (!indexOk) {\r\n\t\t\t\tresult.text = 'Index not allowed here';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tlet provResult = this.evaluateExpression(expressiontype.Index, line, ++result.position, 1);\r\n\t\t\tresult.position = provResult.position;\r\n\t\t\tresult.indexFound = true;\r\n\t\t}\r\n\t\tif (!varFound) {\r\n\t\t\tresult.text = 'Name missing';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkBreak(line: string, position: number): ErrorInformation {\r\n\t\t//[expr[:tvexpr][,...]]\r\n\t\tlet result = this.evaluateExpression(expressiontype.Standard, line, position);\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkKeyword(keywords: RegExp, line: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (line.substring(result.position).match(keywords)) {\r\n\t\t\tlet keyword = line.substring(result.position).match(keywords)![0];\r\n\t\t\tresult.position += keyword.length;\r\n\t\t\tif (keyword.slice(-1) === '=') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult.text = 'No valid Keyword for command found';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkOUC(keywords: RegExp, line: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\t//expr[:(keyword[=expr][:...])][,...]\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (line[result.position] === '(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tresult = this._checkKeyword(keywords, line, result.position);\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (!this._isEndOfArgument(line, result.position))\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Keyword';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (line[result.position] !== ':') {\r\n\t\t\t\t\tresult = this._checkKeyword(keywords, line, result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (keywords === openkeywords && line[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (line[result.position] !== ':') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (keywords === openkeywords && line[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkFor(line: string, position: number, argNumber: number): ErrorInformation {\r\n\t\t//[lvn=expr[:numexpr1[:numexpr2]][,...]]]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (argNumber > 1) { //If it's not the first Argument the Options are possible: F I=1:2:3,4 or F I=1:2:3,I=4:1:6\r\n\t\t\ttry {\r\n\t\t\t\tlet provResult = this._checkVar(line, result.position, false);\r\n\t\t\t\tif (line[provResult.position] === '\"') {\r\n\t\t\t\t\tresult.position = provResult.position + 1;\r\n\t\t\t\t}\r\n\t\t\t} catch (provResult) {\r\n\t\t\t\tif (provResult.text !== \"Name missing\") {\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult = this._checkVar(line, result.position, false);\r\n\t\t\tif (line[result.position] !== '=') {\r\n\t\t\t\tresult.text = 'Missing equal-sign';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tresult.position++;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\tif (line[result.position] !== ':') {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\tif (line[result.position] !== ':') {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkJobKeyword(line: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (line.substring(result.position).match(jobkeywords)) {\r\n\t\t\tlet keyword = line.substring(result.position).match(jobkeywords)![0];\r\n\t\t\tresult.position += keyword.length;\r\n\t\t\tif (keyword[keyword.length - 1] === '=') {\r\n\t\t\t\tif (line.substring(result.position).match(strlit)) {\r\n\t\t\t\t\tlet stringlit = line.substring(result.position).match(strlit)![0];\r\n\t\t\t\t\tresult.position += stringlit.length;\r\n\t\t\t\t\tif (stringlit.length === 0) {\r\n\t\t\t\t\t\tresult.text = 'String literal expected';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.text = 'String literal expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult.text = 'No valid Keyword for JOB Command';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkJob(line: string, position: number): ErrorInformation {\r\n\t\t//entryref[(expr[,...])][:[(keyword[=value][:...])][:numexpr]][,...]\r\n\t\tlet result = this._checkEntryRef(line, position, true);\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (line[result.position] === '(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tresult = this._checkJobKeyword(line, result.position);\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (!this._isEndOfArgument(line, result.position))\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Keyword';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (line[result.position] !== ':') {\r\n\t\t\t\t\tresult = this._checkJobKeyword(line, result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (line[result.position] === ':') { //Numeric expression for Job-Timeout\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkKill(line: string, position: number): ErrorInformation {\r\n\t\t//[glvn | (lvn[,...]) | *lname | *lvn ]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (line[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line[result.position] !== ',') {\r\n\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = false;\r\n\t\t\t} while (!this._isEndOfArgument(line, result.position))\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkLock(line: string, position: number, isLock: boolean): ErrorInformation {\r\n\t\t//[[-|+]nref|(nref[,...])[:numexpr] [,...]]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif ((line[result.position] === '+' || line[result.position] === '-') && isLock) {\r\n\t\t\tresult.position++;\r\n\t\t}\r\n\t\tif (line[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line[result.position] !== ',') {\r\n\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = false;\r\n\t\t\t} while (!this._isEndOfArgument(line, result.position))\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t}\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkMerge(line: string, position: number): ErrorInformation {\r\n\t\t//glvn=glvn[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this._checkVar(line, result.position);\r\n\t\tif (line[result.position] !== '=') {\r\n\t\t\tresult.text = 'Equal-Sign expected';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tresult = this._checkVar(line, ++result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkNew(line: string, position: number): ErrorInformation {\r\n\t\t//[[(]lvn[,...][)][,...]]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (line[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tif (line.substring(result.position).match(isv)) {\r\n\t\t\t\t\tresult.position += line.substring(result.position).match(isv)![0].length;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = this._checkVar(line, result.position, false);\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line[result.position] !== ',') {\r\n\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = false;\r\n\t\t\t} while (!this._isEndOfArgument(line, result.position))\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (line.substring(result.position).match(isv)) {\r\n\t\t\t\tresult.position += line.substring(result.position).match(isv)![0].length;\r\n\t\t\t} else {\r\n\t\t\t\tresult = this._checkVar(line, result.position, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkRead(line: string, position: number): ErrorInformation {\r\n\t\t//(glvn|*glvn|glvn#intexpr)[:numexpr]|strlit|fcc[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet starDetected = false;\r\n\t\tlet mat: string[] | null;\r\n\t\tif (line[result.position] === '*') {\r\n\t\t\tresult.position++;\r\n\t\t\tstarDetected = true;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tlet provResult = this._checkVar(line, result.position);\r\n\t\t\tresult.position = provResult.position;\r\n\t\t\tif (line[result.position] === '#') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\tif (result.text !== '') {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (line[result.position] === ':') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t} catch {\r\n\t\t\tif (starDetected) {\r\n\t\t\t\tresult.text = 'Variable expected';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tif (mat = line.substring(result.position).match(strlit)) {\r\n\t\t\t\tresult.position += mat[0].length;\r\n\t\t\t\treturn result;\r\n\t\t\t} else if (mat = line.substring(result.position).match(/^(#|!)+/)) {\r\n\t\t\t\tresult.position += mat[0].length;\r\n\t\t\t}\r\n\t\t\tif (line[result.position] === '?') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkSet(line: string, position: number): ErrorInformation {\r\n\t\t//setleft=expr | (setleft[,...])=expr | *lvn=lname | aliascontainer[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\t\tlet isBraced = false;\r\n\t\tif (line[result.position] === '*') { //*lvn=lname\r\n\t\t\tresult = this._checkVar(line, ++result.position, false);\r\n\t\t\tif (line[result.position] !== '=') {\r\n\t\t\t\tresult.text = 'Equal-Sign expected';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tresult = this._checkVar(line, ++result.position, false);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (line[result.position] === '(') {\r\n\t\t\tisBraced = true;\r\n\t\t\tresult.position++;\r\n\t\t}\r\n\t\tdo {\r\n\t\t\tif (line[result.position] === '@') {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet provResult = this._checkVar(line, result.position);\r\n\t\t\t\t\tresult.position = provResult.position;\r\n\t\t\t\t\tif (this._isEndOfArgument(line, result.position) || line[result.position] === ',') {\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Atom, line, ++result.position);\r\n\t\t\t\t\tif (this._isEndOfArgument(line, result.position) || line[result.position] === ',') {\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (mat = line.substring(result.position).match(/^\\$Z?(PIECE|P|EXTRACT|E)\\(/i)) {\r\n\t\t\t\tlet functionname = mat[0].substring(1, mat[0].length - 1).toUpperCase();\r\n\t\t\t\tresult.position += functionname.length + 2\r\n\t\t\t\tif (funcExpansions[functionname] !== undefined) {\r\n\t\t\t\t\tthis.tokens.push({ name: \"$\" + functionname, position: result.position - functionname.length - 2, type: TokenType.ifunction, longName: \"$\" + funcExpansions[functionname] });\r\n\t\t\t\t\tfunctionname = funcExpansions[functionname];\r\n\t\t\t\t}\r\n\t\t\t\tresult = this._checkFunction(functionname, line, result.position);\r\n\t\t\t} else if (mat = line.substring(result.position).match(isv)) {\r\n\t\t\t\tresult.position += mat[0].length;\r\n\t\t\t} else {\r\n\t\t\t\tresult = this._checkVar(line, result.position, true);\r\n\t\t\t}\r\n\t\t\tif (line[result.position] === ',' && isBraced) {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (line[result.position] === ')' && isBraced) {\r\n\t\t\t\tisBraced = false;\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t} while (!this._isEndOfArgument(line, result.position) && isBraced);\r\n\t\tif (line[result.position] !== '=') {\r\n\t\t\tresult.text = 'Equal-Sign expected';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkTstart(line: string, position: number): ErrorInformation {\r\n\t\t//[([lvn...])|lvn|*|][:keyword|(keyword...)]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (line[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (line[result.position] !== ')') {\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tresult = this._checkVar(line, result.position, false, false);\r\n\t\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line[result.position] !== ',') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (!this._isEndOfArgument(line, result.position))\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (line[result.position] !== '*') {\r\n\t\t\t\tresult = this._checkVar(line, result.position, false, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (line[result.position] === '(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tresult = this._checkKeyword(tstartkeywords, line, result.position);\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (result.position < line.length)\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Keyword';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tresult = this._checkKeyword(tstartkeywords, line, result.position);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkView(line: string, position: number): ErrorInformation {\r\n\t\t//keyword[:expr[:...]][,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\twhile (line[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkWrite(line: string, position: number): ErrorInformation {\r\n\t\t//expr|*intexpr|fcc[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\t\tif (line[result.position] === '*') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (line.substring(result.position).match(/^\\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)) {\r\n\t\t\tresult = this._checkWriteSocket(line, result.position);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (mat = line.substring(result.position).match(/^(#|!)+/)) {\r\n\t\t\tresult.position += mat[0].length;\r\n\t\t\tif (line[result.position] === '?') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (line[result.position] === '?') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkWriteSocket(line: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\t\tif (mat = line.substring(result.position).match(/^\\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)) {\r\n\t\t\tresult.position += mat[0].length;\r\n\t\t\tlet fname = mat![0].toUpperCase();\r\n\t\t\tif (fname === '/EOF') {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tif (line[result.position] !== '(') {\r\n\t\t\t\tif (!fname.match(/^\\/(LISTEN|L|WAIT|W)/)) {\r\n\t\t\t\t\tresult.text = fname + ' needs Parameter(s)';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tresult.position++;\r\n\t\t\tlet maxparams = 99;\r\n\t\t\tif (fname === '/LISTEN' || fname === '/L' || fname === '/WAIT' || fname === '/W') {\r\n\t\t\t\tmaxparams = 1;\r\n\t\t\t} else if (fname === '/TLS') {\r\n\t\t\t\tmaxparams = 4;\r\n\t\t\t}\r\n\t\t\tlet paramCount = 0;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tparamCount++;\r\n\t\t\t\tif (paramCount > maxparams) {\r\n\t\t\t\t\tresult.text = 'More Parameters than expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tif (fname === '/ACCEPT' && paramCount === 1) {\r\n\t\t\t\t\tif (line[result.position] !== '.') {\r\n\t\t\t\t\t\tresult.text = 'Local Variablereference expected (.lvn)';\r\n\t\t\t\t\t\tthrow result\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult = this._checkVar(line, ++result.position, false, false);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (line[result.position] === ',') {\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (line[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} while (!this._isEndOfArgument(line, result.position))\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing Parameter or \")\"';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkXecute(line: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkZbreak(line: string, position: number): ErrorInformation {\r\n\t\t//[-]entryref[:[expr][:intexpr]][,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (line[result.position] === '-') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (line[result.position] === '*') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\t\tresult = this._checkEntryRef(line, result.position, false);\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (line[result.position] === ':') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t} else {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\tif (line[result.position] === ':') {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkZprint(line: string, position: number): ErrorInformation {\r\n\t\t// 'parameter': '[entryref[:label[+intexpr]][,...]'\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this._checkEntryRef(line, result.position, false);\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult = this._checkEntryRef(line, ++result.position, false);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkZstep(line: string, position: number): ErrorInformation {\r\n\t\t// 'parameter': '[keyword[:expr]][,...]'\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\r\n\t\tif (mat = line.substring(result.position).match(/^(INTO|OUTOF|OU|OVER|OV)/i)) {\r\n\t\t\tresult.position += mat.length;\r\n\t\t} else {\r\n\t\t\tresult.text = 'Invalid ZSTEP Qualifier';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tif (line[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkCommand(line: string, longcmd: string, code: TmpFunction): ErrorInformation {\r\n\t\tlet para = cmdParams[longcmd];\r\n\t\tlet position = code.pcPosition\r\n\t\tlet postcondPossible = para.postcondition;\r\n\t\tlet argFormat = para.parameter;\r\n\t\tlet result: ErrorInformation = { text: '', position: 0 }\r\n\t\tif (!postcondPossible && code.mPostCondition !== '') {\r\n\t\t\tthrow { text: 'Poscondition not allowed', position }\r\n\t\t} else if (code.mPostCondition !== '') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, position);\r\n\t\t}\r\n\t\tposition = code.argPosition;\r\n\t\tif (code.mArguments === '') {\r\n\t\t\tif (argFormat === '' || argFormat[0] === '[') {\r\n\t\t\t\treturn { text: '', position }\r\n\t\t\t} else {\r\n\t\t\t\tthrow { text: 'Argument for command ' + code.mCommand + \" required\", position }\r\n\t\t\t}\r\n\t\t}\r\n\t\tresult.position = position;\r\n\t\tlet argCount = 0;\r\n\t\tdo {\r\n\t\t\targCount++;\r\n\t\t\tswitch (longcmd) {\r\n\t\t\t\tcase 'BREAK':\r\n\t\t\t\t\tresult = this._checkBreak(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'CLOSE':\r\n\t\t\t\t\tresult = this._checkOUC(closekeywords, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'DO':\r\n\t\t\t\t\tresult = this._checkEntryRefAndPostcondition(line, result.position, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ELSE':\r\n\t\t\t\t\tif (line !== '') {\r\n\t\t\t\t\t\tthrow { text: 'No Argument expected', position }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'FOR':\r\n\t\t\t\t\tresult = this._checkFor(line, result.position, argCount);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'GOTO':\r\n\t\t\t\t\tresult = this._checkEntryRefAndPostcondition(line, result.position, false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'HANG':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'IF':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'JOB':\r\n\t\t\t\t\tresult = this._checkJob(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'KILL':\r\n\t\t\t\t\tresult = this._checkKill(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'LOCK':\r\n\t\t\t\t\tresult = this._checkLock(line, result.position, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'MERGE':\r\n\t\t\t\t\tresult = this._checkMerge(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'NEW':\r\n\t\t\t\t\tresult = this._checkNew(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'OPEN':\r\n\t\t\t\t\tresult = this._checkOUC(openkeywords, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'QUIT':\r\n\t\t\t\t\tif (argCount > 1) {\r\n\t\t\t\t\t\tresult.text = 'Quit allows only one Argument'\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (line[result.position] === '*') {\r\n\t\t\t\t\t\t\tresult = this._checkVar(line, ++result.position, false);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'READ':\r\n\t\t\t\t\tresult = this._checkRead(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'SET':\r\n\t\t\t\t\tresult = this._checkSet(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'TROLLBACK':\r\n\t\t\t\t\tif (argCount > 1) {\r\n\t\t\t\t\t\tresult.text = 'TROLLBACK allows only one Argument'\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'TSTART':\r\n\t\t\t\t\tresult = this._checkTstart(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'USE':\r\n\t\t\t\t\tresult = this._checkOUC(usekeywords, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'VIEW':\r\n\t\t\t\t\tresult = this._checkView(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'WRITE':\r\n\t\t\t\t\tresult = this._checkWrite(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'XECUTE':\r\n\t\t\t\t\tresult = this._checkXecute(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZALLOCATE':\r\n\t\t\t\t\tresult = this._checkLock(line, result.position, false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZBREAK':\r\n\t\t\t\t\tresult = this._checkZbreak(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZCOMPILE':\r\n\t\t\t\t\t// 'abbreviation': 'ZCOM',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': 'expr[,...]'\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZDEALLOCATE':\r\n\t\t\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t\t\t\t// 'abbreviation': 'ZD',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[nref[,...]]'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZEDIT':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\t// 'abbreviation': 'ZED',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[expr[,...]]'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZGOTO':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tif (line[result.position] === ':') {\r\n\t\t\t\t\t\tresult = this._checkEntryRefAndPostcondition(line, ++result.position, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 'abbreviation': 'ZG',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[[intexpr][:entryref[:tvexpr]],...]'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZHALT':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\t// 'abbreviation': 'ZHALT',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[intexpr]'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZHELP':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tif (line[result.position] === ':') {\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 'abbreviation': 'ZH',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[expr1[:expr2],...]'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZKILL':\r\n\t\t\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t\t\t\t// 'abbreviation': 'ZK',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': 'glvn'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZLINK':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tif (line[result.position] === ':') {\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 'abbreviation': 'ZL',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[expr1[:expr2][,...]]'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZMESSAGE':\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\twhile (line[result.position] === ':') {\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, ++result.position);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 'abbreviation': 'ZM',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': 'intexpr[:expr2][:...]'\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZPRINT':\r\n\t\t\t\t\t// 'abbreviation': 'ZP',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[entryref[:label[+intexpr]][,...]'\r\n\t\t\t\t\tresult = this._checkZprint(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZRUPDATE':\r\n\t\t\t\t\t// 'abbreviation': 'ZRUP',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': 'expr[,...]'\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZSHOW':\r\n\t\t\t\t\t// 'abbreviation': 'ZSH',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[expr[:glvn][,...]]'\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tif (line[result.position] === ':') {\r\n\t\t\t\t\t\tresult = this._checkVar(line, ++result.position);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZSTEP':\r\n\t\t\t\t\t// 'abbreviation': 'ZST',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[keyword[:expr]][,...]'\r\n\t\t\t\t\tresult = this._checkZstep(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZSYSTEM':\r\n\t\t\t\t\t// 'abbreviation': 'ZSY',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[expr][,...]]'\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZTCOMMIT':\r\n\t\t\t\t\t// 'abbreviation': 'ZTC',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': '[intexpr]'\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZTRIGGER':\r\n\t\t\t\t\t// 'abbreviation': 'ZTR',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': 'gvn'\r\n\t\t\t\t\tresult = this._checkVar(line, result.position, true, false);\r\n\t\t\t\t\tif (!result.globalFound) {\r\n\t\t\t\t\t\tresult.text = 'Global Variable expected';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZWITHDRAW':\r\n\t\t\t\t\t// 'abbreviation': 'ZWI',\r\n\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t// 'parameter': 'glvn'\r\n\t\t\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ZWRITE':\r\n\t\t\t\t\t//'abbreviation': 'ZWR',\r\n\t\t\t\t\t//'postcondition': true,\r\n\t\t\t\t\t//'parameter': '[zwrglvn[,...]]'\r\n\t\t\t\t\t//not separately tested because ZWRITE is for debugging and should not appear in normal code\r\n\t\t\t\t\tresult.position += line.length;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tresult.position = line.length;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (line[result.position] === ',') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tif (result.position === line.length) {\r\n\t\t\t\t\tif (argFormat !== '' && argFormat[0] !== '[') {\r\n\t\t\t\t\t\tthrow { text: 'Argument for command ' + code.mCommand + \" required\", position: result.position }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (line[result.position] !== undefined) {\r\n\t\t\t\tlet char = line[result.position];\r\n\t\t\t\tif (char === \" \" || char === \"\\t\" || char === \";\") { break; }\r\n\t\t\t\tresult.text = 'Unexpected Character \"' + line[result.position] + '\"';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} while (result.position < line.length)\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkFunction(longfunc: string, line: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position: position };\r\n\t\tlet params = funcParams[longfunc];\r\n\t\tif (params === undefined) {\r\n\t\t\tresult.text = \"Unknown Function \" + longfunc;\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tlet minArguments = params.minparams !== undefined ? params.minparams : 1;\r\n\t\tlet formats = params.format !== undefined ? params.format.split(',') : undefined;\r\n\t\tlet argCount = 0;\r\n\t\tlongfunc = '$' + longfunc;\r\n\t\tif (minArguments === 0 && line[result.position] === ')') {\r\n\t\t\tresult.position++;\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tdo {\r\n\t\t\tlet format = (formats !== undefined && formats[argCount] !== undefined) ? formats[argCount] : 'expr';\r\n\t\t\tif (longfunc === '$SELECT') {\r\n\t\t\t\tformat = 'special';\r\n\t\t\t}\r\n\t\t\tif (format === 'glvn' || format === 'gvn' || format === 'glvn(' || format === 'lvn') {\r\n\t\t\t\tresult = this._checkVar(line, result.position);\r\n\t\t\t\tif (format === 'glvn(' && (!result.indexFound && !result.indirectionFound)) {\r\n\t\t\t\t\tresult.text = 'Variable with Index expected for ' + longfunc;\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tif (format === 'lvn' && result.globalFound) {\r\n\t\t\t\t\tresult.text = 'Local variable expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else if (format === 'entryref') {\r\n\t\t\t\tresult = this._checkEntryRef(line, result.position, false);\r\n\t\t\t} else if (format === 'expr') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t} else if (format === 'bool') {\r\n\t\t\t\tif (line[result.position] !== '0' && line[result.position] !== '1') {\r\n\t\t\t\t\tresult.text = '0/1 expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t} else if (format === 'special') {\r\n\t\t\t\tif (longfunc === '$SELECT') {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t\tif (line[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Missing Expression';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult.position++\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, line, result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\targCount++;\r\n\t\t\tlet char = line[result.position];\r\n\t\t\tif (char === ',') {\r\n\t\t\t\tif (argCount > params.maxparams) {\r\n\t\t\t\t\tresult.text = 'More Arguments for ' + longfunc + ' than expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (char === ')') {\r\n\t\t\t\tif (argCount < minArguments) {\r\n\t\t\t\t\tresult.text = 'Less Arguments for ' + longfunc + ' than expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tbreak;\r\n\t\t\t} else {\r\n\t\t\t\tresult.text = 'Unxepected character ';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} while (!this._isEndOfArgument(line, result.position));\r\n\r\n\t\treturn result;\r\n\t}\r\n\tprivate _isEndOfArgument(line: string, position: number): boolean {\r\n\t\tlet isEndOfArgument = false;\r\n\t\tlet char = line[position];\r\n\t\tif (char === undefined || char === \" \" || char === \"\\t\" || char === \";\") { isEndOfArgument = true; }\r\n\t\treturn isEndOfArgument;\r\n\t}\r\n}\r\n/*\r\nlet dir = \"t:\\\\\";\r\nlet test = new MumpsLineParser();\r\nlet erg: Array<ErrorInformation> = [];\r\nfs.readdir(dir, function (err, files) {\r\n\t//handling error\r\n\tif (err) {\r\n\t\treturn console.log('Unable to scan directory: ' + err);\r\n\t}\r\n\t//listing all files using forEach\r\n\tfiles.forEach(function (file: string) {\r\n\t\tif (file.substring(file.length - 2, file.length) === \".m\")\r\n\t\t\terg = test.checkFile(dir + file);\r\n\t\tif (erg.length) {\r\n\t\t\tconsole.log(file);\r\n\t\t\tconsole.log(erg);\r\n\t\t}\r\n\t});\r\n});\r\nlet test = new MumpsLineParser();\r\nlet expanded = test.expandCompressFile(\"t:\\\\KTEST93.m\", true);\r\nconsole.log(expanded);\r\nlet lines = expanded.split(\"\\n\");\r\nfor (let i = 0; i < lines.length; i++) {\r\n\tconsole.log(test.expandCompressLine(lines[i], false).lineText);\r\n}\r\n*/\r\n//let result = test.checkLine('\tS VGZR=$E(YDL(2),5,6)-1 S:VGZR=0 VGZR=12_($E(YDL(2),1,4)-1)');\r\n//console.log(result);\r\n//console.log(test.tokens);\r\n","module.exports = require(\"events\");","module.exports = require(\"net\");","\"use strict\";\n/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\nconst path = require(\"path\");\nconst mkdirp = require(\"mkdirp\");\nconst debugSession_1 = require(\"./debugSession\");\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"Verbose\"] = 0] = \"Verbose\";\n    LogLevel[LogLevel[\"Log\"] = 1] = \"Log\";\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\n    LogLevel[LogLevel[\"Stop\"] = 4] = \"Stop\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\nclass Logger {\n    constructor() {\n        this._pendingLogQ = [];\n    }\n    log(msg, level = LogLevel.Log) {\n        msg = msg + '\\n';\n        this._write(msg, level);\n    }\n    verbose(msg) {\n        this.log(msg, LogLevel.Verbose);\n    }\n    warn(msg) {\n        this.log(msg, LogLevel.Warn);\n    }\n    error(msg) {\n        this.log(msg, LogLevel.Error);\n    }\n    dispose() {\n        if (this._currentLogger) {\n            const disposeP = this._currentLogger.dispose();\n            this._currentLogger = null;\n            return disposeP;\n        }\n        else {\n            return Promise.resolve();\n        }\n    }\n    /**\n     * `log` adds a newline, `write` doesn't\n     */\n    _write(msg, level = LogLevel.Log) {\n        // [null, undefined] => string\n        msg = msg + '';\n        if (this._pendingLogQ) {\n            this._pendingLogQ.push({ msg, level });\n        }\n        else if (this._currentLogger) {\n            this._currentLogger.log(msg, level);\n        }\n    }\n    /**\n     * Set the logger's minimum level to log in the console, and whether to log to the file. Log messages are queued before this is\n     * called the first time, because minLogLevel defaults to Warn.\n     */\n    setup(consoleMinLogLevel, _logFilePath, prependTimestamp = true) {\n        const logFilePath = typeof _logFilePath === 'string' ?\n            _logFilePath :\n            (_logFilePath && this._logFilePathFromInit);\n        if (this._currentLogger) {\n            const options = {\n                consoleMinLogLevel,\n                logFilePath,\n                prependTimestamp\n            };\n            this._currentLogger.setup(options).then(() => {\n                // Now that we have a minimum logLevel, we can clear out the queue of pending messages\n                if (this._pendingLogQ) {\n                    const logQ = this._pendingLogQ;\n                    this._pendingLogQ = null;\n                    logQ.forEach(item => this._write(item.msg, item.level));\n                }\n            });\n        }\n    }\n    init(logCallback, logFilePath, logToConsole) {\n        // Re-init, create new global Logger\n        this._pendingLogQ = this._pendingLogQ || [];\n        this._currentLogger = new InternalLogger(logCallback, logToConsole);\n        this._logFilePathFromInit = logFilePath;\n    }\n}\nexports.Logger = Logger;\nexports.logger = new Logger();\n/**\n * Manages logging, whether to console.log, file, or VS Code console.\n * Encapsulates the state specific to each logging session\n */\nclass InternalLogger {\n    constructor(logCallback, isServer) {\n        /** Dispose and allow exit to continue normally */\n        this.beforeExitCallback = () => this.dispose();\n        this._logCallback = logCallback;\n        this._logToConsole = isServer;\n        this._minLogLevel = LogLevel.Warn;\n        this.disposeCallback = (signal, code) => {\n            this.dispose();\n            // Exit with 128 + value of the signal code.\n            // https://nodejs.org/api/process.html#process_exit_codes\n            code = code || 2; // SIGINT\n            code += 128;\n            process.exit(code);\n        };\n    }\n    setup(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._minLogLevel = options.consoleMinLogLevel;\n            this._prependTimestamp = options.prependTimestamp;\n            // Open a log file in the specified location. Overwritten on each run.\n            if (options.logFilePath) {\n                if (!path.isAbsolute(options.logFilePath)) {\n                    this.log(`logFilePath must be an absolute path: ${options.logFilePath}`, LogLevel.Error);\n                }\n                else {\n                    const handleError = err => this.sendLog(`Error creating log file at path: ${options.logFilePath}. Error: ${err.toString()}\\n`, LogLevel.Error);\n                    try {\n                        yield mkdirpPromise(path.dirname(options.logFilePath));\n                        this.log(`Verbose logs are written to:\\n`, LogLevel.Warn);\n                        this.log(options.logFilePath + '\\n', LogLevel.Warn);\n                        this._logFileStream = fs.createWriteStream(options.logFilePath);\n                        this.logDateTime();\n                        this.setupShutdownListeners();\n                        this._logFileStream.on('error', err => {\n                            handleError(err);\n                        });\n                    }\n                    catch (err) {\n                        handleError(err);\n                    }\n                }\n            }\n        });\n    }\n    logDateTime() {\n        let d = new Date();\n        let dateString = d.getUTCFullYear() + '-' + `${d.getUTCMonth() + 1}` + '-' + d.getUTCDate();\n        const timeAndDateStamp = dateString + ', ' + getFormattedTimeString();\n        this.log(timeAndDateStamp + '\\n', LogLevel.Verbose, false);\n    }\n    setupShutdownListeners() {\n        process.addListener('beforeExit', this.beforeExitCallback);\n        process.addListener('SIGTERM', this.disposeCallback);\n        process.addListener('SIGINT', this.disposeCallback);\n    }\n    removeShutdownListeners() {\n        process.removeListener('beforeExit', this.beforeExitCallback);\n        process.removeListener('SIGTERM', this.disposeCallback);\n        process.removeListener('SIGINT', this.disposeCallback);\n    }\n    dispose() {\n        return new Promise(resolve => {\n            this.removeShutdownListeners();\n            if (this._logFileStream) {\n                this._logFileStream.end(resolve);\n                this._logFileStream = null;\n            }\n            else {\n                resolve();\n            }\n        });\n    }\n    log(msg, level, prependTimestamp = true) {\n        if (this._minLogLevel === LogLevel.Stop) {\n            return;\n        }\n        if (level >= this._minLogLevel) {\n            this.sendLog(msg, level);\n        }\n        if (this._logToConsole) {\n            const logFn = level === LogLevel.Error ? console.error :\n                level === LogLevel.Warn ? console.warn :\n                    null;\n            if (logFn) {\n                logFn(trimLastNewline(msg));\n            }\n        }\n        // If an error, prepend with '[Error]'\n        if (level === LogLevel.Error) {\n            msg = `[${LogLevel[level]}] ${msg}`;\n        }\n        if (this._prependTimestamp && prependTimestamp) {\n            msg = '[' + getFormattedTimeString() + '] ' + msg;\n        }\n        if (this._logFileStream) {\n            this._logFileStream.write(msg);\n        }\n    }\n    sendLog(msg, level) {\n        // Truncate long messages, they can hang VS Code\n        if (msg.length > 1500) {\n            const endsInNewline = !!msg.match(/(\\n|\\r\\n)$/);\n            msg = msg.substr(0, 1500) + '[...]';\n            if (endsInNewline) {\n                msg = msg + '\\n';\n            }\n        }\n        if (this._logCallback) {\n            const event = new LogOutputEvent(msg, level);\n            this._logCallback(event);\n        }\n    }\n}\nfunction mkdirpPromise(folder) {\n    return new Promise((resolve, reject) => {\n        mkdirp(folder, err => {\n            if (err) {\n                reject(err);\n            }\n            else {\n                resolve();\n            }\n        });\n    });\n}\nclass LogOutputEvent extends debugSession_1.OutputEvent {\n    constructor(msg, level) {\n        const category = level === LogLevel.Error ? 'stderr' :\n            level === LogLevel.Warn ? 'console' :\n                'stdout';\n        super(msg, category);\n    }\n}\nexports.LogOutputEvent = LogOutputEvent;\nfunction trimLastNewline(str) {\n    return str.replace(/(\\n|\\r\\n)$/, '');\n}\nexports.trimLastNewline = trimLastNewline;\nfunction getFormattedTimeString() {\n    let d = new Date();\n    let hourString = _padZeroes(2, String(d.getUTCHours()));\n    let minuteString = _padZeroes(2, String(d.getUTCMinutes()));\n    let secondString = _padZeroes(2, String(d.getUTCSeconds()));\n    let millisecondString = _padZeroes(3, String(d.getUTCMilliseconds()));\n    return hourString + ':' + minuteString + ':' + secondString + '.' + millisecondString + ' UTC';\n}\nfunction _padZeroes(minDesiredLength, numberToPad) {\n    if (numberToPad.length >= minDesiredLength) {\n        return numberToPad;\n    }\n    else {\n        return String('0'.repeat(minDesiredLength) + numberToPad).slice(-minDesiredLength);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2xvZ2dlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OzREQUU0RDs7Ozs7Ozs7OztBQUU1RCx5QkFBeUI7QUFDekIsNkJBQTZCO0FBQzdCLGlDQUFpQztBQUNqQyxpREFBMkM7QUFFM0MsSUFBWSxRQU1YO0FBTkQsV0FBWSxRQUFRO0lBQ25CLDZDQUFXLENBQUE7SUFDWCxxQ0FBTyxDQUFBO0lBQ1AsdUNBQVEsQ0FBQTtJQUNSLHlDQUFTLENBQUE7SUFDVCx1Q0FBUSxDQUFBO0FBQ1QsQ0FBQyxFQU5XLFFBQVEsR0FBUixnQkFBUSxLQUFSLGdCQUFRLFFBTW5CO0FBZ0JELE1BQWEsTUFBTTtJQUFuQjtRQUlTLGlCQUFZLEdBQWUsRUFBRSxDQUFDO0lBMkV2QyxDQUFDO0lBekVBLEdBQUcsQ0FBQyxHQUFXLEVBQUUsS0FBSyxHQUFHLFFBQVEsQ0FBQyxHQUFHO1FBQ3BDLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3pCLENBQUM7SUFFRCxPQUFPLENBQUMsR0FBVztRQUNsQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVELElBQUksQ0FBQyxHQUFXO1FBQ2YsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxLQUFLLENBQUMsR0FBVztRQUNoQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVELE9BQU87UUFDTixJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDeEIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUMvQyxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztZQUMzQixPQUFPLFFBQVEsQ0FBQztTQUNoQjthQUFNO1lBQ04sT0FBTyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7U0FDekI7SUFDRixDQUFDO0lBRUQ7O09BRUc7SUFDSyxNQUFNLENBQUMsR0FBVyxFQUFFLEtBQUssR0FBRyxRQUFRLENBQUMsR0FBRztRQUMvQyw4QkFBOEI7UUFDOUIsR0FBRyxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDZixJQUFJLElBQUksQ0FBQyxZQUFZLEVBQUU7WUFDdEIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztTQUN2QzthQUFNLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUMvQixJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDcEM7SUFDRixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLGtCQUE0QixFQUFFLFlBQTZCLEVBQUUsbUJBQTRCLElBQUk7UUFDbEcsTUFBTSxXQUFXLEdBQUcsT0FBTyxZQUFZLEtBQUssUUFBUSxDQUFDLENBQUM7WUFDckQsWUFBWSxDQUFDLENBQUM7WUFDZCxDQUFDLFlBQVksSUFBSSxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUU3QyxJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDeEIsTUFBTSxPQUFPLEdBQUc7Z0JBQ2Ysa0JBQWtCO2dCQUNsQixXQUFXO2dCQUNYLGdCQUFnQjthQUNoQixDQUFDO1lBQ0YsSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtnQkFDNUMsc0ZBQXNGO2dCQUN0RixJQUFJLElBQUksQ0FBQyxZQUFZLEVBQUU7b0JBQ3RCLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7b0JBQy9CLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO29CQUN6QixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO2lCQUN4RDtZQUNGLENBQUMsQ0FBQyxDQUFDO1NBRUg7SUFDRixDQUFDO0lBRUQsSUFBSSxDQUFDLFdBQXlCLEVBQUUsV0FBb0IsRUFBRSxZQUFzQjtRQUMzRSxvQ0FBb0M7UUFDcEMsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsWUFBWSxJQUFJLEVBQUUsQ0FBQztRQUM1QyxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksY0FBYyxDQUFDLFdBQVcsRUFBRSxZQUFZLENBQUMsQ0FBQztRQUNwRSxJQUFJLENBQUMsb0JBQW9CLEdBQUcsV0FBVyxDQUFDO0lBQ3pDLENBQUM7Q0FDRDtBQS9FRCx3QkErRUM7QUFFWSxRQUFBLE1BQU0sR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBUW5DOzs7R0FHRztBQUNILE1BQU0sY0FBYztJQW1CbkIsWUFBWSxXQUF5QixFQUFFLFFBQWtCO1FBVHpELGtEQUFrRDtRQUMxQyx1QkFBa0IsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFTakQsSUFBSSxDQUFDLFlBQVksR0FBRyxXQUFXLENBQUM7UUFDaEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxRQUFRLENBQUM7UUFFOUIsSUFBSSxDQUFDLFlBQVksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDO1FBRWxDLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxNQUFjLEVBQUUsSUFBWSxFQUFFLEVBQUU7WUFDdkQsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBRWYsNENBQTRDO1lBQzVDLHlEQUF5RDtZQUN6RCxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVM7WUFDM0IsSUFBSSxJQUFJLEdBQUcsQ0FBQztZQUVaLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEIsQ0FBQyxDQUFDO0lBQ0gsQ0FBQztJQUVZLEtBQUssQ0FBQyxPQUErQjs7WUFDakQsSUFBSSxDQUFDLFlBQVksR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUM7WUFDL0MsSUFBSSxDQUFDLGlCQUFpQixHQUFHLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztZQUVsRCxzRUFBc0U7WUFDdEUsSUFBSSxPQUFPLENBQUMsV0FBVyxFQUFFO2dCQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUU7b0JBQzFDLElBQUksQ0FBQyxHQUFHLENBQUMseUNBQXlDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7aUJBQ3pGO3FCQUFNO29CQUNOLE1BQU0sV0FBVyxHQUFHLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxvQ0FBb0MsT0FBTyxDQUFDLFdBQVcsWUFBWSxHQUFHLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBRS9JLElBQUk7d0JBQ0gsTUFBTSxhQUFhLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQzt3QkFDdkQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxnQ0FBZ0MsRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7d0JBQzFELElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsR0FBRyxJQUFJLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO3dCQUVwRCxJQUFJLENBQUMsY0FBYyxHQUFHLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7d0JBQ2hFLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQzt3QkFDbkIsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7d0JBQzlCLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsRUFBRTs0QkFDckMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO3dCQUNsQixDQUFDLENBQUMsQ0FBQztxQkFDSDtvQkFBQyxPQUFPLEdBQUcsRUFBRTt3QkFDYixXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7cUJBQ2pCO2lCQUNEO2FBQ0Q7UUFDRixDQUFDO0tBQUE7SUFFTyxXQUFXO1FBQ2xCLElBQUksQ0FBQyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDbkIsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDLGNBQWMsRUFBRSxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLEVBQUUsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzVGLE1BQU0sZ0JBQWdCLEdBQUcsVUFBVSxHQUFHLElBQUksR0FBRyxzQkFBc0IsRUFBRSxDQUFDO1FBQ3RFLElBQUksQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxFQUFFLFFBQVEsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDNUQsQ0FBQztJQUVPLHNCQUFzQjtRQUM3QixPQUFPLENBQUMsV0FBVyxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUMzRCxPQUFPLENBQUMsV0FBVyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDckQsT0FBTyxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQ3JELENBQUM7SUFFTyx1QkFBdUI7UUFDOUIsT0FBTyxDQUFDLGNBQWMsQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDOUQsT0FBTyxDQUFDLGNBQWMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ3hELE9BQU8sQ0FBQyxjQUFjLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBRU0sT0FBTztRQUNiLE9BQU8sSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDNUIsSUFBSSxDQUFDLHVCQUF1QixFQUFFLENBQUM7WUFDL0IsSUFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO2dCQUN4QixJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztnQkFDakMsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7YUFDM0I7aUJBQU07Z0JBQ04sT0FBTyxFQUFFLENBQUM7YUFDVjtRQUNGLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQztJQUVNLEdBQUcsQ0FBQyxHQUFXLEVBQUUsS0FBZSxFQUFFLGdCQUFnQixHQUFHLElBQUk7UUFDL0QsSUFBSSxJQUFJLENBQUMsWUFBWSxLQUFLLFFBQVEsQ0FBQyxJQUFJLEVBQUU7WUFDeEMsT0FBTztTQUNQO1FBRUQsSUFBSSxLQUFLLElBQUksSUFBSSxDQUFDLFlBQVksRUFBRTtZQUMvQixJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztTQUN6QjtRQUVELElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtZQUN2QixNQUFNLEtBQUssR0FDVixLQUFLLEtBQUssUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMxQyxLQUFLLEtBQUssUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO29CQUN4QyxJQUFJLENBQUM7WUFFTixJQUFJLEtBQUssRUFBRTtnQkFDVixLQUFLLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7YUFDNUI7U0FDRDtRQUVELHNDQUFzQztRQUN0QyxJQUFJLEtBQUssS0FBSyxRQUFRLENBQUMsS0FBSyxFQUFFO1lBQzdCLEdBQUcsR0FBRyxJQUFJLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztTQUNwQztRQUVELElBQUksSUFBSSxDQUFDLGlCQUFpQixJQUFJLGdCQUFnQixFQUFFO1lBQy9DLEdBQUcsR0FBRyxHQUFHLEdBQUcsc0JBQXNCLEVBQUUsR0FBRyxJQUFJLEdBQUcsR0FBRyxDQUFDO1NBQ2xEO1FBRUQsSUFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQy9CO0lBQ0YsQ0FBQztJQUVPLE9BQU8sQ0FBQyxHQUFXLEVBQUUsS0FBZTtRQUMzQyxnREFBZ0Q7UUFDaEQsSUFBSSxHQUFHLENBQUMsTUFBTSxHQUFHLElBQUksRUFBRTtZQUN0QixNQUFNLGFBQWEsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNoRCxHQUFHLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDO1lBQ3BDLElBQUksYUFBYSxFQUFFO2dCQUNsQixHQUFHLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQzthQUNqQjtTQUNEO1FBRUQsSUFBSSxJQUFJLENBQUMsWUFBWSxFQUFFO1lBQ3RCLE1BQU0sS0FBSyxHQUFHLElBQUksY0FBYyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM3QyxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3pCO0lBQ0YsQ0FBQztDQUNEO0FBRUQsU0FBUyxhQUFhLENBQUMsTUFBYztJQUNwQyxPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1FBQ3RDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLEVBQUU7WUFDcEIsSUFBSSxHQUFHLEVBQUU7Z0JBQ1IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ1o7aUJBQU07Z0JBQ04sT0FBTyxFQUFFLENBQUM7YUFDVjtRQUNGLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBYSxjQUFlLFNBQVEsMEJBQVc7SUFDOUMsWUFBWSxHQUFXLEVBQUUsS0FBZTtRQUN2QyxNQUFNLFFBQVEsR0FDYixLQUFLLEtBQUssUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDckMsS0FBSyxLQUFLLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUNyQyxRQUFRLENBQUM7UUFDVixLQUFLLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3RCLENBQUM7Q0FDRDtBQVJELHdDQVFDO0FBRUQsU0FBZ0IsZUFBZSxDQUFDLEdBQVc7SUFDMUMsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsQ0FBQztBQUN0QyxDQUFDO0FBRkQsMENBRUM7QUFFRCxTQUFTLHNCQUFzQjtJQUM5QixJQUFJLENBQUMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO0lBQ25CLElBQUksVUFBVSxHQUFHLFVBQVUsQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDeEQsSUFBSSxZQUFZLEdBQUcsVUFBVSxDQUFDLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM1RCxJQUFJLFlBQVksR0FBRyxVQUFVLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzVELElBQUksaUJBQWlCLEdBQUcsVUFBVSxDQUFDLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3RFLE9BQU8sVUFBVSxHQUFHLEdBQUcsR0FBRyxZQUFZLEdBQUcsR0FBRyxHQUFHLFlBQVksR0FBRyxHQUFHLEdBQUcsaUJBQWlCLEdBQUcsTUFBTSxDQUFDO0FBQ2hHLENBQUM7QUFFRCxTQUFTLFVBQVUsQ0FBQyxnQkFBd0IsRUFBRSxXQUFtQjtJQUNoRSxJQUFJLFdBQVcsQ0FBQyxNQUFNLElBQUksZ0JBQWdCLEVBQUU7UUFDM0MsT0FBTyxXQUFXLENBQUM7S0FDbkI7U0FBTTtRQUNOLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0tBQ25GO0FBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBDb3B5cmlnaHQgKEMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgbWtkaXJwIGZyb20gJ21rZGlycCc7XG5pbXBvcnQge091dHB1dEV2ZW50fSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5cbmV4cG9ydCBlbnVtIExvZ0xldmVsIHtcblx0VmVyYm9zZSA9IDAsXG5cdExvZyA9IDEsXG5cdFdhcm4gPSAyLFxuXHRFcnJvciA9IDMsXG5cdFN0b3AgPSA0XG59XG5cbmV4cG9ydCB0eXBlIElMb2dDYWxsYmFjayA9IChvdXRwdXRFdmVudDogT3V0cHV0RXZlbnQpID0+IHZvaWQ7XG5cbmludGVyZmFjZSBJTG9nSXRlbSB7XG5cdG1zZzogc3RyaW5nO1xuXHRsZXZlbDogTG9nTGV2ZWw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUxvZ2dlciB7XG5cdGxvZyhtc2c6IHN0cmluZywgbGV2ZWw/OiBMb2dMZXZlbCk6IHZvaWQ7XG5cdHZlcmJvc2UobXNnOiBzdHJpbmcpOiB2b2lkO1xuXHR3YXJuKG1zZzogc3RyaW5nKTogdm9pZDtcblx0ZXJyb3IobXNnOiBzdHJpbmcpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgTG9nZ2VyIHtcblx0cHJpdmF0ZSBfbG9nRmlsZVBhdGhGcm9tSW5pdDogc3RyaW5nO1xuXG5cdHByaXZhdGUgX2N1cnJlbnRMb2dnZXI6IEludGVybmFsTG9nZ2VyO1xuXHRwcml2YXRlIF9wZW5kaW5nTG9nUTogSUxvZ0l0ZW1bXSA9IFtdO1xuXG5cdGxvZyhtc2c6IHN0cmluZywgbGV2ZWwgPSBMb2dMZXZlbC5Mb2cpOiB2b2lkIHtcblx0XHRtc2cgPSBtc2cgKyAnXFxuJztcblx0XHR0aGlzLl93cml0ZShtc2csIGxldmVsKTtcblx0fVxuXG5cdHZlcmJvc2UobXNnOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmxvZyhtc2csIExvZ0xldmVsLlZlcmJvc2UpO1xuXHR9XG5cblx0d2Fybihtc2c6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMubG9nKG1zZywgTG9nTGV2ZWwuV2Fybik7XG5cdH1cblxuXHRlcnJvcihtc2c6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMubG9nKG1zZywgTG9nTGV2ZWwuRXJyb3IpO1xuXHR9XG5cblx0ZGlzcG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAodGhpcy5fY3VycmVudExvZ2dlcikge1xuXHRcdFx0Y29uc3QgZGlzcG9zZVAgPSB0aGlzLl9jdXJyZW50TG9nZ2VyLmRpc3Bvc2UoKTtcblx0XHRcdHRoaXMuX2N1cnJlbnRMb2dnZXIgPSBudWxsO1xuXHRcdFx0cmV0dXJuIGRpc3Bvc2VQO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIGBsb2dgIGFkZHMgYSBuZXdsaW5lLCBgd3JpdGVgIGRvZXNuJ3Rcblx0ICovXG5cdHByaXZhdGUgX3dyaXRlKG1zZzogc3RyaW5nLCBsZXZlbCA9IExvZ0xldmVsLkxvZyk6IHZvaWQge1xuXHRcdC8vIFtudWxsLCB1bmRlZmluZWRdID0+IHN0cmluZ1xuXHRcdG1zZyA9IG1zZyArICcnO1xuXHRcdGlmICh0aGlzLl9wZW5kaW5nTG9nUSkge1xuXHRcdFx0dGhpcy5fcGVuZGluZ0xvZ1EucHVzaCh7IG1zZywgbGV2ZWwgfSk7XG5cdFx0fSBlbHNlIGlmICh0aGlzLl9jdXJyZW50TG9nZ2VyKSB7XG5cdFx0XHR0aGlzLl9jdXJyZW50TG9nZ2VyLmxvZyhtc2csIGxldmVsKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU2V0IHRoZSBsb2dnZXIncyBtaW5pbXVtIGxldmVsIHRvIGxvZyBpbiB0aGUgY29uc29sZSwgYW5kIHdoZXRoZXIgdG8gbG9nIHRvIHRoZSBmaWxlLiBMb2cgbWVzc2FnZXMgYXJlIHF1ZXVlZCBiZWZvcmUgdGhpcyBpc1xuXHQgKiBjYWxsZWQgdGhlIGZpcnN0IHRpbWUsIGJlY2F1c2UgbWluTG9nTGV2ZWwgZGVmYXVsdHMgdG8gV2Fybi5cblx0ICovXG5cdHNldHVwKGNvbnNvbGVNaW5Mb2dMZXZlbDogTG9nTGV2ZWwsIF9sb2dGaWxlUGF0aD86IHN0cmluZ3xib29sZWFuLCBwcmVwZW5kVGltZXN0YW1wOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuXHRcdGNvbnN0IGxvZ0ZpbGVQYXRoID0gdHlwZW9mIF9sb2dGaWxlUGF0aCA9PT0gJ3N0cmluZycgP1xuXHRcdFx0X2xvZ0ZpbGVQYXRoIDpcblx0XHRcdChfbG9nRmlsZVBhdGggJiYgdGhpcy5fbG9nRmlsZVBhdGhGcm9tSW5pdCk7XG5cblx0XHRpZiAodGhpcy5fY3VycmVudExvZ2dlcikge1xuXHRcdFx0Y29uc3Qgb3B0aW9ucyA9IHtcblx0XHRcdFx0Y29uc29sZU1pbkxvZ0xldmVsLFxuXHRcdFx0XHRsb2dGaWxlUGF0aCxcblx0XHRcdFx0cHJlcGVuZFRpbWVzdGFtcFxuXHRcdFx0fTtcblx0XHRcdHRoaXMuX2N1cnJlbnRMb2dnZXIuc2V0dXAob3B0aW9ucykudGhlbigoKSA9PiB7XG5cdFx0XHRcdC8vIE5vdyB0aGF0IHdlIGhhdmUgYSBtaW5pbXVtIGxvZ0xldmVsLCB3ZSBjYW4gY2xlYXIgb3V0IHRoZSBxdWV1ZSBvZiBwZW5kaW5nIG1lc3NhZ2VzXG5cdFx0XHRcdGlmICh0aGlzLl9wZW5kaW5nTG9nUSkge1xuXHRcdFx0XHRcdGNvbnN0IGxvZ1EgPSB0aGlzLl9wZW5kaW5nTG9nUTtcblx0XHRcdFx0XHR0aGlzLl9wZW5kaW5nTG9nUSA9IG51bGw7XG5cdFx0XHRcdFx0bG9nUS5mb3JFYWNoKGl0ZW0gPT4gdGhpcy5fd3JpdGUoaXRlbS5tc2csIGl0ZW0ubGV2ZWwpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHR9XG5cdH1cblxuXHRpbml0KGxvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2ssIGxvZ0ZpbGVQYXRoPzogc3RyaW5nLCBsb2dUb0NvbnNvbGU/OiBib29sZWFuKTogdm9pZCB7XG5cdFx0Ly8gUmUtaW5pdCwgY3JlYXRlIG5ldyBnbG9iYWwgTG9nZ2VyXG5cdFx0dGhpcy5fcGVuZGluZ0xvZ1EgPSB0aGlzLl9wZW5kaW5nTG9nUSB8fCBbXTtcblx0XHR0aGlzLl9jdXJyZW50TG9nZ2VyID0gbmV3IEludGVybmFsTG9nZ2VyKGxvZ0NhbGxiYWNrLCBsb2dUb0NvbnNvbGUpO1xuXHRcdHRoaXMuX2xvZ0ZpbGVQYXRoRnJvbUluaXQgPSBsb2dGaWxlUGF0aDtcblx0fVxufVxuXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcigpO1xuXG5pbnRlcmZhY2UgSUludGVybmFsTG9nZ2VyT3B0aW9ucyB7XG5cdGNvbnNvbGVNaW5Mb2dMZXZlbDogTG9nTGV2ZWw7XG5cdGxvZ0ZpbGVQYXRoPzogc3RyaW5nO1xuXHRwcmVwZW5kVGltZXN0YW1wPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIGxvZ2dpbmcsIHdoZXRoZXIgdG8gY29uc29sZS5sb2csIGZpbGUsIG9yIFZTIENvZGUgY29uc29sZS5cbiAqIEVuY2Fwc3VsYXRlcyB0aGUgc3RhdGUgc3BlY2lmaWMgdG8gZWFjaCBsb2dnaW5nIHNlc3Npb25cbiAqL1xuY2xhc3MgSW50ZXJuYWxMb2dnZXIge1xuXHRwcml2YXRlIF9taW5Mb2dMZXZlbDogTG9nTGV2ZWw7XG5cdHByaXZhdGUgX2xvZ1RvQ29uc29sZTogYm9vbGVhbjtcblxuXHQvKiogTG9nIGluZm8gdGhhdCBtZWV0cyBtaW5Mb2dMZXZlbCBpcyBzZW50IHRvIHRoaXMgY2FsbGJhY2suICovXG5cdHByaXZhdGUgX2xvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2s7XG5cblx0LyoqIFdyaXRlIHN0ZWFtIGZvciBsb2cgZmlsZSAqL1xuXHRwcml2YXRlIF9sb2dGaWxlU3RyZWFtOiBmcy5Xcml0ZVN0cmVhbTtcblxuXHQvKiogRGlzcG9zZSBhbmQgYWxsb3cgZXhpdCB0byBjb250aW51ZSBub3JtYWxseSAqL1xuXHRwcml2YXRlIGJlZm9yZUV4aXRDYWxsYmFjayA9ICgpID0+IHRoaXMuZGlzcG9zZSgpO1xuXG5cdC8qKiBEaXNwb3NlIGFuZCBleGl0ICovXG5cdHByaXZhdGUgZGlzcG9zZUNhbGxiYWNrO1xuXG5cdC8qKiBXaGV0aGVyIHRvIGFkZCBhIHRpbWVzdGFtcCB0byBtZXNzYWdlcyBpbiB0aGUgbG9nZmlsZSAqL1xuXHRwcml2YXRlIF9wcmVwZW5kVGltZXN0YW1wOiBib29sZWFuO1xuXG5cdGNvbnN0cnVjdG9yKGxvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2ssIGlzU2VydmVyPzogYm9vbGVhbikge1xuXHRcdHRoaXMuX2xvZ0NhbGxiYWNrID0gbG9nQ2FsbGJhY2s7XG5cdFx0dGhpcy5fbG9nVG9Db25zb2xlID0gaXNTZXJ2ZXI7XG5cblx0XHR0aGlzLl9taW5Mb2dMZXZlbCA9IExvZ0xldmVsLldhcm47XG5cblx0XHR0aGlzLmRpc3Bvc2VDYWxsYmFjayA9IChzaWduYWw6IHN0cmluZywgY29kZTogbnVtYmVyKSA9PiB7XG5cdFx0XHR0aGlzLmRpc3Bvc2UoKTtcblxuXHRcdFx0Ly8gRXhpdCB3aXRoIDEyOCArIHZhbHVlIG9mIHRoZSBzaWduYWwgY29kZS5cblx0XHRcdC8vIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvcHJvY2Vzcy5odG1sI3Byb2Nlc3NfZXhpdF9jb2Rlc1xuXHRcdFx0Y29kZSA9IGNvZGUgfHwgMjsgLy8gU0lHSU5UXG5cdFx0XHRjb2RlICs9IDEyODtcblxuXHRcdFx0cHJvY2Vzcy5leGl0KGNvZGUpO1xuXHRcdH07XG5cdH1cblxuXHRwdWJsaWMgYXN5bmMgc2V0dXAob3B0aW9uczogSUludGVybmFsTG9nZ2VyT3B0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMuX21pbkxvZ0xldmVsID0gb3B0aW9ucy5jb25zb2xlTWluTG9nTGV2ZWw7XG5cdFx0dGhpcy5fcHJlcGVuZFRpbWVzdGFtcCA9IG9wdGlvbnMucHJlcGVuZFRpbWVzdGFtcDtcblxuXHRcdC8vIE9wZW4gYSBsb2cgZmlsZSBpbiB0aGUgc3BlY2lmaWVkIGxvY2F0aW9uLiBPdmVyd3JpdHRlbiBvbiBlYWNoIHJ1bi5cblx0XHRpZiAob3B0aW9ucy5sb2dGaWxlUGF0aCkge1xuXHRcdFx0aWYgKCFwYXRoLmlzQWJzb2x1dGUob3B0aW9ucy5sb2dGaWxlUGF0aCkpIHtcblx0XHRcdFx0dGhpcy5sb2coYGxvZ0ZpbGVQYXRoIG11c3QgYmUgYW4gYWJzb2x1dGUgcGF0aDogJHtvcHRpb25zLmxvZ0ZpbGVQYXRofWAsIExvZ0xldmVsLkVycm9yKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGhhbmRsZUVycm9yID0gZXJyID0+IHRoaXMuc2VuZExvZyhgRXJyb3IgY3JlYXRpbmcgbG9nIGZpbGUgYXQgcGF0aDogJHtvcHRpb25zLmxvZ0ZpbGVQYXRofS4gRXJyb3I6ICR7ZXJyLnRvU3RyaW5nKCl9XFxuYCwgTG9nTGV2ZWwuRXJyb3IpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0YXdhaXQgbWtkaXJwUHJvbWlzZShwYXRoLmRpcm5hbWUob3B0aW9ucy5sb2dGaWxlUGF0aCkpO1xuXHRcdFx0XHRcdHRoaXMubG9nKGBWZXJib3NlIGxvZ3MgYXJlIHdyaXR0ZW4gdG86XFxuYCwgTG9nTGV2ZWwuV2Fybik7XG5cdFx0XHRcdFx0dGhpcy5sb2cob3B0aW9ucy5sb2dGaWxlUGF0aCArICdcXG4nLCBMb2dMZXZlbC5XYXJuKTtcblxuXHRcdFx0XHRcdHRoaXMuX2xvZ0ZpbGVTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShvcHRpb25zLmxvZ0ZpbGVQYXRoKTtcblx0XHRcdFx0XHR0aGlzLmxvZ0RhdGVUaW1lKCk7XG5cdFx0XHRcdFx0dGhpcy5zZXR1cFNodXRkb3duTGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbS5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRcdFx0XHRcdFx0aGFuZGxlRXJyb3IoZXJyKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdFx0aGFuZGxlRXJyb3IoZXJyKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgbG9nRGF0ZVRpbWUoKTogdm9pZCB7XG5cdFx0bGV0IGQgPSBuZXcgRGF0ZSgpO1xuXHRcdGxldCBkYXRlU3RyaW5nID0gZC5nZXRVVENGdWxsWWVhcigpICsgJy0nICsgYCR7ZC5nZXRVVENNb250aCgpICsgMX1gICsgJy0nICsgZC5nZXRVVENEYXRlKCk7XG5cdFx0Y29uc3QgdGltZUFuZERhdGVTdGFtcCA9IGRhdGVTdHJpbmcgKyAnLCAnICsgZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpO1xuXHRcdHRoaXMubG9nKHRpbWVBbmREYXRlU3RhbXAgKyAnXFxuJywgTG9nTGV2ZWwuVmVyYm9zZSwgZmFsc2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBzZXR1cFNodXRkb3duTGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHByb2Nlc3MuYWRkTGlzdGVuZXIoJ2JlZm9yZUV4aXQnLCB0aGlzLmJlZm9yZUV4aXRDYWxsYmFjayk7XG5cdFx0cHJvY2Vzcy5hZGRMaXN0ZW5lcignU0lHVEVSTScsIHRoaXMuZGlzcG9zZUNhbGxiYWNrKTtcblx0XHRwcm9jZXNzLmFkZExpc3RlbmVyKCdTSUdJTlQnLCB0aGlzLmRpc3Bvc2VDYWxsYmFjayk7XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZVNodXRkb3duTGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHByb2Nlc3MucmVtb3ZlTGlzdGVuZXIoJ2JlZm9yZUV4aXQnLCB0aGlzLmJlZm9yZUV4aXRDYWxsYmFjayk7XG5cdFx0cHJvY2Vzcy5yZW1vdmVMaXN0ZW5lcignU0lHVEVSTScsIHRoaXMuZGlzcG9zZUNhbGxiYWNrKTtcblx0XHRwcm9jZXNzLnJlbW92ZUxpc3RlbmVyKCdTSUdJTlQnLCB0aGlzLmRpc3Bvc2VDYWxsYmFjayk7XG5cdH1cblxuXHRwdWJsaWMgZGlzcG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG5cdFx0XHR0aGlzLnJlbW92ZVNodXRkb3duTGlzdGVuZXJzKCk7XG5cdFx0XHRpZiAodGhpcy5fbG9nRmlsZVN0cmVhbSkge1xuXHRcdFx0XHR0aGlzLl9sb2dGaWxlU3RyZWFtLmVuZChyZXNvbHZlKTtcblx0XHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbSA9IG51bGw7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwdWJsaWMgbG9nKG1zZzogc3RyaW5nLCBsZXZlbDogTG9nTGV2ZWwsIHByZXBlbmRUaW1lc3RhbXAgPSB0cnVlKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuX21pbkxvZ0xldmVsID09PSBMb2dMZXZlbC5TdG9wKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKGxldmVsID49IHRoaXMuX21pbkxvZ0xldmVsKSB7XG5cdFx0XHR0aGlzLnNlbmRMb2cobXNnLCBsZXZlbCk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX2xvZ1RvQ29uc29sZSkge1xuXHRcdFx0Y29uc3QgbG9nRm4gPVxuXHRcdFx0XHRsZXZlbCA9PT0gTG9nTGV2ZWwuRXJyb3IgPyBjb25zb2xlLmVycm9yIDpcblx0XHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLldhcm4gPyBjb25zb2xlLndhcm4gOlxuXHRcdFx0XHRudWxsO1xuXG5cdFx0XHRpZiAobG9nRm4pIHtcblx0XHRcdFx0bG9nRm4odHJpbUxhc3ROZXdsaW5lKG1zZykpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIGFuIGVycm9yLCBwcmVwZW5kIHdpdGggJ1tFcnJvcl0nXG5cdFx0aWYgKGxldmVsID09PSBMb2dMZXZlbC5FcnJvcikge1xuXHRcdFx0bXNnID0gYFske0xvZ0xldmVsW2xldmVsXX1dICR7bXNnfWA7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX3ByZXBlbmRUaW1lc3RhbXAgJiYgcHJlcGVuZFRpbWVzdGFtcCkge1xuXHRcdFx0bXNnID0gJ1snICsgZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpICsgJ10gJyArIG1zZztcblx0XHR9XG5cblx0XHRpZiAodGhpcy5fbG9nRmlsZVN0cmVhbSkge1xuXHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbS53cml0ZShtc2cpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2VuZExvZyhtc2c6IHN0cmluZywgbGV2ZWw6IExvZ0xldmVsKTogdm9pZCB7XG5cdFx0Ly8gVHJ1bmNhdGUgbG9uZyBtZXNzYWdlcywgdGhleSBjYW4gaGFuZyBWUyBDb2RlXG5cdFx0aWYgKG1zZy5sZW5ndGggPiAxNTAwKSB7XG5cdFx0XHRjb25zdCBlbmRzSW5OZXdsaW5lID0gISFtc2cubWF0Y2goLyhcXG58XFxyXFxuKSQvKTtcblx0XHRcdG1zZyA9IG1zZy5zdWJzdHIoMCwgMTUwMCkgKyAnWy4uLl0nO1xuXHRcdFx0aWYgKGVuZHNJbk5ld2xpbmUpIHtcblx0XHRcdFx0bXNnID0gbXNnICsgJ1xcbic7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX2xvZ0NhbGxiYWNrKSB7XG5cdFx0XHRjb25zdCBldmVudCA9IG5ldyBMb2dPdXRwdXRFdmVudChtc2csIGxldmVsKTtcblx0XHRcdHRoaXMuX2xvZ0NhbGxiYWNrKGV2ZW50KTtcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gbWtkaXJwUHJvbWlzZShmb2xkZXI6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdG1rZGlycChmb2xkZXIsIGVyciA9PiB7XG5cdFx0XHRpZiAoZXJyKSB7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn1cblxuZXhwb3J0IGNsYXNzIExvZ091dHB1dEV2ZW50IGV4dGVuZHMgT3V0cHV0RXZlbnQge1xuXHRjb25zdHJ1Y3Rvcihtc2c6IHN0cmluZywgbGV2ZWw6IExvZ0xldmVsKSB7XG5cdFx0Y29uc3QgY2F0ZWdvcnkgPVxuXHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLkVycm9yID8gJ3N0ZGVycicgOlxuXHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLldhcm4gPyAnY29uc29sZScgOlxuXHRcdFx0J3N0ZG91dCc7XG5cdFx0c3VwZXIobXNnLCBjYXRlZ29yeSk7XG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyaW1MYXN0TmV3bGluZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdHJldHVybiBzdHIucmVwbGFjZSgvKFxcbnxcXHJcXG4pJC8sICcnKTtcbn1cblxuZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpOiBzdHJpbmcge1xuXHRsZXQgZCA9IG5ldyBEYXRlKCk7XG5cdGxldCBob3VyU3RyaW5nID0gX3BhZFplcm9lcygyLCBTdHJpbmcoZC5nZXRVVENIb3VycygpKSk7XG5cdGxldCBtaW51dGVTdHJpbmcgPSBfcGFkWmVyb2VzKDIsIFN0cmluZyhkLmdldFVUQ01pbnV0ZXMoKSkpO1xuXHRsZXQgc2Vjb25kU3RyaW5nID0gX3BhZFplcm9lcygyLCBTdHJpbmcoZC5nZXRVVENTZWNvbmRzKCkpKTtcblx0bGV0IG1pbGxpc2Vjb25kU3RyaW5nID0gX3BhZFplcm9lcygzLCBTdHJpbmcoZC5nZXRVVENNaWxsaXNlY29uZHMoKSkpO1xuXHRyZXR1cm4gaG91clN0cmluZyArICc6JyArIG1pbnV0ZVN0cmluZyArICc6JyArIHNlY29uZFN0cmluZyArICcuJyArIG1pbGxpc2Vjb25kU3RyaW5nICsgJyBVVEMnO1xufVxuXG5mdW5jdGlvbiBfcGFkWmVyb2VzKG1pbkRlc2lyZWRMZW5ndGg6IG51bWJlciwgbnVtYmVyVG9QYWQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdGlmIChudW1iZXJUb1BhZC5sZW5ndGggPj0gbWluRGVzaXJlZExlbmd0aCkge1xuXHRcdHJldHVybiBudW1iZXJUb1BhZDtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gU3RyaW5nKCcwJy5yZXBlYXQobWluRGVzaXJlZExlbmd0aCkgKyBudW1iZXJUb1BhZCkuc2xpY2UoLW1pbkRlc2lyZWRMZW5ndGgpO1xuXHR9XG59XG4iXX0=","import * as vscode from 'vscode';\r\nimport { MumpsLabel } from \"./mumps-label-lookup\";\r\nconst DIVIDERLINE = \"\\t;****************\\n\"\r\n\r\nfunction DocumentFunction(){\r\n\t\tlet editor = vscode.window.activeTextEditor\r\n\t\tif (editor) {\r\n\t\t\tlet document = editor.document\r\n\t\t\tlet InsertPosition = editor.selection.start.with(editor.selection.start.line,0)\r\n\r\n\t\t\t//if the line is empty look down for the label\r\n\t\t\twhile(InsertPosition.line < document.lineCount){\r\n\t\t\t\tlet txt = editor.document.lineAt(InsertPosition.line).text\r\n\t\t\t\tif (txt.replace(/\\t|\\ /i,\"\")===\"\"){\r\n\t\t\t\t\tInsertPosition = InsertPosition.translate(1,0)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(InsertPosition.line === document.lineCount){\r\n\t\t\t\tInsertPosition = InsertPosition.translate(-1,0)\r\n\t\t\t}\r\n\t\t\t//start moving up the file looking for the label header\r\n\t\t\twhile(InsertPosition.line >= 0){\r\n\t\t\t\tlet txt = editor.document.lineAt(InsertPosition.line).text\r\n\t\t\t\tlet functionSig = lineIsFunctionSig(txt)\r\n\t\t\t\tif (functionSig){\r\n\t\t\t\t\teditor.edit((editBuilder) =>{\r\n\t\t\t\t\t\teditBuilder.insert(InsertPosition, makeSignature(txt))\r\n\t\t\t\t\t})\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tInsertPosition = InsertPosition.translate(-1,0)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n};\r\n\r\n/**\r\n * @description this will assume if there is code on the first position of the line that it is a function\r\n * @param {text to search} text\r\n * @return {returns false if there is none, true otherwise}\r\n */\r\nfunction lineIsFunctionSig(text){\r\n  if(text.length ===0 || text.charAt(0)===\" \" || text.charAt(0)==='\\t' || text.charAt(0)===';'){\r\n    return false;\r\n  }\r\n  return true\r\n}\r\n\r\nfunction makeSignature(labelLine:string){\r\n  let Signature = \"\"\r\n\r\n  Signature+=DIVIDERLINE\r\n  Signature+=\"\\t; DESCRIPTION: \\n\"\r\n  let parameters = labelLine.match(/\\(.*\\)/)\r\n  if(parameters !== null && parameters.length> 0){\r\n    parameters = parameters[0].substring(1, parameters[0].length-1).split(\",\")\r\n    if(parameters.length > 0){\r\n      Signature+=\"\\t; PARAMETERS: \\n\"\r\n      parameters.forEach(function(element:string) {\r\n        Signature+=\"\\t;    \" + element + \"(I/O,REQ): \\n\"\r\n      });\r\n    }\r\n  }\r\n\r\n  Signature+=\"\\t; RETURNS: \\n\"\r\n  Signature+=\"\\t; REVISIONS: \\n\"\r\n  Signature+=DIVIDERLINE\r\n  return Signature;\r\n}\r\n\r\nfunction getSigInfo(referredTo:MumpsLabel, definition, parametersByName){\r\n\tif (referredTo.text) {\r\n\t\tlet description = referredTo.text.match(/DESCRIPTION:.*/i)\r\n\t\tif(description!==null) {definition.description = description[0];}\r\n\t\t//console.log(definition.description)\r\n\t\t//console.log(parametersByName)\r\n\r\n\t\tfor(let param in parametersByName){\r\n\t\t\t//console.log(param)\r\n\t\t\tlet paramDescription = referredTo.text.match(new RegExp(param+\"\\\\(.*\\\\):.*\",'i'))\r\n\t\t\tif(paramDescription !== null) {parametersByName[param].description=paramDescription}\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport {getSigInfo, DocumentFunction};","/*\r\nMumps-Debug-Extension for Visual Studio Code by Jens Wulf\r\n*/\r\n\r\n'use strict';\r\n\r\nimport * as vscode from 'vscode';\r\nimport { WorkspaceFolder, ProviderResult, DebugConfiguration, CancellationToken } from 'vscode';\r\nimport { MumpsDebugSession } from './mumpsDebug';\r\nimport { MumpsHoverProvider } from './mumps-hover-provider'\r\nimport { MumpsDefinitionProvider } from './mumps-definition-provider'\r\nimport { MumpsSignatureHelpProvider } from './mumps-signature-help-provider'\r\nimport { DocumentFunction } from './mumps-documenter'\r\nimport { MumpsDocumentSymbolProvider } from './mumps-document';\r\nimport { CompletionItemProvider } from './mumps-completion-item-provider';\r\nimport * as AutospaceFunction from './mumps-autospace'\r\nimport { MumpsLineParser } from './mumpsLineParser';\r\nimport { MumpsHighlighter, SemanticTokens } from './mumps-highlighter';\r\nimport { expandCompress } from './mumpsCompExp';\r\nconst parser = new MumpsLineParser;\r\n\r\nconst fs = require('fs');\r\nlet timeout: ReturnType<typeof setTimeout> | undefined;\r\nlet entryRef: string | undefined = \"\";\r\nexport async function activate(context: vscode.ExtensionContext) {\r\n\tconst MUMPS_MODE: vscode.DocumentFilter = { language: 'mumps', scheme: 'file' };\r\n\t// register a configuration provider for 'mumps' debug type\r\n\tconst mumpsDiagnostics = vscode.languages.createDiagnosticCollection(\"mumps\");\r\n\tcontext.subscriptions.push(\r\n\t\tvscode.commands.registerCommand('mumps.getEntryRef', () => {\r\n\t\t\treturn vscode.window.showInputBox({\r\n\t\t\t\tplaceHolder: \"Please enter the Entry-Reference to start Debugging\",\r\n\t\t\t\tvalue: entryRef\r\n\t\t\t});\r\n\t\t})\r\n\t);\r\n\tlet storage = context.storageUri!.fsPath;\r\n\tif (!fs.existsSync(storage)) {\r\n\t\tfs.mkdirSync(storage);\r\n\t}\r\n\tconst dbFile = storage + \"/labeldb.json\";\r\n\tconst wsState = context.workspaceState;\r\n\tcontext.subscriptions.push(\r\n\t\tvscode.commands.registerCommand(\"mumps.documentFunction\", () => { DocumentFunction(); }),\r\n\t\tvscode.commands.registerCommand(\"mumps.autoSpaceEnter\", () => { AutospaceFunction.autoSpaceEnter(); }),\r\n\t\tvscode.commands.registerCommand(\"mumps.autoSpaceTab\", () => { AutospaceFunction.autoSpaceTab(); }),\r\n\t\tvscode.commands.registerCommand(\"mumps.toggleExpandedCommands\", () => { expandCompress(wsState) }),\r\n\t\tvscode.languages.registerHoverProvider(MUMPS_MODE, new MumpsHoverProvider()),\r\n\t\tvscode.languages.registerDefinitionProvider(MUMPS_MODE, new MumpsDefinitionProvider()),\r\n\t\tvscode.languages.registerSignatureHelpProvider(MUMPS_MODE, new MumpsSignatureHelpProvider(), '(', ','),\r\n\t\tvscode.languages.registerDocumentSymbolProvider(MUMPS_MODE, new MumpsDocumentSymbolProvider()),\r\n\t\tvscode.languages.registerCompletionItemProvider(MUMPS_MODE, new CompletionItemProvider(dbFile)),\r\n\t\tvscode.languages.registerDocumentSemanticTokensProvider(MUMPS_MODE, MumpsHighlighter, SemanticTokens),\r\n\t\tvscode.languages.registerDocumentFormattingEditProvider(MUMPS_MODE, {\r\n\t\t\tprovideDocumentFormattingEdits: (document, options, token) => {\r\n\t\t\t\tlet textEdits: vscode.TextEdit[] = []\r\n\t\t\t\tfor (let i = 0; i < document.lineCount; i++) {\r\n\t\t\t\t\tlet line = document.lineAt(i).text;\r\n\t\t\t\t\tformatDocumentLine(line, i, textEdits);\r\n\t\t\t\t}\r\n\t\t\t\treturn textEdits;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tvscode.languages.registerDocumentRangeFormattingEditProvider(MUMPS_MODE, {\r\n\t\t\tprovideDocumentRangeFormattingEdits: (document, range, options, token) => {\r\n\t\t\t\tlet textEdits: vscode.TextEdit[] = []\r\n\t\t\t\tfor (let i = range.start.line; i <= range.end.line; i++) {\r\n\t\t\t\t\tlet line = document.lineAt(i).text;\r\n\t\t\t\t\tformatDocumentLine(line, i, textEdits);\r\n\t\t\t\t}\r\n\t\t\t\treturn textEdits;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tvscode.debug.registerDebugConfigurationProvider('mumps', new MumpsConfigurationProvider()),\r\n\t\tvscode.debug.registerDebugAdapterDescriptorFactory('mumps', new InlineDebugAdapterFactory()),\r\n\t\tvscode.window.onDidChangeActiveTextEditor(editor => { if (editor) { triggerUpdateDiagnostics(editor.document, mumpsDiagnostics) } }),\r\n\t\tvscode.workspace.onDidChangeTextDocument(editor => { if (editor) { triggerUpdateDiagnostics(editor.document, mumpsDiagnostics) } })\r\n\t);\r\n\tvscode.languages.registerEvaluatableExpressionProvider(MUMPS_MODE, {\r\n\t\tprovideEvaluatableExpression(document: vscode.TextDocument, position: vscode.Position): vscode.ProviderResult<vscode.EvaluatableExpression> {\r\n\t\t\tconst diags: readonly vscode.Diagnostic[] | undefined = mumpsDiagnostics.get(document.uri);\r\n\t\t\t//If Position is inside Error-marked Area then no Check for Variables is performed\r\n\t\t\tif (diags) {\r\n\t\t\t\tconst found = diags.find(diag => diag.range.contains(position))\r\n\t\t\t\tif (found) {\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst lineContent = document.lineAt(position.line).text;\r\n\t\t\tlet expression = /([ (,+\\-\\*_:=])(\\^?%?[a-zA-Z][a-zA-Z\\d]*(\\(.[^\\)]+\\))?)/g;\r\n\t\t\tif (lineContent.substring(position.character, position.character + 1) !== \")\") {\r\n\t\t\t\texpression = /([ (,+\\-\\*_:=])(\\^?%?[a-zA-Z][a-zA-Z\\d]*)/g;\r\n\t\t\t}\r\n\t\t\tlet result: RegExpExecArray | null = null;\r\n\r\n\t\t\t// find the word under the cursor\r\n\t\t\twhile (result = expression.exec(lineContent)) {\r\n\t\t\t\tlet start = result.index;\r\n\t\t\t\tstart += result[0].length - result[2].length; // ignore first part of expression\r\n\t\t\t\tlet end = start + result[2].length - 1;\r\n\r\n\t\t\t\tif (start <= position.character && end >= position.character) {\r\n\t\t\t\t\treturn new vscode.EvaluatableExpression(new vscode.Range(position.line, start, position.line, end), result[2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\t\t\t//\tconst wordRange = document.getWordRangeAtPosition(position);\r\n\t\t\t//return wordRange ? new vscode.EvaluatableExpression(wordRange) : undefined;\r\n\t\t}\r\n\t});\r\n}\r\n\r\nexport function deactivate() {\r\n\t// nothing to do\r\n}\r\n\r\nclass MumpsConfigurationProvider implements vscode.DebugConfigurationProvider {\r\n\r\n\t/**\r\n\t * Massage a debug configuration just before a debug session is being launched,\r\n\t * e.g. add all missing attributes to the debug configuration.\r\n\t*/\r\n\tresolveDebugConfiguration(folder: WorkspaceFolder | undefined, config: DebugConfiguration, token?: CancellationToken): ProviderResult<DebugConfiguration> {\r\n\r\n\t\t// if launch.json is missing or empty\r\n\t\tif (!config.type && !config.request && !config.name) {\r\n\t\t\tconst editor = vscode.window.activeTextEditor;\r\n\t\t\tif (editor && editor.document.languageId === 'mumps') {\r\n\t\t\t\tconfig.type = 'mumps';\r\n\t\t\t\tconfig.name = 'Launch';\r\n\t\t\t\tconfig.request = 'launch';\r\n\t\t\t\tconfig.program = '${file}';\r\n\t\t\t\tconfig.stopOnEntry = true;\r\n\t\t\t\tconfig.hostname = '127.0.0.1';\r\n\t\t\t\tconfig.localRoutinesPath = 'y:\\\\',\r\n\t\t\t\t\tconfig.port = 9000\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!config.program) {\r\n\t\t\treturn vscode.window.showInformationMessage(\"Cannot find a program to debug\").then(_ => {\r\n\t\t\t\treturn undefined;\t// abort launch\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn config;\r\n\t}\r\n}\r\nclass InlineDebugAdapterFactory implements vscode.DebugAdapterDescriptorFactory {\r\n\r\n\tcreateDebugAdapterDescriptor(_session: vscode.DebugSession): ProviderResult<vscode.DebugAdapterDescriptor> {\r\n\t\treturn new vscode.DebugAdapterInlineImplementation(new MumpsDebugSession());\r\n\t}\r\n}\r\nfunction formatDocumentLine(line: string, lineNumber, textEdits) {\r\n\tlet emptyLine = line.replace(/(\\ |\\t)/ig, \"\");\r\n\tif (emptyLine.length === 0) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, 0), \"\\t;\"))\r\n\t}\r\n\tif (line.endsWith(\". \")) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, line.length), \";\"))\r\n\t} else if (line.endsWith(\".\")) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, line.length), \" ;\"))\r\n\t}\r\n\tif (line.startsWith(\" \")) {\r\n\t\tlet endSpace: number;\r\n\t\t//console.log(\"start\")\r\n\t\tfor (endSpace = 0; endSpace < line.length; endSpace++) {\r\n\t\t\tif (line.charAt(endSpace) !== \" \") {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttextEdits.push(vscode.TextEdit.replace(new vscode.Range(new vscode.Position(lineNumber, 0), new vscode.Position(lineNumber, endSpace)), \"\\t\"));\r\n\t}\r\n}\r\nfunction updateDiagnostics(document: vscode.TextDocument, collection: vscode.DiagnosticCollection): void {\r\n\tif (document && document.languageId === 'mumps') {\r\n\t\tcollection.clear();\r\n\t\tlet diags: Array<vscode.Diagnostic> = [];\r\n\t\tfor (let i = 0; i < document.lineCount; i++) {\r\n\t\t\tlet line = document.lineAt(i);\r\n\t\t\tlet diag = parser.checkLine(line.text);\r\n\t\t\tif (diag.text !== '') {\r\n\t\t\t\tdiags.push({\r\n\t\t\t\t\tcode: '',\r\n\t\t\t\t\tmessage: diag.text,\r\n\t\t\t\t\trange: new vscode.Range(new vscode.Position(i, diag.position), new vscode.Position(i, line.text.length)),\r\n\t\t\t\t\tseverity: vscode.DiagnosticSeverity.Error,\r\n\t\t\t\t\tsource: '',\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (diags) {\r\n\t\t\tcollection.set(document.uri, diags);\r\n\t\t}\r\n\t}\r\n}\r\nfunction triggerUpdateDiagnostics(document: vscode.TextDocument, collection: vscode.DiagnosticCollection) {\r\n\tif (timeout) {\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = undefined;\r\n\t}\r\n\ttimeout = setTimeout(() => updateDiagnostics(document, collection), 500);\r\n}\r\n","/*\r\n\tImplementation of DebugProtocol-Server for GT.M, Yottadb by Jens Wulf\r\n\tbased on Mock-Debug by Microsoft Corp.\r\n\tLicense: LGPL\r\n*/\r\n\r\nimport {\r\n\tLogger, logger,\r\n\tLoggingDebugSession,\r\n\tInitializedEvent, TerminatedEvent, StoppedEvent, BreakpointEvent, OutputEvent,\r\n\tThread, StackFrame, Scope, Source, Handles, Breakpoint\r\n} from 'vscode-debugadapter';\r\nimport { DebugProtocol } from 'vscode-debugprotocol';\r\nimport { basename } from 'path';\r\nconst { Subject } = require('await-notify');\r\nimport { MConnect, MumpsBreakpoint } from './mconnect';\r\nimport * as vscode from 'vscode';\r\nimport { readFileSync } from 'fs';\r\nconst MUMPSDIAGNOSTICS = vscode.languages.createDiagnosticCollection(\"mumps\");\r\n/**\r\n * This interface describes the mumps-debug specific launch attributes\r\n * The schema for these attributes lives in the package.json of the mumps-debug extension.\r\n * The interface should always match this schema.\r\n */\r\ninterface LaunchRequestArguments extends DebugProtocol.LaunchRequestArguments {\r\n\t/** An absolute path to the \"program\" to debug. */\r\n\tprogram: string;\r\n\t/** Automatically stop target after launch. If not specified, target does not stop. */\r\n\tstopOnEntry?: boolean;\r\n\t/** enable logging the Debug Adapter Protocol */\r\n\ttrace?: boolean;\r\n\t/** The Port on which MDEBUG listens */\r\n\tport: number;\r\n\t/**The Hostname of the MDEBUG-Server */\r\n\thostname: string;\r\n\t/**Map Local-Routines to Host-Routines */\r\n\tlocalRoutinesPath: string;\r\n\r\n}\r\ninterface VarData {\r\n\tname: string,\r\n\tindexCount: number,\r\n\tbases: Array<string>,\r\n\tcontent: string\r\n}\r\nexport class MumpsDebugSession extends LoggingDebugSession {\r\n\r\n\t// we don't support multiple threads, so we can use a hardcoded ID for the default thread\r\n\tprivate static THREAD_ID = 1;\r\n\t//private _mconnect: MConnect;\r\n\r\n\tprivate _variableHandles = new Handles<string>();\r\n\r\n\tprivate _configurationDone = new Subject();\r\n\r\n\tprivate _program: string;\r\n\r\n\tprivate _mconnect: MConnect;\r\n\t/**\r\n\t * Creates a new debug adapter that is used for one debug session.\r\n\t * We configure the default implementation of a debug adapter here.\r\n\t */\r\n\tpublic constructor() {\r\n\t\tsuper();\r\n\r\n\t\t// this debugger uses zero-based lines and columns\r\n\t\tthis.setDebuggerLinesStartAt1(false);\r\n\t\tthis.setDebuggerColumnsStartAt1(false);\r\n\t\tthis._program = \"\";\r\n\t\tthis._mconnect = new MConnect();\r\n\r\n\t\t// setup event handlers\r\n\t\tthis._mconnect.on('stopOnEntry', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('entry', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnStep', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('step', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnBreakpoint', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('breakpoint', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnDataBreakpoint', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('data breakpoint', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnException', (errortext) => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('exception', MumpsDebugSession.THREAD_ID, errortext));\r\n\t\t});\r\n\t\tthis._mconnect.on('breakpointValidated', (bp: MumpsBreakpoint) => {\r\n\t\t\tthis.sendEvent(new BreakpointEvent('changed', <DebugProtocol.Breakpoint>{ verified: bp.verified, id: bp.id }));\r\n\t\t});\r\n\t\tthis._mconnect.on('output', (text, filePath, line, column) => {\r\n\t\t\tconst e: DebugProtocol.OutputEvent = new OutputEvent(`${text}\\n`);\r\n\t\t\te.body.source = this.createSource(filePath);\r\n\t\t\te.body.line = this.convertDebuggerLineToClient(line);\r\n\t\t\te.body.column = this.convertDebuggerColumnToClient(column);\r\n\t\t\tthis.sendEvent(e);\r\n\t\t});\r\n\t\tthis._mconnect.on('end', () => {\r\n\t\t\tthis.sendEvent(new TerminatedEvent());\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * The 'initialize' request is the first request called by the frontend\r\n\t * to interrogate the features the debug adapter provides.\r\n\t */\r\n\tprotected initializeRequest(response: DebugProtocol.InitializeResponse, args: DebugProtocol.InitializeRequestArguments): void {\r\n\r\n\t\t// build and return the capabilities of this debug adapter:\r\n\t\tresponse.body = response.body || {};\r\n\r\n\t\t// the adapter implements the configurationDoneRequest.\r\n\t\tresponse.body.supportsConfigurationDoneRequest = true;\r\n\r\n\t\t// make VS Code to use 'evaluate' when hovering over source\r\n\t\tresponse.body.supportsEvaluateForHovers = true;\r\n\r\n\t\t// make VS Code to support data breakpoints\r\n\t\tresponse.body.supportsDataBreakpoints = false;\r\n\r\n\t\t// make VS Code to support completion in REPL\r\n\t\tresponse.body.supportsCompletionsRequest = false;\r\n\t\tresponse.body.completionTriggerCharacters = [\".\", \"[\"];\r\n\r\n\t\t// make VS Code to send cancelRequests\r\n\t\tresponse.body.supportsCancelRequest = false;\r\n\r\n\t\t// make VS Code send the breakpointLocations request\r\n\t\tresponse.body.supportsBreakpointLocationsRequest = true;\r\n\t\tresponse.body.supportsExceptionInfoRequest = true;\r\n\t\tresponse.body.supportsRestartRequest = true;\r\n\r\n\r\n\t\t// since this debug adapter can accept configuration requests like 'setBreakpoint' at any time,\r\n\t\t// we request them early by sending an 'initializeRequest' to the frontend.\r\n\t\t// The frontend will end the configuration sequence by calling 'configurationDone' request.\r\n\t\tthis.sendResponse(response);\r\n\t\tthis.sendEvent(new InitializedEvent());\r\n\t}\r\n\r\n\t/**\r\n\t * Called at the end of the configuration sequence.\r\n\t * Indicates that all breakpoints etc. have been sent to the DA and that the 'launch' can start.\r\n\t */\r\n\tprotected configurationDoneRequest(response: DebugProtocol.ConfigurationDoneResponse, args: DebugProtocol.ConfigurationDoneArguments): void {\r\n\t\tsuper.configurationDoneRequest(response, args);\r\n\r\n\t\t// notify the launchRequest that configuration has finished\r\n\r\n\t\tthis._configurationDone.notify();\r\n\t}\r\n\r\n\tprotected async launchRequest(response: DebugProtocol.LaunchResponse, args: LaunchRequestArguments) {\r\n\r\n\t\t// make sure to 'Stop' the buffered logging if 'trace' is not set\r\n\t\tlogger.setup(args.trace ? Logger.LogLevel.Verbose : Logger.LogLevel.Stop, false);\r\n\r\n\t\t// wait until configuration has finished (and configurationDoneRequest has been called)\r\n\t\tawait this._configurationDone.wait(1000);\r\n\r\n\t\t// start the program in the runtime\r\n\t\tthis._mconnect.init(args.hostname, args.port, args.localRoutinesPath).then(async () => {\r\n\t\t\tthis.refreshDiagnostics(vscode.window.activeTextEditor!.document, MUMPSDIAGNOSTICS);\r\n\t\t\tthis._mconnect.start(args.program, !!args.stopOnEntry);\r\n\t\t\tthis._program = args.program;\r\n\t\t\tthis.sendResponse(response);\r\n\t\t}).catch((error) => {\r\n\t\t\tvscode.window.showErrorMessage(\"Connection to MDEBUG failed. \\nPlease start MDEBUG first.\");\r\n\t\t})\r\n\r\n\t}\r\n\tprotected setBreakPointsRequest(response: DebugProtocol.SetBreakpointsResponse, args: DebugProtocol.SetBreakpointsArguments): void {\r\n\r\n\t\tconst path = <string>args.source.path;\r\n\t\tconst clientLines = args.lines || [];\r\n\r\n\t\tthis._mconnect.clearBreakpoints(path);\r\n\t\t// set and verify breakpoint locations\r\n\t\tconst actualBreakpoints = clientLines.map(l => {\r\n\t\t\tlet { verified, line, id } = this._mconnect.setBreakPoint(path, this.convertClientLineToDebugger(l));\r\n\t\t\tconst bp = <DebugProtocol.Breakpoint>new Breakpoint(verified, this.convertDebuggerLineToClient(line));\r\n\t\t\tbp.id = id;\r\n\t\t\treturn bp;\r\n\t\t});\r\n\t\t// send back the actual breakpoint positions\r\n\t\tresponse.body = {\r\n\t\t\tbreakpoints: actualBreakpoints\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t\tthis._mconnect.requestBreakpoints();\r\n\t}\r\n\r\n\tprotected threadsRequest(response: DebugProtocol.ThreadsResponse): void {\r\n\r\n\t\t// runtime supports no threads so just return a default thread.\r\n\t\tresponse.body = {\r\n\t\t\tthreads: [\r\n\t\t\t\tnew Thread(MumpsDebugSession.THREAD_ID, \"thread 1\")\r\n\t\t\t]\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stackTraceRequest(response: DebugProtocol.StackTraceResponse, args: DebugProtocol.StackTraceArguments): void {\r\n\r\n\t\tconst startFrame = typeof args.startFrame === 'number' ? args.startFrame : 0;\r\n\t\tconst maxLevels = typeof args.levels === 'number' ? args.levels : 1000;\r\n\t\tconst endFrame = startFrame + maxLevels;\r\n\r\n\t\tconst stk = this._mconnect.stack(startFrame, endFrame);\r\n\r\n\t\tresponse.body = {\r\n\t\t\tstackFrames: stk.frames.map(f => new StackFrame(f.index, f.name, this.createSource(f.file), this.convertDebuggerLineToClient(f.line))),\r\n\t\t\ttotalFrames: stk.count\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected scopesRequest(response: DebugProtocol.ScopesResponse, args: DebugProtocol.ScopesArguments): void {\r\n\r\n\t\tresponse.body = {\r\n\t\t\tscopes: [\r\n\t\t\t\tnew Scope(\"Local\", this._variableHandles.create(\"local|0\"), true),\r\n\t\t\t\tnew Scope(\"System\", this._variableHandles.create(\"system\"), false)\r\n\t\t\t]\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected async variablesRequest(response: DebugProtocol.VariablesResponse, args: DebugProtocol.VariablesArguments, request?: DebugProtocol.Request) {\r\n\r\n\t\tconst variables: DebugProtocol.Variable[] = [];\r\n\t\tlet insertVariable: DebugProtocol.Variable | undefined;\r\n\t\tconst varId = this._variableHandles.get(args.variablesReference);\r\n\t\tif (varId === \"system\") {\r\n\t\t\tlet varObject = this._mconnect.getVariables(\"system\");\r\n\t\t\tfor (let varname in varObject) {\r\n\t\t\t\tvariables.push({\r\n\t\t\t\t\tname: varname,\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tvalue: varObject[varname],\r\n\t\t\t\t\tvariablesReference: 0\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst varparts: string[] = varId.split(\"|\");\r\n\t\t\tconst indexCount: number = parseInt(varparts.pop()!);\r\n\t\t\tconst varBase = varparts.join(\"|\");\r\n\t\t\tlet varObject = this._mconnect.getVariables(\"local\");\r\n\t\t\tlet lastVar: VarData;\r\n\t\t\tlet firstTime: boolean = true;\r\n\t\t\tlet lastRef: string = \"\";\r\n\t\t\tfor (let varname in varObject) {\r\n\t\t\t\tlet actualVar = this.varAnalyze(varname, varObject[varname]);\r\n\t\t\t\tif (firstTime) { //First Variable not processed\r\n\t\t\t\t\tlastVar = actualVar;\r\n\t\t\t\t\tfirstTime = false;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (insertVariable = this.checkVars(lastVar!, actualVar, indexCount, varBase, lastRef)) {\r\n\t\t\t\t\tif (insertVariable.variablesReference !== 0) { lastRef = lastVar!.bases[indexCount]; }\r\n\t\t\t\t\tvariables.push(insertVariable);\r\n\t\t\t\t}\r\n\t\t\t\tlastVar = actualVar;\r\n\t\t\t}\r\n\t\t\tif (!firstTime) { // process Last Variable if there was minimum one\r\n\t\t\t\tconst dummyVar: VarData = { name: \"\", \"indexCount\": 0, \"bases\": [], \"content\": \"\" }\r\n\t\t\t\tif (insertVariable = this.checkVars(lastVar!, dummyVar, indexCount, varBase, lastRef)) {\r\n\t\t\t\t\tvariables.push(insertVariable);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tresponse.body = {\r\n\t\t\tvariables: variables\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\t//checkVars checks if Variable has to be inserted in Var-Display and if it has descendants\r\n\tprivate checkVars(lastVar: VarData, actualVar: VarData, indexCount: number, varBase: string, lastRef: string): DebugProtocol.Variable | undefined {\r\n\t\tlet returnVar: DebugProtocol.Variable | undefined = undefined;\r\n\t\tlet actualReference: number = 0;\r\n\t\tif (indexCount === 0 || (lastVar.bases[indexCount - 1] === varBase && lastVar.indexCount > indexCount)) {\r\n\t\t\tif (lastVar.indexCount > indexCount + 1) {\r\n\t\t\t\tif (lastRef !== lastVar.bases[indexCount]) {\r\n\t\t\t\t\tlet name = lastVar.bases[indexCount];\r\n\t\t\t\t\tif (indexCount > 0) { name += \")\"; }\r\n\t\t\t\t\treturnVar = {\r\n\t\t\t\t\t\tname,\r\n\t\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\t\tvalue: 'undefined',\r\n\t\t\t\t\t\tvariablesReference: this._variableHandles.create(lastVar.bases[indexCount] + \"|\" + (indexCount + 1))\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t} else { //lastVar.indexCount==indexCount+1\r\n\t\t\t\tif (lastVar.bases[indexCount] === actualVar.bases[indexCount]) {\r\n\t\t\t\t\tactualReference = this._variableHandles.create(lastVar.bases[indexCount] + \"|\" + (indexCount + 1));\r\n\t\t\t\t}\r\n\t\t\t\treturnVar = {\r\n\t\t\t\t\tname: lastVar.name,\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tvalue: lastVar.content,\r\n\t\t\t\t\tvariablesReference: actualReference\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn returnVar\r\n\t}\r\n\tprotected continueRequest(response: DebugProtocol.ContinueResponse, args: DebugProtocol.ContinueArguments): void {\r\n\t\tthis._mconnect.continue();\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected nextRequest(response: DebugProtocol.NextResponse, args: DebugProtocol.NextArguments): void {\r\n\t\tthis._mconnect.step(\"OVER\");\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stepInRequest(response: DebugProtocol.StepInResponse, args: DebugProtocol.StepInArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.step(\"INTO\");\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stepOutRequest(response: DebugProtocol.StepOutResponse, args: DebugProtocol.StepOutArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.step(\"OUTOF\");\r\n\t}\r\n\r\n\tprotected async evaluateRequest(response: DebugProtocol.EvaluateResponse, args: DebugProtocol.EvaluateArguments) {\r\n\t\tif (args.context === \"hover\" || args.context === \"repl\") {\r\n\t\t\tthis._mconnect.getSingleVar(args.expression).then((varReply: VarData) => {\r\n\t\t\t\tresponse.body = {\r\n\t\t\t\t\tresult: varReply.name + \" := \" + varReply.content,\r\n\t\t\t\t\tvariablesReference: 0\r\n\t\t\t\t};\r\n\t\t\t\tthis.sendResponse(response);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected async restartRequest(args: DebugProtocol.RestartArguments) {\r\n\t\tlet sourceLines = readFileSync(this._program).toString().split('\\n');\r\n\t\tthis._mconnect.checkRoutine(sourceLines).then((errorLines: string[]) => {\r\n\t\t\tif (errorLines.length) {\r\n\t\t\t\tvscode.window.showErrorMessage(\"File contains Problems - No Restart possible!\");\r\n\t\t\t} else {\r\n\t\t\t\tthis._mconnect.restart(this._program);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tprotected disconnectRequest(response: DebugProtocol.DisconnectResponse, args: DebugProtocol.DisconnectArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.disconnect();\r\n\t\tthis.sendResponse(response);\r\n\t};\r\n\tprivate createSource(filePath: string): Source {\r\n\t\treturn new Source(basename(filePath), this.convertDebuggerPathToClient(filePath), undefined, undefined, 'mock-adapter-data');\r\n\t}\r\n\r\n\tprivate varAnalyze(varname: string, content: string): VarData {\r\n\t\tlet indexcount = 1;\r\n\t\tlet bases: string[] = [];\r\n\t\tlet length = varname.length;\r\n\t\tlet klammerpos = varname.indexOf(\"(\");\r\n\t\tlet countKomma = true;\r\n\t\t//let lastKommaPos = varname.length;\r\n\t\tif (klammerpos > 0) {\r\n\t\t\tbases.push(varname.substring(0, klammerpos));\r\n\t\t\tindexcount++;\r\n\t\t\t//lastKommaPos = klammerpos;\r\n\t\t\tfor (let i = klammerpos; i < length; i++) {\r\n\t\t\t\tif (varname.substring(i, i + 1) === \",\" && countKomma) {\r\n\t\t\t\t\tbases.push(varname.substring(0, i));\r\n\t\t\t\t\tindexcount++;\r\n\t\t\t\t\t//lastKommaPos = i;\r\n\t\t\t\t}\r\n\t\t\t\tif (varname.substring(i, i + 1) === '\"') { countKomma = !countKomma; }\r\n\t\t\t}\r\n\t\t\tbases.push(varname.substring(0, varname.length - 1));\r\n\t\t} else {\r\n\t\t\tbases.push(varname);\r\n\t\t}\r\n\t\treturn { \"name\": varname, \"indexCount\": indexcount, \"bases\": bases, content };\r\n\t}\r\n\tprivate refreshDiagnostics(doc: vscode.TextDocument | undefined, mumpsDiagnostics: vscode.DiagnosticCollection): void {\r\n\t\tlet diagnostics: vscode.Diagnostic[] = [];\r\n\t\tif (doc) {\r\n\t\t\tlet lines: string[] = []\r\n\t\t\tfor (let lineIndex = 0; lineIndex < doc.lineCount; lineIndex++) {\r\n\t\t\t\tconst lineOfText = doc.lineAt(lineIndex);\r\n\t\t\t\tlines.push(lineOfText.text);\r\n\t\t\t}\r\n\t\t\tthis._mconnect.checkRoutine(lines).then((errLines: string[]) => {\r\n\t\t\t\tfor (let i = 0; i < errLines.length; i++) {\r\n\t\t\t\t\tlet errData = errLines[i].split(\";\");\r\n\t\t\t\t\tlet column = parseInt(errData[0]) - 1;\r\n\t\t\t\t\tif (isNaN(column)) { column = 0 };\r\n\t\t\t\t\tlet line = parseInt(errData[1]) - 1;\r\n\t\t\t\t\tif (isNaN(line)) { line = 0 };\r\n\t\t\t\t\tlet endColumn = doc.lineAt(line).text.length\r\n\t\t\t\t\tif (line === 0 && column === 0) { endColumn = 0 };\r\n\t\t\t\t\tlet message = errData[2];\r\n\t\t\t\t\tlet range = new vscode.Range(line, column, line, endColumn);\r\n\t\t\t\t\tlet diagnostic = new vscode.Diagnostic(range, message, vscode.DiagnosticSeverity.Error);\r\n\t\t\t\t\tdiagnostic.code = message;\r\n\t\t\t\t\tdiagnostics.push(diagnostic);\r\n\t\t\t\t}\r\n\t\t\t\tmumpsDiagnostics.clear();\r\n\t\t\t\tmumpsDiagnostics.set(doc.uri, diagnostics);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst debugSession_1 = require(\"./debugSession\");\nexports.DebugSession = debugSession_1.DebugSession;\nexports.InitializedEvent = debugSession_1.InitializedEvent;\nexports.TerminatedEvent = debugSession_1.TerminatedEvent;\nexports.StoppedEvent = debugSession_1.StoppedEvent;\nexports.ContinuedEvent = debugSession_1.ContinuedEvent;\nexports.OutputEvent = debugSession_1.OutputEvent;\nexports.ThreadEvent = debugSession_1.ThreadEvent;\nexports.BreakpointEvent = debugSession_1.BreakpointEvent;\nexports.ModuleEvent = debugSession_1.ModuleEvent;\nexports.LoadedSourceEvent = debugSession_1.LoadedSourceEvent;\nexports.CapabilitiesEvent = debugSession_1.CapabilitiesEvent;\nexports.Thread = debugSession_1.Thread;\nexports.StackFrame = debugSession_1.StackFrame;\nexports.Scope = debugSession_1.Scope;\nexports.Variable = debugSession_1.Variable;\nexports.Breakpoint = debugSession_1.Breakpoint;\nexports.Source = debugSession_1.Source;\nexports.Module = debugSession_1.Module;\nexports.CompletionItem = debugSession_1.CompletionItem;\nexports.ErrorDestination = debugSession_1.ErrorDestination;\nconst loggingDebugSession_1 = require(\"./loggingDebugSession\");\nexports.LoggingDebugSession = loggingDebugSession_1.LoggingDebugSession;\nconst Logger = require(\"./logger\");\nexports.Logger = Logger;\nconst messages_1 = require(\"./messages\");\nexports.Event = messages_1.Event;\nexports.Response = messages_1.Response;\nconst handles_1 = require(\"./handles\");\nexports.Handles = handles_1.Handles;\nconst logger = Logger.logger;\nexports.logger = logger;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Z0dBR2dHO0FBQ2hHLFlBQVksQ0FBQzs7QUFFYixpREFNd0I7QUFTdkIsdUJBZEEsMkJBQVksQ0FjQTtBQUlaLDJCQWpCQSwrQkFBZ0IsQ0FpQkE7QUFBRSwwQkFqQkEsOEJBQWUsQ0FpQkE7QUFBRSx1QkFqQkEsMkJBQVksQ0FpQkE7QUFBRSx5QkFqQkEsNkJBQWMsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSwwQkFqQkEsOEJBQWUsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSw0QkFqQkEsZ0NBQWlCLENBaUJBO0FBQUUsNEJBakJBLGdDQUFpQixDQWlCQTtBQUM3SixpQkFqQkEscUJBQU0sQ0FpQkE7QUFBRSxxQkFqQkEseUJBQVUsQ0FpQkE7QUFBRSxnQkFqQkEsb0JBQUssQ0FpQkE7QUFBRSxtQkFqQkEsdUJBQVEsQ0FpQkE7QUFDbkMscUJBakJBLHlCQUFVLENBaUJBO0FBQUUsaUJBakJBLHFCQUFNLENBaUJBO0FBQUUsaUJBakJBLHFCQUFNLENBaUJBO0FBQUUseUJBakJBLDZCQUFjLENBaUJBO0FBQzFDLDJCQWpCQSwrQkFBZ0IsQ0FpQkE7QUFmakIsK0RBQTBEO0FBU3pELDhCQVRPLHlDQUFtQixDQVNQO0FBUnBCLG1DQUFtQztBQVNsQyx3QkFBTTtBQVJQLHlDQUE2QztBQWM1QyxnQkFkUSxnQkFBSyxDQWNSO0FBQUUsbUJBZFEsbUJBQVEsQ0FjUjtBQWJoQix1Q0FBb0M7QUFjbkMsa0JBZFEsaUJBQU8sQ0FjUjtBQVpSLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFNNUIsd0JBQU0iLCJzb3VyY2VzQ29udGVudCI6WyIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB7XG5cdERlYnVnU2Vzc2lvbixcblx0SW5pdGlhbGl6ZWRFdmVudCwgVGVybWluYXRlZEV2ZW50LCBTdG9wcGVkRXZlbnQsIENvbnRpbnVlZEV2ZW50LCBPdXRwdXRFdmVudCwgVGhyZWFkRXZlbnQsIEJyZWFrcG9pbnRFdmVudCwgTW9kdWxlRXZlbnQsIExvYWRlZFNvdXJjZUV2ZW50LCBDYXBhYmlsaXRpZXNFdmVudCxcblx0VGhyZWFkLCBTdGFja0ZyYW1lLCBTY29wZSwgVmFyaWFibGUsXG5cdEJyZWFrcG9pbnQsIFNvdXJjZSwgTW9kdWxlLCBDb21wbGV0aW9uSXRlbSxcblx0RXJyb3JEZXN0aW5hdGlvblxufSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5pbXBvcnQge0xvZ2dpbmdEZWJ1Z1Nlc3Npb259IGZyb20gJy4vbG9nZ2luZ0RlYnVnU2Vzc2lvbic7XG5pbXBvcnQgKiBhcyBMb2dnZXIgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgRXZlbnQsIFJlc3BvbnNlIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBIYW5kbGVzIH0gZnJvbSAnLi9oYW5kbGVzJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmxvZ2dlcjtcblxuZXhwb3J0IHtcblx0RGVidWdTZXNzaW9uLFxuXHRMb2dnaW5nRGVidWdTZXNzaW9uLFxuXHRMb2dnZXIsXG5cdGxvZ2dlcixcblx0SW5pdGlhbGl6ZWRFdmVudCwgVGVybWluYXRlZEV2ZW50LCBTdG9wcGVkRXZlbnQsIENvbnRpbnVlZEV2ZW50LCBPdXRwdXRFdmVudCwgVGhyZWFkRXZlbnQsIEJyZWFrcG9pbnRFdmVudCwgTW9kdWxlRXZlbnQsIExvYWRlZFNvdXJjZUV2ZW50LCBDYXBhYmlsaXRpZXNFdmVudCxcblx0VGhyZWFkLCBTdGFja0ZyYW1lLCBTY29wZSwgVmFyaWFibGUsXG5cdEJyZWFrcG9pbnQsIFNvdXJjZSwgTW9kdWxlLCBDb21wbGV0aW9uSXRlbSxcblx0RXJyb3JEZXN0aW5hdGlvbixcblx0RXZlbnQsIFJlc3BvbnNlLFxuXHRIYW5kbGVzXG59XG4iXX0=","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ee = require(\"events\");\nconst messages_1 = require(\"./messages\");\nclass Disposable0 {\n    dispose() {\n    }\n}\nclass Emitter {\n    get event() {\n        if (!this._event) {\n            this._event = (listener, thisArg) => {\n                this._listener = listener;\n                this._this = thisArg;\n                let result;\n                result = {\n                    dispose: () => {\n                        this._listener = undefined;\n                        this._this = undefined;\n                    }\n                };\n                return result;\n            };\n        }\n        return this._event;\n    }\n    fire(event) {\n        if (this._listener) {\n            try {\n                this._listener.call(this._this, event);\n            }\n            catch (e) {\n            }\n        }\n    }\n    hasListener() {\n        return !!this._listener;\n    }\n    dispose() {\n        this._listener = undefined;\n        this._this = undefined;\n    }\n}\nclass ProtocolServer extends ee.EventEmitter {\n    constructor() {\n        super();\n        this._sendMessage = new Emitter();\n        this._pendingRequests = new Map();\n        this.onDidSendMessage = this._sendMessage.event;\n    }\n    // ---- implements vscode.Debugadapter interface ---------------------------\n    dispose() {\n    }\n    handleMessage(msg) {\n        if (msg.type === 'request') {\n            this.dispatchRequest(msg);\n        }\n        else if (msg.type === 'response') {\n            const response = msg;\n            const clb = this._pendingRequests.get(response.request_seq);\n            if (clb) {\n                this._pendingRequests.delete(response.request_seq);\n                clb(response);\n            }\n        }\n    }\n    _isRunningInline() {\n        return this._sendMessage && this._sendMessage.hasListener();\n    }\n    //--------------------------------------------------------------------------\n    start(inStream, outStream) {\n        this._sequence = 1;\n        this._writableStream = outStream;\n        this._rawData = new Buffer(0);\n        inStream.on('data', (data) => this._handleData(data));\n        inStream.on('close', () => {\n            this._emitEvent(new messages_1.Event('close'));\n        });\n        inStream.on('error', (error) => {\n            this._emitEvent(new messages_1.Event('error', 'inStream error: ' + (error && error.message)));\n        });\n        outStream.on('error', (error) => {\n            this._emitEvent(new messages_1.Event('error', 'outStream error: ' + (error && error.message)));\n        });\n        inStream.resume();\n    }\n    stop() {\n        if (this._writableStream) {\n            this._writableStream.end();\n        }\n    }\n    sendEvent(event) {\n        this._send('event', event);\n    }\n    sendResponse(response) {\n        if (response.seq > 0) {\n            console.error(`attempt to send more than one response for command ${response.command}`);\n        }\n        else {\n            this._send('response', response);\n        }\n    }\n    sendRequest(command, args, timeout, cb) {\n        const request = {\n            command: command\n        };\n        if (args && Object.keys(args).length > 0) {\n            request.arguments = args;\n        }\n        if (!this._writableStream) {\n            this._emitEvent(new messages_1.Event('error', 'sendRequest: No writableStream'));\n            return;\n        }\n        this._send('request', request);\n        if (cb) {\n            this._pendingRequests.set(request.seq, cb);\n            const timer = setTimeout(() => {\n                clearTimeout(timer);\n                const clb = this._pendingRequests.get(request.seq);\n                if (clb) {\n                    this._pendingRequests.delete(request.seq);\n                    clb(new messages_1.Response(request, 'timeout'));\n                }\n            }, timeout);\n        }\n    }\n    // ---- protected ----------------------------------------------------------\n    dispatchRequest(request) {\n    }\n    // ---- private ------------------------------------------------------------\n    _emitEvent(event) {\n        this.emit(event.event, event);\n    }\n    _send(typ, message) {\n        message.type = typ;\n        message.seq = this._sequence++;\n        if (this._writableStream) {\n            const json = JSON.stringify(message);\n            this._writableStream.write(`Content-Length: ${Buffer.byteLength(json, 'utf8')}\\r\\n\\r\\n${json}`, 'utf8');\n        }\n        this._sendMessage.fire(message);\n    }\n    _handleData(data) {\n        this._rawData = Buffer.concat([this._rawData, data]);\n        while (true) {\n            if (this._contentLength >= 0) {\n                if (this._rawData.length >= this._contentLength) {\n                    const message = this._rawData.toString('utf8', 0, this._contentLength);\n                    this._rawData = this._rawData.slice(this._contentLength);\n                    this._contentLength = -1;\n                    if (message.length > 0) {\n                        try {\n                            let msg = JSON.parse(message);\n                            this.handleMessage(msg);\n                        }\n                        catch (e) {\n                            this._emitEvent(new messages_1.Event('error', 'Error handling data: ' + (e && e.message)));\n                        }\n                    }\n                    continue; // there may be more complete messages to process\n                }\n            }\n            else {\n                const idx = this._rawData.indexOf(ProtocolServer.TWO_CRLF);\n                if (idx !== -1) {\n                    const header = this._rawData.toString('utf8', 0, idx);\n                    const lines = header.split('\\r\\n');\n                    for (let i = 0; i < lines.length; i++) {\n                        const pair = lines[i].split(/: +/);\n                        if (pair[0] == 'Content-Length') {\n                            this._contentLength = +pair[1];\n                        }\n                    }\n                    this._rawData = this._rawData.slice(idx + ProtocolServer.TWO_CRLF.length);\n                    continue;\n                }\n            }\n            break;\n        }\n    }\n}\nProtocolServer.TWO_CRLF = '\\r\\n\\r\\n';\nexports.ProtocolServer = ProtocolServer;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdG9jb2wuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcHJvdG9jb2wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Z0dBR2dHOztBQUVoRyw2QkFBNkI7QUFFN0IseUNBQTZDO0FBUzdDLE1BQU0sV0FBVztJQUNoQixPQUFPO0lBQ1AsQ0FBQztDQUNEO0FBTUQsTUFBTSxPQUFPO0lBTVosSUFBSSxLQUFLO1FBQ1IsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDakIsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLFFBQXVCLEVBQUUsT0FBYSxFQUFFLEVBQUU7Z0JBRXhELElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDO2dCQUMxQixJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztnQkFFckIsSUFBSSxNQUFtQixDQUFDO2dCQUN4QixNQUFNLEdBQUc7b0JBQ1IsT0FBTyxFQUFFLEdBQUcsRUFBRTt3QkFDYixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQzt3QkFDM0IsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7b0JBQ3hCLENBQUM7aUJBQ0QsQ0FBQztnQkFDRixPQUFPLE1BQU0sQ0FBQztZQUNmLENBQUMsQ0FBQztTQUNGO1FBQ0QsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3BCLENBQUM7SUFFRCxJQUFJLENBQUMsS0FBUTtRQUNaLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNuQixJQUFJO2dCQUNILElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDdkM7WUFBQyxPQUFPLENBQUMsRUFBRTthQUNYO1NBQ0Q7SUFDRixDQUFDO0lBRUQsV0FBVztRQUNWLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDekIsQ0FBQztJQUVELE9BQU87UUFDTixJQUFJLENBQUMsU0FBUyxH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QyxFQUFFLEVBQUU7d0JBQ3RDLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQ25DLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLGdCQUFnQixFQUFFOzRCQUNoQyxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO3lCQUMvQjtxQkFDRDtvQkFDRCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxjQUFjLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO29CQUMxRSxTQUFTO2lCQUNUO2FBQ0Q7WUFDRCxNQUFNO1NBQ047SUFDRixDQUFDOztBQTFLYyx1QkFBUSxHQUFHLFVBQVUsQ0FBQztBQUZ0Qyx3Q0E2S0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0ICogYXMgZWUgZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7IERlYnVnUHJvdG9jb2wgfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5pbXBvcnQgeyBSZXNwb25zZSwgRXZlbnQgfSBmcm9tICcuL21lc3NhZ2VzJztcblxuaW50ZXJmYWNlIERlYnVnUHJvdG9jb2xNZXNzYWdlIHtcbn1cblxuaW50ZXJmYWNlIElEaXNwb3NhYmxlIHtcblx0ZGlzcG9zZSgpOiB2b2lkO1xufVxuXG5jbGFzcyBEaXNwb3NhYmxlMCBpbXBsZW1lbnRzIElEaXNwb3NhYmxlIHtcblx0ZGlzcG9zZSgpOiBhbnkge1xuXHR9XG59XG5cbmludGVyZmFjZSBFdmVudDA8VD4ge1xuXHQobGlzdGVuZXI6IChlOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpOiBEaXNwb3NhYmxlMDtcbn1cblxuY2xhc3MgRW1pdHRlcjxUPiB7XG5cblx0cHJpdmF0ZSBfZXZlbnQ/OiBFdmVudDA8VD47XG5cdHByaXZhdGUgX2xpc3RlbmVyPzogKGU6IFQpID0+IHZvaWQ7XG5cdHByaXZhdGUgX3RoaXM/OiBhbnk7XG5cblx0Z2V0IGV2ZW50KCk6IEV2ZW50MDxUPiB7XG5cdFx0aWYgKCF0aGlzLl9ldmVudCkge1xuXHRcdFx0dGhpcy5fZXZlbnQgPSAobGlzdGVuZXI6IChlOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpID0+IHtcblxuXHRcdFx0XHR0aGlzLl9saXN0ZW5lciA9IGxpc3RlbmVyO1xuXHRcdFx0XHR0aGlzLl90aGlzID0gdGhpc0FyZztcblxuXHRcdFx0XHRsZXQgcmVzdWx0OiBJRGlzcG9zYWJsZTtcblx0XHRcdFx0cmVzdWx0ID0ge1xuXHRcdFx0XHRcdGRpc3Bvc2U6ICgpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMuX2xpc3RlbmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0dGhpcy5fdGhpcyA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5fZXZlbnQ7XG5cdH1cblxuXHRmaXJlKGV2ZW50OiBUKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuX2xpc3RlbmVyKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR0aGlzLl9saXN0ZW5lci5jYWxsKHRoaXMuX3RoaXMsIGV2ZW50KTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRoYXNMaXN0ZW5lcigpIDogYm9vbGVhbiB7XG5cdFx0cmV0dXJuICEhdGhpcy5fbGlzdGVuZXI7XG5cdH1cblxuXHRkaXNwb3NlKCkge1xuXHRcdHRoaXMuX2xpc3RlbmVyID0gdW5kZWZpbmVkO1xuXHRcdHRoaXMuX3RoaXMgPSB1bmRlZmluZWQ7XG5cdH1cbn1cblxuLyoqXG4gKiBBIHN0cnVjdHVyYWxseSBlcXVpdmFsZW50IGNvcHkgb2YgdnNjb2RlLkRlYnVnQWRhcHRlclxuICovXG5pbnRlcmZhY2UgVlNDb2RlRGVidWdBZGFwdGVyIGV4dGVuZHMgRGlzcG9zYWJsZTAge1xuXG5cdHJlYWRvbmx5IG9uRGlkU2VuZE1lc3NhZ2U6IEV2ZW50MDxEZWJ1Z1Byb3RvY29sTWVzc2FnZT47XG5cblx0aGFuZGxlTWVzc2FnZShtZXNzYWdlOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBQcm90b2NvbFNlcnZlciBleHRlbmRzIGVlLkV2ZW50RW1pdHRlciBpbXBsZW1lbnRzIFZTQ29kZURlYnVnQWRhcHRlciB7XG5cblx0cHJpdmF0ZSBzdGF0aWMgVFdPX0NSTEYgPSAnXFxyXFxuXFxyXFxuJztcblxuXHRwcml2YXRlIF9zZW5kTWVzc2FnZSA9IG5ldyBFbWl0dGVyPERlYnVnUHJvdG9jb2xNZXNzYWdlPigpO1xuXG5cdHByaXZhdGUgX3Jhd0RhdGE6IEJ1ZmZlcjtcblx0cHJpdmF0ZSBfY29udGVudExlbmd0aDogbnVtYmVyO1xuXHRwcml2YXRlIF9zZXF1ZW5jZTogbnVtYmVyO1xuXHRwcml2YXRlIF93cml0YWJsZVN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtO1xuXHRwcml2YXRlIF9wZW5kaW5nUmVxdWVzdHMgPSBuZXcgTWFwPG51bWJlciwgKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlKSA9PiB2b2lkPigpO1xuXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHQvLyAtLS0tIGltcGxlbWVudHMgdnNjb2RlLkRlYnVnYWRhcHRlciBpbnRlcmZhY2UgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHVibGljIGRpc3Bvc2UoKTogYW55IHtcblx0fVxuXG5cdHB1YmxpYyBvbkRpZFNlbmRNZXNzYWdlOiBFdmVudDA8RGVidWdQcm90b2NvbE1lc3NhZ2U+ID0gdGhpcy5fc2VuZE1lc3NhZ2UuZXZlbnQ7XG5cblx0cHVibGljIGhhbmRsZU1lc3NhZ2UobXNnOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSk6IHZvaWQge1xuXHRcdGlmIChtc2cudHlwZSA9PT0gJ3JlcXVlc3QnKSB7XG5cdFx0XHR0aGlzLmRpc3BhdGNoUmVxdWVzdCg8RGVidWdQcm90b2NvbC5SZXF1ZXN0Pm1zZyk7XG5cdFx0fSBlbHNlIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJykge1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSA8RGVidWdQcm90b2NvbC5SZXNwb25zZT5tc2c7XG5cdFx0XHRjb25zdCBjbGIgPSB0aGlzLl9wZW5kaW5nUmVxdWVzdHMuZ2V0KHJlc3BvbnNlLnJlcXVlc3Rfc2VxKTtcblx0XHRcdGlmIChjbGIpIHtcblx0XHRcdFx0dGhpcy5fcGVuZGluZ1JlcXVlc3RzLmRlbGV0ZShyZXNwb25zZS5yZXF1ZXN0X3NlcSk7XG5cdFx0XHRcdGNsYihyZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJvdGVjdGVkIF9pc1J1bm5pbmdJbmxpbmUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlbmRNZXNzYWdlICYmIHRoaXMuX3NlbmRNZXNzYWdlLmhhc0xpc3RlbmVyKCk7XG5cdH1cblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHVibGljIHN0YXJ0KGluU3RyZWFtOiBOb2RlSlMuUmVhZGFibGVTdHJlYW0sIG91dFN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKTogdm9pZCB7XG5cdFx0dGhpcy5fc2VxdWVuY2UgPSAxO1xuXHRcdHRoaXMuX3dyaXRhYmxlU3RyZWFtID0gb3V0U3RyZWFtO1xuXHRcdHRoaXMuX3Jhd0RhdGEgPSBuZXcgQnVmZmVyKDApO1xuXG5cdFx0aW5TdHJlYW0ub24oJ2RhdGEnLCAoZGF0YTogQnVmZmVyKSA9PiB0aGlzLl9oYW5kbGVEYXRhKGRhdGEpKTtcblxuXHRcdGluU3RyZWFtLm9uKCdjbG9zZScsICgpID0+IHtcblx0XHRcdHRoaXMuX2VtaXRFdmVudChuZXcgRXZlbnQoJ2Nsb3NlJykpO1xuXHRcdH0pO1xuXHRcdGluU3RyZWFtLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuXHRcdFx0dGhpcy5fZW1pdEV2ZW50KG5ldyBFdmVudCgnZXJyb3InLCAnaW5TdHJlYW0gZXJyb3I6ICcgKyAoZXJyb3IgJiYgZXJyb3IubWVzc2FnZSkpKTtcblx0XHR9KTtcblxuXHRcdG91dFN0cmVhbS5vbignZXJyb3InLCAoZXJyb3IpID0+IHtcblx0XHRcdHRoaXMuX2VtaXRFdmVudChuZXcgRXZlbnQoJ2Vycm9yJywgJ291dFN0cmVhbSBlcnJvcjogJyArIChlcnJvciAmJiBlcnJvci5tZXNzYWdlKSkpO1xuXHRcdH0pO1xuXG5cdFx0aW5TdHJlYW0ucmVzdW1lKCk7XG5cdH1cblxuXHRwdWJsaWMgc3RvcCgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5fd3JpdGFibGVTdHJlYW0pIHtcblx0XHRcdHRoaXMuX3dyaXRhYmxlU3RyZWFtLmVuZCgpO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBzZW5kRXZlbnQoZXZlbnQ6IERlYnVnUHJvdG9jb2wuRXZlbnQpOiB2b2lkIHtcblx0XHR0aGlzLl9zZW5kKCdldmVudCcsIGV2ZW50KTtcblx0fVxuXG5cdHB1YmxpYyBzZW5kUmVzcG9uc2UocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzcG9uc2UpOiB2b2lkIHtcblx0XHRpZiAocmVzcG9uc2Uuc2VxID4gMCkge1xuXHRcdFx0Y29uc29sZS5lcnJvcihgYXR0ZW1wdCB0byBzZW5kIG1vcmUgdGhhbiBvbmUgcmVzcG9uc2UgZm9yIGNvbW1hbmQgJHtyZXNwb25zZS5jb21tYW5kfWApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zZW5kKCdyZXNwb25zZScsIHJlc3BvbnNlKTtcblx0XHR9XG5cdH1cblxuXHRwdWJsaWMgc2VuZFJlcXVlc3QoY29tbWFuZDogc3RyaW5nLCBhcmdzOiBhbnksIHRpbWVvdXQ6IG51bWJlciwgY2I6IChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXNwb25zZSkgPT4gdm9pZCkgOiB2b2lkIHtcblxuXHRcdGNvbnN0IHJlcXVlc3Q6IGFueSA9IHtcblx0XHRcdGNvbW1hbmQ6IGNvbW1hbmRcblx0XHR9O1xuXHRcdGlmIChhcmdzICYmIE9iamVjdC5rZXlzKGFyZ3MpLmxlbmd0aCA+IDApIHtcblx0XHRcdHJlcXVlc3QuYXJndW1lbnRzID0gYXJncztcblx0XHR9XG5cblx0XHRpZiAoIXRoaXMuX3dyaXRhYmxlU3RyZWFtKSB7XG5cdFx0XHR0aGlzLl9lbWl0RXZlbnQobmV3IEV2ZW50KCdlcnJvcicsICdzZW5kUmVxdWVzdDogTm8gd3JpdGFibGVTdHJlYW0nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5fc2VuZCgncmVxdWVzdCcsIHJlcXVlc3QpO1xuXG5cdFx0aWYgKGNiKSB7XG5cdFx0XHR0aGlzLl9wZW5kaW5nUmVxdWVzdHMuc2V0KHJlcXVlc3Quc2VxLCBjYik7XG5cblx0XHRcdGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdGNvbnN0IGNsYiA9IHRoaXMuX3BlbmRpbmdSZXF1ZXN0cy5nZXQocmVxdWVzdC5zZXEpO1xuXHRcdFx0XHRpZiAoY2xiKSB7XG5cdFx0XHRcdFx0dGhpcy5fcGVuZGluZ1JlcXVlc3RzLmRlbGV0ZShyZXF1ZXN0LnNlcSk7XG5cdFx0XHRcdFx0Y2xiKG5ldyBSZXNwb25zZShyZXF1ZXN0LCAndGltZW91dCcpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgdGltZW91dCk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gLS0tLSBwcm90ZWN0ZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHByb3RlY3RlZCBkaXNwYXRjaFJlcXVlc3QocmVxdWVzdDogRGVidWdQcm90b2NvbC5SZXF1ZXN0KTogdm9pZCB7XG5cdH1cblxuXHQvLyAtLS0tIHByaXZhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHJpdmF0ZSBfZW1pdEV2ZW50KGV2ZW50OiBEZWJ1Z1Byb3RvY29sLkV2ZW50KSB7XG5cdFx0dGhpcy5lbWl0KGV2ZW50LmV2ZW50LCBldmVudCk7XG5cdH1cblxuXHRwcml2YXRlIF9zZW5kKHR5cDogJ3JlcXVlc3QnIHwgJ3Jlc3BvbnNlJyB8ICdldmVudCcsIG1lc3NhZ2U6IERlYnVnUHJvdG9jb2wuUHJvdG9jb2xNZXNzYWdlKTogdm9pZCB7XG5cblx0XHRtZXNzYWdlLnR5cGUgPSB0eXA7XG5cdFx0bWVzc2FnZS5zZXEgPSB0aGlzLl9zZXF1ZW5jZSsrO1xuXG5cdFx0aWYgKHRoaXMuX3dyaXRhYmxlU3RyZWFtKSB7XG5cdFx0XHRjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG5cdFx0XHR0aGlzLl93cml0YWJsZVN0cmVhbS53cml0ZShgQ29udGVudC1MZW5ndGg6ICR7QnVmZmVyLmJ5dGVMZW5ndGgoanNvbiwgJ3V0ZjgnKX1cXHJcXG5cXHJcXG4ke2pzb259YCwgJ3V0ZjgnKTtcblx0XHR9XG5cdFx0dGhpcy5fc2VuZE1lc3NhZ2UuZmlyZShtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgX2hhbmRsZURhdGEoZGF0YTogQnVmZmVyKTogdm9pZCB7XG5cblx0XHR0aGlzLl9yYXdEYXRhID0gQnVmZmVyLmNvbmNhdChbdGhpcy5fcmF3RGF0YSwgZGF0YV0pO1xuXG5cdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdGlmICh0aGlzLl9jb250ZW50TGVuZ3RoID49IDApIHtcblx0XHRcdFx0aWYgKHRoaXMuX3Jhd0RhdGEubGVuZ3RoID49IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcblx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy5fcmF3RGF0YS50b1N0cmluZygndXRmOCcsIDAsIHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuXHRcdFx0XHRcdHRoaXMuX3Jhd0RhdGEgPSB0aGlzLl9yYXdEYXRhLnNsaWNlKHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnRMZW5ndGggPSAtMTtcblx0XHRcdFx0XHRpZiAobWVzc2FnZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRsZXQgbXNnOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZSk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuaGFuZGxlTWVzc2FnZShtc2cpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Y2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5fZW1pdEV2ZW50KG5ldyBFdmVudCgnZXJyb3InLCAnRXJyb3IgaGFuZGxpbmcgZGF0YTogJyArIChlICYmIGUubWVzc2FnZSkpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29udGludWU7XHQvLyB0aGVyZSBtYXkgYmUgbW9yZSBjb21wbGV0ZSBtZXNzYWdlcyB0byBwcm9jZXNzXG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGlkeCA9IHRoaXMuX3Jhd0RhdGEuaW5kZXhPZihQcm90b2NvbFNlcnZlci5UV09fQ1JMRik7XG5cdFx0XHRcdGlmIChpZHggIT09IC0xKSB7XG5cdFx0XHRcdFx0Y29uc3QgaGVhZGVyID0gdGhpcy5fcmF3RGF0YS50b1N0cmluZygndXRmOCcsIDAsIGlkeCk7XG5cdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBoZWFkZXIuc3BsaXQoJ1xcclxcbicpO1xuXHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGNvbnN0IHBhaXIgPSBsaW5lc1tpXS5zcGxpdCgvOiArLyk7XG5cdFx0XHRcdFx0XHRpZiAocGFpclswXSA9PSAnQ29udGVudC1MZW5ndGgnKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuX2NvbnRlbnRMZW5ndGggPSArcGFpclsxXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5fcmF3RGF0YSA9IHRoaXMuX3Jhd0RhdGEuc2xpY2UoaWR4ICsgUHJvdG9jb2xTZXJ2ZXIuVFdPX0NSTEYubGVuZ3RoKTtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG59XG4iXX0=","module.exports = require(\"url\");","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Logger = require(\"./logger\");\nconst logger = Logger.logger;\nconst debugSession_1 = require(\"./debugSession\");\nclass LoggingDebugSession extends debugSession_1.DebugSession {\n    constructor(obsolete_logFilePath, obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer) {\n        super(obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer);\n        this.obsolete_logFilePath = obsolete_logFilePath;\n        this.on('error', (event) => {\n            logger.error(event.body);\n        });\n    }\n    start(inStream, outStream) {\n        super.start(inStream, outStream);\n        logger.init(e => this.sendEvent(e), this.obsolete_logFilePath, this._isServer);\n    }\n    /**\n     * Overload sendEvent to log\n     */\n    sendEvent(event) {\n        if (!(event instanceof Logger.LogOutputEvent)) {\n            // Don't create an infinite loop...\n            let objectToLog = event;\n            if (event instanceof debugSession_1.OutputEvent && event.body && event.body.data && event.body.data.doNotLogOutput) {\n                delete event.body.data.doNotLogOutput;\n                objectToLog = Object.assign({}, event);\n                objectToLog.body = Object.assign({}, event.body, { output: '<output not logged>' });\n            }\n            logger.verbose(`To client: ${JSON.stringify(objectToLog)}`);\n        }\n        super.sendEvent(event);\n    }\n    /**\n     * Overload sendRequest to log\n     */\n    sendRequest(command, args, timeout, cb) {\n        logger.verbose(`To client: ${JSON.stringify(command)}(${JSON.stringify(args)}), timeout: ${timeout}`);\n        super.sendRequest(command, args, timeout, cb);\n    }\n    /**\n     * Overload sendResponse to log\n     */\n    sendResponse(response) {\n        logger.verbose(`To client: ${JSON.stringify(response)}`);\n        super.sendResponse(response);\n    }\n    dispatchRequest(request) {\n        logger.verbose(`From client: ${request.command}(${JSON.stringify(request.arguments)})`);\n        super.dispatchRequest(request);\n    }\n}\nexports.LoggingDebugSession = LoggingDebugSession;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2luZ0RlYnVnU2Vzc2lvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9sb2dnaW5nRGVidWdTZXNzaW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O2dHQUdnRzs7QUFJaEcsbUNBQW1DO0FBQ25DLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDN0IsaURBQXlEO0FBRXpELE1BQWEsbUJBQW9CLFNBQVEsMkJBQVk7SUFDcEQsWUFBMkIsb0JBQTZCLEVBQUUsd0NBQWtELEVBQUUsaUJBQTJCO1FBQ3hJLEtBQUssQ0FBQyx3Q0FBd0MsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO1FBRHpDLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBUztRQUd2RCxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQTBCLEVBQUUsRUFBRTtZQUMvQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFTSxLQUFLLENBQUMsUUFBK0IsRUFBRSxTQUFnQztRQUM3RSxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNqQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2hGLENBQUM7SUFFRDs7T0FFRztJQUNJLFNBQVMsQ0FBQyxLQUEwQjtRQUMxQyxJQUFJLENBQUMsQ0FBQyxLQUFLLFlBQVksTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQzlDLG1DQUFtQztZQUVuQyxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDeEIsSUFBSSxLQUFLLFlBQVksMEJBQVcsSUFBSSxLQUFLLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBRTtnQkFDcEcsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7Z0JBQ3RDLFdBQVcscUJBQVEsS0FBSyxDQUFFLENBQUM7Z0JBQzNCLFdBQVcsQ0FBQyxJQUFJLHFCQUFRLEtBQUssQ0FBQyxJQUFJLElBQUUsTUFBTSxFQUFFLHFCQUFxQixHQUFFLENBQUE7YUFDbkU7WUFFRCxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDNUQ7UUFFRCxLQUFLLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFFRDs7T0FFRztJQUNJLFdBQVcsQ0FBQyxPQUFlLEVBQUUsSUFBUyxFQUFFLE9BQWUsRUFBRSxFQUE4QztRQUM3RyxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxlQUFlLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFDdEcsS0FBSyxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxZQUFZLENBQUMsUUFBZ0M7UUFDbkQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELEtBQUssQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVTLGVBQWUsQ0FBQyxPQUE4QjtRQUN2RCxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixPQUFPLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBRSxHQUFHLENBQUMsQ0FBQztRQUN6RixLQUFLLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2hDLENBQUM7Q0FDRDtBQXRERCxrREFzREMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHtEZWJ1Z1Byb3RvY29sfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5cbmltcG9ydCAqIGFzIExvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5jb25zdCBsb2dnZXIgPSBMb2dnZXIubG9nZ2VyO1xuaW1wb3J0IHtEZWJ1Z1Nlc3Npb24sIE91dHB1dEV2ZW50fSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5cbmV4cG9ydCBjbGFzcyBMb2dnaW5nRGVidWdTZXNzaW9uIGV4dGVuZHMgRGVidWdTZXNzaW9uIHtcblx0cHVibGljIGNvbnN0cnVjdG9yKHByaXZhdGUgb2Jzb2xldGVfbG9nRmlsZVBhdGg/OiBzdHJpbmcsIG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDE/OiBib29sZWFuLCBvYnNvbGV0ZV9pc1NlcnZlcj86IGJvb2xlYW4pIHtcblx0XHRzdXBlcihvYnNvbGV0ZV9kZWJ1Z2dlckxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxLCBvYnNvbGV0ZV9pc1NlcnZlcik7XG5cblx0XHR0aGlzLm9uKCdlcnJvcicsIChldmVudDogRGVidWdQcm90b2NvbC5FdmVudCkgPT4ge1xuXHRcdFx0bG9nZ2VyLmVycm9yKGV2ZW50LmJvZHkpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIHN0YXJ0KGluU3RyZWFtOiBOb2RlSlMuUmVhZGFibGVTdHJlYW0sIG91dFN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKTogdm9pZCB7XG5cdFx0c3VwZXIuc3RhcnQoaW5TdHJlYW0sIG91dFN0cmVhbSk7XG5cdFx0bG9nZ2VyLmluaXQoZSA9PiB0aGlzLnNlbmRFdmVudChlKSwgdGhpcy5vYnNvbGV0ZV9sb2dGaWxlUGF0aCwgdGhpcy5faXNTZXJ2ZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIE92ZXJsb2FkIHNlbmRFdmVudCB0byBsb2dcblx0ICovXG5cdHB1YmxpYyBzZW5kRXZlbnQoZXZlbnQ6IERlYnVnUHJvdG9jb2wuRXZlbnQpOiB2b2lkIHtcblx0XHRpZiAoIShldmVudCBpbnN0YW5jZW9mIExvZ2dlci5Mb2dPdXRwdXRFdmVudCkpIHtcblx0XHRcdC8vIERvbid0IGNyZWF0ZSBhbiBpbmZpbml0ZSBsb29wLi4uXG5cblx0XHRcdGxldCBvYmplY3RUb0xvZyA9IGV2ZW50O1xuXHRcdFx0aWYgKGV2ZW50IGluc3RhbmNlb2YgT3V0cHV0RXZlbnQgJiYgZXZlbnQuYm9keSAmJiBldmVudC5ib2R5LmRhdGEgJiYgZXZlbnQuYm9keS5kYXRhLmRvTm90TG9nT3V0cHV0KSB7XG5cdFx0XHRcdGRlbGV0ZSBldmVudC5ib2R5LmRhdGEuZG9Ob3RMb2dPdXRwdXQ7XG5cdFx0XHRcdG9iamVjdFRvTG9nID0geyAuLi5ldmVudCB9O1xuXHRcdFx0XHRvYmplY3RUb0xvZy5ib2R5ID0geyAuLi5ldmVudC5ib2R5LCBvdXRwdXQ6ICc8b3V0cHV0IG5vdCBsb2dnZWQ+JyB9XG5cdFx0XHR9XG5cblx0XHRcdGxvZ2dlci52ZXJib3NlKGBUbyBjbGllbnQ6ICR7SlNPTi5zdHJpbmdpZnkob2JqZWN0VG9Mb2cpfWApO1xuXHRcdH1cblxuXHRcdHN1cGVyLnNlbmRFdmVudChldmVudCk7XG5cdH1cblxuXHQvKipcblx0ICogT3ZlcmxvYWQgc2VuZFJlcXVlc3QgdG8gbG9nXG5cdCAqL1xuXHRwdWJsaWMgc2VuZFJlcXVlc3QoY29tbWFuZDogc3RyaW5nLCBhcmdzOiBhbnksIHRpbWVvdXQ6IG51bWJlciwgY2I6IChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXNwb25zZSkgPT4gdm9pZCk6IHZvaWQge1xuXHRcdGxvZ2dlci52ZXJib3NlKGBUbyBjbGllbnQ6ICR7SlNPTi5zdHJpbmdpZnkoY29tbWFuZCl9KCR7SlNPTi5zdHJpbmdpZnkoYXJncyl9KSwgdGltZW91dDogJHt0aW1lb3V0fWApO1xuXHRcdHN1cGVyLnNlbmRSZXF1ZXN0KGNvbW1hbmQsIGFyZ3MsIHRpbWVvdXQsIGNiKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBPdmVybG9hZCBzZW5kUmVzcG9uc2UgdG8gbG9nXG5cdCAqL1xuXHRwdWJsaWMgc2VuZFJlc3BvbnNlKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlKTogdm9pZCB7XG5cdFx0bG9nZ2VyLnZlcmJvc2UoYFRvIGNsaWVudDogJHtKU09OLnN0cmluZ2lmeShyZXNwb25zZSl9YCk7XG5cdFx0c3VwZXIuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkaXNwYXRjaFJlcXVlc3QocmVxdWVzdDogRGVidWdQcm90b2NvbC5SZXF1ZXN0KTogdm9pZCB7XG5cdFx0bG9nZ2VyLnZlcmJvc2UoYEZyb20gY2xpZW50OiAke3JlcXVlc3QuY29tbWFuZH0oJHtKU09OLnN0cmluZ2lmeShyZXF1ZXN0LmFyZ3VtZW50cykgfSlgKTtcblx0XHRzdXBlci5kaXNwYXRjaFJlcXVlc3QocmVxdWVzdCk7XG5cdH1cbn1cbiJdfQ==","var path = require('path');\nvar fs = require('fs');\nvar _0777 = parseInt('0777', 8);\n\nmodule.exports = mkdirP.mkdirp = mkdirP.mkdirP = mkdirP;\n\nfunction mkdirP (p, opts, f, made) {\n    if (typeof opts === 'function') {\n        f = opts;\n        opts = {};\n    }\n    else if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n    \n    var cb = f || function () {};\n    p = path.resolve(p);\n    \n    xfs.mkdir(p, mode, function (er) {\n        if (!er) {\n            made = made || p;\n            return cb(null, made);\n        }\n        switch (er.code) {\n            case 'ENOENT':\n                mkdirP(path.dirname(p), opts, function (er, made) {\n                    if (er) cb(er, made);\n                    else mkdirP(p, opts, cb, made);\n                });\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                xfs.stat(p, function (er2, stat) {\n                    // if the stat fails, then that's super weird.\n                    // let the original error be the failure reason.\n                    if (er2 || !stat.isDirectory()) cb(er, made)\n                    else cb(null, made);\n                });\n                break;\n        }\n    });\n}\n\nmkdirP.sync = function sync (p, opts, made) {\n    if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n\n    p = path.resolve(p);\n\n    try {\n        xfs.mkdirSync(p, mode);\n        made = made || p;\n    }\n    catch (err0) {\n        switch (err0.code) {\n            case 'ENOENT' :\n                made = sync(path.dirname(p), opts, made);\n                sync(p, opts, made);\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                var stat;\n                try {\n                    stat = xfs.statSync(p);\n                }\n                catch (err1) {\n                    throw err0;\n                }\n                if (!stat.isDirectory()) throw err0;\n                break;\n        }\n    }\n\n    return made;\n};\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Handles {\n    constructor(startHandle) {\n        this.START_HANDLE = 1000;\n        this._handleMap = new Map();\n        this._nextHandle = typeof startHandle === 'number' ? startHandle : this.START_HANDLE;\n    }\n    reset() {\n        this._nextHandle = this.START_HANDLE;\n        this._handleMap = new Map();\n    }\n    create(value) {\n        var handle = this._nextHandle++;\n        this._handleMap.set(handle, value);\n        return handle;\n    }\n    get(handle, dflt) {\n        return this._handleMap.get(handle) || dflt;\n    }\n}\nexports.Handles = Handles;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9oYW5kbGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O2dHQUdnRzs7QUFFaEcsTUFBYSxPQUFPO0lBT25CLFlBQW1CLFdBQW9CO1FBTC9CLGlCQUFZLEdBQUcsSUFBSSxDQUFDO1FBR3BCLGVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFDO1FBR3pDLElBQUksQ0FBQyxXQUFXLEdBQUcsT0FBTyxXQUFXLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDdEYsQ0FBQztJQUVNLEtBQUs7UUFDWCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDckMsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFDO0lBQ3hDLENBQUM7SUFFTSxNQUFNLENBQUMsS0FBUTtRQUNyQixJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ25DLE9BQU8sTUFBTSxDQUFDO0lBQ2YsQ0FBQztJQUVNLEdBQUcsQ0FBQyxNQUFjLEVBQUUsSUFBUTtRQUNsQyxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQztJQUM1QyxDQUFDO0NBQ0Q7QUF6QkQsMEJBeUJDIiwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbmV4cG9ydCBjbGFzcyBIYW5kbGVzPFQ+IHtcblxuXHRwcml2YXRlIFNUQVJUX0hBTkRMRSA9IDEwMDA7XG5cblx0cHJpdmF0ZSBfbmV4dEhhbmRsZSA6IG51bWJlcjtcblx0cHJpdmF0ZSBfaGFuZGxlTWFwID0gbmV3IE1hcDxudW1iZXIsIFQ+KCk7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHN0YXJ0SGFuZGxlPzogbnVtYmVyKSB7XG5cdFx0dGhpcy5fbmV4dEhhbmRsZSA9IHR5cGVvZiBzdGFydEhhbmRsZSA9PT0gJ251bWJlcicgPyBzdGFydEhhbmRsZSA6IHRoaXMuU1RBUlRfSEFORExFO1xuXHR9XG5cblx0cHVibGljIHJlc2V0KCk6IHZvaWQge1xuXHRcdHRoaXMuX25leHRIYW5kbGUgPSB0aGlzLlNUQVJUX0hBTkRMRTtcblx0XHR0aGlzLl9oYW5kbGVNYXAgPSBuZXcgTWFwPG51bWJlciwgVD4oKTtcblx0fVxuXG5cdHB1YmxpYyBjcmVhdGUodmFsdWU6IFQpOiBudW1iZXIge1xuXHRcdHZhciBoYW5kbGUgPSB0aGlzLl9uZXh0SGFuZGxlKys7XG5cdFx0dGhpcy5faGFuZGxlTWFwLnNldChoYW5kbGUsIHZhbHVlKTtcblx0XHRyZXR1cm4gaGFuZGxlO1xuXHR9XG5cblx0cHVibGljIGdldChoYW5kbGU6IG51bWJlciwgZGZsdD86IFQpOiBUIHtcblx0XHRyZXR1cm4gdGhpcy5faGFuZGxlTWFwLmdldChoYW5kbGUpIHx8IGRmbHQ7XG5cdH1cbn1cbiJdfQ==","function Subject() {\n  this.waiters = [];\n}\n\nSubject.prototype.wait = function (timeout) {\n  var self = this;\n  var waiter = {};\n  this.waiters.push(waiter);\n  var promise = new Promise(function (resolve) {\n    var resolved = false;\n    waiter.resolve = function (noRemove) {\n      if (resolved) {\n        return;\n      }\n      resolved = true;\n      if (waiter.timeout) {\n        clearTimeout(waiter.timeout);\n        waiter.timeout = null;\n      }\n      if (!noRemove) {\n        var pos = self.waiters.indexOf(waiter);\n        if (pos > -1) {\n          self.waiters.splice(pos, 1);\n        }\n      }\n      resolve();\n    };\n  });\n  if (timeout > 0 && isFinite(timeout)) {\n    waiter.timeout = setTimeout(function () {\n      waiter.timeout = null;\n      waiter.resolve();\n    }, timeout);\n  }\n  return promise;\n};\n\nSubject.prototype.notify = function () {\n  if (this.waiters.length > 0) {\n    this.waiters.pop().resolve(true);\n  }\n};\n\nSubject.prototype.notifyAll = function () {\n  for (var i = this.waiters.length - 1; i >= 0; i--) {\n    this.waiters[i].resolve(true);\n  }\n  this.waiters = [];\n}\n\nexports.Subject = Subject;\n","/*\r\n\tConnector to MDEBUG-Server by Jens Wulf\r\n\tLicense: LGPL\r\n*/\r\nimport { Socket } from \"net\";\r\nimport { EventEmitter } from 'events';\r\nimport { readFileSync } from 'fs';\r\nexport interface MumpsBreakpoint {\r\n\tid: number;\r\n\tfile: string,\r\n\tline: number;\r\n\tverified: boolean;\r\n}\r\ninterface VarData {\r\n\tname: string,\r\n\tindexCount: number,\r\n\tbases: Array<string>,\r\n\tcontent: string\r\n}\r\n\r\nexport class MConnect extends EventEmitter {\r\n\tprivate _socket: Socket;\r\n\tprivate _connectState: string;\r\n\tprivate _readedData: string;\r\n\tprivate _mVars: Object;\r\n\tprivate _mStack: Array<string>;\r\n\tprivate _activeBreakpoints: Array<string>;\r\n\tprivate _event = new EventEmitter();\r\n\tprivate _hostname: string;\r\n\tprivate _port: number;\r\n\tprivate _sourceFile: string;\r\n\tprivate _sourceLines: string[];\r\n\tprivate _currentLine = 0;\r\n\tprivate _errorLines: string[];\r\n\tprivate _hints: string[];\r\n\tprivate _breakPoints: MumpsBreakpoint[];\r\n\tprivate _localRoutinesPath: string;\r\n\tprivate _breakpointId: number = 1;\r\n\tprivate _commandQueue: string[];\r\n\tprivate _logging: boolean = true;\r\n\tprivate _singleVar: string = \"\";\r\n\tprivate _singleVarContent: string = \"\";\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._commandQueue = [];\r\n\t\tthis._socket = new Socket();\r\n\t\tthis._connectState = \"waitingforStart\";\r\n\t\tthis._readedData = \"\";\r\n\t\tthis._mVars = {};\r\n\t\tthis._mStack = [];\r\n\t\tthis._activeBreakpoints = [];\r\n\t\tthis._breakPoints = [];\r\n\t\tthis._errorLines = [];\r\n\t\tthis._singleVar = \"\";\r\n\t\tthis._singleVarContent = \"\";\r\n\t\tthis._hints = [];\r\n\t\tthis._event.on('varsComplete', () => {\r\n\t\t\tif (typeof (this._mVars[\"I\"]) !== 'undefined') {\r\n\t\t\t\tlet internals = this._mVars[\"I\"];\r\n\t\t\t\tthis.checkEvents(internals[\"$ZPOSITION\"], internals[\"$ZSTATUS\"]);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic async init(hostname: string, port: number, localRoutinesPath: string) {\r\n\t\tthis._localRoutinesPath = localRoutinesPath;\r\n\t\tthis._hostname = hostname;\r\n\t\tthis._port = port;\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._socket.connect(this._port, this._hostname, () => {\r\n\t\t\t\tthis._log(\"Debug-Server connected\\n\");\r\n\t\t\t\tthis._socket.on('data', (chunk) => {\r\n\t\t\t\t\tthis._readedData += chunk.toString();\r\n\t\t\t\t\tlet n = this._readedData.indexOf('\\n');\r\n\t\t\t\t\twhile (n !== -1) {\r\n\t\t\t\t\t\tlet data = this._readedData.substring(0, n);\r\n\t\t\t\t\t\tthis.processLine(data)\r\n\t\t\t\t\t\tthis._readedData = this._readedData.substring(n + 1);\r\n\t\t\t\t\t\tn = this._readedData.indexOf('\\n');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tresolve(this._socket);\r\n\t\t\t});\r\n\t\t\tthis._socket.on('error', (error) => {\r\n\t\t\t\treject(error);\r\n\t\t\t});\r\n\t\t})\r\n\t\t// Put a friendly message on the terminal of the server.\r\n\t}\r\n\tprivate _log(msg) {\r\n\t\tif (this._logging) { console.log(msg); }\r\n\t}\r\n\tprivate processLine(line: string) {\r\n\t\tthis._log(\"Line:  \" + line);\r\n\r\n\t\tlet varname: string;\r\n\t\tlet value: string;\r\n\t\tlet vartype: string;\r\n\t\tswitch (this._connectState) {\r\n\t\t\tcase \"waitingforStart\": {\r\n\t\t\t\tif (line === \"***STARTVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforVars\";\r\n\t\t\t\t\tthis._mStack = [];\r\n\t\t\t\t\tthis._mVars = {};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***STARTBP\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforBreakpoints\";\r\n\t\t\t\t\tthis._activeBreakpoints = [];\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***SINGLEVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForSingleVar\";\r\n\t\t\t\t\tthis._singleVar = \"\";\r\n\t\t\t\t\tthis._singleVarContent = \"\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***ENDPROGRAM\") {\r\n\t\t\t\t\tthis.sendEvent(\"end\");\r\n\t\t\t\t\tthis._socket.end();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***BEGINERRCHK\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForErrorreport\";\r\n\t\t\t\t\tthis._errorLines = [];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***STARTHINTS\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForHints\";\r\n\t\t\t\t\tthis._hints = [];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingforVars\": {\r\n\t\t\t\tif (line === \"***ENDVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit(\"varsComplete\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvartype = line.substring(0, 1); //I=internal,V=local Variable,S=Stackframe\r\n\t\t\t\t\tif (vartype === \"S\") {\r\n\t\t\t\t\t\tthis._mStack.push(line.substring(2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvarname = line.substring(2, line.indexOf('='));\r\n\t\t\t\t\twhile ((varname.split('\"').length - 1) % 2 !== 0) {\r\n\t\t\t\t\t\tvarname = line.substring(0, line.indexOf('=', varname.length + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue = line.substring(varname.length + 3).replace(/^\"/, \"\").replace(/\"$/, \"\");\r\n\t\t\t\t\tif (typeof (this._mVars[vartype]) === 'undefined') { this._mVars[vartype] = {}; }\r\n\t\t\t\t\tthis._mVars[vartype][varname] = value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingforBreakpoints\": {\r\n\t\t\t\tif (line === \"***ENDBP\") {\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis.verifyBreakpoints();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tthis._activeBreakpoints.push(line);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForSingleVar\": {\r\n\t\t\t\tif (line === \"***SINGLEEND\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('SingleVarReceived', this._event, this._singleVar, this._singleVarContent);\r\n\t\t\t\t} else if (line === \"***SINGLEVARCONTENT\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForSingleVarContent\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._singleVar += line;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForSingleVarContent\": {\r\n\t\t\t\tif (line === \"***SINGLEEND\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('SingleVarReceived', this._event, this._singleVar, this._singleVarContent);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._singleVarContent += line;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForErrorreport\": {\r\n\t\t\t\tif (line === \"***ENDERRCHK\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('ErrorreportReceived', this._event, this._errorLines);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._errorLines.push(line);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForHints\": {\r\n\t\t\t\tif (line === \"***ENDHINTS\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('HintsReceived', this._event, this._hints);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._hints.push(line);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdefault: {\r\n\t\t\t\tconsole.error(\"Unexpected Message: \" + line);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate writeln(message: string): void {\r\n\t\tthis._commandQueue.push(message);\r\n\t\tif (this._commandQueue.length > 1000) {\r\n\t\t\tconsole.error(\"Too many Commands in Queue Check Debugger Connection\");\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tif (this._socket && this._socket.writable) {\r\n\t\t\twhile (this._commandQueue.length) {\r\n\t\t\t\tmessage = this._commandQueue.shift()!;\r\n\t\t\t\t//this._log(\"out: \" + message);\r\n\t\t\t\tthis._socket.write(message + \"\\n\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate sendBreakpoint(file: string, line: number, onOff: boolean): void {\r\n\t\tif (onOff) { this.writeln(\"SETBP;\" + file + \";\" + line); }\r\n\t\telse { this.writeln(\"CLEARBP;\" + file + \";\" + line); }\r\n\t}\r\n\tpublic start(file: string, stopAtStart: boolean): void {\r\n\t\tif (stopAtStart) {\r\n\t\t\tif (file.indexOf(\"^\")) {\r\n\t\t\t\t//Stop direct at given Label not at first line\r\n\t\t\t\tthis.sendBreakpoint(file, 0, true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendBreakpoint(file, 1, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.requestBreakpoints();\r\n\t\tthis.writeln(\"START;\" + file);\r\n\t}\r\n\tpublic step(type: string): void {\r\n\t\tthis.writeln(type);\r\n\t}\r\n\tpublic continue(): void {\r\n\t\tthis.writeln(\"CONTINUE\");\r\n\t}\r\n\tpublic disconnect(): void {\r\n\t\tthis.writeln(\"RESET\");\r\n\t\tthis._socket.end();\r\n\t}\r\n\tpublic requestBreakpoints(): void {\r\n\t\tthis.writeln(\"REQUESTBP\");\r\n\t}\r\n\tpublic restart(file: string) {\r\n\t\tthis.writeln(\"RESTART;\" + file);\r\n\t}\r\n\t/**\r\n\t * Fire events if line has a breakpoint or hs stopped beacause of a different reason\r\n\t */\r\n\tprivate checkEvents(mumpsposition: string, mumpsstatus: string): void {\r\n\t\tconst parts = mumpsposition.split(\"^\");\r\n\t\tconst position = parts[0];\r\n\t\tconst program = parts[1];\r\n\t\tconst file = this._localRoutinesPath + program + \".m\";\r\n\t\tthis.loadSource(file);\r\n\t\tconst startlabel = position.split(\"+\")[0];\r\n\t\tlet offset = 0;\r\n\t\tif (position.split(\"+\")[1] !== undefined) {\r\n\t\t\toffset = parseInt(position.split(\"+\")[1]);\r\n\t\t}\r\n\t\tlet line = 0\r\n\t\tif (startlabel !== \"\") {\r\n\t\t\tfor (let ln = 0; ln < this._sourceLines.length; ln++) {\r\n\t\t\t\tif (this._sourceLines[ln].substring(0, startlabel.length) === startlabel) {\r\n\t\t\t\t\tline = ln;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._currentLine = line + offset;\r\n\t\tif (mumpsstatus !== \"\") {\r\n\t\t\tthis.sendEvent('stopOnException', mumpsstatus);\r\n\t\t} else {\r\n\t\t\tconst bps = this._breakPoints.filter(bp => bp.file === this._sourceFile && bp.line === this._currentLine);\r\n\t\t\tif (bps.length > 0) {\r\n\t\t\t\tthis.sendEvent('stopOnBreakpoint');\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendEvent('stopOnStep');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the actual Stack\r\n\t */\r\n\tpublic stack(startFrame: number, endFrame: number): any {\r\n\r\n\t\tconst frames = new Array<any>();\r\n\r\n\t\tfor (let i = startFrame; i < this._mStack.length; i++) {\r\n\t\t\tconst position = this._mStack[i];\r\n\t\t\tconst fileposition = this.convertMumpsPosition(position);\r\n\t\t\tfileposition.line++;\t//Correction 0/1 based in Editor/GT.M\r\n\t\t\tframes.push({\r\n\t\t\t\tindex: i,\r\n\t\t\t\tname: `${position}(${i})`,\r\n\t\t\t\tfile: fileposition.file,\r\n\t\t\t\tline: fileposition.line\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tframes: frames,\r\n\t\t\tcount: Math.min(this._mStack.length, endFrame)\r\n\t\t};\r\n\t}\r\n\r\n\r\n\t/*\r\n\t * Set breakpoint in file with given line.\r\n\t */\r\n\tpublic setBreakPoint(file: string, line: number): MumpsBreakpoint {\r\n\t\tconst bp = <MumpsBreakpoint>{ verified: false, file, line, id: this._breakpointId++ };\r\n\t\tthis._breakPoints.push(bp);\r\n\t\tthis.sendBreakpoint(file, bp.line + 1, true);\r\n\t\treturn bp;\r\n\t}\r\n\r\n\t/*\r\n\t * Clear breakpoint in file with given line.\r\n\t */\r\n\tpublic clearBreakPoint(file: string, line: number): MumpsBreakpoint | undefined {\r\n\t\tlet bps = this._breakPoints;\r\n\t\tif (bps) {\r\n\t\t\tconst index = bps.findIndex(bp => bp.file === file && bp.line === line);\r\n\t\t\tif (index >= 0) {\r\n\t\t\t\tconst bp = bps[index];\r\n\t\t\t\tthis.sendBreakpoint(file, bp.line, false);\r\n\t\t\t\tbps.splice(index, 1);\r\n\t\t\t\treturn bp;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/*\r\n\t * Clear all breakpoints\r\n\t */\r\n\tpublic clearBreakpoints(file: string): void {\r\n\t\tthis.writeln(\"CLEARBP;\" + file);\r\n\t}\r\n\r\n\tprivate verifyBreakpoints(): void {\r\n\t\tlet merk: boolean[] = [];\r\n\t\tthis._breakPoints.forEach(bp => {\r\n\t\t\tbp.verified = false;\r\n\t\t\tfor (let i = 0; i < this._activeBreakpoints.length; i++) {\r\n\t\t\t\tlet internalBp = this.convertMumpsPosition(this._activeBreakpoints[i])\r\n\t\t\t\tif (internalBp.file === bp.file && bp.line === internalBp.line) {\r\n\t\t\t\t\tbp.verified = true;\r\n\t\t\t\t\tthis.sendEvent('breakpointValidated', bp);\r\n\t\t\t\t\tmerk[i] = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!bp.verified) { this.sendEvent('breakpointValidated', bp); }\r\n\t\t});\r\n\t\tfor (let i = 0; i < this._activeBreakpoints.length; i++) {\r\n\t\t\tif (!merk[i]) {\r\n\t\t\t\tlet internalBp = this.convertMumpsPosition(this._activeBreakpoints[i])\r\n\t\t\t\tlet bp: MumpsBreakpoint = { 'verified': true, 'file': internalBp.file, 'line': internalBp.line, 'id': this._breakpointId++ }\r\n\t\t\t\tthis.sendEvent('breakpointValidated', bp);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getVariables(type: string) {\r\n\t\tif (type === \"system\") {\r\n\t\t\treturn this._mVars[\"I\"];\r\n\t\t} else if (type === \"local\") {\r\n\t\t\treturn this._mVars[\"V\"];\r\n\t\t}\r\n\t}\r\n\tpublic async requestHints(part: string) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._event.on('HintsReceived', function HintsReceived(event: EventEmitter, hints: string[]) {\r\n\t\t\t\tevent.removeListener('HintsReceived', HintsReceived);\r\n\t\t\t\tresolve(hints);\r\n\t\t\t});\r\n\t\t\tthis.writeln(\"GETHINTS;\" + part);\r\n\t\t})\r\n\t}\r\n\tpublic async checkRoutine(lines: string[]) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._event.on('ErrorreportReceived', function ErrorreportReceived(event: EventEmitter, errorLines: string[]) {\r\n\t\t\t\tevent.removeListener('ErrorreportReceived', ErrorreportReceived);\r\n\t\t\t\tresolve(errorLines);\r\n\t\t\t});\r\n\t\t\tthis.writeln(\"ERRCHK\");\r\n\t\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\t\tthis.writeln(lines[i]);\r\n\t\t\t}\r\n\t\t\tthis.writeln(\"***ENDPROGRAM\");\r\n\t\t})\r\n\t}\r\n\tpublic async getSingleVar(expression: string) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet reply: VarData = { name: expression, indexCount: 0, content: \"undefined\", bases: [] }\r\n\t\t\tif (expression.substring(0, 1) === \"$\") {\r\n\t\t\t\treply.content = (this._mVars[\"I\"] !== undefined) ? this._mVars[\"I\"][expression] : \"undefined\";\r\n\t\t\t\tresolve(reply);\r\n\t\t\t} else {\r\n\t\t\t\tif (this._mVars[\"V\"] !== undefined) {\r\n\t\t\t\t\tif (this._mVars[\"V\"][expression] !== undefined) {\r\n\t\t\t\t\t\treply.content = this._mVars[\"V\"][expression];\r\n\t\t\t\t\t\tresolve(reply);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._event.on('SingleVarReceived', function SingleVarReceived(event, singleVar, singleVarContent) {\r\n\t\t\t\t\t\t\tevent.removeListener('SingleVarReceived', SingleVarReceived);\r\n\t\t\t\t\t\t\treply.name = singleVar;\r\n\t\t\t\t\t\t\treply.content = singleVarContent;\r\n\t\t\t\t\t\t\tresolve(reply);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.writeln(\"GETVAR;\" + expression);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve(reply);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// private methods\r\n\r\n\tprivate loadSource(file: string) {\r\n\t\tfile = file.replace(\"%\", \"_\");\r\n\t\tif (this._sourceFile !== file) {\r\n\t\t\tthis._sourceFile = file;\r\n\t\t\ttry {\r\n\t\t\t\tthis._sourceLines = readFileSync(this._sourceFile).toString().split('\\n');\r\n\t\t\t} catch {\r\n\t\t\t\tconsole.log(\"Could not read Sourcefile \" + file)\r\n\t\t\t}\r\n\t\t\tconsole.log(\"OK\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate convertMumpsPosition(positionstring: string) {\r\n\t\tlet parts = positionstring.split(\"^\");\r\n\t\tlet position = parts[0];\r\n\t\tlet program = parts[1].split(\" \", 1)[0];\r\n\t\tlet file = (this._localRoutinesPath + program + \".m\").replace(\"%\", \"_\");\r\n\t\ttry {\r\n\t\t\tlet filecontent = readFileSync(file).toString().split('\\n');\r\n\t\t\tlet startlabel = position.split(\"+\")[0];\r\n\t\t\tlet offset = 0;\r\n\t\t\tif (position.split(\"+\")[1] !== undefined) {\r\n\t\t\t\toffset = parseInt(position.split(\"+\")[1]);\r\n\t\t\t}\r\n\t\t\tlet line = 0;\r\n\t\t\tif (startlabel !== \"\") {\r\n\t\t\t\tfor (let ln = 0; ln < filecontent.length; ln++) {\r\n\t\t\t\t\tif (filecontent[ln].substring(0, startlabel.length) === startlabel) {\r\n\t\t\t\t\t\tline = ln;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn { \"file\": file, \"line\": line + offset - 1 };\r\n\t\t} catch {\r\n\t\t\tconsole.log(\"Could not read Sourcefile \" + file)\r\n\t\t\treturn { \"file\": file, \"line\": 1 };\r\n\t\t}\r\n\t}\r\n\r\n\tprivate sendEvent(event: string, ...args: any[]) {\r\n\t\tthis.emit(event, ...args);\r\n\t}\r\n}","import * as vscode from 'vscode';\r\nlet Hover = vscode.Hover;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\n\r\nclass MumpsHoverProvider {\r\n    provideHover(document, position) {\r\n        let token = new MumpsToken(document, position);\r\n\t\t\t\tif (!token.range) {return}\r\n        if (!token.mayBeCommand && !token.isIntrinsic && !token.isLabelReference) {\r\n            return;\r\n        }\r\n\r\n        if (token.definition) {\r\n            let definition = token.definition;\r\n            let snippet = { language: 'typescript', value: definition.functionSignature || definition.name };\r\n            return new Hover([snippet, definition.description]);\r\n        }\r\n    }\r\n}\r\n\r\nexport {MumpsHoverProvider}\r\n","let fs = require('fs');\r\nlet path = require('path');\r\nimport * as vscode from 'vscode';\r\nimport * as autoDoc from './mumps-documenter'\r\nlet Position = vscode.Position;\r\nlet Uri = vscode.Uri;\r\n\r\nconst EXTENSIONS = ['.M', '.INT', '.ZWR', '.m', '.int', '.zwr'];\r\n\r\nlet cache: any = {};\r\n\r\nfunction lookupLabelReference(token): MumpsLabel {\r\n\t//console.log(\"here\")\r\n\tlet uri = token.labelProgram ?\r\n\t\tsiblingUri(token.document, token.labelProgram) :\r\n\t\ttoken.document.uri;\r\n\tlet referredTo = findReferredToLabel(getText(uri, token.document), token.label);\r\n\t//console.log(referredTo)\r\n\tif (referredTo) {\r\n\t\treferredTo.position = new Position(referredTo.line + (token.labelOffset || 0), 0);\r\n\t} else {\r\n\t\treferredTo = {\r\n\t\t\ttext: '',\r\n\t\t\tposition: new Position(0, 0)\r\n\t\t};\r\n\t}\r\n\treferredTo.uri = uri;\r\n\treturn referredTo;\r\n}\r\n\r\nfunction siblingUri(document, fileName) {\r\n\tlet siblingPath = path.resolve(document.uri.fsPath, '../' + fileName);\r\n\tif (!fs.existsSync(siblingPath)) {\r\n\t\tif (fileName.charAt(0) === '%') {\r\n\t\t\treturn siblingUri(document, '_' + fileName.substring(1));\r\n\t\t}\r\n\r\n\t\tfor (let extension of EXTENSIONS) {\r\n\t\t\tlet extendedPath = siblingPath + extension;\r\n\t\t\tif (fs.existsSync(extendedPath)) {\r\n\t\t\t\tsiblingPath = extendedPath;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn Uri.file(siblingPath);\r\n}\r\n\r\nfunction getText(uri, document) {\r\n\tif (uri === document.uri) {\r\n\t\treturn document.getText();\r\n\t}\r\n\tif (uri.fsPath === cache.fsPath) {\r\n\t\treturn cache.text;\r\n\t}\r\n\ttry {\r\n\t\tcache.text = fs.readFileSync(uri.fsPath, 'utf8');\r\n\t\tcache.fsPath = uri.fsPath;\r\n\t\treturn cache.text;\r\n\t} catch (e) {\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nfunction findReferredToLabel(text: string, label): MumpsLabel | undefined {\r\n\tlet lines = text.split(\"\\n\");\r\n\tlet commentText = \"\";\r\n\tlet i=0;\r\n\tfor (i = 0; i < lines.length; i++) {\r\n\t\tif (lines[i].match(\"^\" + label) !== null) {\r\n\t\t\tcommentText += lines[i] + \"\\n\";\r\n\t\t\tfor (let j = i - 1; j > 0; j--) {\r\n\t\t\t\tif (lines[j].length === 0 || lines[j].charAt(1) === \";\") {\r\n\t\t\t\t\tcommentText += lines[j] + \"\\n\"\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (commentText.length > 0) {\r\n\t\treturn {\r\n\t\t\ttext: commentText,\r\n\t\t\tline: i\r\n\t\t};\r\n\t}\r\n}\r\n/*\r\nfunction countLines(text, index) {\r\n    if (index >= text.length) {\r\n        index = text.length - 1;\r\n    }\r\n    let re = /[\\r\\n]+/g;\r\n    let result;\r\n    let line = 0;\r\n    while ((result = re.exec(text)) && result.index >= 0 && result.index < index) {\r\n        ++line;\r\n    }\r\n    return line;\r\n}\r\n*/\r\nfunction createDefinitionForLabelReference(referredTo: MumpsLabel) {\r\n\t//console.log(\"CreateLabel\")\r\n\tif (!referredTo.text) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet definitionRegex = /^([%A-Z][A-Z0-9]*)(\\((,?[%A-Z][A-Z0-9]*)+\\))?/i;\r\n\tlet result = definitionRegex.exec(referredTo.text);\r\n\tif (!result) {\r\n\t\treturn;\r\n\t}\r\n\tlet commentText='';\r\n\tif (referredTo.text.indexOf(';')) {\r\n\t\tcommentText=referredTo.text.substring(referredTo.text.indexOf(';')+1);\r\n\t}\r\n\tlet parameters:any = [];\r\n\tlet parametersByName = {};\r\n\tif (result[2] !== undefined) {\r\n\t\tparameters = result[2].substring(1, result[2].length - 1).split(',');\r\n\t\tfor (let i = 0; i < parameters.length; i++) {\r\n\t\t\tparameters[i] = {\r\n\t\t\t\tname: parameters[i],\r\n\t\t\t\ttype: 'any'\r\n\t\t\t};\r\n\t\t\tparametersByName[parameters[i].name] = parameters[i];\r\n\t\t}\r\n\t}\r\n\tlet definition = {\r\n\t\tname: result[1],\r\n\t\ttype: 'function',\r\n\t\tparameters,\r\n\t\tcommentText\r\n\t};\r\n\r\n\t//extractDescriptionFromComments(referredTo, definition, parametersByName);\r\n\tautoDoc.getSigInfo(referredTo, definition, parametersByName);\r\n\r\n\treturn definition;\r\n}\r\n/*\r\nfunction extractDescriptionFromComments(referredTo:MumpsLabel, definition, parametersByName) {\r\n    let commentRegex = /;[ \\t]*(.*)$/gm;\r\n    let commentText = '';\r\n    let result;\r\n    while ((result = commentRegex.exec(referredTo.text)) !== null) {\r\n        commentText += result[1] + '\\n';\r\n    }\r\n    if (!commentText) {\r\n        return;\r\n    }\r\n\r\n    // don't look for parameters in the first line\r\n    let newlineResult = /\\n/m.exec(commentText);\r\n    if (newlineResult) {\r\n        let additionalLines = commentText.substring(newlineResult.index + 1);\r\n        for (let name in parametersByName) {\r\n            let parameterRegex = new RegExp('^((input|output|input/output)[ \\t:\\\\-]+)?' + name + '[ \\t:\\\\-]+(.+)\\n', 'm');\r\n            let result = parameterRegex.exec(additionalLines);\r\n            if (result) {\r\n                parametersByName[name].description = result[3] + \"ss\";\r\n                if (result[2]) {\r\n                    parametersByName[name].description = result[2] + parametersByName[name].description;\r\n                }\r\n                additionalLines = additionalLines.substring(0, result.index) + additionalLines.substring(result.index + result[0].length);\r\n            }\r\n        }\r\n        commentText = commentText.substring(0, newlineResult.index) + '\\n' + additionalLines;\r\n    }\r\n\r\n    definition.description = commentText;\r\n}\r\n*/\r\ninterface MumpsLabel { text: string, line?: number, position?: vscode.Position, uri?: string }\r\nexport { lookupLabelReference, createDefinitionForLabelReference, MumpsLabel };","import * as vscode from 'vscode';\r\nlet Location = vscode.Location;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\nclass MumpsDefinitionProvider {\r\n    provideDefinition(document, position) {\r\n        let token = new MumpsToken(document, position);\r\n        if (token.isLabelReference && token.referredToLabel) {\r\n            let position = token.referredToLabel.position;\r\n            return new Location(token.referredToLabel.uri, position);\r\n        }\r\n    }\r\n}\r\n\r\nexport {MumpsDefinitionProvider};","import * as vscode from 'vscode';\r\nlet ParameterInformation = vscode.ParameterInformation;\r\nlet Position = vscode.Position;\r\nlet SignatureHelp = vscode.SignatureHelp;\r\nlet SignatureInformation = vscode.SignatureInformation;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\n\r\nclass MumpsSignatureHelpProvider {\r\n    provideSignatureHelp(document, position) {\r\n        let line = document.lineAt(position);\r\n        if (!line) {\r\n            return;\r\n        }\r\n\r\n        let token = getFunctionToken(document, line, position);\r\n        if (!token || !token.definition) {\r\n            return;\r\n        }\r\n\r\n        let signature = createSignatureInformation(token.definition);\r\n\r\n        let help = new SignatureHelp();\r\n        help.signatures = [signature];\r\n        help.activeSignature = 0;\r\n        help.activeParameter = calculateActiveParameter(line.text, token.position.character + 1, position.character);\r\n        return help;\r\n    }\r\n}\r\nexport {MumpsSignatureHelpProvider};\r\n\r\nfunction getFunctionToken(document, line, position) {\r\n    let depth = 1;\r\n    let index;\r\n    for (index = position.character - 1; index > 0 && depth > 0; index--) {\r\n        let char = line.text.charAt(index);\r\n        if (char === ')') {\r\n            depth++;\r\n        } else if (char === '(') {\r\n            depth--;\r\n        }\r\n    }\r\n    if (depth > 0 || index <= 0) {\r\n        return;\r\n    }\r\n\r\n    return new MumpsToken(document, new Position(position.line, index));\r\n}\r\n\r\nfunction createSignatureInformation(definition) {\r\n    let signature = new SignatureInformation(definition.functionSignature, definition.description);\r\n    if (definition.parameters) {\r\n        signature.parameters = [];\r\n        for (let parameter of definition.parameters) {\r\n            let description = parameter.optional ? '(optional) ' : '';\r\n            description += parameter.description || parameter.name;\r\n            signature.parameters.push(new ParameterInformation(parameter.name, description));\r\n\t\t\t\t}\r\n\t\t\t\tsignature.documentation=definition.commentText;\r\n    }\r\n    return signature;\r\n}\r\n\r\nfunction calculateActiveParameter(lineText, parametersStartIndex, insertIndex) {\r\n    let active = 0;\r\n    let depth = 0;\r\n    for (let i = parametersStartIndex + 1; i < insertIndex; i++) {\r\n        let char = lineText.charAt(i);\r\n        if (char === '(') {\r\n            depth++;\r\n        } else if (char === ')') {\r\n            depth--;\r\n        } else if (char === ',' && depth === 0) {\r\n            active++;\r\n        }\r\n    }\r\n    return active;\r\n}\r\n","import * as vscode from 'vscode';\r\nimport * as parser from './parser/parser';\r\n\r\nexport class MumpsDocumentSymbolProvider implements vscode.DocumentSymbolProvider {\r\n\r\n\tpublic provideDocumentSymbols(document: vscode.TextDocument): Promise<vscode.SymbolInformation[]> {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tlet parsedDoc = parser.parseText(document.getText());\r\n            let symbols: vscode.SymbolInformation[] = [];\r\n\r\n\t\t\tparsedDoc.methods.forEach(method => {\r\n                let kind = vscode.SymbolKind.Function;\r\n\r\n\t\t\t\tlet startPosition = new vscode.Position(method.id.position.line, 0);\r\n\r\n\t\t\t\tlet endPostionLine = (method.endLine === -1) ? document.lineCount - 1 : method.endLine;\r\n                let endPosition = new vscode.Position(endPostionLine, 0);\r\n\r\n                let methodRange = new vscode.Location(document.uri, new vscode.Range(startPosition, endPosition));\r\n\r\n\t\t\t\tsymbols.push(new vscode.SymbolInformation(method.id.value, kind, '', methodRange));\r\n            });\r\n\r\n\t\t\tresolve(symbols);\r\n\t\t})\r\n\t}\r\n}","import { getTokens, Token, Type } from './tokenizer';\r\n\r\n// Code adapted from the vscode-psl extension by ing-bank\r\n\r\n/**\r\n * Used for checking the type of Member at runtime\r\n */\r\nexport enum MemberClass {\r\n\tmethod = 1,\r\n\tparameter = 2,\r\n\t// property = 3,\r\n\tdeclaration = 4,\r\n\tcolumn = 5,\r\n\ttable = 6,\r\n\tproc = 7,\r\n}\r\n\r\n/**\r\n * A generic type that abstracts Method, Parameter, Declaration, etc\r\n */\r\nexport interface IMember {\r\n\r\n\t/**\r\n\t * The Token representing the name of the member.\r\n\t */\r\n\tid: Token\r\n\r\n\tdocumentation?: string;\r\n}\r\n\r\n/**\r\n * Contains information about a Method\r\n */\r\nexport interface IMethod extends IMember {\r\n\r\n\t/**\r\n\t * The Token of the closing parenthesis after the declaration of all the Method's parameters.\r\n\t */\r\n\tcloseParen: Token\r\n\r\n\t/**\r\n\t * The parameters of the Method, each with their own typing and comment information.\r\n\t */\r\n\tparameters: IParameter[]\r\n\r\n\t/**\r\n\t * The zero-based line where the Method begins\r\n\t */\r\n\tline: number\r\n\r\n\t/**\r\n\t * The last line of the Method, right before the start of a new Method\r\n\t */\r\n\tendLine: number\r\n\r\n\t/**\r\n\t * Next Line of a method implementation\r\n\t */\r\n\tnextLine: number\r\n\r\n\t/**\r\n\t * Previous Line of a method implementation\r\n\t */\r\n\tprevLine: number;\r\n\r\n}\r\n\r\n/**\r\n * Represents a parameter, always belonging to a Method\r\n */\r\nexport interface IParameter extends IMember {\r\n\t/**\r\n\t * The contents of the comment for the parameter, i.e.\r\n\t * ```\r\n\t * public String name(\r\n\t * \t\tString p1 // a comment\r\n\t * \t\t)\r\n\t * ```\r\n\t */\r\n\tcomment: Token\r\n}\r\n\r\n/**\r\n * A type declaration, typically found within a method.\r\n */\r\nexport interface IDeclaration extends IMember {\r\n}\r\n\r\n\r\n/**\r\n * An abstract syntax tree of a PSL document\r\n */\r\nexport interface IParsedDocument {\r\n\r\n\t/**\r\n\t * An array of Declarations that are not contained within a method.\r\n\t * This will be empty for valid Profile 7.6 code but is maintained for compatibility.\r\n\t */\r\n\tdeclarations: IDeclaration[]\r\n\r\n\t/**\r\n\t * An array of the methods in the document\r\n\t */\r\n\tmethods: IMethod[]\r\n\r\n\t/**\r\n\t * All the tokens in the document, for reference.\r\n\t */\r\n\ttokens: Token[]\r\n}\r\n\r\nclass Method implements IMethod {\r\n\r\n\tnextLine: number;\r\n\tprevLine: number;\r\n\tcloseParen: Token;\r\n\tid: Token;\r\n\tparameters: Parameter[]\r\n\tdeclarations: IDeclaration[];\r\n\tline: number;\r\n\tendLine: number;\r\n\tmemberClass: MemberClass;\r\n\tdocumentation: string;\r\n\r\n\tconstructor() {\r\n\t\tthis.parameters = [];\r\n\t\tthis.line = -1;\r\n\t\tthis.declarations = [];\r\n\t\tthis.endLine = -1;\r\n\t\tthis.memberClass = MemberClass.method;\r\n\t\tthis.documentation = '';\r\n\t}\r\n}\r\n\r\nclass Parameter implements IParameter {\r\n\tid: Token\r\n\tcomment: Token\r\n\r\n\tconstructor() { }\r\n}\r\n\r\nexport function parseText(sourceText: string): IParsedDocument {\r\n\tlet parser = new Parser();\r\n\treturn parser.parseDocument(sourceText);\r\n}\r\n\r\nclass Parser {\r\n\r\n\tprivate tokenizer: IterableIterator<Token>;\r\n\tprivate activeToken: Token;\r\n\tprivate methods: Method[];\r\n\tprivate declarations: IDeclaration[];\r\n\tprivate activeMethod: Method;\r\n\tprivate tokens: Token[];\r\n\r\n\tconstructor(tokenizer?: IterableIterator<Token>) {\r\n\t\tthis.methods = [];\r\n\t\tthis.declarations = [];\r\n\t\tthis.tokens = [];\r\n\t\tif (tokenizer) { this.tokenizer = tokenizer; }\r\n\t}\r\n\r\n\tprivate next(): boolean {\r\n\t\tthis.activeToken = this.tokenizer.next().value;\r\n\t\tif (this.activeToken) { this.tokens.push(this.activeToken); }\r\n\t\treturn this.activeToken !== undefined;\r\n\t}\r\n\r\n\tparseDocument(documentText: string): IParsedDocument {\r\n\t\tthis.tokenizer = getTokens(documentText);\r\n\t\twhile (this.next()) {\r\n\t\t\tif (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tlet method = this.parseMethod();\r\n\t\t\t\tif (!method) { continue; }\r\n\t\t\t\tthis.methods.push(method);\r\n\t\t\t\tthis.activeMethod = method;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isTab() || this.activeToken.isSpace()) {\r\n\t\t\t\tlet lineNumber = this.activeToken.position.line;\r\n\t\t\t\tlet tokenBuffer = this.loadTokenBuffer();\r\n\t\t\t\tif (this.activeMethod && this.activeMethod.nextLine === lineNumber) {\r\n\t\t\t\t\tlet documentation = this.checkForDocumentation(tokenBuffer);\r\n\t\t\t\t\tif (documentation) { this.activeMethod.documentation = documentation; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isNewLine()) { continue; }\r\n\t\t\telse { this.throwAwayTokensTil(Type.NewLine); }\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tdeclarations: this.declarations,\r\n\t\t\tmethods: this.methods,\r\n\t\t\ttokens: this.tokens\r\n\t\t}\r\n\t}\r\n\r\n\tprivate checkForDocumentation(tokenBuffer: Token[]): string {\r\n\t\tlet i = 0;\r\n\t\twhile (i < tokenBuffer.length) {\r\n\t\t\tlet token = tokenBuffer[i];\r\n\t\t\tif (token.isSpace() || token.isTab()) {\r\n\t\t\t\ti++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (token.isLineCommentInit() && tokenBuffer[i + 1] && tokenBuffer[i + 1].isLineComment()) {\r\n\t\t\t\treturn tokenBuffer[i + 1].value;\r\n\t\t\t}\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tprivate loadTokenBuffer() {\r\n\t\tlet tokenBuffer: Token[] = []\r\n\t\twhile (this.next() && this.activeToken.type !== Type.NewLine) {\r\n\t\t\ttokenBuffer.push(this.activeToken);\r\n\t\t}\r\n\t\treturn tokenBuffer;\r\n\t}\r\n\r\n\tprivate parseMethod(): Method | undefined {\r\n\t\tlet method: Method = new Method();\r\n\t\tdo {\r\n\t\t\tif (!this.activeToken) { continue; }\r\n\t\t\tif (this.activeToken.isTab() || this.activeToken.isSpace()) { continue; }\r\n\t\t\telse if (this.activeToken.isNewLine()) { break; }\r\n\t\t\telse if (this.activeToken.isOpenParen()) {\r\n\t\t\t\tlet processed = this.processParameters(method);\r\n\t\t\t\tif (!processed) { return undefined; }\r\n\t\t\t\tmethod.parameters = processed;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tif (method.line === -1) {\r\n\t\t\t\t\tmethod.line = this.activeToken.position.line;\r\n\t\t\t\t\tmethod.prevLine = this.activeToken.position.line - 1;\r\n\t\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\t\tmethod.id = this.activeToken;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isLineCommentInit() || this.activeToken.isLineComment()) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.value === '\\r') { continue; }\r\n\t\t\telse if (this.activeToken.isCloseParen()) {\r\n\t\t\t\tif (!method.closeParen) {\r\n\t\t\t\t\tmethod.closeParen = this.activeToken;\r\n\t\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.throwAwayTokensTil(Type.NewLine);\r\n\t\t\t\tif (method.id) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\t\t} while (this.next());\r\n\r\n\t\tif (this.activeMethod) {\r\n\t\t\tthis.activeMethod.endLine = method.id.position.line - 1;\r\n\t\t}\r\n\t\tthis.activeMethod = method;\r\n\t\treturn method;\r\n\t}\r\n\r\n\tprivate processParameters(method: Method): Parameter[] | undefined {\r\n\t\tlet args: Parameter[] = [];\r\n\t\tlet param: Parameter | undefined;\r\n\t\tlet open = false;\r\n\t\twhile (this.next()) {\r\n\t\t\tif (this.activeToken.isTab() || this.activeToken.isSpace() || this.activeToken.isNewLine()) { continue; }\r\n\t\t\telse if (this.activeToken.isOpenParen()) {\r\n\t\t\t\topen = true;\r\n\t\t\t\tif (!param) { return undefined; }\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isCloseParen()) {\r\n\t\t\t\topen = false;\r\n\t\t\t\tmethod.closeParen = this.activeToken;\r\n\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\tif (!param) { break; }\r\n\t\t\t\targs.push(param);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tif (!param) { param = new Parameter(); }\r\n\t\t\t\tparam.id = this.activeToken;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isLineComment()) {\r\n\t\t\t\tif (param) {\r\n\t\t\t\t\tparam.comment = this.activeToken\r\n\t\t\t\t}\r\n\t\t\t\telse if (args.length >= 1) {\r\n\t\t\t\t\targs[args.length - 1].comment = this.activeToken;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isComma()) {\r\n\t\t\t\tif (!param) { return undefined; }\r\n\t\t\t\targs.push(param)\r\n\t\t\t\tparam = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (open) { return undefined; }\r\n\t\treturn args;\r\n\t}\r\n\r\n\tprivate throwAwayTokensTil(type: Type) {\r\n\t\tdo { } while (this.next() && this.activeToken.type !== type)\r\n\t}\r\n\r\n}","import { Position, Range } from \"vscode\";\r\n\r\n// Code adapted from the vscode-psl extension by ing-bank\r\n\r\nexport function* getTokens(documentContents: string): IterableIterator<Token> {\r\n\tlet tokenizer: Tokenizer = new Tokenizer()\r\n\r\n\tfor (let char of documentContents) {\r\n\t\ttokenizer.charType = getType(char);\r\n\t\tif (tokenizer.tokenType === 0) {\r\n\t\t\ttokenizer.tokenType = tokenizer.charType;\r\n\t\t}\r\n\t\twhile (!tokenizer.parsed) {\r\n\t\t\tif (tokenizer.parseCharacter(char)) {\r\n\t\t\t\tyield tokenizer.finalizedToken;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttokenizer.parsed = false;\r\n\t}\r\n\r\n\t// if there is an unfinished token left\r\n\tif (tokenizer.tokenType !== 0) {\r\n\t\ttokenizer.finalizeToken(0);\r\n\t\tyield tokenizer.finalizedToken;\r\n\t}\r\n}\r\n\r\nexport class Token {\r\n\ttype: Type;\r\n\tvalue: string;\r\n\tposition: Position;\r\n\r\n\tconstructor(type: Type, value: string, position: Position) {\r\n\t\tthis.type = type;\r\n\t\tthis.value = value;\r\n\t\tthis.position = position;\r\n\t}\r\n\r\n\tgetRange() {\r\n\t\tlet start: Position = this.position;\r\n\t\tlet end: Position = new Position(this.position.line, this.position.character + this.value.length);\r\n\t\treturn new Range(start, end);\r\n\t}\r\n\r\n\tisAlphanumeric() {\r\n\t\treturn this.type === Type.Alphanumeric;\r\n\t}\r\n\r\n\tisCloseParen() {\r\n\t\treturn this.type === Type.CloseParen;\r\n\t}\r\n\r\n\tisComma() {\r\n\t\treturn this.type === Type.Comma;\r\n\t}\r\n\r\n\tisLineComment() {\r\n\t\treturn this.type === Type.LineComment;\r\n\t}\r\n\r\n\tisLineCommentInit() {\r\n\t\treturn this.type === Type.LineCommentInit;\r\n\t}\r\n\r\n\tisNewLine() {\r\n\t\treturn this.type === Type.NewLine;\r\n\t}\r\n\r\n\tisNumeric() {\r\n\t\treturn this.type === Type.Numeric;\r\n\t}\r\n\r\n\tisOpenParen() {\r\n\t\treturn this.type === Type.OpenParen;\r\n\t}\r\n\r\n\tisSpace() {\r\n\t\treturn this.type === Type.Space;\r\n\t}\r\n\r\n\tisTab() {\r\n\t\treturn this.type === Type.Tab;\r\n\t}\r\n\r\n\tisWhiteSpace() {\r\n\t\treturn this.type === Type.Space || this.type === Type.Tab || this.type === Type.NewLine || this.type === Type.Undefined;\r\n\t}\r\n}\r\n\r\nclass Tokenizer {\r\n\tdocumentLine: number;\r\n\tdocumentColumn: number;\r\n\r\n\tcharType: number;\r\n\ttokenType: number;\r\n\ttokenValue: string;\r\n\ttokenPosition: Position;\r\n\tfinalizedToken: Token;\r\n\r\n\tparsed: boolean\r\n\tstringOpen: boolean;\r\n\tfirstSlash: boolean;\r\n\tasterisk: boolean;\r\n\r\n\tconstructor() {\r\n\t\tthis.documentLine = 0;\r\n\t\tthis.documentColumn = 0;\r\n\r\n\t\tthis.charType = 0;\r\n\t\tthis.tokenType = 0;\r\n\t\tthis.tokenValue = '';\r\n\t\tthis.tokenPosition = new Position(this.documentLine, this.documentColumn);\r\n\r\n\t\tthis.parsed = false;\r\n\t\tthis.stringOpen = false;\r\n\t\tthis.firstSlash = false;\r\n\t\tthis.asterisk = false;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param char current character being parsed\r\n\t * @returns true if token is finalized\r\n\t */\r\n\tparseCharacter(char: string): boolean {\r\n\t\tif (this.tokenType === Type.Alphanumeric) {\r\n\t\t\tif (this.charType === Type.Alphanumeric || this.charType === Type.Numeric) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(this.charType);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.Numeric) {\r\n\t\t\tif (this.charType === Type.Numeric) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(this.charType);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.LineComment) {\r\n\t\t\tif (this.charType !== Type.NewLine) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(Type.NewLine);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.String) {\r\n\t\t\tif (this.charType !== Type.DoubleQuotes) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(Type.DoubleQuotes);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.LineCommentInit) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tthis.finalizeToken(Type.LineComment);\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.SemiColon) {\r\n\t\t\tthis.tokenType = Type.LineCommentInit;\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.DoubleQuotes) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tif (this.stringOpen) {\r\n\t\t\t\tthis.stringOpen = false;\r\n\t\t\t\tthis.finalizeToken(0);\r\n\t\t\t} else {\r\n\t\t\t\tthis.stringOpen = true;\r\n\t\t\t\tthis.finalizeToken(Type.String);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.NewLine) {\r\n\t\t\tthis.tokenValue = this.tokenValue + char;\r\n\t\t\tthis.parsed = true;\r\n\t\t\tthis.documentLine++;\r\n\t\t\tthis.documentColumn = 0;\r\n\t\t\tthis.finalizeToken(0);\r\n\t\t\treturn true;\r\n\t\t} else if ((this.tokenType > 10) || (this.tokenType === -1)) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tthis.finalizeToken(0);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tupdateTokenAndAdvanceCursor(char: string) {\r\n\t\tthis.tokenValue = this.tokenValue + char;\r\n\t\tthis.parsed = true;\r\n\t\tthis.documentColumn++;\r\n\t}\r\n\r\n\tfinalizeToken(newType: number): void {\r\n\t\tthis.finalizedToken = new Token(this.tokenType, this.tokenValue, this.tokenPosition);\r\n\t\tthis.tokenType = newType;\r\n\t\tthis.tokenValue = '';\r\n\t\tthis.tokenPosition = new Position(this.documentLine, this.documentColumn);\r\n\t}\r\n}\r\n\r\nfunction getType(c: string): Type {\r\n\tlet charCode: number = c.charCodeAt(0);\r\n\tif (charCode >= 65 && charCode <= 90 || charCode >= 97 && charCode <= 122 || charCode === 37) {\r\n\t\treturn Type.Alphanumeric;\r\n\t} else if (charCode >= 48 && charCode <= 57) {\r\n\t\treturn Type.Numeric;\r\n\t} else if (charCode === 34) {\r\n\t\treturn Type.DoubleQuotes;\r\n\t} else if (charCode === 9) {\r\n\t\treturn Type.Tab;\r\n\t} else if (charCode === 10) {\r\n\t\treturn Type.NewLine;\r\n\t} else if (charCode === 32) {\r\n\t\treturn Type.Space;\r\n\t} else if (charCode === 33) {\r\n\t\treturn Type.ExclamationMark;\r\n\t} else if (charCode === 35) {\r\n\t\treturn Type.NumberSign;\r\n\t} else if (charCode === 36) {\r\n\t\treturn Type.DollarSign;\r\n\t\t// } else if (charCode === 37) {\r\n\t\t// \treturn Type.PercentSign;\r\n\t} else if (charCode === 38) {\r\n\t\treturn Type.Ampersand;\r\n\t} else if (charCode === 39) {\r\n\t\treturn Type.SingleQuote;\r\n\t} else if (charCode === 40) {\r\n\t\treturn Type.OpenParen;\r\n\t} else if (charCode === 41) {\r\n\t\treturn Type.CloseParen;\r\n\t} else if (charCode === 42) {\r\n\t\treturn Type.Asterisk;\r\n\t} else if (charCode === 43) {\r\n\t\treturn Type.PlusSign;\r\n\t} else if (charCode === 44) {\r\n\t\treturn Type.Comma;\r\n\t} else if (charCode === 45) {\r\n\t\treturn Type.MinusSign;\r\n\t} else if (charCode === 46) {\r\n\t\treturn Type.Period;\r\n\t} else if (charCode === 58) {\r\n\t\treturn Type.Colon;\r\n\t} else if (charCode === 59) {\r\n\t\treturn Type.SemiColon;\r\n\t} else if (charCode === 60) {\r\n\t\treturn Type.LessThan;\r\n\t} else if (charCode === 61) {\r\n\t\treturn Type.EqualSign;\r\n\t} else if (charCode === 62) {\r\n\t\treturn Type.GreaterThan;\r\n\t} else if (charCode === 63) {\r\n\t\treturn Type.QuestionMark;\r\n\t} else if (charCode === 64) {\r\n\t\treturn Type.AtSymbol;\r\n\t} else if (charCode === 91) {\r\n\t\treturn Type.OpenBracket;\r\n\t} else if (charCode === 92) {\r\n\t\treturn Type.Backslash;\r\n\t} else if (charCode === 93) {\r\n\t\treturn Type.CloseBracket;\r\n\t} else if (charCode === 94) {\r\n\t\treturn Type.Caret;\r\n\t} else if (charCode === 95) {\r\n\t\treturn Type.Underscore;\r\n\t} else if (charCode === 96) {\r\n\t\treturn Type.BackQuote;\r\n\t} else if (charCode === 123) {\r\n\t\treturn Type.OpenBrace;\r\n\t} else if (charCode === 124) {\r\n\t\treturn Type.Pipe;\r\n\t} else if (charCode === 125) {\r\n\t\treturn Type.CloseBrace;\r\n\t} else if (charCode === 126) {\r\n\t\treturn Type.Tilde;\r\n\t}\r\n\r\n\telse {\r\n\t\treturn -1;\r\n\t}\r\n}\r\n\r\nexport const enum Type {\r\n\tAlphanumeric = 1,\r\n\tNumeric = 2,\r\n\tLineComment = 3,\r\n\tBlockComment = 4,\r\n\tString = 5,\r\n\tLineCommentInit = 6,\r\n\tDoubleQuotes = 9,\r\n\r\n\tTab = 11,\r\n\tNewLine = 13,\r\n\tSpace = 32,\r\n\r\n\tExclamationMark = 33,\r\n\tNumberSign = 35,\r\n\tDollarSign = 36,\r\n\tAmpersand = 38,\r\n\tSingleQuote = 39,\r\n\tOpenParen = 40,\r\n\tCloseParen = 41,\r\n\tAsterisk = 42,\r\n\tPlusSign = 43,\r\n\tComma = 44,\r\n\tMinusSign = 45,\r\n\tPeriod = 46,\r\n\tColon = 58,\r\n\tSemiColon = 59,\r\n\tLessThan = 60,\r\n\tEqualSign = 61,\r\n\tGreaterThan = 62,\r\n\tQuestionMark = 63,\r\n\tAtSymbol = 64,\r\n\tOpenBracket = 91,\r\n\tBackslash = 92,\r\n\tCloseBracket = 93,\r\n\tCaret = 94,\r\n\tUnderscore = 95,\r\n\tBackQuote = 96,\r\n\tOpenBrace = 123,\r\n\tPipe = 124,\r\n\tCloseBrace = 125,\r\n\tTilde = 126,\r\n\r\n\tUndefined = -1\r\n}","import * as vscode from 'vscode';\r\nconst fs = require('fs');\r\n\r\n//let Location = vscode.Location;\r\n//let Position = vscode.Position;\r\ninterface ItemHint {\r\n\tlineStatus: string,\r\n\tstartstring: string\r\n}\r\ninterface LabelItem {\r\n\troutine: string,\r\n\tlabel: string,\r\n\tline: string\r\n}\r\ninterface DbItem {\r\n\tlabels: LabelItem[],\r\n\troutines: {}\r\n}\r\nexport class CompletionItemProvider {\r\n\t/**\r\n * Provides the completion items for the supplied words.\r\n *\r\n * @param {TextDocument} document\r\n * @param {Position} position\r\n * @param {CancellationToken} token\r\n * @returns\r\n */\r\n\tprivate _labelsReady: boolean;\r\n\tprivate _labelDB: DbItem;\r\n\tprivate _filesToCheck: number;\r\n\tprivate _dbfile: string;\r\n\tconstructor(labeldb: string) {\r\n\t\tthis._labelsReady = false;\r\n\t\tthis._dbfile = labeldb;\r\n\t\tthis._refreshLabelDB();\r\n\t}\r\n\tprovideCompletionItems(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken) {\r\n\t\t//let word = document.getText(document.getWordRangeAtPosition(position));\r\n\t\tlet line = document.getText(new vscode.Range(new vscode.Position(position.line, 0), position))\r\n\t\tlet status = getLineStatus(line, position.character);\r\n\t\tlet clean: Array<vscode.CompletionItem> = [];\r\n\r\n\t\tif (this._labelsReady && status.lineStatus === 'jumplabel' && status.startstring.length > 1) {\r\n\t\t\tlet replaceRange=new vscode.Range(new vscode.Position(position.line,position.character-status.startstring.length),position)\r\n\t\t\tclean = this._findLabel(status.startstring, clean, replaceRange);\r\n\t\t}\r\n\t\treturn clean;\r\n\t}\r\n\tprivate _refreshLabelDB() { // Look for all Labels in .m-Routines and them + Comments\r\n\t\tif (!fs.existsSync(this._dbfile)) {\r\n\t\t\tlet db = {\r\n\t\t\t\tlabels: [{ routine: '', label: '' }],\r\n\t\t\t\troutines: {}\r\n\t\t\t}\r\n\t\t\tfs.writeFileSync(this._dbfile, JSON.stringify(db));\r\n\t\t}\r\n\t\tfs.readFile(this._dbfile, (err, data) => {\r\n\t\t\tif (!err) {\r\n\t\t\t\tthis._labelDB = JSON.parse(data);\r\n\t\t\t\tlet dbChanged = false;\r\n\t\t\t\tvscode.workspace.findFiles('*.m').then((files) => {\r\n\t\t\t\t\tthis._filesToCheck = files.length;\r\n\t\t\t\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\t\t\t\tlet path = files[i].fsPath;\r\n\t\t\t\t\t\t\tfs.stat(path, false, (err, stats) => {\r\n\t\t\t\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\t\t\t\tlet ms = this._labelDB.routines[path];\r\n\t\t\t\t\t\t\t\t\tif (ms === undefined || stats.mtimeMs > ms) {\r\n\t\t\t\t\t\t\t\t\t\tthis._labelDB.routines[path] = stats.mtimeMs;\r\n\t\t\t\t\t\t\t\t\t\tdbChanged = true;\r\n\t\t\t\t\t\t\t\t\t\tif (stats.size < 50000) {  //parse only Files <50K\r\n\t\t\t\t\t\t\t\t\t\t\tthis._refreshFileLabels(path);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._labelsReady = true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tprivate _checkReady(dbChanged: boolean) {\t// Check if all .m Files are processed and save LabelDB then\r\n\t\tif (--this._filesToCheck === 0) {\r\n\t\t\tif (dbChanged) {\r\n\t\t\t\tfs.writeFile(this._dbfile, JSON.stringify(this._labelDB), (err) => {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tvscode.window.showErrorMessage(\"Error writing Label DB\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate _refreshFileLabels(path) {  // Refresh all Labels of a changed .m File\r\n\t\tlet routine = path.replace('\\\\', '/').split('/').pop();\r\n\t\troutine = routine!.split('.')[0].replace('_', '%');\r\n\t\tfs.readFile(path, 'utf8',(err,content)=>{\r\n\t\t\tif (!err) {\r\n\t\t\t\tlet lines=content.split('\\n');\r\n\t\t\t\tlet label = '';\r\n\t\t\t\tthis._labelDB.labels = this._labelDB.labels.filter((label) => {\r\n\t\t\t\t\treturn label.routine !== routine;\r\n\t\t\t\t})\r\n\t\t\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\t\t\tif (i===0) {\r\n\t\t\t\t\t\tthis._labelDB.labels.push({label:'*FL',routine,line:lines[0]});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (label = lines[i].match(/^[%A-Za-z0-9][A-Za-z0-9]{0,31}/)) {\r\n\t\t\t\t\t\tthis._labelDB.labels.push({ label: label[0], routine, line: lines[i] })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._checkReady(true);\r\n\t\t});\r\n\t}\r\n\tprivate _findLabel(startstring, list: Array<vscode.CompletionItem>, replaceRange:vscode.Range) {\r\n\t\t//let hits = 0;\r\n\t\tlet hitlist: LabelItem[];\r\n\t\tlet sortText='';\r\n\t\tif (startstring.charAt(0) === '^') {\r\n\t\t\tlet suchstring = startstring.substring(1);\r\n\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\treturn item.routine.startsWith(suchstring);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (startstring.indexOf('^')!==-1) {\r\n\t\t\t\tlet label=startstring.split('^')[0];\r\n\t\t\t\tlet routinepart=startstring.split('^')[1];\r\n\t\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\t\tlet fits = item.label===label && item.routine.startsWith(routinepart);\r\n\t\t\t\t\treturn fits;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\t\tlet fits = item.label.startsWith(startstring);\r\n\t\t\t\t\treturn fits;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < hitlist.length; i++) {\r\n\t\t\tlet item = hitlist[i];\r\n\t\t\tlet label = item.label + '^' + item.routine;\r\n\t\t\tif (label === startstring ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (item.label===\"*FL\") {\r\n\t\t\t\tif (!startstring.startsWith('^')) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlabel='^'+item.routine;\r\n\t\t\t\tsortText=\"100\";\r\n\t\t\t}\r\n\t\t\tlet detail = ''\r\n\t\t\tif (item.line.charAt(item.label.length) === '(') {\r\n\t\t\t\tif (item.line.indexOf(')') !== -1) {\r\n\t\t\t\t\tdetail = item.line.split(')')[0] + ')';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item.line.indexOf(';') !== -1) {\r\n\t\t\t\tdetail += item.line.substring(item.line.indexOf(';') + 1);\r\n\t\t\t}\r\n\t\t\tif (detail.length>0 && sortText!=='100') {sortText='099';}\r\n\t\t\tlist.push({ label, detail, sortText, range:replaceRange });\r\n\t\t}\r\n\t\treturn list;\r\n\t}\r\n}\r\nfunction getLineStatus(line: string | undefined, position: number): ItemHint {\r\n\tlet lineStatus = 'lineStart';\r\n\tlet lookPosition = 0;\r\n\tlet lastCommand = '';\r\n\tlet startstring = '';\r\n\tlet isInsidePostcond = false;\r\n\tif (line) {\r\n\t\twhile (lookPosition < position) {\r\n\t\t\tlet char = line.substring(lookPosition, ++lookPosition);\r\n\t\t\tlet isWhiteSpace = (char === \" \" || char === \"\\t\");\r\n\t\t\tlet isBeginOfVariable = char.match(/[A-Za-z%^]/);\r\n\t\t\tlet isAlphaChar = char.match(/[A-Za-z]/);\r\n\t\t\t//let isAlphanumeric=char.match(/[A-Za-z0-9%]/);\r\n\t\t\t//let isOperand = char.match(/[*+-/\\[\\]']/);\r\n\t\t\tif (lineStatus !== 'string' && char === ';') {\r\n\t\t\t\treturn { lineStatus: 'comment', startstring: '' };\r\n\t\t\t}\r\n\t\t\tif (!isBeginOfVariable) {\r\n\t\t\t\tif (startstring !== '' && char.match(/[0-9]/)) {\r\n\t\t\t\t\tstartstring += char\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstartstring = '';\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartstring += char;\r\n\t\t\t}\r\n\t\t\tswitch (lineStatus) {\r\n\t\t\t\tcase 'argument': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t\tif (lastCommand.match(/[D|DO|G|GOTO|J|JOB]/i)) {\r\n\t\t\t\t\t\t\t\tlineStatus = 'jumplabel'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (char === '\"') {\r\n\t\t\t\t\t\tlineStatus = 'string';\r\n\t\t\t\t\t} else if (isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'variable';\r\n\t\t\t\t\t} else if (char === \"$\") {\r\n\t\t\t\t\t\tlineStatus = 'function';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'command': {\r\n\t\t\t\t\tif (char === \":\") {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\tisInsidePostcond = true;\r\n\t\t\t\t\t} else if (isAlphaChar) {\r\n\t\t\t\t\t\tlastCommand += char;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\tif (lastCommand.match(/[D|DO|G|GOTO|J|JOB]/i)) {\r\n\t\t\t\t\t\t\tlineStatus = 'jumplabel'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlineStatus = 'error';\r\n\t\t\t\t\t\treturn { lineStatus: 'error', startstring: '' };\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'function': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (char === \"$\") {\r\n\t\t\t\t\t\tlineStatus = 'jumplabel';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'jumplabel': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t} else if (char === \":\") {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t} else if (char===\"(\") {\r\n\t\t\t\t\t\tlineStatus='argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'label': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t} else if (char = '(') {\r\n\t\t\t\t\t\tlineStatus = 'variable';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'lineStart': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlineStatus = 'label';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'string': {\r\n\t\t\t\t\tif (char === '\"') {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'variable': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (!isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn { lineStatus, startstring };\r\n}\r\n","import * as vscode from 'vscode';\r\nlet em = require('emcellent');\r\n//let tabSize = vscode.workspace.getConfiguration().get(\"editor.tabSize\")\r\n//var prevfin = true;\r\n\r\nasync function autoSpaceEnter() {\r\n\t//await vscode.commands.executeCommand(\"acceptSelectedSuggestion\");\r\n\tlet editor = vscode.window.activeTextEditor\r\n\tif (editor) {\r\n\t\tlet pos = editor.selection.active\r\n\t\tlet currentLine = editor.document.lineAt(pos.line).text;\r\n\t\tlet parsed = em.parse(currentLine);\r\n\t\tlet newLine = '';\r\n\t\tif (pos.character !== 0) {\r\n\t\t\t//check for removing a trailing .\r\n\t\t\tif ((parsed[0].lineRoutines === undefined || parsed[0].lineRoutines.length === 0) && currentLine.indexOf(\";\") === -1 && parsed[0].lineIndentationArray !== undefined && parsed[0].lineIndentationArray.length > 0) {\r\n\t\t\t\tparsed[0].lineIndentationArray.splice(-1)\r\n\t\t\t\teditor.edit((editBuilder) => {\r\n\t\t\t\t\teditBuilder.replace(new vscode.Range(pos.with(pos.line, 0), pos.with(pos.line, currentLine.length)), em.render(parsed))\r\n\t\t\t\t})\r\n\t\t\t\t//check for adding indentation to the new line\r\n\t\t\t} else {\r\n\t\t\t\tif (parsed[0].lineIndentationArray === undefined) {\r\n\t\t\t\t\tparsed[0].lineIndentationArray = []\r\n\t\t\t\t}\r\n\t\t\t\tif (lineContainsNoParamDo(parsed[0])) {\r\n\t\t\t\t\tparsed[0].lineIndentationArray.push(\" \")\r\n\t\t\t\t}\r\n\t\t\t\tparsed[0].lineRoutines = []\r\n\t\t\t\tdelete parsed[0].lineComment\r\n\t\t\t\tdelete parsed[0].lineLabel\r\n\t\t\t\tnewLine = em.render(parsed);\r\n\t\t\t}\r\n\t\t}\r\n\t\teditor.edit((editBuilder) => {\r\n\t\t\teditBuilder.insert(pos, \"\\n\" + newLine);\r\n\t\t})\r\n\t}\r\n}\r\n\r\nfunction lineContainsNoParamDo(parsed) {\r\n\tlet cmds = parsed.lineRoutines;\r\n\tif (cmds = parsed.lineRoutines) {\r\n\t\tfor (let i = 0; i < cmds.length; i++) {\r\n\t\t\tif (cmds[i].mRoutine.match(/(d|do)/i) && !cmds[i].mArguments) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nasync function autoSpaceTab() {\r\n\r\n\tlet editor = vscode.window.activeTextEditor\r\n\tif (editor) {\r\n\t\tlet pos = editor.selection.active\r\n\t\tlet currentLine = editor.document.lineAt(pos.line).text;\r\n\t\tlet parsed = em.parse(currentLine);\r\n\r\n\t\t//vscode.commands.executeCommand(\"acceptSelectedSuggestion\").then((test)=>{\r\n\t\t//\tconsole.log(test);\r\n\t\t//});\r\n\r\n\t\tif ((parsed[0].lineRoutines === undefined || parsed[0].lineRoutines.length === 0) &&\r\n\t\t\tcurrentLine.indexOf(\";\") === -1 && parsed[0].lineIndentationArray !== undefined &&\r\n\t\t\tparsed[0].lineIndentationArray.length > 0) {\r\n\t\t\tparsed[0].lineIndentationArray.push(\" \")\r\n\t\t\teditor.edit((editBuilder) => {\r\n\t\t\t\tif (currentLine.charAt(pos.character - 1) === \" \") {\r\n\t\t\t\t\teditBuilder.insert(pos.with(pos.line, pos.character), \". \")\r\n\t\t\t\t} else {\r\n\t\t\t\t\teditBuilder.insert(pos.with(pos.line, pos.character), \" . \")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\teditor.edit((eb) => {\r\n\t\t\t\teb.insert(pos, \"\\t\")\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { autoSpaceTab, autoSpaceEnter };","\"use strict\";\n\nvar parser = require('./lib/parse.js');\nvar renderer = require('./lib/render.js');\n\nfunction parseLine(inputString) {\n\n    var tmpObject = {};\n\n    //Parsing must be performed sequentially.\n    tmpObject = parser.extractLabel(inputString, tmpObject);\n    tmpObject = parser.extractComment(tmpObject.lineExpression, tmpObject);\n    tmpObject = parser.extractIndentation(tmpObject.lineExpression, tmpObject);\n    tmpObject = parser.extractRoutines(tmpObject.lineExpression, tmpObject);\n\n    //Line Expression is no longer needed.\n    delete tmpObject.lineExpression;\n    return tmpObject;\n}\n\nfunction renderLine(inputObject) {\n\n    var tmpLine = \"\";\n\n    //Rendering must be performed sequentially.\n    tmpLine = renderer.appendLabel(inputObject, tmpLine);\n    tmpLine = renderer.appendIndentation(inputObject, tmpLine);\n    tmpLine = renderer.appendRoutines(inputObject, tmpLine);\n    tmpLine = renderer.appendComment(inputObject, tmpLine);\n\n    return tmpLine;\n\n}\n\nfunction parse(inputString) {\n\n    //Strip out carriage returns.\n    inputString = inputString.replace(\"\\r\", \"\");\n    var inputArray = inputString.split('\\n');\n    var returnArray = [];\n\n    for (var i = 0; i < inputArray.length; i++) {\n        var tmpLineObject = parseLine(inputArray[i]);\n        tmpLineObject.lineNumber = i + 1;\n        returnArray.push(tmpLineObject);\n    }\n    return returnArray;\n}\n\nfunction render(inputObject) {\n\n    var response = \"\";\n    var parseArray = [];\n\n    if (!Array.isArray(inputObject)) {\n        parseArray.push(inputObject);\n    } else {\n        parseArray = inputObject;\n    }\n\n    for (var i = 0; i < parseArray.length; i++) {\n        var tmpLine = renderLine(parseArray[i]);\n        if (i === (parseArray.length - 1)) {\n            response = response + tmpLine;\n        } else {\n            response = response + tmpLine + \"\\n\";\n        }\n    }\n\n    return response;\n\n}\n\nmodule.exports.parse = parse;\nmodule.exports.render = render;\n","\"use strict\";\n\n//Extract Labels and Lead Spacing.\nfunction extractLabel(inputLine, inputObject) {\n\n    for (var i = 0; i <= inputLine.length; i++) {\n        if (inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\n            //If no leading chars, label.\n            if (i === 0) {\n                inputObject.lineLabel = inputLine.split(/[ \\t]/, 1)[0];\n                for (var ii = inputObject.lineLabel.length; ii <= inputLine.length; ii++) {\n                    //After label spacing.\n                    if (inputLine[ii] !== \" \" && inputLine[ii] !== \"\\t\") {\n                        inputObject.lineLeadSpace = inputLine.substring(inputObject.lineLabel.length, ii);\n                        inputObject.lineExpression = inputLine.substring(ii);\n                        break;\n                    }\n                    //After label spacing for empty lines.\n                    if (ii === (inputLine.length - 1)) {\n                        inputObject.lineLeadSpace = inputLine.substring(inputObject.lineLabel.length);\n                        inputObject.lineExpression = \"\";\n                        break;\n                    }\n                }\n                break;\n                //Unlabeled spacing with code.\n            } else {\n                inputObject.lineLeadSpace = inputLine.substring(0, i);\n                inputObject.lineExpression = inputLine.substring(i);\n                break;\n            }\n        }\n        //Unlabeled spacing without code.\n        if (i === (inputLine.length - 1)) {\n            inputObject.lineLeadSpace = inputLine;\n            inputObject.lineExpression = \"\";\n            break;\n        }\n    }\n    return inputObject;\n}\n\n//Extract Comments.\nfunction extractComment(inputLine, inputObject) {\n\n    //Semicolon identifies comments.\n    if (inputLine.search(\";\") >= 0) {\n        for (var i = 0; i < inputLine.length; i++) {\n            if (inputLine[i] === \";\") {\n                //Check if semicolon is double quoted.\n                if ((inputLine.substring(0, i).split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 !== 0)) {\n                    inputObject.lineExpression = inputLine.substring(0, i);\n                    inputObject.lineComment = inputLine.substring(i).substring(1);\n                    break;\n                } else {\n                    //Check if semicolon has only trailing quote.\n                    if (((inputLine.substring(0, i).replace(\"\").split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 === 0))) {\n                        inputObject.lineExpression = inputLine.substring(0, i);\n                        inputObject.lineComment = inputLine.substring(i).substring(1);\n                        break;\n                    }\n                    //If only quoted semicolons, set expression.\n                    inputObject.lineExpression = inputLine;\n                }\n            }\n        }\n        return inputObject;\n        //If no comments, set expression.\n    } else {\n        inputObject.lineExpression = inputLine;\n        return inputObject;\n    }\n}\n\n//Extract Indentation.\n//Assumes inputLine has extracted comments/spacing.\nfunction extractIndentation(inputLine, inputObject) {\n\n    var lineIndentationArray = [];\n    var lineIndentation = 0;\n    var tmpPosStart = 0;\n    var tmpPosEnd = 0;\n\n    for (var i = 0; i <= inputLine.length; i++) {\n        //Period identifies indentation.\n        if (inputLine[i] === \".\") {\n            //Second period identifies sub-indentation, push to array.\n            if (lineIndentation !== 0) {\n                tmpPosEnd = i;\n                lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n            }\n            //Flag start position and presence.\n            tmpPosStart = i + 1;\n            lineIndentation++;\n        } else {\n            //End of indentation with code.\n            if (inputLine[i] !== \".\" && inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\n                //Make sure a period was found.\n                if (lineIndentation !== 0) {\n                    tmpPosEnd = i;\n                    lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n                    inputObject.lineExpression = inputLine.substring(i);\n                }\n                break;\n            }\n            //End of indentation without code.\n            if (i === (inputLine.length - 1)) {\n                tmpPosEnd = i + 1;\n                lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n                inputObject.lineExpression = inputLine.substring(i + 1);\n                break;\n            }\n        }\n    }\n    //Only assign array if present.\n    if (lineIndentationArray.length > 0) {\n        inputObject.lineIndentationArray = lineIndentationArray;\n    } else {\n        inputObject.lineExpression = inputLine;\n    }\n    return inputObject;\n}\n\n//Divide routines and arguments into array, used by extractRoutines.\nfunction splitRoutinesAndArguments(inputLine) {\n\n    var lineCommands = [];\n    var tmpCursor = 0;\n\n    for (var i = 0; i <= inputLine.length; i++) {\n\n        //Flag spaces/tabs as dividers.\n        if (inputLine[i] === \" \" || inputLine[i] === \"\\t\") {\n            //Ensure space isn't quoted.\n            if ((inputLine.substring(0, i).split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 !== 0)) {\n                //If has content, push.\n                if (inputLine.substring(tmpCursor, i).length > 0) {\n                    lineCommands.push(inputLine.substring(tmpCursor, i));\n                    //Otherwise, push empty commands.\n                } else if (inputLine.substring(tmpCursor, i).length === 0 && (inputLine.substring(tmpCursor - 1, tmpCursor) === \" \" || inputLine.substring(tmpCursor - 1, tmpCursor) === \"\\t\")) {\n                    lineCommands.push(inputLine.substring(tmpCursor, i));\n                }\n                tmpCursor = i + 1;\n            }\n            //Flag splits at line end.\n        } else if (i === inputLine.length) {\n            //If has content, push.\n            if (inputLine.substring(tmpCursor, i).length > 0) {\n                lineCommands.push(inputLine.substring(tmpCursor, i));\n                //Gather empty commands from end of line.\n            } else if (i === tmpCursor && (inputLine.substring(i - 1, i) === \" \" || inputLine.substring(i - 1, i) === \"/t\")) {\n                lineCommands.push('');\n            }\n            //tmpCursor = 0;\n        }\n    }\n    return lineCommands;\n}\n\n//Extracts Post-Conditionals from Routines, used by extractRoutines.\nfunction extractPostConditional(inputObject) {\n\n    //Assign to new variable to truncate Routines.\n    var tmpObject = inputObject;\n    for (var i = 0; i < tmpObject.length; i++) {\n        if (tmpObject[i].mRoutine) {\n            //Semicolon indicates Post-Conditionals.\n            var tmpIndex = tmpObject[i].mRoutine.indexOf(\":\");\n            if (tmpIndex > -1) {\n                tmpObject[i].mPostConditional = tmpObject[i].mRoutine.substring(tmpIndex + 1);\n                tmpObject[i].mRoutine = tmpObject[i].mRoutine.substring(0, tmpIndex);\n            }\n        }\n    }\n    return tmpObject;\n}\n\n//Extract Routines.\n//Assumes inputLine has extracted comments/spacing/indentation.\nfunction extractRoutines(inputLine, inputObject) {\n\n    var tmpFunction = {};\n    var tmpFunctionArray = [];\n\n    //Divide Routines and Arguments.\n    var splitLine = splitRoutinesAndArguments(inputLine);\n\n    //Loop, even is function, odd is arguments.\n    var i = 0;\n    while (i < splitLine.length) {\n\n        if (i % 2 === 0) {\n            tmpFunction.mRoutine = splitLine[i];\n        } else {\n\n            tmpFunction.mArguments = splitLine[i];\n\n            //Custom handler for trailing argument spacing.\n            //Go until splitline hits a non empty val.\n            var ii = i + 1;\n            while (ii < splitLine.length) {\n                if (splitLine[ii] === \"\") {\n                    splitLine.splice(ii, 1);\n                    tmpFunction.mArguments = tmpFunction.mArguments + \" \";\n                } else {\n                    break;\n                }\n            }\n\n            tmpFunctionArray.push(tmpFunction);\n            tmpFunction = {};\n\n        }\n\n        //Last command doesn't always require parameter, so if odd number of pairs, push it.\n        if (splitLine.length % 2 !== 0 && splitLine.length > 0 && i === (splitLine.length - 1)) {\n            tmpFunction.mRoutine = splitLine[i];\n            tmpFunctionArray.push(tmpFunction);\n            tmpFunction = {};\n        }\n\n        i++;\n\n    }\n\n    //Extract and output Post Conditionals.\n    var postConditionFunctionArray = extractPostConditional(tmpFunctionArray);\n    if (postConditionFunctionArray.length > 0) {\n        inputObject.lineRoutines = postConditionFunctionArray;\n    }\n    return inputObject;\n}\n\n//Export all routines.\nmodule.exports.extractLabel = extractLabel;\nmodule.exports.extractComment = extractComment;\nmodule.exports.extractIndentation = extractIndentation;\nmodule.exports.splitRoutinesAndArguments = splitRoutinesAndArguments;\nmodule.exports.extractPostConditional = extractPostConditional;\nmodule.exports.extractRoutines = extractRoutines;\n","\"use strict\";\n\n//Append Line Label and Lead Spacing.\nfunction appendLabel(inputObject, inputLine) {\n    if (inputObject.lineLabel) {\n        inputLine = inputLine + inputObject.lineLabel;\n    }\n    if (inputObject.lineLeadSpace) {\n        inputLine = inputLine + inputObject.lineLeadSpace;\n    }\n    return inputLine;\n}\n\n//Append Indentation to Label/Spacing.\nfunction appendIndentation(inputObject, inputLine) {\n    var tmpIndentation = \"\";\n    if (inputObject.lineIndentationArray) {\n        if (inputObject.lineIndentationArray.length > 0) {\n            for (var i in inputObject.lineIndentationArray) {\n                tmpIndentation = tmpIndentation + \".\" + inputObject.lineIndentationArray[i];\n            }\n            inputLine = inputLine + tmpIndentation;\n        }\n    }\n    return inputLine;\n}\n\n//Append Routines to Label/Spacing/Indentation.\nfunction appendRoutines(inputObject, inputLine) {\n    if (inputObject.lineRoutines) {\n        for (var i in inputObject.lineRoutines) {\n            if (inputObject.lineRoutines[i].mRoutine || inputObject.lineRoutines[i].mRoutine === \"\") {\n                //Leave off interval spacing for first Routine.\n                if (i === \"0\") {\n                    inputLine = inputLine + inputObject.lineRoutines[i].mRoutine;\n                } else {\n                    inputLine = inputLine + \" \" + inputObject.lineRoutines[i].mRoutine;\n                }\n                //Append Post-Conditional.\n                if (inputObject.lineRoutines[i].mPostConditional) {\n                    inputLine = inputLine + \":\" + inputObject.lineRoutines[i].mPostConditional;\n                }\n                //Append Arguments.\n                if (inputObject.lineRoutines[i].hasOwnProperty(\"mArguments\")) {\n                    inputLine = inputLine + \" \" + inputObject.lineRoutines[i].mArguments;\n                }\n            }\n        }\n    }\n    return inputLine;\n}\n\n//Append Comment.\nfunction appendComment(inputObject, inputLine) {\n    if (inputObject.hasOwnProperty(\"lineComment\")) {\n        inputLine = inputLine + \";\" + inputObject.lineComment;\n    }\n    return inputLine;\n}\n\n//Export all Routines.\nmodule.exports.appendLabel = appendLabel;\nmodule.exports.appendIndentation = appendIndentation;\nmodule.exports.appendRoutines = appendRoutines;\nmodule.exports.appendComment = appendComment;\n","interface LineComment {\n\tcomment: string,\n\tposition: number\n}\ninterface LineObject {\n\tlineComment?: LineComment;\n\tlineIndentationArray?: string[];\n\tlineRoutines?: TmpFunction[];\n\tlineLeadSpace?: string,\n\tlineLabel?: string,\n\tlineExpression: string,\n\terrorText?: string,\n\terrorPosition?: number,\n\texpressionPosition: number\n}\ninterface TmpFunction {\n\tmCommand: string,\n\tmArguments: string,\n\tmPostCondition: string,\n\tcmdPosition: number,\n\targPosition: number,\n\tpcPosition: number\n}\n//Append Line Label and Lead Spacing.\nfunction appendLabel(inputObject: LineObject, inputLine: string): string {\n\tif (inputObject.lineLabel) {\n\t\tinputLine = inputLine + inputObject.lineLabel;\n\t}\n\tif (inputObject.lineLeadSpace) {\n\t\tinputLine = inputLine + inputObject.lineLeadSpace;\n\t}\n\treturn inputLine;\n}\n\n//Append Indentation to Label/Spacing.\nfunction appendIndentation(inputObject: LineObject, inputLine: string): string {\n\tlet tmpIndentation = \"\";\n\tif (inputObject.lineIndentationArray) {\n\t\tif (inputObject.lineIndentationArray.length > 0) {\n\t\t\tfor (let i in inputObject.lineIndentationArray) {\n\t\t\t\ttmpIndentation = tmpIndentation + \".\" + inputObject.lineIndentationArray[i];\n\t\t\t}\n\t\t\tinputLine = inputLine + tmpIndentation;\n\t\t}\n\t}\n\treturn inputLine;\n}\n\n//Append Routines to Label/Spacing/Indentation.\nfunction appendRoutines(inputObject: LineObject, inputLine: string): string {\n\tif (inputObject.lineRoutines) {\n\t\tfor (let i in inputObject.lineRoutines) {\n\t\t\tif (inputObject.lineRoutines[i].mCommand || inputObject.lineRoutines[i].mCommand === \"\") {\n\t\t\t\t//Leave off interval spacing for first Routine.\n\t\t\t\tif (i === \"0\") {\n\t\t\t\t\tinputLine = inputLine + inputObject.lineRoutines[i].mCommand;\n\t\t\t\t} else {\n\t\t\t\t\tinputLine = inputLine + \" \" + inputObject.lineRoutines[i].mCommand;\n\t\t\t\t}\n\t\t\t\t//Append Post-Conditional.\n\t\t\t\tif (inputObject.lineRoutines[i].mPostCondition) {\n\t\t\t\t\tinputLine = inputLine + \":\" + inputObject.lineRoutines[i].mPostCondition;\n\t\t\t\t}\n\t\t\t\t//Append Arguments.\n\t\t\t\tif (inputObject.lineRoutines[i].hasOwnProperty(\"mArguments\")) {\n\t\t\t\t\tinputLine = inputLine + \" \" + inputObject.lineRoutines[i].mArguments;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn inputLine;\n}\n\n//Append Comment.\nfunction appendComment(inputObject: LineObject, inputLine: string): string {\n\tif (inputObject.hasOwnProperty(\"lineComment\")) {\n\t\tinputLine = inputLine + \";\" + inputObject.lineComment!.comment;\n\t}\n\treturn inputLine;\n}\n\n//Export all Routines.\nmodule.exports.appendLabel = appendLabel;\nmodule.exports.appendIndentation = appendIndentation;\nmodule.exports.appendRoutines = appendRoutines;\nmodule.exports.appendComment = appendComment;","import * as vscode from 'vscode';\r\nimport {TokenType, MumpsLineParser} from './mumpsLineParser'\r\nconst tokenModifiers = ['standard'];\r\nconst subtype=\"standard\";\r\nconst tokentypes:string[]=Object.values(TokenType);\r\nconst SemanticTokens = new vscode.SemanticTokensLegend(tokentypes, tokenModifiers);\r\nconst parser = new MumpsLineParser();\r\n//type: \"global\" | \"local\" | \"exfunction\" | \"nonMfunction\" | \"entryref\" | \"operator\" |\r\n//      \"keyword\" | \"ifunction\" | \"label\" | \"comment\" | \"sysvariable\" | \"string\" | \"number\",\r\n\r\n\r\nconst MumpsHighlighter: vscode.DocumentSemanticTokensProvider = {\r\n  provideDocumentSemanticTokens(\r\n    document: vscode.TextDocument\r\n  ): vscode.ProviderResult<vscode.SemanticTokens> {\r\n    // analyze the document and return semantic tokens\r\n\t\tconst text = document.getText();\r\n\t\tconst result = parser.analyzeLines(text);\r\n\t\tconst tokensBuilder = new vscode.SemanticTokensBuilder(SemanticTokens);\r\n\t\tfor (let line=0;line<result.length;line++) {\r\n\t\t\tlet tokens=result[line];\r\n\t\t\tfor (let tokenId=0;tokenId<tokens.length;tokenId++) {\r\n\t\t\t\tlet t=tokens[tokenId];\r\n\t\t\t\tlet type=t.type;\r\n\t\t\t\tif (type===\"exfunction\") {\r\n\t\t\t\t\tt.position-=2;\t\t\t//Correct Position because of leading $$\r\n\t\t\t\t\tt.name=\"$$\"+t.name;\r\n\t\t\t\t}\r\n\t\t\t\tif (t.position<0) {\r\n\t\t\t\t\tconsole.log(tokens);\r\n\t\t\t\t}\r\n\t\t\t\ttokensBuilder.push(\r\n\t\t\t\t\tnew vscode.Range(new vscode.Position(line,t.position), new vscode.Position(line, t.position+t.name.length)),\r\n\t\t\t\t  type, [subtype]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n    return tokensBuilder.build();\r\n  }\r\n};\r\n\r\nexport {MumpsHighlighter, SemanticTokens}\r\n","import * as vscode from 'vscode';\nimport { MumpsLineParser } from './mumpsLineParser';\nconst parser = new MumpsLineParser;\nexport function expandCompress(state: vscode.Memento) {\n\tlet doExpand = true;\n\tlet editor = vscode.window.activeTextEditor\n\tif (editor) {\n\t\tlet filename = editor.document.fileName;\n\t\tif (state.get(filename + \"_expandState\") === true) {\n\t\t\tdoExpand = false;\n\t\t\tstate.update(filename + \"_expandState\", false);\n\t\t} else {\n\t\t\tstate.update(filename + \"_expandState\", true);\n\t\t}\n\t\tlet document = editor.document.getText();\n\t\tlet lines = document.split(\"\\n\")\n\t\tlet lineCount = lines.length;\n\t\tif (lineCount) {\n\t\t\tlet lastLineLength = lines[lineCount - 1].length;\n\t\t\tfor (let i = 0; i < lineCount; i++) {\n\t\t\t\tlet info = parser.expandCompressLine(lines[i], doExpand);\n\t\t\t\tif (info.errorText === '') {\n\t\t\t\t\tlines[i] = info.lineText;\n\t\t\t\t}\n\t\t\t}\n\t\t\teditor.edit(editBuilder => {\n\t\t\t\teditBuilder.replace(new vscode.Range(0, 0, lineCount, lastLineLength), lines.join(\"\\n\"));\n\t\t\t})\n\t\t}\n\t}\n}\n"],"sourceRoot":""}