{"version":3,"sources":["../webpack/bootstrap","../external \"vscode\"","../external \"fs\"","../external \"path\"",".././node_modules/vscode-debugadapter/lib/debugSession.js",".././node_modules/vscode-debugadapter/lib/messages.js",".././src/mumps-language-token.ts","../external \"events\"","../external \"net\"",".././node_modules/vscode-debugadapter/lib/logger.js",".././src/mumps-documenter.ts",".././src/mumpsLineParser.ts",".././src/extension.ts",".././src/mumpsDebug.ts",".././node_modules/vscode-debugadapter/lib/main.js",".././node_modules/vscode-debugadapter/lib/protocol.js","../external \"url\"",".././node_modules/vscode-debugadapter/lib/loggingDebugSession.js",".././node_modules/mkdirp/index.js",".././node_modules/vscode-debugadapter/lib/handles.js",".././node_modules/await-notify/index.js",".././src/mconnect.ts",".././src/mumps-hover-provider.ts",".././src/mumps-label-lookup.ts",".././src/mumps-definition-provider.ts",".././src/mumps-signature-help-provider.ts",".././src/mumps-document.ts",".././src/parser/parser.ts",".././src/parser/tokenizer.ts",".././src/mumps-completion-item-provider.ts",".././src/mumps-autospace.ts",".././node_modules/emcellent/index.js",".././node_modules/emcellent/lib/parse.js",".././node_modules/emcellent/lib/render.js",".././src/mumps-highlighter.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","protocol_1","messages_1","Net","url_1","Source","path","id","origin","data","this","sourceReference","adapterData","Scope","reference","expensive","variablesReference","StackFrame","nm","src","ln","col","source","line","column","Thread","Variable","ref","indexedVariables","namedVariables","Breakpoint","verified","e","Module","CompletionItem","label","start","length","StoppedEvent","Event","reason","threadId","exceptionText","super","body","text","ContinuedEvent","allThreadsContinued","InitializedEvent","TerminatedEvent","restart","OutputEvent","output","category","undefined","ThreadEvent","BreakpointEvent","breakpoint","ModuleEvent","LoadedSourceEvent","CapabilitiesEvent","capabilities","ErrorDestination","DebugSession","ProtocolServer","obsolete_debuggerLinesAndColumnsStartAt1","obsolete_isServer","linesAndColumnsStartAt1","_debuggerLinesStartAt1","_debuggerColumnsStartAt1","_debuggerPathsAreURIs","_clientLinesStartAt1","_clientColumnsStartAt1","_clientPathsAreURIs","_isServer","on","shutdown","error","format","enable","debugSession","port","process","argv","slice","forEach","val","index","array","portMatch","exec","parseInt","console","createServer","socket","session","setRunAsServer","listen","stdin","stdout","_isRunningInline","setTimeout","exit","response","codeOrMessage","variables","dest","User","msg","showUser","Telemetry","sendTelemetry","success","message","formatPII","sendResponse","args","timeout","cb","sendRequest","request","Response","command","arguments","linesStartAt1","columnsStartAt1","pathFormat","sendErrorResponse","initializeResponse","initializeRequest","launchRequest","attachRequest","disconnectRequest","terminateRequest","restartRequest","setBreakPointsRequest","setFunctionBreakPointsRequest","setExceptionBreakPointsRequest","configurationDoneRequest","continueRequest","nextRequest","stepInRequest","stepOutRequest","stepBackRequest","reverseContinueRequest","restartFrameRequest","gotoRequest","pauseRequest","stackTraceRequest","scopesRequest","variablesRequest","setVariableRequest","setExpressionRequest","sourceRequest","threadsRequest","terminateThreadsRequest","evaluateRequest","stepInTargetsRequest","gotoTargetsRequest","completionsRequest","exceptionInfoRequest","loadedSourcesRequest","dataBreakpointInfoRequest","setDataBreakpointsRequest","readMemoryRequest","disassembleRequest","cancelRequest","breakpointLocationsRequest","customRequest","_exception","_stack","stack","supportsConditionalBreakpoints","supportsHitConditionalBreakpoints","supportsFunctionBreakpoints","supportsConfigurationDoneRequest","supportsEvaluateForHovers","supportsStepBack","supportsSetVariable","supportsRestartFrame","supportsStepInTargetsRequest","supportsGotoTargetsRequest","supportsCompletionsRequest","supportsRestartRequest","supportsExceptionOptions","supportsValueFormattingOptions","supportsExceptionInfoRequest","supportTerminateDebuggee","supportsDelayedStackTraceLoading","supportsLoadedSourcesRequest","supportsLogPoints","supportsTerminateThreadsRequest","supportsSetExpression","supportsTerminateRequest","supportsDataBreakpoints","supportsReadMemoryRequest","supportsDisassembleRequest","supportsCancelRequest","supportsBreakpointLocationsRequest","clientPath","uri2path","path2uri","debuggerPath","platform","test","toLowerCase","substr","replace","encodeURI","uri","URL","pathname","toString","sourceUri","decodeURIComponent","excludePII","_formatPIIRegexp","match","paramName","Message","type","seq","request_seq","event","definitionsArray","definitions","isWhitespace","char","withoutFirstCharacter","string","substring","formatParameter","parameter","first","optional","addDefinition","definition","push","MumpsToken","document","position","range","getWordRangeAtPosition","word","getText","surroundWord","character","vscode","Position","end","Range","charAt","extendedWord","getWordWithSurrounds","isIntrinsic","lastChar","_isLabelReference","lineAt","RegExp","fullLabel","parts","labelOffset","Number","labelProgram","referredToLabel","lookupLabelReference","_definition","matches","toUpperCase","isFunctionCall","isLabelReference","createDefinitionForLabelReference","functionSignature","signature","parameters","returns","formatFunctionSignature","abbreviation","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","apply","fs","mkdirp","debugSession_1","LogLevel","Logger","_pendingLogQ","level","Log","_write","log","Verbose","Warn","Error","_currentLogger","disposeP","dispose","consoleMinLogLevel","_logFilePath","prependTimestamp","logFilePath","_logFilePathFromInit","options","setup","logQ","item","logCallback","logToConsole","InternalLogger","logger","isServer","beforeExitCallback","_logCallback","_logToConsole","_minLogLevel","disposeCallback","signal","code","_prependTimestamp","isAbsolute","handleError","err","sendLog","folder","dirname","_logFileStream","createWriteStream","logDateTime","setupShutdownListeners","Date","timeAndDateStamp","getUTCFullYear","getUTCMonth","getUTCDate","getFormattedTimeString","addListener","removeListener","removeShutdownListeners","Stop","logFn","warn","trimLastNewline","write","endsInNewline","LogOutputEvent","str","_padZeroes","String","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","minDesiredLength","numberToPad","repeat","lineIsFunctionSig","makeSignature","labelLine","Signature","split","element","DocumentFunction","editor","window","activeTextEditor","InsertPosition","selection","with","lineCount","translate","txt","edit","editBuilder","insert","getSigInfo","referredTo","parametersByName","description","param","paramDescription","TokenType","lvn","gvn","isv","ifunction","nonMfunction","entryref","routineref","numlit","strlit","binoperator","unaryoperator","patcode","repititionCount","openkeywords","usekeywords","closekeywords","jobkeywords","tstartkeywords","cmdExpansions","funcExpansions","cmdParams","funcParams","expressiontype","tokens","linePosition","pattern","patternComplete","evaluateExpression","repCount","_evaluatePattern","exType","expressionComplete","startposition","lastExpression","subExType","evalString","localname","local","operator","provResult","_checkVar","_checkEntryRef","functionname","_checkFunction","specialvarname","sysvariable","numericliteral","number","stringlit","inputObject","lineLabel","inputLine","lineExpression","errorText","errorPosition","lineLeadSpace","expressionPosition","search","isInsideString","lineComment","comment","lineIndentationArray","lineIndentation","spacer","tmpFunction","tmpFunctionArray","splitLine","_splitCommandsAndArguments","mCommand","mPostCondition","mArguments","cmdPosition","argPosition","pcPosition","ii","splice","postConditionFunctionArray","_extractPostConditional","lineRoutines","lineCommands","tmpCursor","tmpObject","tmpIndex","indexOf","inputString","_extractLabel","_extractComment","_extractIndentation","_extractCommands","filename","content","errlist","readFileSync","lines","info","checkLine","input","linetokens","labelparts","labeltext","parameterVars","parsed","parseLine","_splitLabelAndParameters","keyword","cmd","longcmd","_checkCommand","arg","withParams","isUserfunction","tokentype","exfunction","merkpos","routine","globalOk","indexOk","indexFound","globalFound","indirectionFound","varFound","global","keywords","braceComplete","_checkKeyword","argNumber","_checkJobKeyword","isLock","mat","starDetected","isBraced","_checkWriteSocket","fname","maxparams","paramCount","para","postcondPossible","postcondition","argFormat","argCount","_checkBreak","_checkOUC","_checkEntryRefAndPostcondition","_checkFor","_checkJob","_checkKill","_checkLock","_checkMerge","_checkNew","_checkRead","_checkSet","_checkTstart","_checkView","_checkWrite","_checkXecute","_checkZbreak","_checkZprint","_checkZstep","longfunc","params","minArguments","minparams","formats","parser","MumpsLineParser","context","MUMPS_MODE","language","scheme","mumpsDiagnostics","languages","createDiagnosticCollection","subscriptions","commands","registerCommand","showInputBox","placeHolder","storage","storagePath","existsSync","mkdirSync","dbfile","AutospaceFunction","autoSpaceEnter","autoSpaceTab","registerHoverProvider","MumpsHoverProvider","registerDefinitionProvider","MumpsDefinitionProvider","registerSignatureHelpProvider","MumpsSignatureHelpProvider","registerDocumentSymbolProvider","MumpsDocumentSymbolProvider","registerCompletionItemProvider","CompletionItemProvider","registerDocumentSemanticTokensProvider","MumpsHighlighter","SemanticTokens","registerDocumentFormattingEditProvider","provideDocumentFormattingEdits","token","textEdits","formatDocumentLine","registerDocumentRangeFormattingEditProvider","provideDocumentRangeFormattingEdits","debug","registerDebugConfigurationProvider","MumpsConfigurationProvider","registerDebugAdapterDescriptorFactory","InlineDebugAdapterFactory","onDidChangeActiveTextEditor","triggerUpdateDiagnostics","workspace","onDidChangeTextDocument","registerEvaluatableExpressionProvider","diags","find","diag","contains","lineContent","expression","EvaluatableExpression","config","languageId","program","stopOnEntry","hostname","localRoutinesPath","showInformationMessage","_","_session","DebugAdapterInlineImplementation","MumpsDebugSession","lineNumber","TextEdit","endsWith","startsWith","endSpace","collection","clearTimeout","clear","severity","DiagnosticSeverity","set","updateDiagnostics","Subject","MUMPSDIAGNOSTICS","LoggingDebugSession","_variableHandles","Handles","_configurationDone","setDebuggerLinesStartAt1","setDebuggerColumnsStartAt1","_program","_mconnect","MConnect","sendEvent","THREAD_ID","errortext","bp","filePath","createSource","convertDebuggerLineToClient","convertDebuggerColumnToClient","completionTriggerCharacters","notify","trace","wait","init","refreshDiagnostics","catch","showErrorMessage","clientLines","clearBreakpoints","actualBreakpoints","map","setBreakPoint","convertClientLineToDebugger","breakpoints","requestBreakpoints","threads","startFrame","endFrame","levels","stk","stackFrames","frames","f","file","totalFrames","count","scopes","insertVariable","varId","varObject","getVariables","varname","varparts","indexCount","pop","varBase","join","lastVar","firstTime","lastRef","actualVar","varAnalyze","checkVars","bases","dummyVar","returnVar","actualReference","continue","getSingleVar","varReply","sourceLines","checkRoutine","errorLines","disconnect","basename","convertDebuggerPathToClient","indexcount","klammerpos","countKomma","doc","diagnostics","lineIndex","lineOfText","errLines","errData","isNaN","endColumn","diagnostic","Diagnostic","loggingDebugSession_1","handles_1","ee","Emitter","_event","listener","_listener","_this","EventEmitter","_sendMessage","_pendingRequests","Map","onDidSendMessage","dispatchRequest","clb","delete","hasListener","inStream","outStream","_sequence","_writableStream","_rawData","Buffer","_handleData","_emitEvent","resume","_send","keys","timer","emit","typ","json","JSON","stringify","byteLength","fire","concat","_contentLength","parse","handleMessage","idx","TWO_CRLF","pair","obsolete_logFilePath","objectToLog","doNotLogOutput","assign","verbose","_0777","mkdirP","opts","made","xfs","umask","mkdir","er","stat","er2","isDirectory","sync","err0","statSync","err1","startHandle","START_HANDLE","_handleMap","_nextHandle","handle","dflt","waiters","self","waiter","promise","resolved","noRemove","pos","isFinite","notifyAll","_currentLine","_breakpointId","_logging","_singleVar","_singleVarContent","_commandQueue","_socket","Socket","_connectState","_readedData","_mVars","_mStack","_activeBreakpoints","_breakPoints","_errorLines","_hints","internals","checkEvents","_localRoutinesPath","_hostname","_port","connect","_log","chunk","processLine","vartype","verifyBreakpoints","writable","shift","onOff","writeln","stopAtStart","sendBreakpoint","mumpsposition","mumpsstatus","loadSource","startlabel","offset","_sourceLines","filter","_sourceFile","Array","fileposition","convertMumpsPosition","Math","min","bps","findIndex","merk","internalBp","part","HintsReceived","hints","ErrorreportReceived","reply","SingleVarReceived","singleVar","singleVarContent","positionstring","filecontent","Hover","mayBeCommand","snippet","Uri","EXTENSIONS","cache","siblingUri","fileName","siblingPath","fsPath","extension","extendedPath","commentText","j","findReferredToLabel","autoDoc","Location","ParameterInformation","SignatureHelp","SignatureInformation","depth","getFunctionToken","documentation","createSignatureInformation","help","signatures","activeSignature","activeParameter","lineText","parametersStartIndex","insertIndex","active","calculateActiveParameter","parsedDoc","parseText","symbols","methods","method","kind","SymbolKind","Function","startPosition","endPostionLine","endLine","endPosition","methodRange","SymbolInformation","MemberClass","Method","declarations","memberClass","Parameter","sourceText","Parser","parseDocument","tokenizer","activeToken","documentText","getTokens","isAlphanumeric","parseMethod","activeMethod","isTab","isSpace","tokenBuffer","loadTokenBuffer","nextLine","checkForDocumentation","isNewLine","throwAwayTokensTil","isLineCommentInit","isLineComment","isOpenParen","processed","processParameters","prevLine","isCloseParen","closeParen","open","isComma","documentContents","Tokenizer","charType","getType","tokenType","parseCharacter","finalizedToken","finalizeToken","Token","documentLine","documentColumn","tokenValue","tokenPosition","stringOpen","firstSlash","asterisk","updateTokenAndAdvanceCursor","newType","charCode","charCodeAt","Type","labeldb","_labelsReady","_dbfile","_refreshLabelDB","status","lineStatus","lookPosition","lastCommand","startstring","isInsidePostcond","isWhiteSpace","isBeginOfVariable","isAlphaChar","getLineStatus","clean","replaceRange","_findLabel","db","labels","routines","writeFileSync","readFile","_labelDB","dbChanged","findFiles","files","_filesToCheck","stats","_checkReady","ms","mtimeMs","size","_refreshFileLabels","writeFile","list","hitlist","sortText","suchstring","routinepart","detail","em","currentLine","newLine","render","cmds","mRoutine","lineContainsNoParamDo","eb","renderer","extractLabel","extractComment","extractIndentation","extractRoutines","renderLine","tmpLine","appendLabel","appendIndentation","appendRoutines","appendComment","inputArray","returnArray","tmpLineObject","parseArray","isArray","splitRoutinesAndArguments","extractPostConditional","mPostConditional","tmpPosStart","tmpPosEnd","tmpIndentation","tokentypes","values","SemanticTokensLegend","analyzeLines","tokensBuilder","SemanticTokensBuilder","tokenId","build"],"mappings":"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ACZ,GAKT,4BAA4BttB,GAC3BzN,KAAKm7B,WAAan7B,KAAKm7B,WAAa1tB,EACpCzN,KAAKqe,QAAS,EACdre,KAAKk7B,iBAGN,cAAcO,GACbz7B,KAAK86B,eAAiB,IAAIE,EAAMh7B,KAAK46B,UAAW56B,KAAKm7B,WAAYn7B,KAAKo7B,eACtEp7B,KAAK46B,UAAYa,EACjBz7B,KAAKm7B,WAAa,GAClBn7B,KAAKo7B,cAAgB,IAAI,EAAAtsB,SAAS9O,KAAKi7B,aAAcj7B,KAAKk7B,iBAI5D,SAASP,EAAQh9B,GAChB,IAAI+9B,EAAmB/9B,EAAEg+B,WAAW,GACpC,OAAID,GAAY,IAAMA,GAAY,IAAMA,GAAY,IAAMA,GAAY,KAAoB,KAAbA,EACrE,EACGA,GAAY,IAAMA,GAAY,GACjC,EACgB,KAAbA,EACH,EACgB,IAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GAGgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,KAAbA,EACH,GACgB,MAAbA,EACH,IACgB,MAAbA,EACH,IACgB,MAAbA,EACH,IACgB,MAAbA,EACH,KAIC,GAIV,SAAkBE,GACjB,mCACA,yBACA,iCACA,mCACA,uBACA,yCACA,mCAEA,kBACA,0BACA,sBAEA,0CACA,gCACA,gCACA,8BACA,kCACA,8BACA,gCACA,4BACA,4BACA,sBACA,8BACA,wBACA,sBACA,8BACA,4BACA,8BACA,kCACA,oCACA,4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","file":"extension.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","module.exports = require(\"vscode\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst protocol_1 = require(\"./protocol\");\nconst messages_1 = require(\"./messages\");\nconst Net = require(\"net\");\nconst url_1 = require(\"url\");\nclass Source {\n    constructor(name, path, id = 0, origin, data) {\n        this.name = name;\n        this.path = path;\n        this.sourceReference = id;\n        if (origin) {\n            this.origin = origin;\n        }\n        if (data) {\n            this.adapterData = data;\n        }\n    }\n}\nexports.Source = Source;\nclass Scope {\n    constructor(name, reference, expensive = false) {\n        this.name = name;\n        this.variablesReference = reference;\n        this.expensive = expensive;\n    }\n}\nexports.Scope = Scope;\nclass StackFrame {\n    constructor(i, nm, src, ln = 0, col = 0) {\n        this.id = i;\n        this.source = src;\n        this.line = ln;\n        this.column = col;\n        this.name = nm;\n    }\n}\nexports.StackFrame = StackFrame;\nclass Thread {\n    constructor(id, name) {\n        this.id = id;\n        if (name) {\n            this.name = name;\n        }\n        else {\n            this.name = 'Thread #' + id;\n        }\n    }\n}\nexports.Thread = Thread;\nclass Variable {\n    constructor(name, value, ref = 0, indexedVariables, namedVariables) {\n        this.name = name;\n        this.value = value;\n        this.variablesReference = ref;\n        if (typeof namedVariables === 'number') {\n            this.namedVariables = namedVariables;\n        }\n        if (typeof indexedVariables === 'number') {\n            this.indexedVariables = indexedVariables;\n        }\n    }\n}\nexports.Variable = Variable;\nclass Breakpoint {\n    constructor(verified, line, column, source) {\n        this.verified = verified;\n        const e = this;\n        if (typeof line === 'number') {\n            e.line = line;\n        }\n        if (typeof column === 'number') {\n            e.column = column;\n        }\n        if (source) {\n            e.source = source;\n        }\n    }\n}\nexports.Breakpoint = Breakpoint;\nclass Module {\n    constructor(id, name) {\n        this.id = id;\n        this.name = name;\n    }\n}\nexports.Module = Module;\nclass CompletionItem {\n    constructor(label, start, length = 0) {\n        this.label = label;\n        this.start = start;\n        this.length = length;\n    }\n}\nexports.CompletionItem = CompletionItem;\nclass StoppedEvent extends messages_1.Event {\n    constructor(reason, threadId, exceptionText) {\n        super('stopped');\n        this.body = {\n            reason: reason\n        };\n        if (typeof threadId === 'number') {\n            this.body.threadId = threadId;\n        }\n        if (typeof exceptionText === 'string') {\n            this.body.text = exceptionText;\n        }\n    }\n}\nexports.StoppedEvent = StoppedEvent;\nclass ContinuedEvent extends messages_1.Event {\n    constructor(threadId, allThreadsContinued) {\n        super('continued');\n        this.body = {\n            threadId: threadId\n        };\n        if (typeof allThreadsContinued === 'boolean') {\n            this.body.allThreadsContinued = allThreadsContinued;\n        }\n    }\n}\nexports.ContinuedEvent = ContinuedEvent;\nclass InitializedEvent extends messages_1.Event {\n    constructor() {\n        super('initialized');\n    }\n}\nexports.InitializedEvent = InitializedEvent;\nclass TerminatedEvent extends messages_1.Event {\n    constructor(restart) {\n        super('terminated');\n        if (typeof restart === 'boolean' || restart) {\n            const e = this;\n            e.body = {\n                restart: restart\n            };\n        }\n    }\n}\nexports.TerminatedEvent = TerminatedEvent;\nclass OutputEvent extends messages_1.Event {\n    constructor(output, category = 'console', data) {\n        super('output');\n        this.body = {\n            category: category,\n            output: output\n        };\n        if (data !== undefined) {\n            this.body.data = data;\n        }\n    }\n}\nexports.OutputEvent = OutputEvent;\nclass ThreadEvent extends messages_1.Event {\n    constructor(reason, threadId) {\n        super('thread');\n        this.body = {\n            reason: reason,\n            threadId: threadId\n        };\n    }\n}\nexports.ThreadEvent = ThreadEvent;\nclass BreakpointEvent extends messages_1.Event {\n    constructor(reason, breakpoint) {\n        super('breakpoint');\n        this.body = {\n            reason: reason,\n            breakpoint: breakpoint\n        };\n    }\n}\nexports.BreakpointEvent = BreakpointEvent;\nclass ModuleEvent extends messages_1.Event {\n    constructor(reason, module) {\n        super('module');\n        this.body = {\n            reason: reason,\n            module: module\n        };\n    }\n}\nexports.ModuleEvent = ModuleEvent;\nclass LoadedSourceEvent extends messages_1.Event {\n    constructor(reason, source) {\n        super('loadedSource');\n        this.body = {\n            reason: reason,\n            source: source\n        };\n    }\n}\nexports.LoadedSourceEvent = LoadedSourceEvent;\nclass CapabilitiesEvent extends messages_1.Event {\n    constructor(capabilities) {\n        super('capabilities');\n        this.body = {\n            capabilities: capabilities\n        };\n    }\n}\nexports.CapabilitiesEvent = CapabilitiesEvent;\nvar ErrorDestination;\n(function (ErrorDestination) {\n    ErrorDestination[ErrorDestination[\"User\"] = 1] = \"User\";\n    ErrorDestination[ErrorDestination[\"Telemetry\"] = 2] = \"Telemetry\";\n})(ErrorDestination = exports.ErrorDestination || (exports.ErrorDestination = {}));\n;\nclass DebugSession extends protocol_1.ProtocolServer {\n    constructor(obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer) {\n        super();\n        const linesAndColumnsStartAt1 = typeof obsolete_debuggerLinesAndColumnsStartAt1 === 'boolean' ? obsolete_debuggerLinesAndColumnsStartAt1 : false;\n        this._debuggerLinesStartAt1 = linesAndColumnsStartAt1;\n        this._debuggerColumnsStartAt1 = linesAndColumnsStartAt1;\n        this._debuggerPathsAreURIs = false;\n        this._clientLinesStartAt1 = true;\n        this._clientColumnsStartAt1 = true;\n        this._clientPathsAreURIs = false;\n        this._isServer = typeof obsolete_isServer === 'boolean' ? obsolete_isServer : false;\n        this.on('close', () => {\n            this.shutdown();\n        });\n        this.on('error', (error) => {\n            this.shutdown();\n        });\n    }\n    setDebuggerPathFormat(format) {\n        this._debuggerPathsAreURIs = format !== 'path';\n    }\n    setDebuggerLinesStartAt1(enable) {\n        this._debuggerLinesStartAt1 = enable;\n    }\n    setDebuggerColumnsStartAt1(enable) {\n        this._debuggerColumnsStartAt1 = enable;\n    }\n    setRunAsServer(enable) {\n        this._isServer = enable;\n    }\n    /**\n     * A virtual constructor...\n     */\n    static run(debugSession) {\n        // parse arguments\n        let port = 0;\n        const args = process.argv.slice(2);\n        args.forEach(function (val, index, array) {\n            const portMatch = /^--server=(\\d{4,5})$/.exec(val);\n            if (portMatch) {\n                port = parseInt(portMatch[1], 10);\n            }\n        });\n        if (port > 0) {\n            // start as a server\n            console.error(`waiting for debug protocol on port ${port}`);\n            Net.createServer((socket) => {\n                console.error('>> accepted connection from client');\n                socket.on('end', () => {\n                    console.error('>> client connection closed\\n');\n                });\n                const session = new debugSession(false, true);\n                session.setRunAsServer(true);\n                session.start(socket, socket);\n            }).listen(port);\n        }\n        else {\n            // start a session\n            //console.error('waiting for debug protocol on stdin/stdout');\n            const session = new debugSession(false);\n            process.on('SIGTERM', () => {\n                session.shutdown();\n            });\n            session.start(process.stdin, process.stdout);\n        }\n    }\n    shutdown() {\n        if (this._isServer || this._isRunningInline()) {\n            // shutdown ignored in server mode\n        }\n        else {\n            // wait a bit before shutting down\n            setTimeout(() => {\n                process.exit(0);\n            }, 100);\n        }\n    }\n    sendErrorResponse(response, codeOrMessage, format, variables, dest = ErrorDestination.User) {\n        let msg;\n        if (typeof codeOrMessage === 'number') {\n            msg = {\n                id: codeOrMessage,\n                format: format\n            };\n            if (variables) {\n                msg.variables = variables;\n            }\n            if (dest & ErrorDestination.User) {\n                msg.showUser = true;\n            }\n            if (dest & ErrorDestination.Telemetry) {\n                msg.sendTelemetry = true;\n            }\n        }\n        else {\n            msg = codeOrMessage;\n        }\n        response.success = false;\n        response.message = DebugSession.formatPII(msg.format, true, msg.variables);\n        if (!response.body) {\n            response.body = {};\n        }\n        response.body.error = msg;\n        this.sendResponse(response);\n    }\n    runInTerminalRequest(args, timeout, cb) {\n        this.sendRequest('runInTerminal', args, timeout, cb);\n    }\n    dispatchRequest(request) {\n        const response = new messages_1.Response(request);\n        try {\n            if (request.command === 'initialize') {\n                var args = request.arguments;\n                if (typeof args.linesStartAt1 === 'boolean') {\n                    this._clientLinesStartAt1 = args.linesStartAt1;\n                }\n                if (typeof args.columnsStartAt1 === 'boolean') {\n                    this._clientColumnsStartAt1 = args.columnsStartAt1;\n                }\n                if (args.pathFormat !== 'path') {\n                    this.sendErrorResponse(response, 2018, 'debug adapter only supports native paths', null, ErrorDestination.Telemetry);\n                }\n                else {\n                    const initializeResponse = response;\n                    initializeResponse.body = {};\n                    this.initializeRequest(initializeResponse, args);\n                }\n            }\n            else if (request.command === 'launch') {\n                this.launchRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'attach') {\n                this.attachRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'disconnect') {\n                this.disconnectRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'terminate') {\n                this.terminateRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'restart') {\n                this.restartRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setBreakpoints') {\n                this.setBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setFunctionBreakpoints') {\n                this.setFunctionBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setExceptionBreakpoints') {\n                this.setExceptionBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'configurationDone') {\n                this.configurationDoneRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'continue') {\n                this.continueRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'next') {\n                this.nextRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepIn') {\n                this.stepInRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepOut') {\n                this.stepOutRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepBack') {\n                this.stepBackRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'reverseContinue') {\n                this.reverseContinueRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'restartFrame') {\n                this.restartFrameRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'goto') {\n                this.gotoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'pause') {\n                this.pauseRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stackTrace') {\n                this.stackTraceRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'scopes') {\n                this.scopesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'variables') {\n                this.variablesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setVariable') {\n                this.setVariableRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setExpression') {\n                this.setExpressionRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'source') {\n                this.sourceRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'threads') {\n                this.threadsRequest(response, request);\n            }\n            else if (request.command === 'terminateThreads') {\n                this.terminateThreadsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'evaluate') {\n                this.evaluateRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepInTargets') {\n                this.stepInTargetsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'gotoTargets') {\n                this.gotoTargetsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'completions') {\n                this.completionsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'exceptionInfo') {\n                this.exceptionInfoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'loadedSources') {\n                this.loadedSourcesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'dataBreakpointInfo') {\n                this.dataBreakpointInfoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setDataBreakpoints') {\n                this.setDataBreakpointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'readMemory') {\n                this.readMemoryRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'disassemble') {\n                this.disassembleRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'cancel') {\n                this.cancelRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'breakpointLocations') {\n                this.breakpointLocationsRequest(response, request.arguments, request);\n            }\n            else {\n                this.customRequest(request.command, response, request.arguments, request);\n            }\n        }\n        catch (e) {\n            this.sendErrorResponse(response, 1104, '{_stack}', { _exception: e.message, _stack: e.stack }, ErrorDestination.Telemetry);\n        }\n    }\n    initializeRequest(response, args) {\n        // This default debug adapter does not support conditional breakpoints.\n        response.body.supportsConditionalBreakpoints = false;\n        // This default debug adapter does not support hit conditional breakpoints.\n        response.body.supportsHitConditionalBreakpoints = false;\n        // This default debug adapter does not support function breakpoints.\n        response.body.supportsFunctionBreakpoints = false;\n        // This default debug adapter implements the 'configurationDone' request.\n        response.body.supportsConfigurationDoneRequest = true;\n        // This default debug adapter does not support hovers based on the 'evaluate' request.\n        response.body.supportsEvaluateForHovers = false;\n        // This default debug adapter does not support the 'stepBack' request.\n        response.body.supportsStepBack = false;\n        // This default debug adapter does not support the 'setVariable' request.\n        response.body.supportsSetVariable = false;\n        // This default debug adapter does not support the 'restartFrame' request.\n        response.body.supportsRestartFrame = false;\n        // This default debug adapter does not support the 'stepInTargets' request.\n        response.body.supportsStepInTargetsRequest = false;\n        // This default debug adapter does not support the 'gotoTargets' request.\n        response.body.supportsGotoTargetsRequest = false;\n        // This default debug adapter does not support the 'completions' request.\n        response.body.supportsCompletionsRequest = false;\n        // This default debug adapter does not support the 'restart' request.\n        response.body.supportsRestartRequest = false;\n        // This default debug adapter does not support the 'exceptionOptions' attribute on the 'setExceptionBreakpoints' request.\n        response.body.supportsExceptionOptions = false;\n        // This default debug adapter does not support the 'format' attribute on the 'variables', 'evaluate', and 'stackTrace' request.\n        response.body.supportsValueFormattingOptions = false;\n        // This debug adapter does not support the 'exceptionInfo' request.\n        response.body.supportsExceptionInfoRequest = false;\n        // This debug adapter does not support the 'TerminateDebuggee' attribute on the 'disconnect' request.\n        response.body.supportTerminateDebuggee = false;\n        // This debug adapter does not support delayed loading of stack frames.\n        response.body.supportsDelayedStackTraceLoading = false;\n        // This debug adapter does not support the 'loadedSources' request.\n        response.body.supportsLoadedSourcesRequest = false;\n        // This debug adapter does not support the 'logMessage' attribute of the SourceBreakpoint.\n        response.body.supportsLogPoints = false;\n        // This debug adapter does not support the 'terminateThreads' request.\n        response.body.supportsTerminateThreadsRequest = false;\n        // This debug adapter does not support the 'setExpression' request.\n        response.body.supportsSetExpression = false;\n        // This debug adapter does not support the 'terminate' request.\n        response.body.supportsTerminateRequest = false;\n        // This debug adapter does not support data breakpoints.\n        response.body.supportsDataBreakpoints = false;\n        /** This debug adapter does not support the 'readMemory' request. */\n        response.body.supportsReadMemoryRequest = false;\n        /** The debug adapter does not support the 'disassemble' request. */\n        response.body.supportsDisassembleRequest = false;\n        /** The debug adapter does not support the 'cancel' request. */\n        response.body.supportsCancelRequest = false;\n        /** The debug adapter does not support the 'breakpointLocations' request. */\n        response.body.supportsBreakpointLocationsRequest = false;\n        this.sendResponse(response);\n    }\n    disconnectRequest(response, args, request) {\n        this.sendResponse(response);\n        this.shutdown();\n    }\n    launchRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    attachRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    terminateRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    restartRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setFunctionBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setExceptionBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    configurationDoneRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    continueRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    nextRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepInRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepOutRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepBackRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    reverseContinueRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    restartFrameRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    gotoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    pauseRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    sourceRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    threadsRequest(response, request) {\n        this.sendResponse(response);\n    }\n    terminateThreadsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stackTraceRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    scopesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    variablesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setVariableRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setExpressionRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    evaluateRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepInTargetsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    gotoTargetsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    completionsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    exceptionInfoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    loadedSourcesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    dataBreakpointInfoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setDataBreakpointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    readMemoryRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    disassembleRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    cancelRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    breakpointLocationsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    /**\n     * Override this hook to implement custom requests.\n     */\n    customRequest(command, response, args, request) {\n        this.sendErrorResponse(response, 1014, 'unrecognized request', null, ErrorDestination.Telemetry);\n    }\n    //---- protected -------------------------------------------------------------------------------------------------\n    convertClientLineToDebugger(line) {\n        if (this._debuggerLinesStartAt1) {\n            return this._clientLinesStartAt1 ? line : line + 1;\n        }\n        return this._clientLinesStartAt1 ? line - 1 : line;\n    }\n    convertDebuggerLineToClient(line) {\n        if (this._debuggerLinesStartAt1) {\n            return this._clientLinesStartAt1 ? line : line - 1;\n        }\n        return this._clientLinesStartAt1 ? line + 1 : line;\n    }\n    convertClientColumnToDebugger(column) {\n        if (this._debuggerColumnsStartAt1) {\n            return this._clientColumnsStartAt1 ? column : column + 1;\n        }\n        return this._clientColumnsStartAt1 ? column - 1 : column;\n    }\n    convertDebuggerColumnToClient(column) {\n        if (this._debuggerColumnsStartAt1) {\n            return this._clientColumnsStartAt1 ? column : column - 1;\n        }\n        return this._clientColumnsStartAt1 ? column + 1 : column;\n    }\n    convertClientPathToDebugger(clientPath) {\n        if (this._clientPathsAreURIs !== this._debuggerPathsAreURIs) {\n            if (this._clientPathsAreURIs) {\n                return DebugSession.uri2path(clientPath);\n            }\n            else {\n                return DebugSession.path2uri(clientPath);\n            }\n        }\n        return clientPath;\n    }\n    convertDebuggerPathToClient(debuggerPath) {\n        if (this._debuggerPathsAreURIs !== this._clientPathsAreURIs) {\n            if (this._debuggerPathsAreURIs) {\n                return DebugSession.uri2path(debuggerPath);\n            }\n            else {\n                return DebugSession.path2uri(debuggerPath);\n            }\n        }\n        return debuggerPath;\n    }\n    //---- private -------------------------------------------------------------------------------\n    static path2uri(path) {\n        if (process.platform === 'win32') {\n            if (/^[A-Z]:/.test(path)) {\n                path = path[0].toLowerCase() + path.substr(1);\n            }\n            path = path.replace(/\\\\/g, '/');\n        }\n        path = encodeURI(path);\n        let uri = new url_1.URL(`file:`); // ignore 'path' for now\n        uri.pathname = path; // now use 'path' to get the correct percent encoding (see https://url.spec.whatwg.org)\n        return uri.toString();\n    }\n    static uri2path(sourceUri) {\n        let uri = new url_1.URL(sourceUri);\n        let s = decodeURIComponent(uri.pathname);\n        if (process.platform === 'win32') {\n            if (/^\\/[a-zA-Z]:/.test(s)) {\n                s = s[1].toLowerCase() + s.substr(2);\n            }\n            s = s.replace(/\\//g, '\\\\');\n        }\n        return s;\n    }\n    /*\n    * If argument starts with '_' it is OK to send its value to telemetry.\n    */\n    static formatPII(format, excludePII, args) {\n        return format.replace(DebugSession._formatPIIRegexp, function (match, paramName) {\n            if (excludePII && paramName.length > 0 && paramName[0] !== '_') {\n                return match;\n            }\n            return args[paramName] && args.hasOwnProperty(paramName) ?\n                args[paramName] :\n                match;\n        });\n    }\n}\nDebugSession._formatPIIRegexp = /{([^}]+)}/g;\nexports.DebugSession = DebugSession;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWdTZXNzaW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2RlYnVnU2Vzc2lvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OztnR0FHZ0c7O0FBR2hHLHlDQUEwQztBQUMxQyx5Q0FBMkM7QUFDM0MsMkJBQTJCO0FBQzNCLDZCQUF3QjtBQUd4QixNQUFhLE1BQU07SUFLbEIsWUFBbUIsSUFBWSxFQUFFLElBQWEsRUFBRSxLQUFhLENBQUMsRUFBRSxNQUFlLEVBQUUsSUFBVTtRQUMxRixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsZUFBZSxHQUFHLEVBQUUsQ0FBQztRQUMxQixJQUFJLE1BQU0sRUFBRTtZQUNMLElBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1NBQzVCO1FBQ0QsSUFBSSxJQUFJLEVBQUU7WUFDSCxJQUFLLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztTQUMvQjtJQUNGLENBQUM7Q0FDRDtBQWhCRCx3QkFnQkM7QUFFRCxNQUFhLEtBQUs7SUFLakIsWUFBbUIsSUFBWSxFQUFFLFNBQWlCLEVBQUUsWUFBcUIsS0FBSztRQUM3RSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsU0FBUyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO0lBQzVCLENBQUM7Q0FDRDtBQVZELHNCQVVDO0FBRUQsTUFBYSxVQUFVO0lBT3RCLFlBQW1CLENBQVMsRUFBRSxFQUFVLEVBQUUsR0FBWSxFQUFFLEtBQWEsQ0FBQyxFQUFFLE1BQWMsQ0FBQztRQUN0RixJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNaLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxD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SSxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxFQUFFO2dCQUMvRCxPQUFPLEtBQUssQ0FBQzthQUNiO1lBQ0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2dCQUN6RCxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztnQkFDakIsS0FBSyxDQUFDO1FBQ1IsQ0FBQyxDQUFDLENBQUE7SUFDSCxDQUFDOztBQWRjLDZCQUFnQixHQUFHLFlBQVksQ0FBQztBQWhtQmhELG9DQSttQkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHtEZWJ1Z1Byb3RvY29sfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5pbXBvcnQge1Byb3RvY29sU2VydmVyfSBmcm9tICcuL3Byb3RvY29sJztcbmltcG9ydCB7UmVzcG9uc2UsIEV2ZW50fSBmcm9tICcuL21lc3NhZ2VzJztcbmltcG9ydCAqIGFzIE5ldCBmcm9tICduZXQnO1xuaW1wb3J0IHtVUkx9IGZyb20gJ3VybCc7XG5cblxuZXhwb3J0IGNsYXNzIFNvdXJjZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU291cmNlIHtcblx0bmFtZTogc3RyaW5nO1xuXHRwYXRoOiBzdHJpbmc7XG5cdHNvdXJjZVJlZmVyZW5jZTogbnVtYmVyO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHBhdGg/OiBzdHJpbmcsIGlkOiBudW1iZXIgPSAwLCBvcmlnaW4/OiBzdHJpbmcsIGRhdGE/OiBhbnkpIHtcblx0XHR0aGlzLm5hbWUgPSBuYW1lO1xuXHRcdHRoaXMucGF0aCA9IHBhdGg7XG5cdFx0dGhpcy5zb3VyY2VSZWZlcmVuY2UgPSBpZDtcblx0XHRpZiAob3JpZ2luKSB7XG5cdFx0XHQoPGFueT50aGlzKS5vcmlnaW4gPSBvcmlnaW47XG5cdFx0fVxuXHRcdGlmIChkYXRhKSB7XG5cdFx0XHQoPGFueT50aGlzKS5hZGFwdGVyRGF0YSA9IGRhdGE7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBTY29wZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU2NvcGUge1xuXHRuYW1lOiBzdHJpbmc7XG5cdHZhcmlhYmxlc1JlZmVyZW5jZTogbnVtYmVyO1xuXHRleHBlbnNpdmU6IGJvb2xlYW47XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgcmVmZXJlbmNlOiBudW1iZXIsIGV4cGVuc2l2ZTogYm9vbGVhbiA9IGZhbHNlKSB7XG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcblx0XHR0aGlzLnZhcmlhYmxlc1JlZmVyZW5jZSA9IHJlZmVyZW5jZTtcblx0XHR0aGlzLmV4cGVuc2l2ZSA9IGV4cGVuc2l2ZTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgU3RhY2tGcmFtZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU3RhY2tGcmFtZSB7XG5cdGlkOiBudW1iZXI7XG5cdHNvdXJjZTogU291cmNlO1xuXHRsaW5lOiBudW1iZXI7XG5cdGNvbHVtbjogbnVtYmVyO1xuXHRuYW1lOiBzdHJpbmc7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGk6IG51bWJlciwgbm06IHN0cmluZywgc3JjPzogU291cmNlLCBsbjogbnVtYmVyID0gMCwgY29sOiBudW1iZXIgPSAwKSB7XG5cdFx0dGhpcy5pZCA9IGk7XG5cdFx0dGhpcy5zb3VyY2UgPSBzcmM7XG5cdFx0dGhpcy5saW5lID0gbG47XG5cdFx0dGhpcy5jb2x1bW4gPSBjb2w7XG5cdFx0dGhpcy5uYW1lID0gbm07XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFRocmVhZCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuVGhyZWFkIHtcblx0aWQ6IG51bWJlcjtcblx0bmFtZTogc3RyaW5nO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCBuYW1lOiBzdHJpbmcpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0aWYgKG5hbWUpIHtcblx0XHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMubmFtZSA9ICdUaHJlYWQgIycgKyBpZDtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlIGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5WYXJpYWJsZSB7XG5cdG5hbWU6IHN0cmluZztcblx0dmFsdWU6IHN0cmluZztcblx0dmFyaWFibGVzUmVmZXJlbmNlOiBudW1iZXI7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgcmVmOiBudW1iZXIgPSAwLCBpbmRleGVkVmFyaWFibGVzPzogbnVtYmVyLCBuYW1lZFZhcmlhYmxlcz86IG51bWJlcikge1xuXHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdFx0dGhpcy52YWx1ZSA9IHZhbHVlO1xuXHRcdHRoaXMudmFyaWFibGVzUmVmZXJlbmNlID0gcmVmO1xuXHRcdGlmICh0eXBlb2YgbmFtZWRWYXJpYWJsZXMgPT09ICdudW1iZXInKSB7XG5cdFx0XHQoPERlYnVnUHJvdG9jb2wuVmFyaWFibGU+dGhpcykubmFtZWRWYXJpYWJsZXMgPSBuYW1lZFZhcmlhYmxlcztcblx0XHR9XG5cdFx0aWYgKHR5cGVvZiBpbmRleGVkVmFyaWFibGVzID09PSAnbnVtYmVyJykge1xuXHRcdFx0KDxEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlPnRoaXMpLmluZGV4ZWRWYXJpYWJsZXMgPSBpbmRleGVkVmFyaWFibGVzO1xuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQnJlYWtwb2ludCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuQnJlYWtwb2ludCB7XG5cdHZlcmlmaWVkOiBib29sZWFuO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3Rvcih2ZXJpZmllZDogYm9vbGVhbiwgbGluZT86IG51bWJlciwgY29sdW1uPzogbnVtYmVyLCBzb3VyY2U/OiBTb3VyY2UpIHtcblx0XHR0aGlzLnZlcmlmaWVkID0gdmVyaWZpZWQ7XG5cdFx0Y29uc3QgZTogRGVidWdQcm90b2NvbC5CcmVha3BvaW50ID0gdGhpcztcblx0XHRpZiAodHlwZW9mIGxpbmUgPT09ICdudW1iZXInKSB7XG5cdFx0XHRlLmxpbmUgPSBsaW5lO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGNvbHVtbiA9PT0gJ251bWJlcicpIHtcblx0XHRcdGUuY29sdW1uID0gY29sdW1uO1xuXHRcdH1cblx0XHRpZiAoc291cmNlKSB7XG5cdFx0XHRlLnNvdXJjZSA9IHNvdXJjZTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vZHVsZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuTW9kdWxlIHtcblx0aWQ6IG51bWJlciB8IHN0cmluZztcblx0bmFtZTogc3RyaW5nO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihpZDogbnVtYmVyIHwgc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQ29tcGxldGlvbkl0ZW0gaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkNvbXBsZXRpb25JdGVtIHtcblx0bGFiZWw6IHN0cmluZztcblx0c3RhcnQ6IG51bWJlcjtcblx0bGVuZ3RoOiBudW1iZXI7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGxhYmVsOiBzdHJpbmcsIHN0YXJ0OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyID0gMCkge1xuXHRcdHRoaXMubGFiZWwgPSBsYWJlbDtcblx0XHR0aGlzLnN0YXJ0ID0gc3RhcnQ7XG5cdFx0dGhpcy5sZW5ndGggPSBsZW5ndGg7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0b3BwZWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5TdG9wcGVkRXZlbnQge1xuXHRib2R5OiB7XG5cdFx0cmVhc29uOiBzdHJpbmc7XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCB0aHJlYWRJZD86IG51bWJlciwgZXhjZXB0aW9uVGV4dD86IHN0cmluZykge1xuXHRcdHN1cGVyKCdzdG9wcGVkJyk7XG5cdFx0dGhpcy5ib2R5ID0ge1xuXHRcdFx0cmVhc29uOiByZWFzb25cblx0XHR9O1xuXHRcdGlmICh0eXBlb2YgdGhyZWFkSWQgPT09ICdudW1iZXInKSB7XG5cdFx0XHQodGhpcyBhcyBEZWJ1Z1Byb3RvY29sLlN0b3BwZWRFdmVudCkuYm9keS50aHJlYWRJZCA9IHRocmVhZElkO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGV4Y2VwdGlvblRleHQgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHQodGhpcyBhcyBEZWJ1Z1Byb3RvY29sLlN0b3BwZWRFdmVudCkuYm9keS50ZXh0ID0gZXhjZXB0aW9uVGV4dDtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbnRpbnVlZEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlZEV2ZW50IHtcblx0Ym9keToge1xuXHRcdHRocmVhZElkOiBudW1iZXI7XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHRocmVhZElkOiBudW1iZXIsIGFsbFRocmVhZHNDb250aW51ZWQ/OiBib29sZWFuKSB7XG5cdFx0c3VwZXIoJ2NvbnRpbnVlZCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHRocmVhZElkOiB0aHJlYWRJZFxuXHRcdH07XG5cblx0XHRpZiAodHlwZW9mIGFsbFRocmVhZHNDb250aW51ZWQgPT09ICdib29sZWFuJykge1xuXHRcdFx0KDxEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlZEV2ZW50PnRoaXMpLmJvZHkuYWxsVGhyZWFkc0NvbnRpbnVlZCA9IGFsbFRocmVhZHNDb250aW51ZWQ7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBJbml0aWFsaXplZEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkluaXRpYWxpemVkRXZlbnQge1xuXHRwdWJsaWMgY29uc3RydWN0b3IoKSB7XG5cdFx0c3VwZXIoJ2luaXRpYWxpemVkJyk7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFRlcm1pbmF0ZWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5UZXJtaW5hdGVkRXZlbnQge1xuXHRwdWJsaWMgY29uc3RydWN0b3IocmVzdGFydD86IGFueSkge1xuXHRcdHN1cGVyKCd0ZXJtaW5hdGVkJyk7XG5cdFx0aWYgKHR5cGVvZiByZXN0YXJ0ID09PSAnYm9vbGVhbicgfHwgcmVzdGFydCkge1xuXHRcdFx0Y29uc3QgZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVkRXZlbnQgPSB0aGlzO1xuXHRcdFx0ZS5ib2R5ID0ge1xuXHRcdFx0XHRyZXN0YXJ0OiByZXN0YXJ0XG5cdFx0XHR9O1xuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgY2xhc3MgT3V0cHV0RXZlbnQgZXh0ZW5kcyBFdmVudCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuT3V0cHV0RXZlbnQge1xuXHRib2R5OiB7XG5cdFx0Y2F0ZWdvcnk6IHN0cmluZyxcblx0XHRvdXRwdXQ6IHN0cmluZyxcblx0XHRkYXRhPzogYW55XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG91dHB1dDogc3RyaW5nLCBjYXRlZ29yeTogc3RyaW5nID0gJ2NvbnNvbGUnLCBkYXRhPzogYW55KSB7XG5cdFx0c3VwZXIoJ291dHB1dCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdGNhdGVnb3J5OiBjYXRlZ29yeSxcblx0XHRcdG91dHB1dDogb3V0cHV0XG5cdFx0fTtcblx0XHRpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHR0aGlzLmJvZHkuZGF0YSA9IGRhdGE7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBUaHJlYWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5UaHJlYWRFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246IHN0cmluZyxcblx0XHR0aHJlYWRJZDogbnVtYmVyXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCB0aHJlYWRJZDogbnVtYmVyKSB7XG5cdFx0c3VwZXIoJ3RocmVhZCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0dGhyZWFkSWQ6IHRocmVhZElkXG5cdFx0fTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQnJlYWtwb2ludEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkJyZWFrcG9pbnRFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246IHN0cmluZyxcblx0XHRicmVha3BvaW50OiBCcmVha3BvaW50XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCBicmVha3BvaW50OiBCcmVha3BvaW50KSB7XG5cdFx0c3VwZXIoJ2JyZWFrcG9pbnQnKTtcblx0XHR0aGlzLmJvZHkgPSB7XG5cdFx0XHRyZWFzb246IHJlYXNvbixcblx0XHRcdGJyZWFrcG9pbnQ6IGJyZWFrcG9pbnRcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBNb2R1bGVFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5Nb2R1bGVFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246ICduZXcnIHwgJ2NoYW5nZWQnIHwgJ3JlbW92ZWQnLFxuXHRcdG1vZHVsZTogTW9kdWxlXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogJ25ldycgfCAnY2hhbmdlZCcgfCAncmVtb3ZlZCcsIG1vZHVsZTogTW9kdWxlKSB7XG5cdFx0c3VwZXIoJ21vZHVsZScpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0bW9kdWxlOiBtb2R1bGVcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBMb2FkZWRTb3VyY2VFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246ICduZXcnIHwgJ2NoYW5nZWQnIHwgJ3JlbW92ZWQnLFxuXHRcdHNvdXJjZTogU291cmNlXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogJ25ldycgfCAnY2hhbmdlZCcgfCAncmVtb3ZlZCcsIHNvdXJjZTogU291cmNlKSB7XG5cdFx0c3VwZXIoJ2xvYWRlZFNvdXJjZScpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0c291cmNlOiBzb3VyY2Vcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBDYXBhYmlsaXRpZXNFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5DYXBhYmlsaXRpZXNFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRjYXBhYmlsaXRpZXM6IERlYnVnUHJvdG9jb2wuQ2FwYWJpbGl0aWVzXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGNhcGFiaWxpdGllczogRGVidWdQcm90b2NvbC5DYXBhYmlsaXRpZXMpIHtcblx0XHRzdXBlcignY2FwYWJpbGl0aWVzJyk7XG5cdFx0dGhpcy5ib2R5ID0ge1xuXHRcdFx0Y2FwYWJpbGl0aWVzOiBjYXBhYmlsaXRpZXNcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBlbnVtIEVycm9yRGVzdGluYXRpb24ge1xuXHRVc2VyID0gMSxcblx0VGVsZW1ldHJ5ID0gMlxufTtcblxuZXhwb3J0IGNsYXNzIERlYnVnU2Vzc2lvbiBleHRlbmRzIFByb3RvY29sU2VydmVyIHtcblxuXHRwcml2YXRlIF9kZWJ1Z2dlckxpbmVzU3RhcnRBdDE6IGJvb2xlYW47XG5cdHByaXZhdGUgX2RlYnVnZ2VyQ29sdW1uc1N0YXJ0QXQxOiBib29sZWFuO1xuXHRwcml2YXRlIF9kZWJ1Z2dlclBhdGhzQXJlVVJJczogYm9vbGVhbjtcblxuXHRwcml2YXRlIF9jbGllbnRMaW5lc1N0YXJ0QXQxOiBib29sZWFuO1xuXHRwcml2YXRlIF9jbGllbnRDb2x1bW5zU3RhcnRBdDE6IGJvb2xlYW47XG5cdHByaXZhdGUgX2NsaWVudFBhdGhzQXJlVVJJczogYm9vbGVhbjtcblxuXHRwcm90ZWN0ZWQgX2lzU2VydmVyOiBib29sZWFuO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihvYnNvbGV0ZV9kZWJ1Z2dlckxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxPzogYm9vbGVhbiwgb2Jzb2xldGVfaXNTZXJ2ZXI/OiBib29sZWFuKSB7XG5cdFx0c3VwZXIoKTtcblxuXHRcdGNvbnN0IGxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxID0gdHlwZW9mIG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDEgPT09ICdib29sZWFuJyA/IG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDEgOiBmYWxzZTtcblx0XHR0aGlzLl9kZWJ1Z2dlckxpbmVzU3RhcnRBdDEgPSBsaW5lc0FuZENvbHVtbnNTdGFydEF0MTtcblx0XHR0aGlzLl9kZWJ1Z2dlckNvbHVtbnNTdGFydEF0MSA9IGxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxO1xuXHRcdHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzID0gZmFsc2U7XG5cblx0XHR0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID0gdHJ1ZTtcblx0XHR0aGlzLl9jbGllbnRDb2x1bW5zU3RhcnRBdDEgPSB0cnVlO1xuXHRcdHRoaXMuX2NsaWVudFBhdGhzQXJlVVJJcyA9IGZhbHNlO1xuXG5cdFx0dGhpcy5faXNTZXJ2ZXIgPSB0eXBlb2Ygb2Jzb2xldGVfaXNTZXJ2ZXIgPT09ICdib29sZWFuJyA/IG9ic29sZXRlX2lzU2VydmVyIDogZmFsc2U7XG5cblx0XHR0aGlzLm9uKCdjbG9zZScsICgpID0+IHtcblx0XHRcdHRoaXMuc2h1dGRvd24oKTtcblx0XHR9KTtcblx0XHR0aGlzLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuXHRcdFx0dGhpcy5zaHV0ZG93bigpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIHNldERlYnVnZ2VyUGF0aEZvcm1hdChmb3JtYXQ6IHN0cmluZykge1xuXHRcdHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzID0gZm9ybWF0ICE9PSAncGF0aCc7XG5cdH1cblxuXHRwdWJsaWMgc2V0RGVidWdnZXJMaW5lc1N0YXJ0QXQxKGVuYWJsZTogYm9vbGVhbikge1xuXHRcdHRoaXMuX2RlYnVnZ2VyTGluZXNTdGFydEF0MSA9IGVuYWJsZTtcblx0fVxuXG5cdHB1YmxpYyBzZXREZWJ1Z2dlckNvbHVtbnNTdGFydEF0MShlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9kZWJ1Z2dlckNvbHVtbnNTdGFydEF0MSA9IGVuYWJsZTtcblx0fVxuXG5cdHB1YmxpYyBzZXRSdW5Bc1NlcnZlcihlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9pc1NlcnZlciA9IGVuYWJsZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBBIHZpcnR1YWwgY29uc3RydWN0b3IuLi5cblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgcnVuKGRlYnVnU2Vzc2lvbjogdHlwZW9mIERlYnVnU2Vzc2lvbikge1xuXG5cdFx0Ly8gcGFyc2UgYXJndW1lbnRzXG5cdFx0bGV0IHBvcnQgPSAwO1xuXHRcdGNvbnN0IGFyZ3MgPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMik7XG5cdFx0YXJncy5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGluZGV4LCBhcnJheSkge1xuXHRcdFx0Y29uc3QgcG9ydE1hdGNoID0gL14tLXNlcnZlcj0oXFxkezQsNX0pJC8uZXhlYyh2YWwpO1xuXHRcdFx0aWYgKHBvcnRNYXRjaCkge1xuXHRcdFx0XHRwb3J0ID0gcGFyc2VJbnQocG9ydE1hdGNoWzFdLCAxMCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAocG9ydCA+IDApIHtcblx0XHRcdC8vIHN0YXJ0IGFzIGEgc2VydmVyXG5cdFx0XHRjb25zb2xlLmVycm9yKGB3YWl0aW5nIGZvciBkZWJ1ZyBwcm90b2NvbCBvbiBwb3J0ICR7cG9ydH1gKTtcblx0XHRcdE5ldC5jcmVhdGVTZXJ2ZXIoKHNvY2tldCkgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCc+PiBhY2NlcHRlZCBjb25uZWN0aW9uIGZyb20gY2xpZW50Jyk7XG5cdFx0XHRcdHNvY2tldC5vbignZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoJz4+IGNsaWVudCBjb25uZWN0aW9uIGNsb3NlZFxcbicpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0Y29uc3Qgc2Vzc2lvbiA9IG5ldyBkZWJ1Z1Nlc3Npb24oZmFsc2UsIHRydWUpO1xuXHRcdFx0XHRzZXNzaW9uLnNldFJ1bkFzU2VydmVyKHRydWUpO1xuXHRcdFx0XHRzZXNzaW9uLnN0YXJ0KHNvY2tldCwgc29ja2V0KTtcblx0XHRcdH0pLmxpc3Rlbihwb3J0KTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvLyBzdGFydCBhIHNlc3Npb25cblx0XHRcdC8vY29uc29sZS5lcnJvcignd2FpdGluZyBmb3IgZGVidWcgcHJvdG9jb2wgb24gc3RkaW4vc3Rkb3V0Jyk7XG5cdFx0XHRjb25zdCBzZXNzaW9uID0gbmV3IGRlYnVnU2Vzc2lvbihmYWxzZSk7XG5cdFx0XHRwcm9jZXNzLm9uKCdTSUdURVJNJywgKCkgPT4ge1xuXHRcdFx0XHRzZXNzaW9uLnNodXRkb3duKCk7XG5cdFx0XHR9KTtcblx0XHRcdHNlc3Npb24uc3RhcnQocHJvY2Vzcy5zdGRpbiwgcHJvY2Vzcy5zdGRvdXQpO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBzaHV0ZG93bigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5faXNTZXJ2ZXIgfHwgdGhpcy5faXNSdW5uaW5nSW5saW5lKCkpIHtcblx0XHRcdC8vIHNodXRkb3duIGlnbm9yZWQgaW4gc2VydmVyIG1vZGVcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gd2FpdCBhIGJpdCBiZWZvcmUgc2h1dHRpbmcgZG93blxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHByb2Nlc3MuZXhpdCgwKTtcblx0XHRcdH0sIDEwMCk7XG5cdFx0fVxuXHR9XG5cblx0cHJvdGVjdGVkIHNlbmRFcnJvclJlc3BvbnNlKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlLCBjb2RlT3JNZXNzYWdlOiBudW1iZXIgfCBEZWJ1Z1Byb3RvY29sLk1lc3NhZ2UsIGZvcm1hdD86IHN0cmluZywgdmFyaWFibGVzPzogYW55LCBkZXN0OiBFcnJvckRlc3RpbmF0aW9uID0gRXJyb3JEZXN0aW5hdGlvbi5Vc2VyKTogdm9pZCB7XG5cblx0XHRsZXQgbXNnIDogRGVidWdQcm90b2NvbC5NZXNzYWdlO1xuXHRcdGlmICh0eXBlb2YgY29kZU9yTWVzc2FnZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdG1zZyA9IDxEZWJ1Z1Byb3RvY29sLk1lc3NhZ2U+IHtcblx0XHRcdFx0aWQ6IDxudW1iZXI+IGNvZGVPck1lc3NhZ2UsXG5cdFx0XHRcdGZvcm1hdDogZm9ybWF0XG5cdFx0XHR9O1xuXHRcdFx0aWYgKHZhcmlhYmxlcykge1xuXHRcdFx0XHRtc2cudmFyaWFibGVzID0gdmFyaWFibGVzO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGRlc3QgJiBFcnJvckRlc3RpbmF0aW9uLlVzZXIpIHtcblx0XHRcdFx0bXNnLnNob3dVc2VyID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGlmIChkZXN0ICYgRXJyb3JEZXN0aW5hdGlvbi5UZWxlbWV0cnkpIHtcblx0XHRcdFx0bXNnLnNlbmRUZWxlbWV0cnkgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRtc2cgPSBjb2RlT3JNZXNzYWdlO1xuXHRcdH1cblxuXHRcdHJlc3BvbnNlLnN1Y2Nlc3MgPSBmYWxzZTtcblx0XHRyZXNwb25zZS5tZXNzYWdlID0gRGVidWdTZXNzaW9uLmZvcm1hdFBJSShtc2cuZm9ybWF0LCB0cnVlLCBtc2cudmFyaWFibGVzKTtcblx0XHRpZiAoIXJlc3BvbnNlLmJvZHkpIHtcblx0XHRcdHJlc3BvbnNlLmJvZHkgPSB7IH07XG5cdFx0fVxuXHRcdHJlc3BvbnNlLmJvZHkuZXJyb3IgPSBtc2c7XG5cblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwdWJsaWMgcnVuSW5UZXJtaW5hbFJlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5SdW5JblRlcm1pbmFsUmVxdWVzdEFyZ3VtZW50cywgdGltZW91dDogbnVtYmVyLCBjYjogKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJ1bkluVGVybWluYWxSZXNwb25zZSkgPT4gdm9pZCkge1xuXHRcdHRoaXMuc2VuZFJlcXVlc3QoJ3J1bkluVGVybWluYWwnLCBhcmdzLCB0aW1lb3V0LCBjYik7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZGlzcGF0Y2hSZXF1ZXN0KHJlcXVlc3Q6IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBuZXcgUmVzcG9uc2UocmVxdWVzdCk7XG5cblx0XHR0cnkge1xuXHRcdFx0aWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2luaXRpYWxpemUnKSB7XG5cdFx0XHRcdHZhciBhcmdzID0gPERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlcXVlc3RBcmd1bWVudHM+IHJlcXVlc3QuYXJndW1lbnRzO1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgYXJncy5saW5lc1N0YXJ0QXQxID09PSAnYm9vbGVhbicpIHtcblx0XHRcdFx0XHR0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID0gYXJncy5saW5lc1N0YXJ0QXQxO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0eXBlb2YgYXJncy5jb2x1bW5zU3RhcnRBdDEgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRcdHRoaXMuX2NsaWVudENvbHVtbnNTdGFydEF0MSA9IGFyZ3MuY29sdW1uc1N0YXJ0QXQxO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGFyZ3MucGF0aEZvcm1hdCAhPT0gJ3BhdGgnKSB7XG5cdFx0XHRcdFx0dGhpcy5zZW5kRXJyb3JSZXNwb25zZShyZXNwb25zZSwgMjAxOCwgJ2RlYnVnIGFkYXB0ZXIgb25seSBzdXBwb3J0cyBuYXRpdmUgcGF0aHMnLCBudWxsLCBFcnJvckRlc3RpbmF0aW9uLlRlbGVtZXRyeSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc3QgaW5pdGlhbGl6ZVJlc3BvbnNlID0gPERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlc3BvbnNlPiByZXNwb25zZTtcblx0XHRcdFx0XHRpbml0aWFsaXplUmVzcG9uc2UuYm9keSA9IHt9O1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZVJlcXVlc3QoaW5pdGlhbGl6ZVJlc3BvbnNlLCBhcmdzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2xhdW5jaCcpIHtcblx0XHRcdFx0dGhpcy5sYXVuY2hSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkxhdW5jaFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2F0dGFjaCcpIHtcblx0XHRcdFx0dGhpcy5hdHRhY2hSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2Rpc2Nvbm5lY3QnKSB7XG5cdFx0XHRcdHRoaXMuZGlzY29ubmVjdFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuRGlzY29ubmVjdFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Rlcm1pbmF0ZScpIHtcblx0XHRcdFx0dGhpcy50ZXJtaW5hdGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlRlcm1pbmF0ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Jlc3RhcnQnKSB7XG5cdFx0XHRcdHRoaXMucmVzdGFydFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuUmVzdGFydFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldEJyZWFrUG9pbnRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRCcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEZ1bmN0aW9uQnJlYWtwb2ludHMnKSB7XG5cdFx0XHRcdHRoaXMuc2V0RnVuY3Rpb25CcmVha1BvaW50c1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RnVuY3Rpb25CcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEV4Y2VwdGlvbkJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldEV4Y2VwdGlvbkJyZWFrUG9pbnRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRFeGNlcHRpb25CcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2NvbmZpZ3VyYXRpb25Eb25lJykge1xuXHRcdFx0XHR0aGlzLmNvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Db25maWd1cmF0aW9uRG9uZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2NvbnRpbnVlJykge1xuXHRcdFx0XHR0aGlzLmNvbnRpbnVlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Db250aW51ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ25leHQnKSB7XG5cdFx0XHRcdHRoaXMubmV4dFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuTmV4dFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBJbicpIHtcblx0XHRcdFx0dGhpcy5zdGVwSW5SZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlN0ZXBJblJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBPdXQnKSB7XG5cdFx0XHRcdHRoaXMuc3RlcE91dFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU3RlcE91dFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBCYWNrJykge1xuXHRcdFx0XHR0aGlzLnN0ZXBCYWNrUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TdGVwQmFja1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3JldmVyc2VDb250aW51ZScpIHtcblx0XHRcdFx0dGhpcy5yZXZlcnNlQ29udGludWVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Jlc3RhcnRGcmFtZScpIHtcblx0XHRcdFx0dGhpcy5yZXN0YXJ0RnJhbWVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlJlc3RhcnRGcmFtZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2dvdG8nKSB7XG5cdFx0XHRcdHRoaXMuZ290b1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuR290b1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3BhdXNlJykge1xuXHRcdFx0XHR0aGlzLnBhdXNlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5QYXVzZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0YWNrVHJhY2UnKSB7XG5cdFx0XHRcdHRoaXMuc3RhY2tUcmFjZVJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU3RhY2tUcmFjZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Njb3BlcycpIHtcblx0XHRcdFx0dGhpcy5zY29wZXNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlNjb3Blc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3ZhcmlhYmxlcycpIHtcblx0XHRcdFx0dGhpcy52YXJpYWJsZXNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldFZhcmlhYmxlJykge1xuXHRcdFx0XHR0aGlzLnNldFZhcmlhYmxlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRWYXJpYWJsZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEV4cHJlc3Npb24nKSB7XG5cdFx0XHRcdHRoaXMuc2V0RXhwcmVzc2lvblJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RXhwcmVzc2lvblJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NvdXJjZScpIHtcblx0XHRcdFx0dGhpcy5zb3VyY2VSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlNvdXJjZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3RocmVhZHMnKSB7XG5cdFx0XHRcdHRoaXMudGhyZWFkc1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuVGhyZWFkc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAndGVybWluYXRlVGhyZWFkcycpIHtcblx0XHRcdFx0dGhpcy50ZXJtaW5hdGVUaHJlYWRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5UZXJtaW5hdGVUaHJlYWRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZXZhbHVhdGUnKSB7XG5cdFx0XHRcdHRoaXMuZXZhbHVhdGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkV2YWx1YXRlUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnc3RlcEluVGFyZ2V0cycpIHtcblx0XHRcdFx0dGhpcy5zdGVwSW5UYXJnZXRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TdGVwSW5UYXJnZXRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZ290b1RhcmdldHMnKSB7XG5cdFx0XHRcdHRoaXMuZ290b1RhcmdldHNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkdvdG9UYXJnZXRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnY29tcGxldGlvbnMnKSB7XG5cdFx0XHRcdHRoaXMuY29tcGxldGlvbnNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkNvbXBsZXRpb25zUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZXhjZXB0aW9uSW5mbycpIHtcblx0XHRcdFx0dGhpcy5leGNlcHRpb25JbmZvUmVxdWVzdCg8RGVidWdQcm90b2NvbC5FeGNlcHRpb25JbmZvUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnbG9hZGVkU291cmNlcycpIHtcblx0XHRcdFx0dGhpcy5sb2FkZWRTb3VyY2VzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZGF0YUJyZWFrcG9pbnRJbmZvJykge1xuXHRcdFx0XHR0aGlzLmRhdGFCcmVha3BvaW50SW5mb1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuRGF0YUJyZWFrcG9pbnRJbmZvUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnc2V0RGF0YUJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldERhdGFCcmVha3BvaW50c1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RGF0YUJyZWFrcG9pbnRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAncmVhZE1lbW9yeScpIHtcblx0XHRcdFx0dGhpcy5yZWFkTWVtb3J5UmVxdWVzdCg8RGVidWdQcm90b2NvbC5SZWFkTWVtb3J5UmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZGlzYXNzZW1ibGUnKSB7XG5cdFx0XHRcdHRoaXMuZGlzYXNzZW1ibGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkRpc2Fzc2VtYmxlUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnY2FuY2VsJykge1xuXHRcdFx0XHR0aGlzLmNhbmNlbFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuQ2FuY2VsUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnYnJlYWtwb2ludExvY2F0aW9ucycpIHtcblx0XHRcdFx0dGhpcy5icmVha3BvaW50TG9jYXRpb25zUmVxdWVzdCg8RGVidWdQcm90b2NvbC5CcmVha3BvaW50TG9jYXRpb25zUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY3VzdG9tUmVxdWVzdChyZXF1ZXN0LmNvbW1hbmQsIDxEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdHRoaXMuc2VuZEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDExMDQsICd7X3N0YWNrfScsIHsgX2V4Y2VwdGlvbjogZS5tZXNzYWdlLCBfc3RhY2s6IGUuc3RhY2sgfSwgRXJyb3JEZXN0aW5hdGlvbi5UZWxlbWV0cnkpO1xuXHRcdH1cblx0fVxuXG5cdHByb3RlY3RlZCBpbml0aWFsaXplUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Jbml0aWFsaXplUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlcXVlc3RBcmd1bWVudHMpOiB2b2lkIHtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgY29uZGl0aW9uYWwgYnJlYWtwb2ludHMuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbmRpdGlvbmFsQnJlYWtwb2ludHMgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgaGl0IGNvbmRpdGlvbmFsIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNIaXRDb25kaXRpb25hbEJyZWFrcG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IGZ1bmN0aW9uIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNGdW5jdGlvbkJyZWFrcG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBpbXBsZW1lbnRzIHRoZSAnY29uZmlndXJhdGlvbkRvbmUnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCA9IHRydWU7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IGhvdmVycyBiYXNlZCBvbiB0aGUgJ2V2YWx1YXRlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNFdmFsdWF0ZUZvckhvdmVycyA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3N0ZXBCYWNrJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNTdGVwQmFjayA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3NldFZhcmlhYmxlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNTZXRWYXJpYWJsZSA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Jlc3RhcnRGcmFtZScgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzUmVzdGFydEZyYW1lID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnc3RlcEluVGFyZ2V0cycgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzU3RlcEluVGFyZ2V0c1JlcXVlc3QgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdnb3RvVGFyZ2V0cycgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzR290b1RhcmdldHNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnY29tcGxldGlvbnMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbXBsZXRpb25zUmVxdWVzdCA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Jlc3RhcnQnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1Jlc3RhcnRSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnZXhjZXB0aW9uT3B0aW9ucycgYXR0cmlidXRlIG9uIHRoZSAnc2V0RXhjZXB0aW9uQnJlYWtwb2ludHMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0V4Y2VwdGlvbk9wdGlvbnMgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdmb3JtYXQnIGF0dHJpYnV0ZSBvbiB0aGUgJ3ZhcmlhYmxlcycsICdldmFsdWF0ZScsIGFuZCAnc3RhY2tUcmFjZScgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzVmFsdWVGb3JtYXR0aW5nT3B0aW9ucyA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdleGNlcHRpb25JbmZvJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNFeGNlcHRpb25JbmZvUmVxdWVzdCA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdUZXJtaW5hdGVEZWJ1Z2dlZScgYXR0cmlidXRlIG9uIHRoZSAnZGlzY29ubmVjdCcgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRUZXJtaW5hdGVEZWJ1Z2dlZSA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgZGVsYXllZCBsb2FkaW5nIG9mIHN0YWNrIGZyYW1lcy5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzRGVsYXllZFN0YWNrVHJhY2VMb2FkaW5nID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2xvYWRlZFNvdXJjZXMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0xvYWRlZFNvdXJjZXNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2xvZ01lc3NhZ2UnIGF0dHJpYnV0ZSBvZiB0aGUgU291cmNlQnJlYWtwb2ludC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzTG9nUG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Rlcm1pbmF0ZVRocmVhZHMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1Rlcm1pbmF0ZVRocmVhZHNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3NldEV4cHJlc3Npb24nIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1NldEV4cHJlc3Npb24gPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAndGVybWluYXRlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNUZXJtaW5hdGVSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCBkYXRhIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNEYXRhQnJlYWtwb2ludHMgPSBmYWxzZTtcblxuXHRcdC8qKiBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3JlYWRNZW1vcnknIHJlcXVlc3QuICovXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1JlYWRNZW1vcnlSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvKiogVGhlIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2Rpc2Fzc2VtYmxlJyByZXF1ZXN0LiAqL1xuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNEaXNhc3NlbWJsZVJlcXVlc3QgPSBmYWxzZTtcblxuXHRcdC8qKiBUaGUgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnY2FuY2VsJyByZXF1ZXN0LiAqL1xuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNDYW5jZWxSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvKiogVGhlIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2JyZWFrcG9pbnRMb2NhdGlvbnMnIHJlcXVlc3QuICovXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0JyZWFrcG9pbnRMb2NhdGlvbnNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZGlzY29ubmVjdFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRGlzY29ubmVjdFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkRpc2Nvbm5lY3RBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdFx0dGhpcy5zaHV0ZG93bigpO1xuXHR9XG5cblx0cHJvdGVjdGVkIGxhdW5jaFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuTGF1bmNoUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuTGF1bmNoUmVxdWVzdEFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBhdHRhY2hSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlcXVlc3RBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgdGVybWluYXRlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcmVzdGFydFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzdGFydFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlJlc3RhcnRBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0QnJlYWtQb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldEJyZWFrcG9pbnRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0QnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0RnVuY3Rpb25CcmVha1BvaW50c1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU2V0RnVuY3Rpb25CcmVha3BvaW50c1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldEZ1bmN0aW9uQnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0RXhjZXB0aW9uQnJlYWtQb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldEV4Y2VwdGlvbkJyZWFrcG9pbnRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RXhjZXB0aW9uQnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29uZmlndXJhdGlvbkRvbmVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNvbmZpZ3VyYXRpb25Eb25lUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQ29uZmlndXJhdGlvbkRvbmVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udGludWVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQ29udGludWVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIG5leHRSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLk5leHRSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5OZXh0QXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGVwSW5SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlN0ZXBJblJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBJbkFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc3RlcE91dFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU3RlcE91dFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBPdXRBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHN0ZXBCYWNrUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGVwQmFja1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBCYWNrQXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCByZXZlcnNlQ29udGludWVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZVJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcmVzdGFydEZyYW1lUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXN0YXJ0RnJhbWVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5SZXN0YXJ0RnJhbWVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIGdvdG9SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkdvdG9SZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Hb3RvQXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBwYXVzZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUGF1c2VSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5QYXVzZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc291cmNlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Tb3VyY2VSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Tb3VyY2VBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHRocmVhZHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlRocmVhZHNSZXNwb25zZSwgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCB0ZXJtaW5hdGVUaHJlYWRzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVUaHJlYWRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuVGVybWluYXRlVGhyZWFkc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGFja1RyYWNlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGFja1RyYWNlUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU3RhY2tUcmFjZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzY29wZXNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNjb3Blc1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNjb3Blc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCB2YXJpYWJsZXNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXRWYXJpYWJsZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU2V0VmFyaWFibGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5TZXRWYXJpYWJsZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXRFeHByZXNzaW9uUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TZXRFeHByZXNzaW9uUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RXhwcmVzc2lvbkFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBldmFsdWF0ZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRXZhbHVhdGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5FdmFsdWF0ZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGVwSW5UYXJnZXRzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGVwSW5UYXJnZXRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU3RlcEluVGFyZ2V0c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBnb3RvVGFyZ2V0c1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuR290b1RhcmdldHNSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Hb3RvVGFyZ2V0c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBjb21wbGV0aW9uc1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuQ29tcGxldGlvbnNSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Db21wbGV0aW9uc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBleGNlcHRpb25JbmZvUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5FeGNlcHRpb25JbmZvUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuRXhjZXB0aW9uSW5mb0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBsb2FkZWRTb3VyY2VzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuTG9hZGVkU291cmNlc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkYXRhQnJlYWtwb2ludEluZm9SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkRhdGFCcmVha3BvaW50SW5mb1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkRhdGFCcmVha3BvaW50SW5mb0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXREYXRhQnJlYWtwb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldERhdGFCcmVha3BvaW50c1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldERhdGFCcmVha3BvaW50c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCByZWFkTWVtb3J5UmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZWFkTWVtb3J5UmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuUmVhZE1lbW9yeUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkaXNhc3NlbWJsZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRGlzYXNzZW1ibGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5EaXNhc3NlbWJsZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBjYW5jZWxSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNhbmNlbFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkNhbmNlbEFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBicmVha3BvaW50TG9jYXRpb25zUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5CcmVha3BvaW50TG9jYXRpb25zUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQnJlYWtwb2ludExvY2F0aW9uc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBPdmVycmlkZSB0aGlzIGhvb2sgdG8gaW1wbGVtZW50IGN1c3RvbSByZXF1ZXN0cy5cblx0ICovXG5cdHByb3RlY3RlZCBjdXN0b21SZXF1ZXN0KGNvbW1hbmQ6IHN0cmluZywgcmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzcG9uc2UsIGFyZ3M6IGFueSwgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDEwMTQsICd1bnJlY29nbml6ZWQgcmVxdWVzdCcsIG51bGwsIEVycm9yRGVzdGluYXRpb24uVGVsZW1ldHJ5KTtcblx0fVxuXG5cdC8vLS0tLSBwcm90ZWN0ZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHByb3RlY3RlZCBjb252ZXJ0Q2xpZW50TGluZVRvRGVidWdnZXIobGluZTogbnVtYmVyKTogbnVtYmVyIHtcblx0XHRpZiAodGhpcy5fZGVidWdnZXJMaW5lc1N0YXJ0QXQxKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2xpZW50TGluZXNTdGFydEF0MSA/IGxpbmUgOiBsaW5lICsgMTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuX2NsaWVudExpbmVzU3RhcnRBdDEgPyBsaW5lIC0gMSA6IGxpbmU7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udmVydERlYnVnZ2VyTGluZVRvQ2xpZW50KGxpbmU6IG51bWJlcik6IG51bWJlciB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyTGluZXNTdGFydEF0MSkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2NsaWVudExpbmVzU3RhcnRBdDEgPyBsaW5lIDogbGluZSAtIDE7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID8gbGluZSArIDEgOiBsaW5lO1xuXHR9XG5cblx0cHJvdGVjdGVkIGNvbnZlcnRDbGllbnRDb2x1bW5Ub0RlYnVnZ2VyKGNvbHVtbjogbnVtYmVyKTogbnVtYmVyIHtcblx0XHRpZiAodGhpcy5fZGVidWdnZXJDb2x1bW5zU3RhcnRBdDEpIHtcblx0XHRcdHJldHVybiB0aGlzLl9jbGllbnRDb2x1bW5zU3RhcnRBdDEgPyBjb2x1bW4gOiBjb2x1bW4gKyAxO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5fY2xpZW50Q29sdW1uc1N0YXJ0QXQxID8gY29sdW1uIC0gMSA6IGNvbHVtbjtcblx0fVxuXG5cdHByb3RlY3RlZCBjb252ZXJ0RGVidWdnZXJDb2x1bW5Ub0NsaWVudChjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyQ29sdW1uc1N0YXJ0QXQxKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2xpZW50Q29sdW1uc1N0YXJ0QXQxID8gY29sdW1uIDogY29sdW1uIC0gMTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuX2NsaWVudENvbHVtbnNTdGFydEF0MSA/IGNvbHVtbiArIDEgOiBjb2x1bW47XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udmVydENsaWVudFBhdGhUb0RlYnVnZ2VyKGNsaWVudFBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMuX2NsaWVudFBhdGhzQXJlVVJJcyAhPT0gdGhpcy5fZGVidWdnZXJQYXRoc0FyZVVSSXMpIHtcblx0XHRcdGlmICh0aGlzLl9jbGllbnRQYXRoc0FyZVVSSXMpIHtcblx0XHRcdFx0cmV0dXJuIERlYnVnU2Vzc2lvbi51cmkycGF0aChjbGllbnRQYXRoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBEZWJ1Z1Nlc3Npb24ucGF0aDJ1cmkoY2xpZW50UGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBjbGllbnRQYXRoO1xuXHR9XG5cblx0cHJvdGVjdGVkIGNvbnZlcnREZWJ1Z2dlclBhdGhUb0NsaWVudChkZWJ1Z2dlclBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzICE9PSB0aGlzLl9jbGllbnRQYXRoc0FyZVVSSXMpIHtcblx0XHRcdGlmICh0aGlzLl9kZWJ1Z2dlclBhdGhzQXJlVVJJcykge1xuXHRcdFx0XHRyZXR1cm4gRGVidWdTZXNzaW9uLnVyaTJwYXRoKGRlYnVnZ2VyUGF0aCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gRGVidWdTZXNzaW9uLnBhdGgydXJpKGRlYnVnZ2VyUGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBkZWJ1Z2dlclBhdGg7XG5cdH1cblxuXHQvLy0tLS0gcHJpdmF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHJpdmF0ZSBzdGF0aWMgcGF0aDJ1cmkocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcblxuXHRcdGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XG5cdFx0XHRpZiAoL15bQS1aXTovLnRlc3QocGF0aCkpIHtcblx0XHRcdFx0cGF0aCA9IHBhdGhbMF0udG9Mb3dlckNhc2UoKSArIHBhdGguc3Vic3RyKDEpO1xuXHRcdFx0fVxuXHRcdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFxcXC9nLCAnLycpO1xuXHRcdH1cblx0XHRwYXRoID0gZW5jb2RlVVJJKHBhdGgpO1xuXG5cdFx0bGV0IHVyaSA9IG5ldyBVUkwoYGZpbGU6YCk7XHQvLyBpZ25vcmUgJ3BhdGgnIGZvciBub3dcblx0XHR1cmkucGF0aG5hbWUgPSBwYXRoO1x0Ly8gbm93IHVzZSAncGF0aCcgdG8gZ2V0IHRoZSBjb3JyZWN0IHBlcmNlbnQgZW5jb2RpbmcgKHNlZSBodHRwczovL3VybC5zcGVjLndoYXR3Zy5vcmcpXG5cdFx0cmV0dXJuIHVyaS50b1N0cmluZygpO1xuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgdXJpMnBhdGgoc291cmNlVXJpOiBzdHJpbmcpOiBzdHJpbmcge1xuXG5cdFx0bGV0IHVyaSA9IG5ldyBVUkwoc291cmNlVXJpKTtcblx0XHRsZXQgcyA9IGRlY29kZVVSSUNvbXBvbmVudCh1cmkucGF0aG5hbWUpO1xuXHRcdGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XG5cdFx0XHRpZiAoL15cXC9bYS16QS1aXTovLnRlc3QocykpIHtcblx0XHRcdFx0cyA9IHNbMV0udG9Mb3dlckNhc2UoKSArIHMuc3Vic3RyKDIpO1xuXHRcdFx0fVxuXHRcdFx0cyA9IHMucmVwbGFjZSgvXFwvL2csICdcXFxcJyk7XG5cdFx0fVxuXHRcdHJldHVybiBzO1xuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgX2Zvcm1hdFBJSVJlZ2V4cCA9IC97KFtefV0rKX0vZztcblxuXHQvKlxuXHQqIElmIGFyZ3VtZW50IHN0YXJ0cyB3aXRoICdfJyBpdCBpcyBPSyB0byBzZW5kIGl0cyB2YWx1ZSB0byB0ZWxlbWV0cnkuXG5cdCovXG5cdHByaXZhdGUgc3RhdGljIGZvcm1hdFBJSShmb3JtYXQ6c3RyaW5nLCBleGNsdWRlUElJOiBib29sZWFuLCBhcmdzOiB7W2tleTogc3RyaW5nXTogc3RyaW5nfSk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIGZvcm1hdC5yZXBsYWNlKERlYnVnU2Vzc2lvbi5fZm9ybWF0UElJUmVnZXhwLCBmdW5jdGlvbihtYXRjaCwgcGFyYW1OYW1lKSB7XG5cdFx0XHRpZiAoZXhjbHVkZVBJSSAmJiBwYXJhbU5hbWUubGVuZ3RoID4gMCAmJiBwYXJhbU5hbWVbMF0gIT09ICdfJykge1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gYXJnc1twYXJhbU5hbWVdICYmIGFyZ3MuaGFzT3duUHJvcGVydHkocGFyYW1OYW1lKSA/XG5cdFx0XHRcdGFyZ3NbcGFyYW1OYW1lXSA6XG5cdFx0XHRcdG1hdGNoO1xuXHRcdH0pXG5cdH1cbn1cbiJdfQ==","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Message {\n    constructor(type) {\n        this.seq = 0;\n        this.type = type;\n    }\n}\nexports.Message = Message;\nclass Response extends Message {\n    constructor(request, message) {\n        super('response');\n        this.request_seq = request.seq;\n        this.command = request.command;\n        if (message) {\n            this.success = false;\n            this.message = message;\n        }\n        else {\n            this.success = true;\n        }\n    }\n}\nexports.Response = Response;\nclass Event extends Message {\n    constructor(event, body) {\n        super('event');\n        this.event = event;\n        if (body) {\n            this.body = body;\n        }\n    }\n}\nexports.Event = Event;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvbWVzc2FnZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Z0dBR2dHOztBQUtoRyxNQUFhLE9BQU87SUFJbkIsWUFBbUIsSUFBWTtRQUM5QixJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztRQUNiLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ2xCLENBQUM7Q0FDRDtBQVJELDBCQVFDO0FBRUQsTUFBYSxRQUFTLFNBQVEsT0FBTztJQUtwQyxZQUFtQixPQUE4QixFQUFFLE9BQWdCO1FBQ2xFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNsQixJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDL0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQy9CLElBQUksT0FBTyxFQUFFO1lBQ1osSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDZixJQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztTQUM5QjthQUFNO1lBQ04sSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7U0FDcEI7SUFDRixDQUFDO0NBQ0Q7QUFoQkQsNEJBZ0JDO0FBRUQsTUFBYSxLQUFNLFNBQVEsT0FBTztJQUdqQyxZQUFtQixLQUFhLEVBQUUsSUFBVTtRQUMzQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLElBQUksRUFBRTtZQUNILElBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1NBQ3hCO0lBQ0YsQ0FBQztDQUNEO0FBVkQsc0JBVUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHsgRGVidWdQcm90b2NvbCB9IGZyb20gJ3ZzY29kZS1kZWJ1Z3Byb3RvY29sJztcblxuXG5leHBvcnQgY2xhc3MgTWVzc2FnZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuUHJvdG9jb2xNZXNzYWdlIHtcblx0c2VxOiBudW1iZXI7XG5cdHR5cGU6IHN0cmluZztcblxuXHRwdWJsaWMgY29uc3RydWN0b3IodHlwZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5zZXEgPSAwO1xuXHRcdHRoaXMudHlwZSA9IHR5cGU7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlc3BvbnNlIGV4dGVuZHMgTWVzc2FnZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuUmVzcG9uc2Uge1xuXHRyZXF1ZXN0X3NlcTogbnVtYmVyO1xuXHRzdWNjZXNzOiBib29sZWFuO1xuXHRjb21tYW5kOiBzdHJpbmc7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlcXVlc3Q6IERlYnVnUHJvdG9jb2wuUmVxdWVzdCwgbWVzc2FnZT86IHN0cmluZykge1xuXHRcdHN1cGVyKCdyZXNwb25zZScpO1xuXHRcdHRoaXMucmVxdWVzdF9zZXEgPSByZXF1ZXN0LnNlcTtcblx0XHR0aGlzLmNvbW1hbmQgPSByZXF1ZXN0LmNvbW1hbmQ7XG5cdFx0aWYgKG1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuc3VjY2VzcyA9IGZhbHNlO1xuXHRcdFx0KDxhbnk+dGhpcykubWVzc2FnZSA9IG1lc3NhZ2U7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc3VjY2VzcyA9IHRydWU7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBFdmVudCBleHRlbmRzIE1lc3NhZ2UgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkV2ZW50IHtcblx0ZXZlbnQ6IHN0cmluZztcblxuXHRwdWJsaWMgY29uc3RydWN0b3IoZXZlbnQ6IHN0cmluZywgYm9keT86IGFueSkge1xuXHRcdHN1cGVyKCdldmVudCcpO1xuXHRcdHRoaXMuZXZlbnQgPSBldmVudDtcblx0XHRpZiAoYm9keSkge1xuXHRcdFx0KDxhbnk+dGhpcykuYm9keSA9IGJvZHk7XG5cdFx0fVxuXHR9XG59XG4iXX0=","import * as vscode from 'vscode';\r\nimport { lookupLabelReference, createDefinitionForLabelReference, MumpsLabel } from './mumps-label-lookup';\r\nconst definitionsArray = require('./../language-definitions.json');\r\n\r\nconst definitions = {};\r\nexports.definitions = definitions;\r\n\r\nclass MumpsToken {\r\n    _definition: any;\r\n    referredToLabel:MumpsLabel;\r\n    labelProgram: String;\r\n    labelOffset: number;\r\n    label: string;\r\n    _isLabelReference: Boolean;\r\n    document: vscode.TextDocument;\r\n    position:vscode.Position;\r\n    range:vscode.Range;\r\n    word:String;\r\n    surroundWord:String;\r\n\r\n    constructor(document, position) {\r\n        this.document = document;\r\n        this.position = position;\r\n\r\n        this.range = document.getWordRangeAtPosition(position);\r\n        if (!this.range) {\r\n            return;\r\n        }\r\n\r\n        this.word = document.getText(this.range);\r\n        if (!this.word) {\r\n            return;\r\n        }\r\n\r\n        this.surroundWord = getWordWithSurrounds(document, this.range) || this.word;\r\n\r\n        if (this.isIntrinsic) {\r\n            this.word = '$' + this.word;\r\n        }\r\n    }\r\n\r\n    get mayBeCommand() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        let lastChar = this.surroundWord.charAt(this.surroundWord.length - 1);\r\n        return (isWhitespace(this.surroundWord.charAt(0)) ||this.surroundWord.charAt(0)===\".\") &&\r\n            (lastChar === ':' ||\r\n                isWhitespace(lastChar) ||\r\n                this.surroundWord.length === this.word.length + 1);   // end-of-line\r\n    }\r\n\r\n    get isIntrinsic() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        return this.surroundWord.charAt(0) === '$' && this.surroundWord.charAt(1) !== '$';\r\n    }\r\n\r\n    get isFunctionCall() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        return this.surroundWord.charAt(this.surroundWord.length - 1) === '(';\r\n    }\r\n\r\n    get isLabelReference() {\r\n        if (this._isLabelReference === undefined) {\r\n            let line = this.document.lineAt(this.range.start);\r\n            let word = this.isIntrinsic ? this.word.substring(1) : this.word;\r\n            let regex = new RegExp('(([ \\t](D|DO|G|GOTO)[ \\t]+)|\\\\$\\\\$)([%\\\\^\\\\+A-Z0-9]*' + word + '[%\\\\^\\\\+A-Z0-9]*)', 'i');\r\n            let match = regex.exec(line.text);\r\n            this._isLabelReference = match !== null;\r\n            if (match) {\r\n                let fullLabel = match[4];\r\n                let partsRegex = /([%A-Z][%A-Z0-9]*)?(\\+\\d+)?(\\^[%A-Z][%A-Z0-9]*)?/gi;\r\n\t\t\t\t\t\t\t\tlet parts = partsRegex.exec(fullLabel);\r\n\t\t\t\t\t\t\t\tif (parts) {\r\n\t\t\t\t\t\t\t\t\tthis.label = parts[1];\r\n\t\t\t\t\t\t\t\t\tthis.labelOffset = Number(withoutFirstCharacter(parts[2]));\r\n\t\t\t\t\t\t\t\t\tthis.labelProgram = withoutFirstCharacter(parts[3]);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n                this.referredToLabel = lookupLabelReference(this);\r\n            }\r\n        }\r\n        return this._isLabelReference;\r\n    }\r\n\r\n    get definition() {\r\n        if (this._definition === undefined) {\r\n            this._definition = false;\r\n            let matches = definitions[this.word.toUpperCase()];\r\n            if (matches) {\r\n                for (let definition of matches) {\r\n                    if (this.isFunctionCall && definition.type !== 'function') {\r\n                        continue;\r\n                    }\r\n                    this._definition = definition;\r\n                    break;\r\n                }\r\n            } else if (this.isLabelReference) {\r\n                this._definition = createDefinitionForLabelReference(this.referredToLabel);\r\n            }\r\n            if (this._definition && this._definition.type === 'function') {\r\n                this._definition.functionSignature = formatFunctionSignature(this._definition);\r\n            }\r\n        }\r\n        return this._definition;\r\n    }\r\n}\r\n\r\n\r\nfunction getWordWithSurrounds(document, range) {\r\n    if (range.start.character <= 0) {\r\n        return;\r\n    }\r\n    let start = new vscode.Position(range.start.line, range.start.character - 1);\r\n    let end = new vscode.Position(range.end.line, range.end.character + 1);\r\n    let surroundWord = document.getText(new vscode.Range(start, end));\r\n\r\n    // check for two dollar signs\r\n    if (surroundWord.charAt(0) === '$') {\r\n        start = new vscode.Position(start.line, start.character - 1);\r\n        let extendedWord = document.getText(new vscode.Range(start, end));\r\n        if (extendedWord.charAt(0) === '$') {\r\n            surroundWord = extendedWord;\r\n        }\r\n    }\r\n    return surroundWord;\r\n}\r\n\r\nfunction isWhitespace(char) {\r\n    return /\\s+/.test(char);\r\n}\r\n\r\nfunction withoutFirstCharacter(string) {\r\n    return string ? string.substring(1) : string;\r\n}\r\n\r\nfunction formatFunctionSignature(definition) {\r\n    let signature = definition.name + '(';\r\n    if (definition.parameters) {\r\n        for (let i = 0; i < definition.parameters.length; i++) {\r\n            signature += formatParameter(definition.parameters[i], i === 0);\r\n        }\r\n    }\r\n    signature += ')';\r\n    if (definition.returns) {\r\n        signature += ':' + definition.returns.type;\r\n    }\r\n    return signature;\r\n}\r\n\r\nfunction formatParameter(parameter, first) {\r\n    let s = (first ? '' : ',');\r\n    s += parameter.name;\r\n    s += ':' + parameter.type;\r\n    if (parameter.optional) {\r\n        s = '[' + s + ']';\r\n    }\r\n    return s;\r\n}\r\n\r\nfunction addDefinition(name, definition) {\r\n    if (!definitions[name]) {\r\n        definitions[name] = [definition];\r\n    } else {\r\n        definitions[name].push(definition);\r\n    }\r\n}\r\n\r\nfor (let definition of definitionsArray) {\r\n    addDefinition(definition.name, definition);\r\n    if (definition.abbreviation) {\r\n        addDefinition(definition.abbreviation, definition);\r\n    }\r\n}\r\nexport {MumpsToken};","module.exports = require(\"events\");","module.exports = require(\"net\");","\"use strict\";\n/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\nconst path = require(\"path\");\nconst mkdirp = require(\"mkdirp\");\nconst debugSession_1 = require(\"./debugSession\");\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"Verbose\"] = 0] = \"Verbose\";\n    LogLevel[LogLevel[\"Log\"] = 1] = \"Log\";\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\n    LogLevel[LogLevel[\"Stop\"] = 4] = \"Stop\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\nclass Logger {\n    constructor() {\n        this._pendingLogQ = [];\n    }\n    log(msg, level = LogLevel.Log) {\n        msg = msg + '\\n';\n        this._write(msg, level);\n    }\n    verbose(msg) {\n        this.log(msg, LogLevel.Verbose);\n    }\n    warn(msg) {\n        this.log(msg, LogLevel.Warn);\n    }\n    error(msg) {\n        this.log(msg, LogLevel.Error);\n    }\n    dispose() {\n        if (this._currentLogger) {\n            const disposeP = this._currentLogger.dispose();\n            this._currentLogger = null;\n            return disposeP;\n        }\n        else {\n            return Promise.resolve();\n        }\n    }\n    /**\n     * `log` adds a newline, `write` doesn't\n     */\n    _write(msg, level = LogLevel.Log) {\n        // [null, undefined] => string\n        msg = msg + '';\n        if (this._pendingLogQ) {\n            this._pendingLogQ.push({ msg, level });\n        }\n        else if (this._currentLogger) {\n            this._currentLogger.log(msg, level);\n        }\n    }\n    /**\n     * Set the logger's minimum level to log in the console, and whether to log to the file. Log messages are queued before this is\n     * called the first time, because minLogLevel defaults to Warn.\n     */\n    setup(consoleMinLogLevel, _logFilePath, prependTimestamp = true) {\n        const logFilePath = typeof _logFilePath === 'string' ?\n            _logFilePath :\n            (_logFilePath && this._logFilePathFromInit);\n        if (this._currentLogger) {\n            const options = {\n                consoleMinLogLevel,\n                logFilePath,\n                prependTimestamp\n            };\n            this._currentLogger.setup(options).then(() => {\n                // Now that we have a minimum logLevel, we can clear out the queue of pending messages\n                if (this._pendingLogQ) {\n                    const logQ = this._pendingLogQ;\n                    this._pendingLogQ = null;\n                    logQ.forEach(item => this._write(item.msg, item.level));\n                }\n            });\n        }\n    }\n    init(logCallback, logFilePath, logToConsole) {\n        // Re-init, create new global Logger\n        this._pendingLogQ = this._pendingLogQ || [];\n        this._currentLogger = new InternalLogger(logCallback, logToConsole);\n        this._logFilePathFromInit = logFilePath;\n    }\n}\nexports.Logger = Logger;\nexports.logger = new Logger();\n/**\n * Manages logging, whether to console.log, file, or VS Code console.\n * Encapsulates the state specific to each logging session\n */\nclass InternalLogger {\n    constructor(logCallback, isServer) {\n        /** Dispose and allow exit to continue normally */\n        this.beforeExitCallback = () => this.dispose();\n        this._logCallback = logCallback;\n        this._logToConsole = isServer;\n        this._minLogLevel = LogLevel.Warn;\n        this.disposeCallback = (signal, code) => {\n            this.dispose();\n            // Exit with 128 + value of the signal code.\n            // https://nodejs.org/api/process.html#process_exit_codes\n            code = code || 2; // SIGINT\n            code += 128;\n            process.exit(code);\n        };\n    }\n    setup(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._minLogLevel = options.consoleMinLogLevel;\n            this._prependTimestamp = options.prependTimestamp;\n            // Open a log file in the specified location. Overwritten on each run.\n            if (options.logFilePath) {\n                if (!path.isAbsolute(options.logFilePath)) {\n                    this.log(`logFilePath must be an absolute path: ${options.logFilePath}`, LogLevel.Error);\n                }\n                else {\n                    const handleError = err => this.sendLog(`Error creating log file at path: ${options.logFilePath}. Error: ${err.toString()}\\n`, LogLevel.Error);\n                    try {\n                        yield mkdirpPromise(path.dirname(options.logFilePath));\n                        this.log(`Verbose logs are written to:\\n`, LogLevel.Warn);\n                        this.log(options.logFilePath + '\\n', LogLevel.Warn);\n                        this._logFileStream = fs.createWriteStream(options.logFilePath);\n                        this.logDateTime();\n                        this.setupShutdownListeners();\n                        this._logFileStream.on('error', err => {\n                            handleError(err);\n                        });\n                    }\n                    catch (err) {\n                        handleError(err);\n                    }\n                }\n            }\n        });\n    }\n    logDateTime() {\n        let d = new Date();\n        let dateString = d.getUTCFullYear() + '-' + `${d.getUTCMonth() + 1}` + '-' + d.getUTCDate();\n        const timeAndDateStamp = dateString + ', ' + getFormattedTimeString();\n        this.log(timeAndDateStamp + '\\n', LogLevel.Verbose, false);\n    }\n    setupShutdownListeners() {\n        process.addListener('beforeExit', this.beforeExitCallback);\n        process.addListener('SIGTERM', this.disposeCallback);\n        process.addListener('SIGINT', this.disposeCallback);\n    }\n    removeShutdownListeners() {\n        process.removeListener('beforeExit', this.beforeExitCallback);\n        process.removeListener('SIGTERM', this.disposeCallback);\n        process.removeListener('SIGINT', this.disposeCallback);\n    }\n    dispose() {\n        return new Promise(resolve => {\n            this.removeShutdownListeners();\n            if (this._logFileStream) {\n                this._logFileStream.end(resolve);\n                this._logFileStream = null;\n            }\n            else {\n                resolve();\n            }\n        });\n    }\n    log(msg, level, prependTimestamp = true) {\n        if (this._minLogLevel === LogLevel.Stop) {\n            return;\n        }\n        if (level >= this._minLogLevel) {\n            this.sendLog(msg, level);\n        }\n        if (this._logToConsole) {\n            const logFn = level === LogLevel.Error ? console.error :\n                level === LogLevel.Warn ? console.warn :\n                    null;\n            if (logFn) {\n                logFn(trimLastNewline(msg));\n            }\n        }\n        // If an error, prepend with '[Error]'\n        if (level === LogLevel.Error) {\n            msg = `[${LogLevel[level]}] ${msg}`;\n        }\n        if (this._prependTimestamp && prependTimestamp) {\n            msg = '[' + getFormattedTimeString() + '] ' + msg;\n        }\n        if (this._logFileStream) {\n            this._logFileStream.write(msg);\n        }\n    }\n    sendLog(msg, level) {\n        // Truncate long messages, they can hang VS Code\n        if (msg.length > 1500) {\n            const endsInNewline = !!msg.match(/(\\n|\\r\\n)$/);\n            msg = msg.substr(0, 1500) + '[...]';\n            if (endsInNewline) {\n                msg = msg + '\\n';\n            }\n        }\n        if (this._logCallback) {\n            const event = new LogOutputEvent(msg, level);\n            this._logCallback(event);\n        }\n    }\n}\nfunction mkdirpPromise(folder) {\n    return new Promise((resolve, reject) => {\n        mkdirp(folder, err => {\n            if (err) {\n                reject(err);\n            }\n            else {\n                resolve();\n            }\n        });\n    });\n}\nclass LogOutputEvent extends debugSession_1.OutputEvent {\n    constructor(msg, level) {\n        const category = level === LogLevel.Error ? 'stderr' :\n            level === LogLevel.Warn ? 'console' :\n                'stdout';\n        super(msg, category);\n    }\n}\nexports.LogOutputEvent = LogOutputEvent;\nfunction trimLastNewline(str) {\n    return str.replace(/(\\n|\\r\\n)$/, '');\n}\nexports.trimLastNewline = trimLastNewline;\nfunction getFormattedTimeString() {\n    let d = new Date();\n    let hourString = _padZeroes(2, String(d.getUTCHours()));\n    let minuteString = _padZeroes(2, String(d.getUTCMinutes()));\n    let secondString = _padZeroes(2, String(d.getUTCSeconds()));\n    let millisecondString = _padZeroes(3, String(d.getUTCMilliseconds()));\n    return hourString + ':' + minuteString + ':' + secondString + '.' + millisecondString + ' UTC';\n}\nfunction _padZeroes(minDesiredLength, numberToPad) {\n    if (numberToPad.length >= minDesiredLength) {\n        return numberToPad;\n    }\n    else {\n        return String('0'.repeat(minDesiredLength) + numberToPad).slice(-minDesiredLength);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2xvZ2dlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OzREQUU0RDs7Ozs7Ozs7OztBQUU1RCx5QkFBeUI7QUFDekIsNkJBQTZCO0FBQzdCLGlDQUFpQztBQUNqQyxpREFBMkM7QUFFM0MsSUFBWSxRQU1YO0FBTkQsV0FBWSxRQUFRO0lBQ25CLDZDQUFXLENBQUE7SUFDWCxxQ0FBTyxDQUFBO0lBQ1AsdUNBQVEsQ0FBQTtJQUNSLHlDQUFTLENBQUE7SUFDVCx1Q0FBUSxDQUFBO0FBQ1QsQ0FBQyxFQU5XLFFBQVEsR0FBUixnQkFBUSxLQUFSLGdCQUFRLFFBTW5CO0FBZ0JELE1BQWEsTUFBTTtJQUFuQjtRQUlTLGlCQUFZLEdBQWUsRUFBRSxDQUFDO0lBMkV2QyxDQUFDO0lBekVBLEdBQUcsQ0FBQyxHQUFXLEVBQUUsS0FBSyxHQUFHLFFBQVEsQ0FBQyxHQUFHO1FBQ3BDLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3pCLENBQUM7SUFFRCxPQUFPLENBQUMsR0FBVztRQUNsQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVELElBQUksQ0FBQyxHQUFXO1FBQ2YsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxLQUFLLENBQUMsR0FBVztRQUNoQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVELE9BQU87UUFDTixJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDeEIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FB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QUcsR0FBRyxHQUFHLFlBQVksR0FBRyxHQUFHLEdBQUcsaUJBQWlCLEdBQUcsTUFBTSxDQUFDO0FBQ2hHLENBQUM7QUFFRCxTQUFTLFVBQVUsQ0FBQyxnQkFBd0IsRUFBRSxXQUFtQjtJQUNoRSxJQUFJLFdBQVcsQ0FBQyxNQUFNLElBQUksZ0JBQWdCLEVBQUU7UUFDM0MsT0FBTyxXQUFXLENBQUM7S0FDbkI7U0FBTTtRQUNOLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0tBQ25GO0FBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBDb3B5cmlnaHQgKEMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgbWtkaXJwIGZyb20gJ21rZGlycCc7XG5pbXBvcnQge091dHB1dEV2ZW50fSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5cbmV4cG9ydCBlbnVtIExvZ0xldmVsIHtcblx0VmVyYm9zZSA9IDAsXG5cdExvZyA9IDEsXG5cdFdhcm4gPSAyLFxuXHRFcnJvciA9IDMsXG5cdFN0b3AgPSA0XG59XG5cbmV4cG9ydCB0eXBlIElMb2dDYWxsYmFjayA9IChvdXRwdXRFdmVudDogT3V0cHV0RXZlbnQpID0+IHZvaWQ7XG5cbmludGVyZmFjZSBJTG9nSXRlbSB7XG5cdG1zZzogc3RyaW5nO1xuXHRsZXZlbDogTG9nTGV2ZWw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUxvZ2dlciB7XG5cdGxvZyhtc2c6IHN0cmluZywgbGV2ZWw/OiBMb2dMZXZlbCk6IHZvaWQ7XG5cdHZlcmJvc2UobXNnOiBzdHJpbmcpOiB2b2lkO1xuXHR3YXJuKG1zZzogc3RyaW5nKTogdm9pZDtcblx0ZXJyb3IobXNnOiBzdHJpbmcpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgTG9nZ2VyIHtcblx0cHJpdmF0ZSBfbG9nRmlsZVBhdGhGcm9tSW5pdDogc3RyaW5nO1xuXG5cdHByaXZhdGUgX2N1cnJlbnRMb2dnZXI6IEludGVybmFsTG9nZ2VyO1xuXHRwcml2YXRlIF9wZW5kaW5nTG9nUTogSUxvZ0l0ZW1bXSA9IFtdO1xuXG5cdGxvZyhtc2c6IHN0cmluZywgbGV2ZWwgPSBMb2dMZXZlbC5Mb2cpOiB2b2lkIHtcblx0XHRtc2cgPSBtc2cgKyAnXFxuJztcblx0XHR0aGlzLl93cml0ZShtc2csIGxldmVsKTtcblx0fVxuXG5cdHZlcmJvc2UobXNnOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmxvZyhtc2csIExvZ0xldmVsLlZlcmJvc2UpO1xuXHR9XG5cblx0d2Fybihtc2c6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMubG9nKG1zZywgTG9nTGV2ZWwuV2Fybik7XG5cdH1cblxuXHRlcnJvcihtc2c6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMubG9nKG1zZywgTG9nTGV2ZWwuRXJyb3IpO1xuXHR9XG5cblx0ZGlzcG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAodGhpcy5fY3VycmVudExvZ2dlcikge1xuXHRcdFx0Y29uc3QgZGlzcG9zZVAgPSB0aGlzLl9jdXJyZW50TG9nZ2VyLmRpc3Bvc2UoKTtcblx0XHRcdHRoaXMuX2N1cnJlbnRMb2dnZXIgPSBudWxsO1xuXHRcdFx0cmV0dXJuIGRpc3Bvc2VQO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIGBsb2dgIGFkZHMgYSBuZXdsaW5lLCBgd3JpdGVgIGRvZXNuJ3Rcblx0ICovXG5cdHByaXZhdGUgX3dyaXRlKG1zZzogc3RyaW5nLCBsZXZlbCA9IExvZ0xldmVsLkxvZyk6IHZvaWQge1xuXHRcdC8vIFtudWxsLCB1bmRlZmluZWRdID0+IHN0cmluZ1xuXHRcdG1zZyA9IG1zZyArICcnO1xuXHRcdGlmICh0aGlzLl9wZW5kaW5nTG9nUSkge1xuXHRcdFx0dGhpcy5fcGVuZGluZ0xvZ1EucHVzaCh7IG1zZywgbGV2ZWwgfSk7XG5cdFx0fSBlbHNlIGlmICh0aGlzLl9jdXJyZW50TG9nZ2VyKSB7XG5cdFx0XHR0aGlzLl9jdXJyZW50TG9nZ2VyLmxvZyhtc2csIGxldmVsKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU2V0IHRoZSBsb2dnZXIncyBtaW5pbXVtIGxldmVsIHRvIGxvZyBpbiB0aGUgY29uc29sZSwgYW5kIHdoZXRoZXIgdG8gbG9nIHRvIHRoZSBmaWxlLiBMb2cgbWVzc2FnZXMgYXJlIHF1ZXVlZCBiZWZvcmUgdGhpcyBpc1xuXHQgKiBjYWxsZWQgdGhlIGZpcnN0IHRpbWUsIGJlY2F1c2UgbWluTG9nTGV2ZWwgZGVmYXVsdHMgdG8gV2Fybi5cblx0ICovXG5cdHNldHVwKGNvbnNvbGVNaW5Mb2dMZXZlbDogTG9nTGV2ZWwsIF9sb2dGaWxlUGF0aD86IHN0cmluZ3xib29sZWFuLCBwcmVwZW5kVGltZXN0YW1wOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuXHRcdGNvbnN0IGxvZ0ZpbGVQYXRoID0gdHlwZW9mIF9sb2dGaWxlUGF0aCA9PT0gJ3N0cmluZycgP1xuXHRcdFx0X2xvZ0ZpbGVQYXRoIDpcblx0XHRcdChfbG9nRmlsZVBhdGggJiYgdGhpcy5fbG9nRmlsZVBhdGhGcm9tSW5pdCk7XG5cblx0XHRpZiAodGhpcy5fY3VycmVudExvZ2dlcikge1xuXHRcdFx0Y29uc3Qgb3B0aW9ucyA9IHtcblx0XHRcdFx0Y29uc29sZU1pbkxvZ0xldmVsLFxuXHRcdFx0XHRsb2dGaWxlUGF0aCxcblx0XHRcdFx0cHJlcGVuZFRpbWVzdGFtcFxuXHRcdFx0fTtcblx0XHRcdHRoaXMuX2N1cnJlbnRMb2dnZXIuc2V0dXAob3B0aW9ucykudGhlbigoKSA9PiB7XG5cdFx0XHRcdC8vIE5vdyB0aGF0IHdlIGhhdmUgYSBtaW5pbXVtIGxvZ0xldmVsLCB3ZSBjYW4gY2xlYXIgb3V0IHRoZSBxdWV1ZSBvZiBwZW5kaW5nIG1lc3NhZ2VzXG5cdFx0XHRcdGlmICh0aGlzLl9wZW5kaW5nTG9nUSkge1xuXHRcdFx0XHRcdGNvbnN0IGxvZ1EgPSB0aGlzLl9wZW5kaW5nTG9nUTtcblx0XHRcdFx0XHR0aGlzLl9wZW5kaW5nTG9nUSA9IG51bGw7XG5cdFx0XHRcdFx0bG9nUS5mb3JFYWNoKGl0ZW0gPT4gdGhpcy5fd3JpdGUoaXRlbS5tc2csIGl0ZW0ubGV2ZWwpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHR9XG5cdH1cblxuXHRpbml0KGxvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2ssIGxvZ0ZpbGVQYXRoPzogc3RyaW5nLCBsb2dUb0NvbnNvbGU/OiBib29sZWFuKTogdm9pZCB7XG5cdFx0Ly8gUmUtaW5pdCwgY3JlYXRlIG5ldyBnbG9iYWwgTG9nZ2VyXG5cdFx0dGhpcy5fcGVuZGluZ0xvZ1EgPSB0aGlzLl9wZW5kaW5nTG9nUSB8fCBbXTtcblx0XHR0aGlzLl9jdXJyZW50TG9nZ2VyID0gbmV3IEludGVybmFsTG9nZ2VyKGxvZ0NhbGxiYWNrLCBsb2dUb0NvbnNvbGUpO1xuXHRcdHRoaXMuX2xvZ0ZpbGVQYXRoRnJvbUluaXQgPSBsb2dGaWxlUGF0aDtcblx0fVxufVxuXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcigpO1xuXG5pbnRlcmZhY2UgSUludGVybmFsTG9nZ2VyT3B0aW9ucyB7XG5cdGNvbnNvbGVNaW5Mb2dMZXZlbDogTG9nTGV2ZWw7XG5cdGxvZ0ZpbGVQYXRoPzogc3RyaW5nO1xuXHRwcmVwZW5kVGltZXN0YW1wPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIGxvZ2dpbmcsIHdoZXRoZXIgdG8gY29uc29sZS5sb2csIGZpbGUsIG9yIFZTIENvZGUgY29uc29sZS5cbiAqIEVuY2Fwc3VsYXRlcyB0aGUgc3RhdGUgc3BlY2lmaWMgdG8gZWFjaCBsb2dnaW5nIHNlc3Npb25cbiAqL1xuY2xhc3MgSW50ZXJuYWxMb2dnZXIge1xuXHRwcml2YXRlIF9taW5Mb2dMZXZlbDogTG9nTGV2ZWw7XG5cdHByaXZhdGUgX2xvZ1RvQ29uc29sZTogYm9vbGVhbjtcblxuXHQvKiogTG9nIGluZm8gdGhhdCBtZWV0cyBtaW5Mb2dMZXZlbCBpcyBzZW50IHRvIHRoaXMgY2FsbGJhY2suICovXG5cdHByaXZhdGUgX2xvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2s7XG5cblx0LyoqIFdyaXRlIHN0ZWFtIGZvciBsb2cgZmlsZSAqL1xuXHRwcml2YXRlIF9sb2dGaWxlU3RyZWFtOiBmcy5Xcml0ZVN0cmVhbTtcblxuXHQvKiogRGlzcG9zZSBhbmQgYWxsb3cgZXhpdCB0byBjb250aW51ZSBub3JtYWxseSAqL1xuXHRwcml2YXRlIGJlZm9yZUV4aXRDYWxsYmFjayA9ICgpID0+IHRoaXMuZGlzcG9zZSgpO1xuXG5cdC8qKiBEaXNwb3NlIGFuZCBleGl0ICovXG5cdHByaXZhdGUgZGlzcG9zZUNhbGxiYWNrO1xuXG5cdC8qKiBXaGV0aGVyIHRvIGFkZCBhIHRpbWVzdGFtcCB0byBtZXNzYWdlcyBpbiB0aGUgbG9nZmlsZSAqL1xuXHRwcml2YXRlIF9wcmVwZW5kVGltZXN0YW1wOiBib29sZWFuO1xuXG5cdGNvbnN0cnVjdG9yKGxvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2ssIGlzU2VydmVyPzogYm9vbGVhbikge1xuXHRcdHRoaXMuX2xvZ0NhbGxiYWNrID0gbG9nQ2FsbGJhY2s7XG5cdFx0dGhpcy5fbG9nVG9Db25zb2xlID0gaXNTZXJ2ZXI7XG5cblx0XHR0aGlzLl9taW5Mb2dMZXZlbCA9IExvZ0xldmVsLldhcm47XG5cblx0XHR0aGlzLmRpc3Bvc2VDYWxsYmFjayA9IChzaWduYWw6IHN0cmluZywgY29kZTogbnVtYmVyKSA9PiB7XG5cdFx0XHR0aGlzLmRpc3Bvc2UoKTtcblxuXHRcdFx0Ly8gRXhpdCB3aXRoIDEyOCArIHZhbHVlIG9mIHRoZSBzaWduYWwgY29kZS5cblx0XHRcdC8vIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvcHJvY2Vzcy5odG1sI3Byb2Nlc3NfZXhpdF9jb2Rlc1xuXHRcdFx0Y29kZSA9IGNvZGUgfHwgMjsgLy8gU0lHSU5UXG5cdFx0XHRjb2RlICs9IDEyODtcblxuXHRcdFx0cHJvY2Vzcy5leGl0KGNvZGUpO1xuXHRcdH07XG5cdH1cblxuXHRwdWJsaWMgYXN5bmMgc2V0dXAob3B0aW9uczogSUludGVybmFsTG9nZ2VyT3B0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMuX21pbkxvZ0xldmVsID0gb3B0aW9ucy5jb25zb2xlTWluTG9nTGV2ZWw7XG5cdFx0dGhpcy5fcHJlcGVuZFRpbWVzdGFtcCA9IG9wdGlvbnMucHJlcGVuZFRpbWVzdGFtcDtcblxuXHRcdC8vIE9wZW4gYSBsb2cgZmlsZSBpbiB0aGUgc3BlY2lmaWVkIGxvY2F0aW9uLiBPdmVyd3JpdHRlbiBvbiBlYWNoIHJ1bi5cblx0XHRpZiAob3B0aW9ucy5sb2dGaWxlUGF0aCkge1xuXHRcdFx0aWYgKCFwYXRoLmlzQWJzb2x1dGUob3B0aW9ucy5sb2dGaWxlUGF0aCkpIHtcblx0XHRcdFx0dGhpcy5sb2coYGxvZ0ZpbGVQYXRoIG11c3QgYmUgYW4gYWJzb2x1dGUgcGF0aDogJHtvcHRpb25zLmxvZ0ZpbGVQYXRofWAsIExvZ0xldmVsLkVycm9yKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGhhbmRsZUVycm9yID0gZXJyID0+IHRoaXMuc2VuZExvZyhgRXJyb3IgY3JlYXRpbmcgbG9nIGZpbGUgYXQgcGF0aDogJHtvcHRpb25zLmxvZ0ZpbGVQYXRofS4gRXJyb3I6ICR7ZXJyLnRvU3RyaW5nKCl9XFxuYCwgTG9nTGV2ZWwuRXJyb3IpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0YXdhaXQgbWtkaXJwUHJvbWlzZShwYXRoLmRpcm5hbWUob3B0aW9ucy5sb2dGaWxlUGF0aCkpO1xuXHRcdFx0XHRcdHRoaXMubG9nKGBWZXJib3NlIGxvZ3MgYXJlIHdyaXR0ZW4gdG86XFxuYCwgTG9nTGV2ZWwuV2Fybik7XG5cdFx0XHRcdFx0dGhpcy5sb2cob3B0aW9ucy5sb2dGaWxlUGF0aCArICdcXG4nLCBMb2dMZXZlbC5XYXJuKTtcblxuXHRcdFx0XHRcdHRoaXMuX2xvZ0ZpbGVTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShvcHRpb25zLmxvZ0ZpbGVQYXRoKTtcblx0XHRcdFx0XHR0aGlzLmxvZ0RhdGVUaW1lKCk7XG5cdFx0XHRcdFx0dGhpcy5zZXR1cFNodXRkb3duTGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbS5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRcdFx0XHRcdFx0aGFuZGxlRXJyb3IoZXJyKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdFx0aGFuZGxlRXJyb3IoZXJyKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgbG9nRGF0ZVRpbWUoKTogdm9pZCB7XG5cdFx0bGV0IGQgPSBuZXcgRGF0ZSgpO1xuXHRcdGxldCBkYXRlU3RyaW5nID0gZC5nZXRVVENGdWxsWWVhcigpICsgJy0nICsgYCR7ZC5nZXRVVENNb250aCgpICsgMX1gICsgJy0nICsgZC5nZXRVVENEYXRlKCk7XG5cdFx0Y29uc3QgdGltZUFuZERhdGVTdGFtcCA9IGRhdGVTdHJpbmcgKyAnLCAnICsgZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpO1xuXHRcdHRoaXMubG9nKHRpbWVBbmREYXRlU3RhbXAgKyAnXFxuJywgTG9nTGV2ZWwuVmVyYm9zZSwgZmFsc2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBzZXR1cFNodXRkb3duTGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHByb2Nlc3MuYWRkTGlzdGVuZXIoJ2JlZm9yZUV4aXQnLCB0aGlzLmJlZm9yZUV4aXRDYWxsYmFjayk7XG5cdFx0cHJvY2Vzcy5hZGRMaXN0ZW5lcignU0lHVEVSTScsIHRoaXMuZGlzcG9zZUNhbGxiYWNrKTtcblx0XHRwcm9jZXNzLmFkZExpc3RlbmVyKCdTSUdJTlQnLCB0aGlzLmRpc3Bvc2VDYWxsYmFjayk7XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZVNodXRkb3duTGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHByb2Nlc3MucmVtb3ZlTGlzdGVuZXIoJ2JlZm9yZUV4aXQnLCB0aGlzLmJlZm9yZUV4aXRDYWxsYmFjayk7XG5cdFx0cHJvY2Vzcy5yZW1vdmVMaXN0ZW5lcignU0lHVEVSTScsIHRoaXMuZGlzcG9zZUNhbGxiYWNrKTtcblx0XHRwcm9jZXNzLnJlbW92ZUxpc3RlbmVyKCdTSUdJTlQnLCB0aGlzLmRpc3Bvc2VDYWxsYmFjayk7XG5cdH1cblxuXHRwdWJsaWMgZGlzcG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG5cdFx0XHR0aGlzLnJlbW92ZVNodXRkb3duTGlzdGVuZXJzKCk7XG5cdFx0XHRpZiAodGhpcy5fbG9nRmlsZVN0cmVhbSkge1xuXHRcdFx0XHR0aGlzLl9sb2dGaWxlU3RyZWFtLmVuZChyZXNvbHZlKTtcblx0XHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbSA9IG51bGw7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwdWJsaWMgbG9nKG1zZzogc3RyaW5nLCBsZXZlbDogTG9nTGV2ZWwsIHByZXBlbmRUaW1lc3RhbXAgPSB0cnVlKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuX21pbkxvZ0xldmVsID09PSBMb2dMZXZlbC5TdG9wKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKGxldmVsID49IHRoaXMuX21pbkxvZ0xldmVsKSB7XG5cdFx0XHR0aGlzLnNlbmRMb2cobXNnLCBsZXZlbCk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX2xvZ1RvQ29uc29sZSkge1xuXHRcdFx0Y29uc3QgbG9nRm4gPVxuXHRcdFx0XHRsZXZlbCA9PT0gTG9nTGV2ZWwuRXJyb3IgPyBjb25zb2xlLmVycm9yIDpcblx0XHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLldhcm4gPyBjb25zb2xlLndhcm4gOlxuXHRcdFx0XHRudWxsO1xuXG5cdFx0XHRpZiAobG9nRm4pIHtcblx0XHRcdFx0bG9nRm4odHJpbUxhc3ROZXdsaW5lKG1zZykpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIGFuIGVycm9yLCBwcmVwZW5kIHdpdGggJ1tFcnJvcl0nXG5cdFx0aWYgKGxldmVsID09PSBMb2dMZXZlbC5FcnJvcikge1xuXHRcdFx0bXNnID0gYFske0xvZ0xldmVsW2xldmVsXX1dICR7bXNnfWA7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX3ByZXBlbmRUaW1lc3RhbXAgJiYgcHJlcGVuZFRpbWVzdGFtcCkge1xuXHRcdFx0bXNnID0gJ1snICsgZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpICsgJ10gJyArIG1zZztcblx0XHR9XG5cblx0XHRpZiAodGhpcy5fbG9nRmlsZVN0cmVhbSkge1xuXHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbS53cml0ZShtc2cpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2VuZExvZyhtc2c6IHN0cmluZywgbGV2ZWw6IExvZ0xldmVsKTogdm9pZCB7XG5cdFx0Ly8gVHJ1bmNhdGUgbG9uZyBtZXNzYWdlcywgdGhleSBjYW4gaGFuZyBWUyBDb2RlXG5cdFx0aWYgKG1zZy5sZW5ndGggPiAxNTAwKSB7XG5cdFx0XHRjb25zdCBlbmRzSW5OZXdsaW5lID0gISFtc2cubWF0Y2goLyhcXG58XFxyXFxuKSQvKTtcblx0XHRcdG1zZyA9IG1zZy5zdWJzdHIoMCwgMTUwMCkgKyAnWy4uLl0nO1xuXHRcdFx0aWYgKGVuZHNJbk5ld2xpbmUpIHtcblx0XHRcdFx0bXNnID0gbXNnICsgJ1xcbic7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX2xvZ0NhbGxiYWNrKSB7XG5cdFx0XHRjb25zdCBldmVudCA9IG5ldyBMb2dPdXRwdXRFdmVudChtc2csIGxldmVsKTtcblx0XHRcdHRoaXMuX2xvZ0NhbGxiYWNrKGV2ZW50KTtcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gbWtkaXJwUHJvbWlzZShmb2xkZXI6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdG1rZGlycChmb2xkZXIsIGVyciA9PiB7XG5cdFx0XHRpZiAoZXJyKSB7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn1cblxuZXhwb3J0IGNsYXNzIExvZ091dHB1dEV2ZW50IGV4dGVuZHMgT3V0cHV0RXZlbnQge1xuXHRjb25zdHJ1Y3Rvcihtc2c6IHN0cmluZywgbGV2ZWw6IExvZ0xldmVsKSB7XG5cdFx0Y29uc3QgY2F0ZWdvcnkgPVxuXHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLkVycm9yID8gJ3N0ZGVycicgOlxuXHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLldhcm4gPyAnY29uc29sZScgOlxuXHRcdFx0J3N0ZG91dCc7XG5cdFx0c3VwZXIobXNnLCBjYXRlZ29yeSk7XG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyaW1MYXN0TmV3bGluZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdHJldHVybiBzdHIucmVwbGFjZSgvKFxcbnxcXHJcXG4pJC8sICcnKTtcbn1cblxuZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpOiBzdHJpbmcge1xuXHRsZXQgZCA9IG5ldyBEYXRlKCk7XG5cdGxldCBob3VyU3RyaW5nID0gX3BhZFplcm9lcygyLCBTdHJpbmcoZC5nZXRVVENIb3VycygpKSk7XG5cdGxldCBtaW51dGVTdHJpbmcgPSBfcGFkWmVyb2VzKDIsIFN0cmluZyhkLmdldFVUQ01pbnV0ZXMoKSkpO1xuXHRsZXQgc2Vjb25kU3RyaW5nID0gX3BhZFplcm9lcygyLCBTdHJpbmcoZC5nZXRVVENTZWNvbmRzKCkpKTtcblx0bGV0IG1pbGxpc2Vjb25kU3RyaW5nID0gX3BhZFplcm9lcygzLCBTdHJpbmcoZC5nZXRVVENNaWxsaXNlY29uZHMoKSkpO1xuXHRyZXR1cm4gaG91clN0cmluZyArICc6JyArIG1pbnV0ZVN0cmluZyArICc6JyArIHNlY29uZFN0cmluZyArICcuJyArIG1pbGxpc2Vjb25kU3RyaW5nICsgJyBVVEMnO1xufVxuXG5mdW5jdGlvbiBfcGFkWmVyb2VzKG1pbkRlc2lyZWRMZW5ndGg6IG51bWJlciwgbnVtYmVyVG9QYWQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdGlmIChudW1iZXJUb1BhZC5sZW5ndGggPj0gbWluRGVzaXJlZExlbmd0aCkge1xuXHRcdHJldHVybiBudW1iZXJUb1BhZDtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gU3RyaW5nKCcwJy5yZXBlYXQobWluRGVzaXJlZExlbmd0aCkgKyBudW1iZXJUb1BhZCkuc2xpY2UoLW1pbkRlc2lyZWRMZW5ndGgpO1xuXHR9XG59XG4iXX0=","import * as vscode from 'vscode';\r\nimport { MumpsLabel } from \"./mumps-label-lookup\";\r\nconst DIVIDERLINE = \"\\t;****************\\n\"\r\n\r\nfunction DocumentFunction(){\r\n\t\tlet editor = vscode.window.activeTextEditor\r\n\t\tif (editor) {\r\n\t\t\tlet document = editor.document\r\n\t\t\tlet InsertPosition = editor.selection.start.with(editor.selection.start.line,0)\r\n\r\n\t\t\t//if the line is empty look down for the label\r\n\t\t\twhile(InsertPosition.line < document.lineCount){\r\n\t\t\t\tlet txt = editor.document.lineAt(InsertPosition.line).text\r\n\t\t\t\tif (txt.replace(/\\t|\\ /i,\"\")===\"\"){\r\n\t\t\t\t\tInsertPosition = InsertPosition.translate(1,0)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(InsertPosition.line === document.lineCount){\r\n\t\t\t\tInsertPosition = InsertPosition.translate(-1,0)\r\n\t\t\t}\r\n\t\t\t//start moving up the file looking for the label header\r\n\t\t\twhile(InsertPosition.line >= 0){\r\n\t\t\t\tlet txt = editor.document.lineAt(InsertPosition.line).text\r\n\t\t\t\tlet functionSig = lineIsFunctionSig(txt)\r\n\t\t\t\tif (functionSig){\r\n\t\t\t\t\teditor.edit((editBuilder) =>{\r\n\t\t\t\t\t\teditBuilder.insert(InsertPosition, makeSignature(txt))\r\n\t\t\t\t\t})\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tInsertPosition = InsertPosition.translate(-1,0)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n};\r\n\r\n/**\r\n * @description this will assume if there is code on the first position of the line that it is a function\r\n * @param {text to search} text\r\n * @return {returns false if there is none, true otherwise}\r\n */\r\nfunction lineIsFunctionSig(text){\r\n  if(text.length ===0 || text.charAt(0)===\" \" || text.charAt(0)==='\\t' || text.charAt(0)===';'){\r\n    return false;\r\n  }\r\n  return true\r\n}\r\n\r\nfunction makeSignature(labelLine:string){\r\n  let Signature = \"\"\r\n\r\n  Signature+=DIVIDERLINE\r\n  Signature+=\"\\t; DESCRIPTION: \\n\"\r\n  let parameters = labelLine.match(/\\(.*\\)/)\r\n  if(parameters !== null && parameters.length> 0){\r\n    parameters = parameters[0].substring(1, parameters[0].length-1).split(\",\")\r\n    if(parameters.length > 0){\r\n      Signature+=\"\\t; PARAMETERS: \\n\"\r\n      parameters.forEach(function(element:string) {\r\n        Signature+=\"\\t;    \" + element + \"(I/O,REQ): \\n\"\r\n      });\r\n    }\r\n  }\r\n\r\n  Signature+=\"\\t; RETURNS: \\n\"\r\n  Signature+=\"\\t; REVISIONS: \\n\"\r\n  Signature+=DIVIDERLINE\r\n  return Signature;\r\n}\r\n\r\nfunction getSigInfo(referredTo:MumpsLabel, definition, parametersByName){\r\n\tif (referredTo.text) {\r\n\t\tlet description = referredTo.text.match(/DESCRIPTION:.*/i)\r\n\t\tif(description!==null) {definition.description = description[0];}\r\n\t\t//console.log(definition.description)\r\n\t\t//console.log(parametersByName)\r\n\r\n\t\tfor(let param in parametersByName){\r\n\t\t\t//console.log(param)\r\n\t\t\tlet paramDescription = referredTo.text.match(new RegExp(param+\"\\\\(.*\\\\):.*\",'i'))\r\n\t\t\tif(paramDescription !== null) {parametersByName[param].description=paramDescription}\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport {getSigInfo, DocumentFunction};","let fs = require('fs');\r\ninterface ErrorInformation {\r\n\ttext: string,\r\n\tposition: number,\r\n\tline?: number,\r\n\tindexFound?: boolean,\r\n\tglobalFound?: boolean\r\n\tindirectionFound?: boolean;\r\n}\r\nexport enum TokenType {\r\n\t\"global\"= \"global\" , \"local\"=\"local\" , \"exfunction\"=\"exfunction\", \"nonMfunction\"=\"nonMfunction\" , \"entryref\"=\"entryref\" ,\r\n\t \"operator\"=\"operator\" ,\t\"keyword\"=\"keyword\" , \"ifunction\"=\"ifunction\" , \"label\"=\"label\" , \"comment\"=\"comment\",\r\n\t \"sysvariable\"=\"sysvariable\" , \"string\"=\"string\" , \"number\"=\"number\"\r\n}\r\ninterface LineToken {\r\n\ttype: TokenType,\r\n\tname: string,\r\n\tposition: number\r\n}\r\ninterface LineComand {\r\n\tcommand: string,\r\n\tposition: number\r\n}\r\ninterface LineComment {\r\n\tcomment: string,\r\n\tposition: number\r\n}\r\ninterface LineObject {\r\n\tlineComment?: LineComment;\r\n\tlineIndentationArray?: string[];\r\n\tlineRoutines?: TmpFunction[];\r\n\tlineLeadSpace?: string,\r\n\tlineLabel?: string,\r\n\tlineExpression: string,\r\n\terrorText?: string,\r\n\terrorPosition?: number,\r\n\texpressionPosition: number\r\n}\r\ninterface TmpFunction {\r\n\tmCommand: string,\r\n\tmArguments: string,\r\n\tmPostCondition: string,\r\n\tcmdPosition: number,\r\n\targPosition: number,\r\n\tpcPosition: number\r\n}\r\nconst label = /^[A-Za-z%][A-Za-z0-9]*(\\([A-Za-z%][A-Za-z0-9]*(,[A-Za-z%][A-Za-z0-9]*)*\\))?/\r\nconst lvn = /^[A-Za-z%][A-Za-z0-9]*/\r\nconst gvn = /^\\^[A-Za-z%][A-Za-z0-9]*/\r\nconst isv = /^\\$(DEVICE|ECODE|EC|ESTACK|ES|ETRAP|ET|HALT|HOROLOG|H|IO|I|JOB|J|KEY|K|NAMESPACE|PRINCIPAL|P|QUIT|Q|REFERENCE|R|STACK|ST|STORAGE|S|SYSTEM|TEST|THIS|TLEVEL|TL|T|USERNAME|X|Y|ZALLOCSTOR|ZA|ZB|ZCHSET|ZCLOSE|ZCMDLINE|ZCM|ZCOMPILE|ZCO|ZCSTATUS|ZC|ZDATEFORM|ZDA|ZDIRECTORY|ZD|ZEDITOR|ZED|ZEOF|ZEO|ZE[A-Z]*|ZGBLDIR|ZG|ZHRORLOG|ZH|ZININTERRUPT|ZINI|ZINTERRUPT|ZINT|ZIO|ZJOB|ZJ|ZKEY|ZLEVEL|ZL|ZMAXTPTIME|ZMAXTPTI|ZMODE|ZMO|ZONLNRLBK|ZPATNUMERIC|ZPATN|ZPIN|ZPOSITION|ZPOS|ZPOUT|ZPROMPT|ZQUIT|ZREALSTOR|ZRELDATE|ZRO[A-Z]*|ZSOURCE|ZSO|ZSTA[A-Z]*|ZSTEP|ZSTRP|ZSTRPLLIM|ZST|ZSYSTEM|ZSY|ZS|ZTEXIT|ZTE|ZTIMEOUT|ZTIM|ZTRAP|ZT|ZUSEDSTOR|ZUT|ZVERSION|ZV[A-Z]*|ZYERROR|ZYRELEASE|ZTDATA|ZTDELIM|ZTLEVEL|ZTNAME|ZTOLDVAL|ZTRIGGEROP|ZTSLATE|ZTUPDATE|ZTVALUE|ZTWORMHOLE)/i\r\nconst ifunction = /^\\$(ASCII|A|CHAR|C|DATA|D|EXTRACT|E|FIND|F|FNUMBER|FN|GET|G|INCREMENT|INCR|I|JUSTIFY|J|LENGTH|L|NAME|NA|NEXT|N|ORDER|O|PIECE|P|QLENGTH|QL|QSUBSCRIPT|QS|QUERY|Q|RANDOM|R|REVERSE|RE|SELECT|S|STACK|ST|TEXT|T|TRANSLATE|TR|VIEW|V|ZAHANDLE|ZAH|ZASCII|ZATRANSFORM|ZAT|ZBITAND|ZBITCOUNT|ZBITFIND|ZBITGET|ZBITLEN|ZBITNOT|ZBITOR|ZBITSET|ZBITSTR|ZBITXOR|ZCHAR|ZCH|ZCOLLATE|ZCONVERT|ZCO|ZDATE|ZDATA|ZD|ZEXTRACT|ZE|ZFIND|ZF|ZGETJPI|ZG|ZINCREMENT|ZINCR|ZJOBEXAM|ZJUSTIFY|ZJ|ZLENGTH|ZL|ZMESSAGE|ZPARSE|ZPEEK|ZPIECE|ZPI|ZPREVIOUS|ZP|ZQGBLMOD|ZSEARCH|ZSIGPROC|ZSOCKET|ZSUBSTR|ZSUB|ZSYSLOG|ZTRANSLATE|ZTRIGGER|ZTRI|ZTRNLNM|ZTR|ZWIDTH|ZWRITE|ZW)(?=\\()/i;\r\nconst nonMfunction = /^\\$\\&([A-Za-z%0-9][A-Za-z0-9]*.)?([A-Za-z%0-9][A-Za-z0-9]*)?(\\^[A-Za-z%][A-Za-z0-9]*)?/\r\nconst entryref = /^(\\&[A-Za-z0-9]*\\.?)?@?([A-Za-z%0-9][A-Za-z0-9]*)?(\\^@?[A-Za-z%][A-Za-z0-9]*)?/\r\nconst routineref = /^\\^@?[A-Za-z%][A-Za-z0-9]*/\r\nconst numlit = /^(\\d*\\.?\\d*(E-?\\d+)?)/\r\nconst strlit = /^\"([^\"]*(\"\")*)*\"/\r\nconst command = /^[B|BREAK|C|CLOSE|D|DO|E|ELSE|F|FOR|G|GOTO|H|HALT|HANG|I|IF|J|JOB|K|KILL|L|LOCK|M|MERGE|N|NEW|O|OPEN|Q|QUIT|R|READ|S|SET|U|USE|V|VIEW|W|WRITE|X|XECUTE|ZA|ZALLOCATE|ZBR|ZBREAK|ZC|ZCONTINUE|ZD|ZDEALLOCATE|ZE|ZEDIT|ZG|ZGOTO|ZHALT|ZH|ZHELP|ZK|ZKILL|ZL|ZLINK|ZM|ZMESSAGE|ZP|ZPRINT|ZRUPDATE|ZSH|ZSHOW|ZST|ZSTEP|ZSY|ZSYSTEM|ZTC|ZTCOMMIT|ZTR|ZTRIGGER|ZTS|ZTSTART|ZWI|ZWITHDRAW|ZWR|ZWRITE]/i\r\nconst binoperator = /^('=|'>|'<|<=|>=|'&|'!|'\\?|'\\[|'\\]|\\*\\*|\\+|\\-|\\*|\\/|\\\\|#|'|&|!|_|<|>|=|\\[|\\]|\\?|@)/\r\nconst unaryoperator = /(\\-|'|\\+|@)/\r\nconst patcode = /^([A|C|E|L|N|P|U]|^(\"([^\"](\"\")*)*\"))+/i\r\nconst repititionCount = /^\\d*\\.?\\d*/\r\nconst openkeywords = /^APPEND|ATTACH=|BLOCK(SIZE)?=|COMMAND=|CONNECT=|(NO)?DELIM(ITER)?=?|EXC(EPTION)?=|FIFO|(NO)?FIXED|GROUP=|[IO]?CHSET=|KEY|IKEY|INDEPENDANT|IOERROR=|NEW[A-Z]*|MOREREADTIME=|OKEY|OWNER=|(NO)?RCHK|(NO)?READ(ONLY)?|RECORD(SIZE)?=|(NO)?RETRY|REWIND|SEEK=|SHELL=|STDERR=|(NO)?STREAM|SYSTEM=|(NO)?TRUNCATE|UIC=|VARIABLE|WORLD=|Z?(NO)?WRAP|WRITE(ONLY)?|ZBFSIZE|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE|Z?LISTEN=/i\r\nconst usekeywords = /^ATTACH|(NO)?CENABLE|[IO]?CHSET=|CLEAR(SCREEN)?|CONNECT|(NO)?CONVERT|CTRAP=|(NO)?DELIM(ITER)?=?|DETACH|DOWNSCROLL|(NO)?ECHO|(NO)?EDITING|ERASELINE|(NO)?ESC(APE)?|EXC(EPTION)?=|(NO)?FILTER=?|FLUSH|GROUP=|KEY|IKEY|IOERROR=|OKEY|OWNER=|(NO)?PASTHRU|(NO)?RCHK|(NO)?RETRY|REWIND|SEEK=|SKIPFILE=|SOCKET=|SPACE=|TERM(INATOR)?=|(NO)?TRUNCATE|(NO)?TTSNYC|(NO)?TYPEAHEAD|UPSCROLL|Z?LENGTH=|Z?WIDTH=|Z?(NO)?WRAP|WRITELB=|X=|Y=|ZBFSIZE|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE|LISTEN=/i\r\nconst closekeywords = /^DELETE|(NO)?DESTROY|EXCEPTION=|GROUP=|OWNER=|RENAME=|SOCKET=|TIMEOUT=|UIC=|WORLD=/i\r\nconst jobkeywords = /^CMD=|CMDLINE=|DEF=|DEFAULT=|ERR=|ERROR=|GBL=|GBLDIR=|IN=|INPUT=|OUT=|OUTPUT=|PASS|PASSCURLVN|STA=|STARTUP=/i\r\nconst tstartkeywords = /^SERIAL|S|T=|TRANSACTIONID=/i\r\nconst cmdExpansions = {\r\n\t'B': 'BREAK', 'C': 'CLOSE', 'D': 'DO', 'E': 'ELSE', 'F': 'FOR', 'G': 'GOTO', 'H': 'HALT', 'I': 'IF', 'J': 'JOB', 'K': 'KILL', 'L': 'LOCK', 'M': 'MERGE', 'N': 'NEW',\r\n\t'O': 'OPEN', 'Q': 'QUIT', 'R': 'READ', 'S': 'SET', 'U': 'USE', 'V': 'VIEW', 'W': 'WRITE', 'X': 'XECUTE', 'ZA': 'ZALLOCATE', 'ZB': 'ZBREAK', 'ZC': 'ZCONTINUE',\r\n\t'ZD': 'ZDEALLOCATE', 'ZED': 'ZEDIT', 'ZG': 'ZGOTO', 'ZH': 'ZHELP', 'ZK': 'ZKILL', 'ZL': 'ZLINK', 'ZM': 'ZMESSAGE', 'ZP': 'ZPRINT', 'ZSH': 'ZSHOW',\r\n\t'ZST': 'ZSTEP', 'ZSY': 'ZSYSTEM', 'ZTC': 'ZTCOMMIT', 'ZTR': 'ZTRIGGER', 'ZTS': 'ZTSTART', 'ZWI': 'ZWITHDRAW', 'ZWR': 'ZWRITE'\r\n}\r\nconst funcExpansions = {\r\n\t'A': 'ASCII', 'C': 'CHAR', 'D': 'DATA', 'E': 'EXTRACT', 'F': 'FIND', 'FN': 'FNUMBER', 'G': 'GET', 'I': 'INCREMENT', 'J': 'JUSTIFY', 'L': 'LENGTH', 'NA': 'NAME', 'N': 'NEXT', 'O': 'ORDER',\r\n\t'P': 'PIECE', 'QL': 'QLENGTH', 'QS': 'QSUBSCRIPT', 'Q': 'QUERY', 'R': 'RANDOM', 'RE': 'REVERSE', 'S': 'SELECT', 'ST': 'STACK', 'T': 'TEXT', 'TR': 'TRANSLATE', 'V': 'VIEW',\r\n\t'ZA': 'ZASCII', 'ZAH': 'ZAHANDLE', 'ZD': 'ZDATE', 'ZE': 'ZEXTRACT', 'ZF': 'ZFIND', 'ZG': 'ZGETJPI', 'ZJ': 'ZJUSTIFY', 'ZL': 'ZLENGTH', 'ZM': 'ZMESSAGE', 'ZPI': 'ZPIECE', 'ZP': 'ZPREVIOUS',\r\n\t'ZSUB': 'ZSUBSTR', 'ZTR': 'ZTRANSLATE', 'ZTRI': 'ZTRIGGER', 'ZW': 'ZWIDTH'\r\n}\r\nconst cmdParams = {\r\n\t'BREAK': {\r\n\t\t'abbreviation': 'B',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr[:tvexpr][,...]]'\r\n\t},\r\n\t'CLOSE': {\r\n\t\t'abbreviation': 'C',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:(keyword[=expr][:...])][,...]'\r\n\t},\r\n\t'DO': {\r\n\t\t'abbreviation': 'D',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[entryref[(expr:.lvn[,...])][:tvexpr][,...]]'\r\n\t},\r\n\t'ELSE':\r\n\t{\r\n\t\t'abbreviation': 'E',\r\n\t\t'postcondition': false,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'FOR': {\r\n\t\t'abbreviation': 'F',\r\n\t\t'postcondition': false,\r\n\t\t'parameter': '[lvn=expr[:numexpr1[:numexpr2]][,...]]]'\r\n\t},\r\n\t'GOTO': {\r\n\t\t'abbreviation': 'G',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'entryref[:tvexpr][,...]'\r\n\t},\r\n\t'HALT': {\r\n\t\t'abbreviation': 'H',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'HANG': {\r\n\t\t'abbreviation': 'H',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'numexpr[,...]'\r\n\t},\r\n\t'IF': {\r\n\t\t'abbreviation': 'I',\r\n\t\t'postcondition': false,\r\n\t\t'parameter': '[tvexpr[,...]]'\r\n\t},\r\n\t'JOB': {\r\n\t\t'abbreviation': 'J',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'entryref[(expr[,...])][:[(keyword[=value][:...])][:numexpr]][,...]'\r\n\t},\r\n\t'KILL': {\r\n\t\t'abbreviation': 'K',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[glvn | (lvn[,...]) | *lname | *lvn ]'\r\n\t},\r\n\t'LOCK': {\r\n\t\t'abbreviation': 'L',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[[-|+]nref|(nref[,...])[:numexpr] [,...]]'\r\n\t},\r\n\t'MERGE': {\r\n\t\t'abbreviation': 'M',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'glvn=glvn[,...]'\r\n\t},\r\n\t'NEW': {\r\n\t\t'abbreviation': 'N',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[[(]lvn[,...][)][,...]]'\r\n\t},\r\n\t'OPEN': {\r\n\t\t'abbreviation': 'O',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:[(keyword[=expr][:...])] [:numexpr]][,...]'\r\n\t},\r\n\t'QUIT': {\r\n\t\t'abbreviation': 'Q',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr | *lname | *lvn]'\r\n\t},\r\n\t'READ': {\r\n\t\t'abbreviation': 'R',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '(glvn|*glvn|glvn#intexpr)[:numexpr]|strlit|fcc[,...]'\r\n\t},\r\n\t'SET': {\r\n\t\t'abbreviation': 'S',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'setleft=expr | (setleft[,...])=expr | *lvn=lname | aliascontainer[,...]'\r\n\t},\r\n\t'TCOMMIT': {\r\n\t\t'abbreviation': 'TC',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'TRESTART': {\r\n\t\t'abbreviation': 'TRE',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'TROLLBACK': {\r\n\t\t'abbreviation': 'TRO',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[intexpr]'\r\n\t},\r\n\t'TSTART': {\r\n\t\t'abbreviation': 'TS',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[([lvn...])|lvn|*|][:keyword|(keyword...)]'\r\n\t},\r\n\t'USE': {\r\n\t\t'abbreviation': 'U',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:(keyword[=expr][:...])][,...]'\r\n\t},\r\n\t'VIEW': {\r\n\t\t'abbreviation': 'V',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'keyword[:expr[:...]][,...]'\r\n\t},\r\n\t'WRITE': {\r\n\t\t'abbreviation': 'W',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr|*intexpr|fcc[,...]'\r\n\t},\r\n\t'XECUTE': {\r\n\t\t'abbreviation': 'X',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[:tvexpr][,...]'\r\n\t},\r\n\t'ZALLOCATE': {\r\n\t\t'abbreviation': 'ZA',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[(]nref[,...][)][:intexpr][,...]'\r\n\t},\r\n\t'ZBREAK': {\r\n\t\t'abbreviation': 'ZB',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[-]entryref[:[expr][:intexpr]][,...]'\r\n\t},\r\n\t'ZCOMPILE': {\r\n\t\t'abbreviation': 'ZCOM',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[,...]'\r\n\t},\r\n\t'ZCONTINUE': {\r\n\t\t'abbreviation': 'ZC',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'ZDEALLOCATE': {\r\n\t\t'abbreviation': 'ZD',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[nref[,...]]'\r\n\t},\r\n\t'ZEDIT': {\r\n\t\t'abbreviation': 'ZED',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr[,...]]'\r\n\t},\r\n\t'ZGOTO': {\r\n\t\t'abbreviation': 'ZG',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[[intexpr][:entryref[:tvexpr]],...]'\r\n\t},\r\n\t'ZHALT': {\r\n\t\t'abbreviation': 'ZHALT',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[intexpr]'\r\n\t},\r\n\t'ZHELP': {\r\n\t\t'abbreviation': 'ZH',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr1[:expr2],...]'\r\n\t},\r\n\t'ZKILL': {\r\n\t\t'abbreviation': 'ZK',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'glvn'\r\n\t},\r\n\t'ZLINK': {\r\n\t\t'abbreviation': 'ZL',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr1[:expr2][,...]]'\r\n\t},\r\n\t'ZMESSAGE': {\r\n\t\t'abbreviation': 'ZM',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'intexpr[:expr2][:...]'\r\n\t},\r\n\t'ZPRINT': {\r\n\t\t'abbreviation': 'ZP',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[entryref[:label[+intexpr]][,...]'\r\n\t},\r\n\t'ZRUPDATE': {\r\n\t\t'abbreviation': 'ZRUP',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'expr[,...]'\r\n\t},\r\n\t'ZSHOW': {\r\n\t\t'abbreviation': 'ZSH',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr[:glvn][,...]]'\r\n\t},\r\n\t'ZSTEP': {\r\n\t\t'abbreviation': 'ZST',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[keyword[:expr]][,...]'\r\n\t},\r\n\t'ZSYSTEM': {\r\n\t\t'abbreviation': 'ZSY',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[expr][,...]]'\r\n\t},\r\n\t'ZTCOMMIT': {\r\n\t\t'abbreviation': 'ZTC',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[intexpr]'\r\n\t},\r\n\t'ZTRIGGER': {\r\n\t\t'abbreviation': 'ZTR',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'gvn'\r\n\t},\r\n\t'ZTSTART': {\r\n\t\t'abbreviation': 'ZTS',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': ''\r\n\t},\r\n\t'ZWITHDRAW': {\r\n\t\t'abbreviation': 'ZWI',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': 'glvn'\r\n\t},\r\n\t'ZWRITE': {\r\n\t\t'abbreviation': 'ZWR',\r\n\t\t'postcondition': true,\r\n\t\t'parameter': '[zwrglvn[,...]]'\r\n\t}\r\n}\r\nconst funcParams = {\r\n\t'ASCII': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'CHAR': {\r\n\t\t'maxparams': 99\r\n\t},\r\n\t'DATA': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn'\r\n\t},\r\n\t'EXTRACT': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'FIND': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'FNUMBER': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'GET': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'INCREMENT': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'JUSTIFY': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'LENGTH': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'NAME': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'NEXT': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn('\r\n\t},\r\n\t'ORDER': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'PIECE': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'QLENGTH': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn'\r\n\t},\r\n\t'QSUBSCRIPT': {\r\n\t\t'maxparams': 2,\r\n\t\t'format': 'glvn,expr'\r\n\t},\r\n\t'QUERY': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn'\r\n\t},\r\n\t'RANDOM': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'REVERSE': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'SELECT': {\r\n\t\t'maxparams': 99,\r\n\t\t'format': 'special'\r\n\t},\r\n\t'STACK': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'TEXT': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'entryref'\r\n\t},\r\n\t'TRANSLATE': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'VIEW': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZASCII': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZATRANSFORM': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 4,\r\n\t\t'format': 'expr,expr,bool,bool'\r\n\t},\r\n\t'ZBITAND': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITCOUNT': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZBITFIND': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZBITGET': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITLEN': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZBITNOT': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZBITOR': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITSET': {\r\n\t\t'minparams': 3,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZBITSTR': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZBITXOR': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZCHAR': {\r\n\t\t'maxparams': 99\r\n\t},\r\n\t'ZCOLLATE': {\r\n\t\t'maxparams': 3,\r\n\t\t'format': 'glvn,expr,bool'\r\n\t},\r\n\t'ZCONVERT': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZDATA': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'lvn'\r\n\t},\r\n\t'ZDATE': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZEXTRACT': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZFIND': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZGETJPI': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZJOBEXAM': {\r\n\t\t'minparams': 0,\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZJUSTIFY': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZLENGTH': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZMESSAGE': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZPARSE': {\r\n\t\t'maxparams': 5\r\n\t},\r\n\t'ZPEEK': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZPIECE': {\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZPREVIOUS': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'glvn'\r\n\t},\r\n\t'ZQGBLMOD': {\r\n\t\t'maxparams': 1,\r\n\t\t'format': 'gvn'\r\n\t},\r\n\t'ZSEARCH': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZSIGPROC': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZSOCKET': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 4\r\n\t},\r\n\t'ZSUBSTR': {\r\n\t\t'minparams': 2,\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZSYSLOG': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZTRANSLATE': {\r\n\t\t'maxparams': 3\r\n\t},\r\n\t'ZTRIGGER': {\r\n\t\t'maxparams': 2\r\n\t},\r\n\t'ZTRNLNM': {\r\n\t\t'maxparams': 6\r\n\t},\r\n\t'ZWIDTH': {\r\n\t\t'maxparams': 1\r\n\t},\r\n\t'ZWRITE': {\r\n\t\t'maxparams': 2\r\n\t}\r\n}\r\nconst expressiontype = {\r\n\t\"Standard\": 0,\r\n\t\"Index\": 1,\r\n\t\"eArgument\": 2,\r\n\t\"iArgument\": 3,\r\n\t\"Atom\": 4\r\n}\r\n\r\nexport class MumpsLineParser {\r\n\ttokens: LineToken[] = [];\r\n\tprivate linePosition: number = 0;\r\n\tprivate _evaluatePattern(pattern: string, position: number, level?: number): ErrorInformation {\r\n\t\tlet result = { text: '', position }\r\n\t\tlet patternComplete = false;\r\n\t\tif (level === undefined) {\r\n\t\t\tlevel = 0;\r\n\t\t}\r\n\t\tdo {\r\n\t\t\tif (pattern[position] === '@') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, pattern, ++position);\r\n\t\t\t\tpatternComplete = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (pattern.substring(result.position).match(repititionCount)) {\r\n\t\t\t\tlet repCount = pattern.substring(result.position).match(repititionCount)![0];\r\n\t\t\t\tif (repCount !== '') {\r\n\t\t\t\t\tpatternComplete = false;\r\n\t\t\t\t\tresult.position += repCount.length;\r\n\t\t\t\t\tif (pattern.substring(result.position).match(patcode)) {\r\n\t\t\t\t\t\tpatternComplete = true;\r\n\t\t\t\t\t\tresult.position += pattern.substring(result.position).match(patcode)![0].length;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else if (pattern[result.position] === '(') {\r\n\t\t\t\t\t\tresult = this._evaluatePattern(pattern, ++result.position, level + 1);\r\n\t\t\t\t\t\tpatternComplete = true;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (pattern[result.position] === ')') {\r\n\t\t\t\t\tif (!patternComplete) {\r\n\t\t\t\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (level > 0) {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else if (pattern[result.position] === ',' && level > 0) {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else if (pattern[result.position] === ')') {\r\n\t\t\t\tif (!patternComplete) {\r\n\t\t\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t} else if (pattern[result.position] === ',' && level > 0) {\r\n\t\t\t\tif (!patternComplete) {\r\n\t\t\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} while (position < pattern.length)\r\n\t\tif (!patternComplete) {\r\n\t\t\tresult.text = 'Incomplete pattern';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tif (level > 0) {\r\n\t\t\tresult.text = 'Missing \")\"';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\r\n\t}\r\n\tpublic evaluateExpression(exType: number, line: string, position: number, level?: number | undefined): ErrorInformation {\r\n\t\tlet expressionComplete = false;\r\n\t\tlet startposition = position;\r\n\t\tif (level === undefined) {\r\n\t\t\tlevel = 0;\r\n\t\t}\r\n\t\tlet lastExpression = '';\r\n\t\twhile (position < line.length) {\r\n\t\t\tlet char = line.charAt(position);\r\n\t\t\tif (char === '(') {\r\n\t\t\t\tlet subExType = expressiontype.Standard\r\n\t\t\t\tswitch (lastExpression) {\r\n\t\t\t\t\tcase 'ifunction':\r\n\t\t\t\t\t\tsubExType = expressiontype.iArgument;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'exfunction':\r\n\t\t\t\t\t\tsubExType = expressiontype.eArgument;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'pattern':\r\n\t\t\t\t\t\tthrow { text: 'Unecpected \"(\"', position };\r\n\t\t\t\t}\r\n\t\t\t\tlet result = this.evaluateExpression(subExType, line, ++position, level + 1);\r\n\t\t\t\tif (exType === expressiontype.Atom) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t\texpressionComplete = true;\r\n\t\t\t\tposition = result.position;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tlastExpression = '';\r\n\t\t\tif (char === ')') {\r\n\t\t\t\tif (!expressionComplete) {\r\n\t\t\t\t\tif (position === startposition && exType === expressiontype.eArgument) {\r\n\t\t\t\t\t\treturn { text: '', position: ++position }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthrow { text: 'Incomplete Expression', position };\r\n\t\t\t\t}\r\n\t\t\t\tif (level > 0) {\r\n\t\t\t\t\tposition++;\r\n\t\t\t\t}\r\n\t\t\t\treturn { text: '', position: position };\r\n\t\t\t}\r\n\t\t\tif (char === '.' && exType === expressiontype.eArgument) {\r\n\t\t\t\tposition++;\r\n\t\t\t\tlet evalString = line.substring(position);\r\n\t\t\t\tif (evalString.match(lvn)) {\r\n\t\t\t\t\tlet localname = evalString.match(lvn)![0];\r\n\t\t\t\t\tthis.tokens.push({ type: TokenType.local, name: localname, position: position + this.linePosition });\r\n\t\t\t\t\tposition += localname.length;\r\n\t\t\t\t\tchar = line.charAt(position);\r\n\t\t\t\t\tif (char !== ',' && char !== ')') {\r\n\t\t\t\t\t\tthrow { text: 'Variablereference must stand alone', position }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (char === ',') {\r\n\t\t\t\tif (!expressionComplete) {\r\n\t\t\t\t\tif (position === startposition && exType === expressiontype.eArgument) {\r\n\t\t\t\t\t\tif (level === 0) {\r\n\t\t\t\t\t\t\treturn { text: '', position: ++position }\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tposition++\r\n\t\t\t\t\t\t\texpressionComplete = false;\r\n\t\t\t\t\t\t\tstartposition = position;\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthrow { text: 'Incomplete Expression', position };\r\n\t\t\t\t}\r\n\t\t\t\tif (exType === expressiontype.Standard || exType === expressiontype.Atom) {\r\n\t\t\t\t\treturn { text: '', position }\r\n\t\t\t\t}\r\n\t\t\t\tposition++\r\n\t\t\t\texpressionComplete = false;\r\n\t\t\t\tstartposition = position;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (expressionComplete) {\r\n\t\t\t\tif (exType === expressiontype.Atom) {\r\n\t\t\t\t\treturn { text: '', position }\r\n\t\t\t\t}\r\n\t\t\t\tif (line.substring(position).match(binoperator)) {\r\n\t\t\t\t\tlet operator = line.substring(position).match(binoperator)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: operator, position: position + this.linePosition, type: TokenType.operator });\r\n\t\t\t\t\tposition += operator.length;\r\n\t\t\t\t\texpressionComplete = false;\r\n\t\t\t\t\tif (operator === '?' || operator === \"'?\") {\r\n\t\t\t\t\t\tlet result = this._evaluatePattern(line, position);\r\n\t\t\t\t\t\tposition = result.position;\r\n\t\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t\t\tlastExpression = 'pattern';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn { text: '', position }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet evalString = line.substring(position);\r\n\t\t\ttry {\r\n\t\t\t\tlet provResult = this._checkVar(line, position);\r\n\t\t\t\texpressionComplete = true;\r\n\t\t\t\tposition = provResult.position;\r\n\t\t\t} catch (provResult) {\r\n\t\t\t\tif (evalString.substring(0, 2) === '$$') {\r\n\t\t\t\t\tposition += 2;\r\n\t\t\t\t\tprovResult = this._checkEntryRef(line, position, true, true);\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t\tposition = provResult.position;\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(nonMfunction)) {\r\n\t\t\t\t\tlet functionname = evalString.match(nonMfunction)![0];\r\n\t\t\t\t\tthis.tokens.push({ type: TokenType.nonMfunction, name: functionname, position: position + this.linePosition });\r\n\t\t\t\t\tposition += functionname.length;\r\n\t\t\t\t\tlastExpression = 'exfunction'\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(ifunction)) {\r\n\t\t\t\t\tlet functionname = evalString.match(ifunction)![0].substring(1).toUpperCase();\r\n\t\t\t\t\tthis.tokens.push({ name: \"$\" + functionname, position: position + this.linePosition, type: TokenType.ifunction });\r\n\t\t\t\t\tposition += functionname.length + 2\r\n\t\t\t\t\tif (funcExpansions[functionname] !== undefined) {\r\n\t\t\t\t\t\tfunctionname = funcExpansions[functionname];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet result = this._checkFunction(functionname, line, position);\r\n\t\t\t\t\tposition = result.position;\r\n\t\t\t\t\tlastExpression = '';\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(isv)) {\r\n\t\t\t\t\tlet specialvarname = evalString.match(isv)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: specialvarname, position: position + this.linePosition, type: TokenType.sysvariable });\r\n\t\t\t\t\tposition += specialvarname.length\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(numlit) && evalString.match(numlit)![0] !== '') {\r\n\t\t\t\t\tlet numericliteral = evalString.match(numlit)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: numericliteral, type: TokenType.number, position: position + this.linePosition });\r\n\t\t\t\t\tposition += numericliteral.length;\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (evalString.match(strlit)) {\r\n\t\t\t\t\tlet stringlit = evalString.match(strlit)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: stringlit, type: TokenType.string, position: position + this.linePosition });\r\n\t\t\t\t\tposition += stringlit.length;\r\n\t\t\t\t\texpressionComplete = true;\r\n\t\t\t\t} else if (char.match(unaryoperator)) {\r\n\t\t\t\t\tthis.tokens.push({ name: char, type: TokenType.operator, position: position + this.linePosition });\r\n\t\t\t\t\tposition++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow { text: 'Unexpected Character ' + char, position }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (expressionComplete) {\r\n\t\t\tif (level > 0) {\r\n\t\t\t\tthrow { text: 'Missing \")\"', position }\r\n\t\t\t}\r\n\t\t\treturn { text: '', position }\r\n\t\t} else {\r\n\t\t\tthrow { text: 'Incomplete Expression', position };\r\n\t\t}\r\n\t}\r\n\tprivate _extractLabel(inputObject: LineObject): LineObject {\r\n\t\tinputObject.lineLabel = '';\r\n\t\tlet inputLine=inputObject.lineExpression;\r\n\t\tinputObject.lineExpression='';\r\n\t\tif (inputLine.match(label)) {\r\n\t\t\tinputObject.lineLabel = inputLine.match(label)![0];\r\n\t\t}\r\n\t\tlet position = inputObject.lineLabel.length;\r\n\t\tif (position === inputLine.length) {\r\n\t\t\treturn inputObject\r\n\t\t}\r\n\t\tif (!inputLine.charAt(position).match(/[\\s|;]/)) {\r\n\t\t\tinputObject.errorText = 'Unexpected Character' + inputLine.charAt(position);\r\n\t\t\tinputObject.errorPosition = position;\r\n\t\t\treturn inputObject;\r\n\t\t}\r\n\t\tlet i = 0;\r\n\t\tfor (i = position; i <= inputLine.length; i++) {\r\n\t\t\tif (inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tinputObject.lineLeadSpace = inputLine.substring(position, i);\r\n\t\tif (i !== (inputLine.length - 1)) {\r\n\t\t\tinputObject.lineExpression = inputLine.substring(i);\r\n\t\t\tinputObject.expressionPosition = i;\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\r\n\t//Extract Comments.\r\n\tprivate _extractComment(inputObject: LineObject): LineObject {\r\n\t\tlet inputLine = inputObject.lineExpression!;\r\n\t\t//Semicolon identifies comments.\r\n\t\tif (inputLine.search(\";\") >= 0) {\r\n\t\t\tlet isInsideString = false;\r\n\t\t\tfor (let i = 0; i < inputLine.length; i++) {\r\n\t\t\t\tif (inputLine[i] === \";\") {\r\n\t\t\t\t\tif (!isInsideString) {\r\n\t\t\t\t\t\tinputObject.lineExpression = inputLine.substring(0, i);\r\n\t\t\t\t\t\tinputObject.lineComment = { comment: inputLine.substring(i).substring(1), position: i+inputObject.expressionPosition };\r\n\t\t\t\t\t\treturn inputObject;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (inputLine[i] === '\"') {\r\n\t\t\t\t\tisInsideString = !isInsideString;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\r\n\t//Extract Indentation.\r\n\t//Assumes inputLine has extracted comments/spacing.\r\n\tprivate _extractIndentation(inputObject: LineObject): LineObject {\r\n\r\n\t\tlet lineIndentationArray: string[] = [];\r\n\t\tlet lineIndentation = 0;\r\n\t\tlet inputLine = inputObject.lineExpression!;\r\n\t\tlet spacer = '';\r\n\t\tlet i = 0;\r\n\t\tfor (i = 0; i <= inputLine.length; i++) {\r\n\t\t\tlet char = inputLine[i];\r\n\t\t\tif (char === \".\") {\r\n\t\t\t\tif (lineIndentation > 0) {\r\n\t\t\t\t\tlineIndentationArray.push(spacer);\r\n\t\t\t\t}\r\n\t\t\t\tlineIndentation++;\r\n\t\t\t\tspacer = '';\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (char === \" \" || char === \"\\t\") {\r\n\t\t\t\tspacer += char;\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (lineIndentation > 0) {\r\n\t\t\tlineIndentationArray.push(spacer);\r\n\t\t\tinputObject.lineExpression = inputLine.substring(i);\r\n\t\t\tinputObject.expressionPosition! += i;\r\n\t\t\tinputObject.lineIndentationArray = lineIndentationArray;\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\r\n\t//Extract M-Commands.\r\n\t//Assumes inputLine has extracted comments/spacing/indentation.\r\n\tprivate _extractCommands(inputObject: LineObject): LineObject {\r\n\r\n\t\tlet tmpFunction: TmpFunction;\r\n\t\tlet tmpFunctionArray: Array<TmpFunction> = [];\r\n\t\t//Divide Routines and Arguments.\r\n\t\tlet splitLine = this._splitCommandsAndArguments(inputObject);\r\n\t\t//Loop, even is function, odd is arguments.\r\n\t\tlet i = 0;\r\n\t\ttmpFunction = { mCommand: '', mPostCondition: '', mArguments: '', cmdPosition: 0, argPosition: 0, pcPosition: 0 }\r\n\t\twhile (i < splitLine.length) {\r\n\t\t\tif (i % 2 === 0) {\r\n\t\t\t\ttmpFunction.mCommand = splitLine[i].command;\r\n\t\t\t\ttmpFunction.cmdPosition = splitLine[i].position;\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttmpFunction.mArguments = splitLine[i].command;\r\n\t\t\t\ttmpFunction.argPosition = splitLine[i].position;\r\n\r\n\t\t\t\t//Custom handler for trailing argument spacing.\r\n\t\t\t\t//Go until splitline hits a non empty val.\r\n\t\t\t\tlet ii = i + 1;\r\n\t\t\t\twhile (ii < splitLine.length) {\r\n\t\t\t\t\tif (splitLine[ii].command === \"\") {\r\n\t\t\t\t\t\tsplitLine.splice(ii, 1);\r\n\t\t\t\t\t\t//tmpFunction.mArguments = tmpFunction.mArguments + \" \";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttmpFunctionArray.push(tmpFunction);\r\n\t\t\t\ttmpFunction = { mCommand: '', mPostCondition: '', mArguments: '', cmdPosition: 0, argPosition: 0, pcPosition: 0 }\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t\t//Last command doesn't always require parameter, so if odd number of pairs, push it.\r\n\t\tif (splitLine.length % 2 !== 0) {\r\n\t\t\ttmpFunction.mCommand = splitLine[splitLine.length - 1].command;\r\n\t\t\ttmpFunction.cmdPosition = splitLine[splitLine.length - 1].position;\r\n\t\t\ttmpFunction.mArguments = '';\r\n\t\t\ttmpFunction.argPosition = inputObject.lineExpression!.length;\r\n\t\t\ttmpFunctionArray.push(tmpFunction);\r\n\t\t}\r\n\r\n\r\n\t\t//Extract and output Post Conditionals.\r\n\t\tlet postConditionFunctionArray = this._extractPostConditional(tmpFunctionArray);\r\n\t\tif (postConditionFunctionArray.length > 0) {\r\n\t\t\tinputObject.lineRoutines = postConditionFunctionArray;\r\n\t\t}\r\n\t\treturn inputObject;\r\n\t}\r\n\r\n\t//Divide commands and arguments into array, used by extractRoutines.\r\n\tprivate _splitCommandsAndArguments(inputObject: LineObject): LineComand[] {\r\n\r\n\t\tlet lineCommands: LineComand[] = [];\r\n\t\tlet tmpCursor = 0;\r\n\t\tlet isInsideString = false;\r\n\t\tlet inputLine = inputObject.lineExpression!;\r\n\t\tlet start = inputObject.expressionPosition!;\r\n\t\tfor (let i = 0; i < inputLine.length; i++) {\r\n\r\n\t\t\t//Ensure space isn't quoted.\r\n\t\t\tif (inputLine[i] === '\"') {\r\n\t\t\t\tisInsideString = !isInsideString;\r\n\t\t\t}\r\n\t\t\t//Flag spaces/tabs as dividers.\r\n\t\t\tif ((inputLine[i] === \" \" || inputLine[i] === \"\\t\") && !isInsideString) {\r\n\t\t\t\t//If has content, push.\r\n\t\t\t\tif (inputLine.substring(tmpCursor, i).length > 0) {\r\n\t\t\t\t\tlineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n\t\t\t\t\t//Otherwise, push empty commands.\r\n\t\t\t\t} else if (inputLine.substring(tmpCursor, i).length === 0 && (inputLine.substring(tmpCursor - 1, tmpCursor) === \" \" || inputLine.substring(tmpCursor - 1, tmpCursor) === \"\\t\")) {\r\n\t\t\t\t\tlineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n\t\t\t\t}\r\n\t\t\t\ttmpCursor = i + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet i = inputLine.length;\r\n\t\tif (inputLine.substring(tmpCursor, i).length > 0) {\r\n\t\t\tlineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n\t\t\t//Gather empty commands from end of line.\r\n\t\t} else if (i === tmpCursor && (inputLine.substring(i - 1, i) === \" \" || inputLine.substring(i - 1, i) === \"/t\")) {\r\n\t\t\tlineCommands.push({ command: '', position: start + tmpCursor });\r\n\t\t}\r\n\t\treturn lineCommands;\r\n\t}\r\n\r\n\t//Extracts Post-Conditionals from Routines, used by extractRoutines.\r\n\tprivate _extractPostConditional(tmpFunctionArray: TmpFunction[]): TmpFunction[] {\r\n\r\n\t\t//Assign to new variable to truncate Routines.\r\n\t\tlet tmpObject = tmpFunctionArray;\r\n\t\tfor (let i = 0; i < tmpObject.length; i++) {\r\n\t\t\t//Colon indicates Post-Conditionals.\r\n\t\t\tlet tmpIndex = tmpObject[i].mCommand!.indexOf(\":\");\r\n\t\t\tif (tmpIndex > -1) {\r\n\t\t\t\ttmpObject[i].mPostCondition = tmpObject[i].mCommand.substring(tmpIndex + 1);\r\n\t\t\t\ttmpObject[i].mCommand = tmpObject[i].mCommand.substring(0, tmpIndex);\r\n\t\t\t\ttmpObject[i].pcPosition = tmpObject[i].cmdPosition + tmpIndex + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn tmpObject;\r\n\t}\r\n\r\n\tpublic parseLine(inputString): LineObject {\r\n\r\n\t\tlet tmpObject: LineObject={lineExpression:inputString, expressionPosition:0};\r\n\r\n\t\t//Parsing must be performed sequentially.\r\n\t\ttmpObject = this._extractLabel(tmpObject);\r\n\t\tif (tmpObject.errorText) {\r\n\t\t\treturn tmpObject;\r\n\t\t}\r\n\t\ttmpObject = this._extractComment(tmpObject);\r\n\t\ttmpObject = this._extractIndentation(tmpObject);\r\n\t\ttmpObject = this._extractCommands(tmpObject);\r\n\r\n\t\t//Line Expression is no longer needed.\r\n\t\tdelete tmpObject.lineExpression;\r\n\t\treturn tmpObject;\r\n\t}\r\n\tpublic checkFile(filename: string): ErrorInformation[] {\r\n\t\tlet errlist: ErrorInformation[] = [];\r\n\t\tlet content: string;\r\n\t\ttry {\r\n\t\t\tcontent = fs.readFileSync(filename, \"utf8\");\r\n\t\t} catch (err) {\r\n\t\t\terrlist.push({ text: 'File read error: ' + filename, position: 0, line: 0 });\r\n\t\t\treturn errlist;\r\n\t\t}\r\n\t\tlet lines = content.split('\\n');\r\n\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\tlines[i] = lines[i].replace('\\r', '');\r\n\t\t\tlet info = this.checkLine(lines[i]);\r\n\t\t\tif (info.text !== '') {\r\n\t\t\t\tinfo.line = i + 1;\r\n\t\t\t\terrlist.push(info);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn errlist;\r\n\t}\r\n\tpublic analyzeLines(input: string): Array<Array<LineToken>> {\r\n\t\tlet lines = input.split('\\n');\r\n\t\tlet linetokens: Array<Array<LineToken>> = [];\r\n\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\tlines[i] = lines[i].replace('\\r', '');\r\n\t\t\tthis.checkLine(lines[i]);\r\n\t\t\tlinetokens[i] = this.tokens;\r\n\t\t}\r\n\t\treturn linetokens;\r\n\t}\r\n\tprivate _splitLabelAndParameters(label:string) {\r\n\t\tif (label.indexOf('(')===-1) {\r\n\t\t\tthis.tokens.push({ name: label, position: 0, type: TokenType.label });\r\n\t\t} else {\r\n\t\t\tlet labelparts=label.split('(');\r\n\t\t\tlet labeltext=labelparts[0];\r\n\t\t\tthis.tokens.push({ name: labeltext, position: 0, type: TokenType.label });\r\n\t\t\tlet parameters=labelparts[1].split(')')[0];\r\n\t\t\tlet parameterVars=parameters.split(',');\r\n\t\t\tlet position=labeltext.length+1\t\t// Position = lengths of Label + trailing \"(\"\r\n\t\t\tfor (let i=0;i<parameterVars.length;i++) {\r\n\t\t\t\tthis.tokens.push({ name: parameterVars[i], position, type: TokenType.local });\r\n\t\t\t\tposition+=parameterVars[i].length+1\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tpublic checkLine(line: string): ErrorInformation {\r\n\t\tthis.tokens = [];\r\n\t\tthis.linePosition = 0;\r\n\t\tlet parsed = this.parseLine(line);\r\n\t\tif (parsed.lineLabel) {\r\n\t\t\tthis._splitLabelAndParameters(parsed.lineLabel);\r\n\t\t}\r\n\t\tif (parsed.lineComment) {\r\n\t\t\tthis.tokens.push({ name: parsed.lineComment.comment, position: parsed.lineComment.position, type: TokenType.comment });\r\n\t\t}\r\n\t\tlet result: ErrorInformation = { text: '', position: 0 }\r\n\t\tif (parsed.lineRoutines) {\r\n\t\t\tfor (let i = 0; i < parsed.lineRoutines.length; i++) {\r\n\t\t\t\tlet code = parsed.lineRoutines[i];\r\n\t\t\t\tif (code.mCommand.length > 0) {\r\n\t\t\t\t\tthis.tokens.push({ name: code.mCommand, type: TokenType.keyword, position: code.cmdPosition });\r\n\t\t\t\t\tlet cmd = code.mCommand.toUpperCase();\r\n\t\t\t\t\tif (cmd === 'H') {\r\n\t\t\t\t\t\tif (code.mArguments === '') {\r\n\t\t\t\t\t\t\tcmd = 'HALT';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcmd = 'HANG';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (cmd.match(command)) {\r\n\t\t\t\t\t\tlet longcmd = cmd;\r\n\t\t\t\t\t\tif (cmdParams[cmd] === undefined) {\r\n\t\t\t\t\t\t\tlongcmd = cmdExpansions[cmd];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (longcmd === undefined) {\r\n\t\t\t\t\t\t\tresult.text = 'Unknown Command';\r\n\t\t\t\t\t\t\tresult.position = code.cmdPosition;\r\n\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tresult = this._checkCommand(longcmd, code);\r\n\t\t\t\t\t\t} catch (result) {\r\n\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn { text: 'Invalid Command', position: code.cmdPosition }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkEntryRefAndPostcondition(arg: string, position: number, withParams: boolean): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this._checkEntryRef(arg, result.position, withParams);\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkEntryRef(arg: string, position: number, withParams: boolean, isUserfunction?:boolean): ErrorInformation {\r\n\t\tif (isUserfunction===undefined) {\r\n\t\t\tisUserfunction=false;\r\n\t\t}\r\n\t\tlet tokentype:TokenType=TokenType.entryref;\r\n\t\tif (isUserfunction) {\r\n\t\t\ttokentype=TokenType.exfunction;\r\n\t\t}\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (arg[result.position] === '@') { //Check Indirection\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n\t\t\tif (arg[result.position] === '+') { //Check Label+Offset\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t}\r\n\t\t\tif (arg[result.position] === '^') { //Check if it's a Label like xxx^yyy\r\n\t\t\t\tif (arg[result.position + 1] === '@') { // or a Label xxx^@expr\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (arg.substring(result.position).match(entryref)) {\r\n\t\t\t\t\t\tlet ref = arg.substring(result.position).match(entryref)![0];\r\n\t\t\t\t\t\tresult.position += ref.length;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.text = 'Invalid EntryRef';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (arg.substring(result.position, result.position + 2) === '@(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t} else if (arg.substring(result.position).match(entryref)) { //No Indirection and a valid entryref\r\n\t\t\tlet ref = arg.substring(result.position).match(entryref)![0];\r\n\t\t\tlet merkpos = result.position;\r\n\t\t\tresult.position += ref.length;\r\n\t\t\tlet char = arg[result.position];\r\n\t\t\tif (result.position >= arg.length) {\r\n\t\t\t\tif (ref.length > 0) {\r\n\t\t\t\t\tif (ref[0]==='&') {\r\n\t\t\t\t\t\ttokentype=TokenType.nonMfunction;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.tokens.push({ 'type':tokentype, name: ref, position: merkpos + this.linePosition });\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.text = 'Missing Entryref';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (ref.indexOf('^') === -1 && char === '+') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\t//ref += \"+X\";\r\n\t\t\t\tif (result.position >= arg.length) {\r\n\t\t\t\t\tthis.tokens.push({ 'type': tokentype, name: ref, position: merkpos+this.linePosition });\r\n\t\t\t\t\treturn result\r\n\t\t\t\t}\r\n\t\t\t\tif (arg.substring(result.position).match(routineref)) {\r\n\t\t\t\t\tlet routine = arg.substring(result.position).match(routineref)![0];\r\n\t\t\t\t\tref += routine;\r\n\t\t\t\t\tresult.position += routine.length;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.tokens.push({ 'type': tokentype, name: ref, position: merkpos + this.linePosition });\r\n\t\t} else {\r\n\t\t\tresult.text = 'Invalid Entryref';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tif (arg[result.position] === '(' && withParams) {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.eArgument, arg, ++result.position, 1);\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\tprivate _checkVar(arg: string, position: number, globalOk?: boolean, indexOk?: boolean): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position, indexFound: false, globalFound: false, indirectionFound: false };\r\n\t\tlet varFound = false;\r\n\t\tif (globalOk === undefined) {\r\n\t\t\tglobalOk = true;\r\n\t\t}\r\n\t\tif (indexOk === undefined) {\r\n\t\t\tindexOk = true;\r\n\t\t}\r\n\t\tif (arg[result.position] === '@') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n\t\t\tresult.indirectionFound = true;\r\n\t\t\tvarFound = true;\r\n\t\t\tif (arg.substring(result.position, result.position + 2) === '@(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (arg.substring(result.position).match(gvn) || arg.substring(result.position, result.position + 2) === '^|') {\r\n\t\t\t\tif (!globalOk) {\r\n\t\t\t\t\tresult.text = 'Global not allowed here';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tresult.globalFound = true;\r\n\t\t\t\tif (arg.substring(result.position, result.position + 2) === '^|') {\r\n\t\t\t\t\tresult.position += 2\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\tresult.globalFound = true;\r\n\t\t\t\t\tif (arg[result.position] === ',') {\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\t\t\tresult.globalFound = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (arg[result.position] !== '|') {\r\n\t\t\t\t\t\tresult.text = 'Missing \"|\"';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tif (arg.substring(result.position).match(lvn)) {\r\n\t\t\t\t\t\tlet global = arg.substring(result.position).match(lvn)![0];\r\n\t\t\t\t\t\tthis.tokens.push({ name: global, type: TokenType.global, position: result.position + this.linePosition });\r\n\t\t\t\t\t\tvarFound = true;\r\n\t\t\t\t\t\tresult.position += global.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet global = arg.substring(result.position).match(gvn)![0];\r\n\t\t\t\t\tthis.tokens.push({ name: global, type: TokenType.global, position: result.position + this.linePosition });\r\n\t\t\t\t\tvarFound = true;\r\n\t\t\t\t\tresult.position += global.length;\r\n\t\t\t\t}\r\n\t\t\t} else if (arg.substring(result.position).match(lvn)) {\r\n\t\t\t\tlet local = arg.substring(result.position).match(lvn)![0];\r\n\t\t\t\tthis.tokens.push({ name: local, type: TokenType.local, position: result.position + this.linePosition });\r\n\t\t\t\tvarFound = true;\r\n\t\t\t\tresult.position += local.length;\r\n\t\t\t} else if (arg.substring(result.position, result.position + 2) === '^(') {\r\n\t\t\t\tresult.globalFound = true;\r\n\t\t\t\tif (!globalOk) {\r\n\t\t\t\t\tresult.text = 'Global not allowed here';\r\n\t\t\t\t\tvarFound = false;\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tvarFound = true;\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (varFound && arg[result.position] === '(') {\r\n\t\t\tif (!indexOk) {\r\n\t\t\t\tresult.text = 'Index not allowed here';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tlet provResult = this.evaluateExpression(expressiontype.Index, arg, ++result.position, 1);\r\n\t\t\tresult.position = provResult.position;\r\n\t\t\tresult.indexFound = true;\r\n\t\t}\r\n\t\tif (!varFound) {\r\n\t\t\tresult.text = 'Name missing';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkBreak(arg: string, position: number): ErrorInformation {\r\n\t\t//[expr[:tvexpr][,...]]\r\n\t\tlet result = this.evaluateExpression(expressiontype.Standard, arg, position);\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkKeyword(keywords: RegExp, arg: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (arg.substring(result.position).match(keywords)) {\r\n\t\t\tlet keyword = arg.substring(result.position).match(keywords)![0];\r\n\t\t\tresult.position += keyword.length;\r\n\t\t\tif (keyword.slice(-1) === '=') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult.text = 'No valid Keyword for command found';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkOUC(keywords: RegExp, arg: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\t//expr[:(keyword[=expr][:...])][,...]\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (arg[result.position] === '(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tresult = this._checkKeyword(keywords, arg, result.position);\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (arg[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (result.position < arg.length)\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Keyword';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (arg[result.position] !== ':') {\r\n\t\t\t\t\tresult = this._checkKeyword(keywords, arg, result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (keywords === openkeywords && arg[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (arg[result.position] !== ':') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (keywords === openkeywords && arg[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkFor(arg: string, position: number, argNumber: number): ErrorInformation {\r\n\t\t//[lvn=expr[:numexpr1[:numexpr2]][,...]]]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (argNumber > 1) { //If it's not the first Argument the Options are possible: F I=1:2:3,4 or F I=1:2:3,I=4:1:6\r\n\t\t\ttry {\r\n\t\t\t\tlet provResult = this._checkVar(arg, result.position, false);\r\n\t\t\t\tif (arg[provResult.position] === '\"') {\r\n\t\t\t\t\tresult.position = provResult.position + 1;\r\n\t\t\t\t}\r\n\t\t\t} catch(provResult) {\r\n\t\t\t\tif (provResult.text!==\"Name missing\") {\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult = this._checkVar(arg, result.position, false);\r\n\t\t\tif (arg[result.position] !== '=') {\r\n\t\t\t\tresult.text = 'Missing equal-sign';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tresult.position++;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\tif (arg[result.position] !== ':') {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\tif (arg[result.position] !== ':') {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkJobKeyword(arg: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (arg.substring(result.position).match(jobkeywords)) {\r\n\t\t\tlet keyword = arg.substring(result.position).match(jobkeywords)![0];\r\n\t\t\tresult.position += keyword.length;\r\n\t\t\tif (keyword[keyword.length - 1] === '=') {\r\n\t\t\t\tif (arg.substring(result.position).match(strlit)) {\r\n\t\t\t\t\tlet stringlit = arg.substring(result.position).match(strlit)![0];\r\n\t\t\t\t\tresult.position += stringlit.length;\r\n\t\t\t\t\tif (stringlit.length === 0) {\r\n\t\t\t\t\t\tresult.text = 'String literal expected';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.text = 'String literal expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult.text = 'No valid Keyword for JOB Command';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkJob(arg: string, position: number): ErrorInformation {\r\n\t\t//entryref[(expr[,...])][:[(keyword[=value][:...])][:numexpr]][,...]\r\n\t\tlet result = this._checkEntryRef(arg, position, true);\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (arg[result.position] === '(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tresult = this._checkJobKeyword(arg, result.position);\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (arg[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (result.position < arg.length)\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Keyword';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (arg[result.position] !== ':') {\r\n\t\t\t\t\tresult = this._checkJobKeyword(arg, result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (arg[result.position] === ':') { //Numeric expression for Job-Timeout\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkKill(arg: string, position: number): ErrorInformation {\r\n\t\t//[glvn | (lvn[,...]) | *lname | *lvn ]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (arg[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (arg[result.position] !== ',') {\r\n\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = false;\r\n\t\t\t} while (result.position < arg.length)\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkLock(arg: string, position: number, isLock: boolean): ErrorInformation {\r\n\t\t//[[-|+]nref|(nref[,...])[:numexpr] [,...]]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif ((arg[result.position] === '+' || arg[result.position] === '-') && isLock) {\r\n\t\t\tresult.position++;\r\n\t\t}\r\n\t\tif (arg[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (arg[result.position] !== ',') {\r\n\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = false;\r\n\t\t\t} while (result.position < arg.length)\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t}\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkMerge(arg: string, position: number): ErrorInformation {\r\n\t\t//glvn=glvn[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this._checkVar(arg, result.position);\r\n\t\tif (arg[result.position] !== '=') {\r\n\t\t\tresult.text = 'Equal-Sign expected';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tresult = this._checkVar(arg, ++result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkNew(arg: string, position: number): ErrorInformation {\r\n\t\t//[[(]lvn[,...][)][,...]]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (arg[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tif (arg.substring(result.position).match(isv)) {\r\n\t\t\t\t\tresult.position += arg.substring(result.position).match(isv)![0].length;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = this._checkVar(arg, result.position, false);\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (arg[result.position] !== ',') {\r\n\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = false;\r\n\t\t\t} while (result.position < arg.length)\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (arg.substring(result.position).match(isv)) {\r\n\t\t\t\tresult.position += arg.substring(result.position).match(isv)![0].length;\r\n\t\t\t} else {\r\n\t\t\t\tresult = this._checkVar(arg, result.position, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkRead(arg: string, position: number): ErrorInformation {\r\n\t\t//(glvn|*glvn|glvn#intexpr)[:numexpr]|strlit|fcc[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet starDetected = false;\r\n\t\tlet mat: string[] | null;\r\n\t\tif (arg[result.position] === '*') {\r\n\t\t\tresult.position++;\r\n\t\t\tstarDetected = true;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tlet provResult = this._checkVar(arg, result.position);\r\n\t\t\tresult.position = provResult.position;\r\n\t\t\tif (arg[result.position] === '#') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\tif (result.text !== '') {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (arg[result.position] === ':') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t} catch {\r\n\t\t\tif (starDetected) {\r\n\t\t\t\tresult.text = 'Variable expected';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tif (mat = arg.substring(result.position).match(strlit)) {\r\n\t\t\t\tresult.position += mat[0].length;\r\n\t\t\t\treturn result;\r\n\t\t\t} else if (mat = arg.substring(result.position).match(/^(#|!)+/)) {\r\n\t\t\t\tresult.position += mat[0].length;\r\n\t\t\t}\r\n\t\t\tif (arg[result.position] === '?') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkSet(arg: string, position: number): ErrorInformation {\r\n\t\t//setleft=expr | (setleft[,...])=expr | *lvn=lname | aliascontainer[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\t\tlet isBraced = false;\r\n\t\tif (arg[result.position] === '*') { //*lvn=lname\r\n\t\t\tresult = this._checkVar(arg, ++result.position, false);\r\n\t\t\tif (arg[result.position] !== '=') {\r\n\t\t\t\tresult.text = 'Equal-Sign expected';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t\tresult = this._checkVar(arg, ++result.position, false);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (arg[result.position] === '(') {\r\n\t\t\tisBraced = true;\r\n\t\t\tresult.position++;\r\n\t\t}\r\n\t\tdo {\r\n\t\t\tif (arg[result.position] === '@') {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet provResult = this._checkVar(arg, result.position);\r\n\t\t\t\t\tresult.position = provResult.position;\r\n\t\t\t\t\tif (result.position === arg.length || arg[result.position] === ',') {\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n\t\t\t\t\tif (result.position === arg.length || arg[result.position] === ',') {\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (mat = arg.substring(result.position).match(/^\\$Z?(PIECE|P|EXTRACT|E)\\(/i)) {\r\n\t\t\t\tlet functionname = mat[0].substring(1, mat[0].length - 1).toUpperCase();\r\n\t\t\t\tresult.position += functionname.length + 2\r\n\t\t\t\tif (funcExpansions[functionname] !== undefined) {\r\n\t\t\t\t\tfunctionname = funcExpansions[functionname];\r\n\t\t\t\t}\r\n\t\t\t\tresult = this._checkFunction(functionname, arg, result.position);\r\n\t\t\t} else if (mat = arg.substring(result.position).match(isv)) {\r\n\t\t\t\tresult.position += mat[0].length;\r\n\t\t\t} else {\r\n\t\t\t\tresult = this._checkVar(arg, result.position, true);\r\n\t\t\t}\r\n\t\t\tif (arg[result.position] === ',' && isBraced) {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (arg[result.position] === ')' && isBraced) {\r\n\t\t\t\tisBraced = false;\r\n\t\t\t\tresult.position++;\r\n\t\t\t}\r\n\t\t} while (result.position < arg.length && isBraced);\r\n\t\tif (arg[result.position] !== '=') {\r\n\t\t\tresult.text = 'Equal-Sign expected';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkTstart(arg: string, position: number): ErrorInformation {\r\n\t\t//[([lvn...])|lvn|*|][:keyword|(keyword...)]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (arg[result.position] === '(') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (arg[result.position] !== ')') {\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tresult = this._checkVar(arg, result.position, false, false);\r\n\t\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (arg[result.position] !== ',') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (result.position < arg.length)\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Name';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (arg[result.position] !== '*') {\r\n\t\t\t\tresult = this._checkVar(arg, result.position, false, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (arg[result.position] === '(') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tlet braceComplete = false;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tresult = this._checkKeyword(tstartkeywords, arg, result.position);\r\n\t\t\t\t\tbraceComplete = true;\r\n\t\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (arg[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Unecpected Character';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.position++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t} while (result.position < arg.length)\r\n\t\t\t\tif (!braceComplete) {\r\n\t\t\t\t\tresult.text = 'Missing \")\" or Keyword';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tresult = this._checkKeyword(tstartkeywords, arg, result.position);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkView(arg: string, position: number): ErrorInformation {\r\n\t\t//keyword[:expr[:...]][,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\twhile (arg[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkWrite(arg: string, position: number): ErrorInformation {\r\n\t\t//expr|*intexpr|fcc[,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\t\tif (arg[result.position] === '*') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (arg.substring(result.position).match(/^\\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)) {\r\n\t\t\tresult = this._checkWriteSocket(arg, result.position);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (mat = arg.substring(result.position).match(/^(#|!)+/)) {\r\n\t\t\tresult.position += mat[0].length;\r\n\t\t\tif (arg[result.position] === '?') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (arg[result.position] === '?') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkWriteSocket(arg: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\t\tif (mat = arg.substring(result.position).match(/^\\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)) {\r\n\t\t\tresult.position += mat[0].length;\r\n\t\t\tlet fname = mat![0].toUpperCase();\r\n\t\t\tif (fname === '/EOF') {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tif (arg[result.position] !== '(') {\r\n\t\t\t\tif (!fname.match(/^\\/(LISTEN|L|WAIT|W)/)) {\r\n\t\t\t\t\tresult.text = fname + ' needs Parameter(s)';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tresult.position++;\r\n\t\t\tlet maxparams = 99;\r\n\t\t\tif (fname === '/LISTEN' || fname === '/L' || fname === '/WAIT' || fname === '/W') {\r\n\t\t\t\tmaxparams = 1;\r\n\t\t\t} else if (fname === '/TLS') {\r\n\t\t\t\tmaxparams = 4;\r\n\t\t\t}\r\n\t\t\tlet paramCount = 0;\r\n\t\t\tlet braceComplete = false;\r\n\t\t\tdo {\r\n\t\t\t\tparamCount++;\r\n\t\t\t\tif (paramCount > maxparams) {\r\n\t\t\t\t\tresult.text = 'More Parameters than expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tif (fname === '/ACCEPT' && paramCount === 1) {\r\n\t\t\t\t\tif (arg[result.position] !== '.') {\r\n\t\t\t\t\t\tresult.text = 'Local Variablereference expected (.lvn)';\r\n\t\t\t\t\t\tthrow result\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult = this._checkVar(arg, ++result.position, false, false);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t}\r\n\t\t\t\tbraceComplete = true;\r\n\t\t\t\tif (arg[result.position] === ',') {\r\n\t\t\t\t\tbraceComplete = false;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (arg[result.position] === ')') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} while (result.position < arg.length)\r\n\t\t\tif (!braceComplete) {\r\n\t\t\t\tresult.text = 'Missing Parameter or \")\"';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkXecute(arg: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkZbreak(arg: string, position: number): ErrorInformation {\r\n\t\t//[-]entryref[:[expr][:intexpr]][,...]\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tif (arg[result.position] === '-') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (arg[result.position] === '*') {\r\n\t\t\t\tresult.position++;\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\t\tresult = this._checkEntryRef(arg, result.position, false);\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult.position++;\r\n\t\t\tif (arg[result.position] === ':') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t} else {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\tif (arg[result.position] === ':') {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkZprint(arg: string, position: number): ErrorInformation {\r\n\t\t// 'parameter': '[entryref[:label[+intexpr]][,...]'\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tresult = this._checkEntryRef(arg, result.position, false);\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult = this._checkEntryRef(arg, ++result.position, false);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkZstep(arg: string, position: number): ErrorInformation {\r\n\t\t// 'parameter': '[keyword[:expr]][,...]'\r\n\t\tlet result: ErrorInformation = { text: '', position };\r\n\t\tlet mat: string[] | null;\r\n\r\n\t\tif (mat = arg.substring(result.position).match(/^(INTO|OUTOF|OU|OVER|OV)/i)) {\r\n\t\t\tresult.position += mat.length;\r\n\t\t} else {\r\n\t\t\tresult.text = 'Invalid ZSTEP Qualifier';\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tif (arg[result.position] === ':') {\r\n\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkCommand(longcmd: string, code: TmpFunction): ErrorInformation {\r\n\t\tlet para = cmdParams[longcmd];\r\n\t\tlet postcondPossible = para.postcondition;\r\n\t\tlet argFormat = para.parameter;\r\n\t\tlet arg = code.mArguments;\r\n\t\tlet argPosition = code.argPosition;\r\n\t\tlet result: ErrorInformation = { text: '', position: 0 }\r\n\t\tif (!postcondPossible && code.mPostCondition !== '') {\r\n\t\t\tthrow { text: 'Poscondition not allowed', position: code.pcPosition }\r\n\t\t} else if (code.mPostCondition !== '') {\r\n\t\t\ttry {\r\n\t\t\t\tthis.linePosition = code.pcPosition;\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, code.mPostCondition, 0);\r\n\t\t\t} catch (result) {\r\n\t\t\t\tresult.position += code.pcPosition;\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (arg === '') {\r\n\t\t\tif (argFormat === '' || argFormat[0] === '[') {\r\n\t\t\t\treturn { text: '', position: code.argPosition }\r\n\t\t\t} else {\r\n\t\t\t\tthrow { text: 'Argument for command ' + code.mCommand + \" required\", position: code.argPosition }\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.linePosition = argPosition;\r\n\t\tresult.position = 0;\r\n\t\tlet argCount = 0;\r\n\t\ttry {\r\n\t\t\tdo {\r\n\t\t\t\targCount++;\r\n\t\t\t\tswitch (longcmd) {\r\n\t\t\t\t\tcase 'BREAK':\r\n\t\t\t\t\t\tresult = this._checkBreak(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'CLOSE':\r\n\t\t\t\t\t\tresult = this._checkOUC(closekeywords, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'DO':\r\n\t\t\t\t\t\tresult = this._checkEntryRefAndPostcondition(arg, result.position, true);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ELSE':\r\n\t\t\t\t\t\tif (arg !== '') {\r\n\t\t\t\t\t\t\treturn { text: 'No Argument expected', position: code.argPosition }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'FOR':\r\n\t\t\t\t\t\tresult = this._checkFor(arg, result.position, argCount);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'GOTO':\r\n\t\t\t\t\t\tresult = this._checkEntryRefAndPostcondition(arg, result.position, false);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'HANG':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'IF':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'JOB':\r\n\t\t\t\t\t\tresult = this._checkJob(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'KILL':\r\n\t\t\t\t\t\tresult = this._checkKill(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'LOCK':\r\n\t\t\t\t\t\tresult = this._checkLock(arg, result.position, true);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'MERGE':\r\n\t\t\t\t\t\tresult = this._checkMerge(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'NEW':\r\n\t\t\t\t\t\tresult = this._checkNew(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'OPEN':\r\n\t\t\t\t\t\tresult = this._checkOUC(openkeywords, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'QUIT':\r\n\t\t\t\t\t\tif (argCount > 1) {\r\n\t\t\t\t\t\t\tresult.text = 'Quit allows only one Argument'\r\n\t\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (arg[result.position] === '*') {\r\n\t\t\t\t\t\t\t\tresult = this._checkVar(arg, ++result.position, false);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'READ':\r\n\t\t\t\t\t\tresult = this._checkRead(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'SET':\r\n\t\t\t\t\t\tresult = this._checkSet(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'TROLLBACK':\r\n\t\t\t\t\t\tif (argCount > 1) {\r\n\t\t\t\t\t\t\tresult.text = 'TROLLBACK allows only one Argument'\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'TSTART':\r\n\t\t\t\t\t\tresult = this._checkTstart(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'USE':\r\n\t\t\t\t\t\tresult = this._checkOUC(usekeywords, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'VIEW':\r\n\t\t\t\t\t\tresult = this._checkView(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'WRITE':\r\n\t\t\t\t\t\tresult = this._checkWrite(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'XECUTE':\r\n\t\t\t\t\t\tresult = this._checkXecute(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZALLOCATE':\r\n\t\t\t\t\t\tresult = this._checkLock(arg, result.position, false);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZBREAK':\r\n\t\t\t\t\t\tresult = this._checkZbreak(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZCOMPILE':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZCOM',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': 'expr[,...]'\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZDEALLOCATE':\r\n\t\t\t\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t\t\t\t\t// 'abbreviation': 'ZD',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[nref[,...]]'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZEDIT':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\t// 'abbreviation': 'ZED',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[expr[,...]]'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZGOTO':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tif (arg[result.position] === ':') {\r\n\t\t\t\t\t\t\tresult = this._checkEntryRefAndPostcondition(arg, ++result.position, false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 'abbreviation': 'ZG',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[[intexpr][:entryref[:tvexpr]],...]'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZHALT':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\t// 'abbreviation': 'ZHALT',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[intexpr]'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZHELP':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tif (arg[result.position] === ':') {\r\n\t\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 'abbreviation': 'ZH',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[expr1[:expr2],...]'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZKILL':\r\n\t\t\t\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t\t\t\t\t// 'abbreviation': 'ZK',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': 'glvn'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZLINK':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tif (arg[result.position] === ':') {\r\n\t\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 'abbreviation': 'ZL',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[expr1[:expr2][,...]]'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZMESSAGE':\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\twhile (arg[result.position] === ':') {\r\n\t\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 'abbreviation': 'ZM',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': 'intexpr[:expr2][:...]'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZPRINT':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZP',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[entryref[:label[+intexpr]][,...]'\r\n\t\t\t\t\t\tresult = this._checkZprint(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZRUPDATE':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZRUP',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': 'expr[,...]'\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZSHOW':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZSH',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[expr[:glvn][,...]]'\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tif (arg[result.position] === ':') {\r\n\t\t\t\t\t\t\tresult = this._checkVar(arg, ++result.position);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZSTEP':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZST',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[keyword[:expr]][,...]'\r\n\t\t\t\t\t\tresult = this._checkZstep(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZSYSTEM':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZSY',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[expr][,...]]'\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZTCOMMIT':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZTC',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': '[intexpr]'\r\n\t\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZTRIGGER':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZTR',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': 'gvn'\r\n\t\t\t\t\t\tresult = this._checkVar(arg, result.position, true, false);\r\n\t\t\t\t\t\tif (!result.globalFound) {\r\n\t\t\t\t\t\t\tresult.text = 'Global Variable expected';\r\n\t\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZWITHDRAW':\r\n\t\t\t\t\t\t// 'abbreviation': 'ZWI',\r\n\t\t\t\t\t\t// 'postcondition': true,\r\n\t\t\t\t\t\t// 'parameter': 'glvn'\r\n\t\t\t\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ZWRITE':\r\n\t\t\t\t\t\t//'abbreviation': 'ZWR',\r\n\t\t\t\t\t\t//'postcondition': true,\r\n\t\t\t\t\t\t//'parameter': '[zwrglvn[,...]]'\r\n\t\t\t\t\t\t//not separately tested because ZWRITE is for debugging and should not appear in normal code\r\n\t\t\t\t\t\tresult.position += arg.length;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tresult.position = arg.length;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (arg[result.position] === ',') {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t\tif (result.position === arg.length) {\r\n\t\t\t\t\t\tif (argFormat !== '' && argFormat[0] !== '[') {\r\n\t\t\t\t\t\t\tthrow { text: 'Argument for command ' + code.mCommand + \" required\", position: result.position }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} else if (arg[result.position] !== undefined) {\r\n\t\t\t\t\tresult.text = 'Unexpected Character \"' + arg[result.position] + '\"';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} while (result.position < arg.length)\r\n\t\t} catch (result) {\r\n\t\t\tresult.position += argPosition;\r\n\t\t\tthrow result;\r\n\t\t}\r\n\t\tresult.position += code.argPosition;\r\n\t\treturn result;\r\n\t}\r\n\tprivate _checkFunction(longfunc: string, arg: string, position: number): ErrorInformation {\r\n\t\tlet result: ErrorInformation = { text: '', position: position };\r\n\t\tlet params = funcParams[longfunc];\r\n\t\tlet minArguments = params.minparams !== undefined ? params.minparams : 1;\r\n\t\tlet formats = params.format !== undefined ? params.format.split(',') : undefined;\r\n\t\tlet argCount = 0;\r\n\t\tlongfunc = '$' + longfunc;\r\n\t\tif (minArguments === 0 && arg[result.position] === ')') {\r\n\t\t\tresult.position++;\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tdo {\r\n\t\t\tlet format = (formats !== undefined && formats[argCount] !== undefined) ? formats[argCount] : 'expr';\r\n\t\t\tif (longfunc === '$SELECT') {\r\n\t\t\t\tformat = 'special';\r\n\t\t\t}\r\n\t\t\tif (format === 'glvn' || format === 'gvn' || format === 'glvn(' || format === 'lvn') {\r\n\t\t\t\tresult = this._checkVar(arg, result.position);\r\n\t\t\t\tif (format === 'glvn(' && (!result.indexFound && !result.indirectionFound)) {\r\n\t\t\t\t\tresult.text = 'Variable with Index expected for ' + longfunc;\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tif (format === 'lvn' && result.globalFound) {\r\n\t\t\t\t\tresult.text = 'Local variable expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t} else if (format === 'entryref') {\r\n\t\t\t\tresult = this._checkEntryRef(arg, result.position, false);\r\n\t\t\t} else if (format === 'expr') {\r\n\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t} else if (format === 'bool') {\r\n\t\t\t\tif (arg[result.position] !== '0' && arg[result.position] !== '1') {\r\n\t\t\t\t\tresult.text = '0/1 expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.position++;\r\n\t\t\t\t}\r\n\t\t\t} else if (format === 'special') {\r\n\t\t\t\tif (longfunc === '$SELECT') {\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t\tif (arg[result.position] !== ':') {\r\n\t\t\t\t\t\tresult.text = 'Missing Expression';\r\n\t\t\t\t\t\tthrow result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult.position++\r\n\t\t\t\t\tresult = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\targCount++;\r\n\t\t\tlet char = arg[result.position];\r\n\t\t\tif (char === ',') {\r\n\t\t\t\tif (argCount > params.maxparams) {\r\n\t\t\t\t\tresult.text = 'More Arguments for ' + longfunc + ' than expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (char === ')') {\r\n\t\t\t\tif (argCount < minArguments) {\r\n\t\t\t\t\tresult.text = 'Less Arguments for ' + longfunc + ' than expected';\r\n\t\t\t\t\tthrow result;\r\n\t\t\t\t}\r\n\t\t\t\tresult.position++;\r\n\t\t\t\tbreak;\r\n\t\t\t} else {\r\n\t\t\t\tresult.text = 'Unxepected character ';\r\n\t\t\t\tthrow result;\r\n\t\t\t}\r\n\t\t} while (result.position < arg.length);\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n/*let dir=\"y:\\\\\";\r\nlet test=new MumpsLineParser();\r\nlet erg:Array<ErrorInformation>=[];\r\nfs.readdir(dir, function (err, files) {\r\n    //handling error\r\n    if (err) {\r\n        return console.log('Unable to scan directory: ' + err);\r\n    }\r\n    //listing all files using forEach\r\n    files.forEach(function (file:string) {\r\n\t\t\tif (file.substring(file.length-2,file.length)===\".m\")\r\n\t\t\t\terg=test.checkFile(dir+file);\r\n\t\t\t\tif (erg.length) {\r\n\t\t\t\t\tconsole.log(file);\r\n\t\t\t\t\tconsole.log(erg);\r\n\t\t\t\t}\r\n    });\r\n});\r\n\r\nlet test=new MumpsLineParser();\r\n\r\nlet result=test.checkLine('\t\tF  S BILD=$$ZSEARCH(PFAD_\"*\") Q:BILD=\"\"  D');\r\nconsole.log(result);\r\nconsole.log(test.tokens);\r\n*/\r\n","/*\r\nMumps-Debug-Extension for Visual Studio Code by Jens Wulf\r\n*/\r\n\r\n'use strict';\r\n\r\nimport * as vscode from 'vscode';\r\nimport { WorkspaceFolder, ProviderResult, DebugConfiguration, CancellationToken } from 'vscode';\r\nimport { MumpsDebugSession } from './mumpsDebug';\r\nimport { MumpsHoverProvider } from './mumps-hover-provider'\r\nimport { MumpsDefinitionProvider } from './mumps-definition-provider'\r\nimport { MumpsSignatureHelpProvider } from './mumps-signature-help-provider'\r\nimport { DocumentFunction } from './mumps-documenter'\r\nimport { MumpsDocumentSymbolProvider } from './mumps-document';\r\nimport { CompletionItemProvider } from './mumps-completion-item-provider';\r\nimport * as AutospaceFunction from './mumps-autospace'\r\nimport { MumpsLineParser } from './mumpsLineParser';\r\nimport { MumpsHighlighter, SemanticTokens } from './mumps-highlighter';\r\nconst parser = new MumpsLineParser;\r\n\r\nconst fs = require('fs');\r\nlet timeout: ReturnType<typeof setTimeout> | undefined;\r\nlet entryRef: string | undefined = \"\";\r\nexport async function activate(context: vscode.ExtensionContext) {\r\n\tconst MUMPS_MODE: vscode.DocumentFilter = { language: 'mumps', scheme: 'file' };\r\n\t// register a configuration provider for 'mumps' debug type\r\n\tconst mumpsDiagnostics = vscode.languages.createDiagnosticCollection(\"mumps\");\r\n\tcontext.subscriptions.push(\r\n\t\tvscode.commands.registerCommand('mumps.getEntryRef', () => {\r\n\t\t\treturn vscode.window.showInputBox({\r\n\t\t\t\tplaceHolder: \"Please enter the Entry-Reference to start Debugging\",\r\n\t\t\t\tvalue: entryRef\r\n\t\t\t});\r\n\t\t})\r\n\t);\r\n\tlet storage = context.storagePath;\r\n\tif (!fs.existsSync(storage)) {\r\n\t\tfs.mkdirSync(storage);\r\n\t}\r\n\tconst dbfile = storage + \"/labeldb.json\";\r\n\tcontext.subscriptions.push(\r\n\t\tmumpsDiagnostics,\r\n\t\tvscode.commands.registerCommand(\"mumps.documentFunction\", () => { DocumentFunction(); }),\r\n\t\tvscode.commands.registerCommand(\"mumps.autoSpaceEnter\", () => { AutospaceFunction.autoSpaceEnter(); }),\r\n\t\tvscode.commands.registerCommand(\"mumps.autoSpaceTab\", () => { AutospaceFunction.autoSpaceTab(); }),\r\n\t\tvscode.languages.registerHoverProvider(MUMPS_MODE, new MumpsHoverProvider()),\r\n\t\tvscode.languages.registerDefinitionProvider(MUMPS_MODE, new MumpsDefinitionProvider()),\r\n\t\tvscode.languages.registerSignatureHelpProvider(MUMPS_MODE, new MumpsSignatureHelpProvider(), '(', ','),\r\n\t\tvscode.languages.registerDocumentSymbolProvider(MUMPS_MODE, new MumpsDocumentSymbolProvider()),\r\n\t\tvscode.languages.registerCompletionItemProvider(MUMPS_MODE, new CompletionItemProvider(dbfile)),\r\n\t\tvscode.languages.registerDocumentSemanticTokensProvider(MUMPS_MODE, MumpsHighlighter, SemanticTokens),\r\n\t\tvscode.languages.registerDocumentFormattingEditProvider(MUMPS_MODE, {\r\n\t\t\tprovideDocumentFormattingEdits: (document, options, token) => {\r\n\t\t\t\tlet textEdits: vscode.TextEdit[] = []\r\n\t\t\t\tfor (let i = 0; i < document.lineCount; i++) {\r\n\t\t\t\t\tlet line = document.lineAt(i).text;\r\n\t\t\t\t\tformatDocumentLine(line, i, textEdits);\r\n\t\t\t\t}\r\n\t\t\t\treturn textEdits;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tvscode.languages.registerDocumentRangeFormattingEditProvider(MUMPS_MODE, {\r\n\t\t\tprovideDocumentRangeFormattingEdits: (document, range, options, token) => {\r\n\t\t\t\tlet textEdits: vscode.TextEdit[] = []\r\n\t\t\t\tfor (let i = range.start.line; i <= range.end.line; i++) {\r\n\t\t\t\t\tlet line = document.lineAt(i).text;\r\n\t\t\t\t\tformatDocumentLine(line, i, textEdits);\r\n\t\t\t\t}\r\n\t\t\t\treturn textEdits;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tvscode.debug.registerDebugConfigurationProvider('mumps', new MumpsConfigurationProvider()),\r\n\t\tvscode.debug.registerDebugAdapterDescriptorFactory('mumps', new InlineDebugAdapterFactory()),\r\n\t\tvscode.window.onDidChangeActiveTextEditor(editor => { if (editor) {triggerUpdateDiagnostics(editor.document, mumpsDiagnostics)} }),\r\n\t\tvscode.workspace.onDidChangeTextDocument(editor => { if (editor) {triggerUpdateDiagnostics(editor.document, mumpsDiagnostics)} })\r\n\t);\r\n\tvscode.languages.registerEvaluatableExpressionProvider(MUMPS_MODE, {\r\n\t\tprovideEvaluatableExpression(document: vscode.TextDocument, position: vscode.Position): vscode.ProviderResult<vscode.EvaluatableExpression> {\r\n\t\t\tconst diags: readonly vscode.Diagnostic[] | undefined = mumpsDiagnostics.get(document.uri);\r\n\t\t\t//If Position is inside Error-marked Area then no Check for Variables is performed\r\n\t\t\tif (diags) {\r\n\t\t\t\tconst found = diags.find(diag => diag.range.contains(position))\r\n\t\t\t\tif (found) {\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst lineContent = document.lineAt(position.line).text;\r\n\t\t\tlet expression = /([ (,+\\-\\*_:=])(\\^?%?[a-zA-Z][a-zA-Z\\d]*(\\(.[^\\)]+\\))?)/g;\r\n\t\t\tif (lineContent.substring(position.character, position.character + 1) !== \")\") {\r\n\t\t\t\texpression = /([ (,+\\-\\*_:=])(\\^?%?[a-zA-Z][a-zA-Z\\d]*)/g;\r\n\t\t\t}\r\n\t\t\tlet result: RegExpExecArray | null = null;\r\n\r\n\t\t\t// find the word under the cursor\r\n\t\t\twhile (result = expression.exec(lineContent)) {\r\n\t\t\t\tlet start = result.index;\r\n\t\t\t\tstart += result[0].length - result[2].length; // ignore first part of expression\r\n\t\t\t\tlet end = start + result[2].length - 1;\r\n\r\n\t\t\t\tif (start <= position.character && end >= position.character) {\r\n\t\t\t\t\treturn new vscode.EvaluatableExpression(new vscode.Range(position.line, start, position.line, end), result[2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\t\t\t//\tconst wordRange = document.getWordRangeAtPosition(position);\r\n\t\t\t//return wordRange ? new vscode.EvaluatableExpression(wordRange) : undefined;\r\n\t\t}\r\n\t});\r\n}\r\n\r\nexport function deactivate() {\r\n\t// nothing to do\r\n}\r\n\r\nclass MumpsConfigurationProvider implements vscode.DebugConfigurationProvider {\r\n\r\n\t/**\r\n\t * Massage a debug configuration just before a debug session is being launched,\r\n\t * e.g. add all missing attributes to the debug configuration.\r\n\t*/\r\n\tresolveDebugConfiguration(folder: WorkspaceFolder | undefined, config: DebugConfiguration, token?: CancellationToken): ProviderResult<DebugConfiguration> {\r\n\r\n\t\t// if launch.json is missing or empty\r\n\t\tif (!config.type && !config.request && !config.name) {\r\n\t\t\tconst editor = vscode.window.activeTextEditor;\r\n\t\t\tif (editor && editor.document.languageId === 'mumps') {\r\n\t\t\t\tconfig.type = 'mumps';\r\n\t\t\t\tconfig.name = 'Launch';\r\n\t\t\t\tconfig.request = 'launch';\r\n\t\t\t\tconfig.program = '${file}';\r\n\t\t\t\tconfig.stopOnEntry = true;\r\n\t\t\t\tconfig.hostname = '127.0.0.1';\r\n\t\t\t\tconfig.localRoutinesPath = 'y:\\\\',\r\n\t\t\t\t\tconfig.port = 9000\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!config.program) {\r\n\t\t\treturn vscode.window.showInformationMessage(\"Cannot find a program to debug\").then(_ => {\r\n\t\t\t\treturn undefined;\t// abort launch\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn config;\r\n\t}\r\n}\r\nclass InlineDebugAdapterFactory implements vscode.DebugAdapterDescriptorFactory {\r\n\r\n\tcreateDebugAdapterDescriptor(_session: vscode.DebugSession): ProviderResult<vscode.DebugAdapterDescriptor> {\r\n\t\treturn new vscode.DebugAdapterInlineImplementation(new MumpsDebugSession());\r\n\t}\r\n}\r\nfunction formatDocumentLine(line: string, lineNumber, textEdits) {\r\n\tlet emptyLine = line.replace(/(\\ |\\t)/ig, \"\");\r\n\tif (emptyLine.length === 0) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, 0), \"\\t;\"))\r\n\t}\r\n\tif (line.endsWith(\". \")) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, line.length), \";\"))\r\n\t} else if (line.endsWith(\".\")) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, line.length), \" ;\"))\r\n\t}\r\n\tif (line.startsWith(\" \")) {\r\n\t\tlet endSpace: number;\r\n\t\t//console.log(\"start\")\r\n\t\tfor (endSpace = 0; endSpace < line.length; endSpace++) {\r\n\t\t\tif (line.charAt(endSpace) !== \" \") {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttextEdits.push(vscode.TextEdit.replace(new vscode.Range(new vscode.Position(lineNumber, 0), new vscode.Position(lineNumber, endSpace)), \"\\t\"));\r\n\t}\r\n}\r\nfunction updateDiagnostics(document: vscode.TextDocument, collection: vscode.DiagnosticCollection): void {\r\n\tif (document) {\r\n\t\tcollection.clear();\r\n\t\tlet diags:Array<vscode.Diagnostic>=[];\r\n\t\tfor (let i = 0; i < document.lineCount; i++) {\r\n\t\t\tlet line = document.lineAt(i);\r\n\t\t\tlet diag = parser.checkLine(line.text);\r\n\t\t\tif (diag.text !== '') {\r\n\t\t\t\tdiags.push({\r\n\t\t\t\t\tcode: '',\r\n\t\t\t\t\tmessage: diag.text,\r\n\t\t\t\t\trange: new vscode.Range(new vscode.Position(i, diag.position), new vscode.Position(i, line.text.length)),\r\n\t\t\t\t\tseverity: vscode.DiagnosticSeverity.Error,\r\n\t\t\t\t\tsource: '',\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (diags) {\r\n\t\t\tcollection.set(document.uri, diags);\r\n\t\t}\r\n\t}\r\n}\r\nfunction triggerUpdateDiagnostics(document: vscode.TextDocument, collection: vscode.DiagnosticCollection) {\r\n\tif (timeout) {\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = undefined;\r\n\t}\r\n\ttimeout = setTimeout(()=>updateDiagnostics(document, collection), 500);\r\n}\r\n","/*\r\n\tImplementation of DebugProtocol-Server for GT.M, Yottadb by Jens Wulf\r\n\tbased on Mock-Debug by Microsoft Corp.\r\n\tLicense: LGPL\r\n*/\r\n\r\nimport {\r\n\tLogger, logger,\r\n\tLoggingDebugSession,\r\n\tInitializedEvent, TerminatedEvent, StoppedEvent, BreakpointEvent, OutputEvent,\r\n\tThread, StackFrame, Scope, Source, Handles, Breakpoint\r\n} from 'vscode-debugadapter';\r\nimport { DebugProtocol } from 'vscode-debugprotocol';\r\nimport { basename } from 'path';\r\nconst { Subject } = require('await-notify');\r\nimport { MConnect, MumpsBreakpoint } from './mconnect';\r\nimport * as vscode from 'vscode';\r\nimport { readFileSync } from 'fs';\r\nconst MUMPSDIAGNOSTICS = vscode.languages.createDiagnosticCollection(\"mumps\");\r\n/**\r\n * This interface describes the mumps-debug specific launch attributes\r\n * The schema for these attributes lives in the package.json of the mumps-debug extension.\r\n * The interface should always match this schema.\r\n */\r\ninterface LaunchRequestArguments extends DebugProtocol.LaunchRequestArguments {\r\n\t/** An absolute path to the \"program\" to debug. */\r\n\tprogram: string;\r\n\t/** Automatically stop target after launch. If not specified, target does not stop. */\r\n\tstopOnEntry?: boolean;\r\n\t/** enable logging the Debug Adapter Protocol */\r\n\ttrace?: boolean;\r\n\t/** The Port on which MDEBUG listens */\r\n\tport: number;\r\n\t/**The Hostname of the MDEBUG-Server */\r\n\thostname: string;\r\n\t/**Map Local-Routines to Host-Routines */\r\n\tlocalRoutinesPath: string;\r\n\r\n}\r\ninterface VarData {\r\n\tname: string,\r\n\tindexCount: number,\r\n\tbases: Array<string>,\r\n\tcontent: string\r\n}\r\nexport class MumpsDebugSession extends LoggingDebugSession {\r\n\r\n\t// we don't support multiple threads, so we can use a hardcoded ID for the default thread\r\n\tprivate static THREAD_ID = 1;\r\n\t//private _mconnect: MConnect;\r\n\r\n\tprivate _variableHandles = new Handles<string>();\r\n\r\n\tprivate _configurationDone = new Subject();\r\n\r\n\tprivate _program: string;\r\n\r\n\tprivate _mconnect: MConnect;\r\n\t/**\r\n\t * Creates a new debug adapter that is used for one debug session.\r\n\t * We configure the default implementation of a debug adapter here.\r\n\t */\r\n\tpublic constructor() {\r\n\t\tsuper();\r\n\r\n\t\t// this debugger uses zero-based lines and columns\r\n\t\tthis.setDebuggerLinesStartAt1(false);\r\n\t\tthis.setDebuggerColumnsStartAt1(false);\r\n\t\tthis._program = \"\";\r\n\t\tthis._mconnect = new MConnect();\r\n\r\n\t\t// setup event handlers\r\n\t\tthis._mconnect.on('stopOnEntry', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('entry', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnStep', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('step', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnBreakpoint', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('breakpoint', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnDataBreakpoint', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('data breakpoint', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnException', (errortext) => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('exception', MumpsDebugSession.THREAD_ID, errortext));\r\n\t\t});\r\n\t\tthis._mconnect.on('breakpointValidated', (bp: MumpsBreakpoint) => {\r\n\t\t\tthis.sendEvent(new BreakpointEvent('changed', <DebugProtocol.Breakpoint>{ verified: bp.verified, id: bp.id }));\r\n\t\t});\r\n\t\tthis._mconnect.on('output', (text, filePath, line, column) => {\r\n\t\t\tconst e: DebugProtocol.OutputEvent = new OutputEvent(`${text}\\n`);\r\n\t\t\te.body.source = this.createSource(filePath);\r\n\t\t\te.body.line = this.convertDebuggerLineToClient(line);\r\n\t\t\te.body.column = this.convertDebuggerColumnToClient(column);\r\n\t\t\tthis.sendEvent(e);\r\n\t\t});\r\n\t\tthis._mconnect.on('end', () => {\r\n\t\t\tthis.sendEvent(new TerminatedEvent());\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * The 'initialize' request is the first request called by the frontend\r\n\t * to interrogate the features the debug adapter provides.\r\n\t */\r\n\tprotected initializeRequest(response: DebugProtocol.InitializeResponse, args: DebugProtocol.InitializeRequestArguments): void {\r\n\r\n\t\t// build and return the capabilities of this debug adapter:\r\n\t\tresponse.body = response.body || {};\r\n\r\n\t\t// the adapter implements the configurationDoneRequest.\r\n\t\tresponse.body.supportsConfigurationDoneRequest = true;\r\n\r\n\t\t// make VS Code to use 'evaluate' when hovering over source\r\n\t\tresponse.body.supportsEvaluateForHovers = true;\r\n\r\n\t\t// make VS Code to support data breakpoints\r\n\t\tresponse.body.supportsDataBreakpoints = false;\r\n\r\n\t\t// make VS Code to support completion in REPL\r\n\t\tresponse.body.supportsCompletionsRequest = false;\r\n\t\tresponse.body.completionTriggerCharacters = [\".\", \"[\"];\r\n\r\n\t\t// make VS Code to send cancelRequests\r\n\t\tresponse.body.supportsCancelRequest = false;\r\n\r\n\t\t// make VS Code send the breakpointLocations request\r\n\t\tresponse.body.supportsBreakpointLocationsRequest = true;\r\n\t\tresponse.body.supportsExceptionInfoRequest = true;\r\n\t\tresponse.body.supportsRestartRequest = true;\r\n\r\n\r\n\t\t// since this debug adapter can accept configuration requests like 'setBreakpoint' at any time,\r\n\t\t// we request them early by sending an 'initializeRequest' to the frontend.\r\n\t\t// The frontend will end the configuration sequence by calling 'configurationDone' request.\r\n\t\tthis.sendResponse(response);\r\n\t\tthis.sendEvent(new InitializedEvent());\r\n\t}\r\n\r\n\t/**\r\n\t * Called at the end of the configuration sequence.\r\n\t * Indicates that all breakpoints etc. have been sent to the DA and that the 'launch' can start.\r\n\t */\r\n\tprotected configurationDoneRequest(response: DebugProtocol.ConfigurationDoneResponse, args: DebugProtocol.ConfigurationDoneArguments): void {\r\n\t\tsuper.configurationDoneRequest(response, args);\r\n\r\n\t\t// notify the launchRequest that configuration has finished\r\n\r\n\t\tthis._configurationDone.notify();\r\n\t}\r\n\r\n\tprotected async launchRequest(response: DebugProtocol.LaunchResponse, args: LaunchRequestArguments) {\r\n\r\n\t\t// make sure to 'Stop' the buffered logging if 'trace' is not set\r\n\t\tlogger.setup(args.trace ? Logger.LogLevel.Verbose : Logger.LogLevel.Stop, false);\r\n\r\n\t\t// wait until configuration has finished (and configurationDoneRequest has been called)\r\n\t\tawait this._configurationDone.wait(1000);\r\n\r\n\t\t// start the program in the runtime\r\n\t\tthis._mconnect.init(args.hostname, args.port, args.localRoutinesPath).then(async () => {\r\n\t\t\tthis.refreshDiagnostics(vscode.window.activeTextEditor!.document, MUMPSDIAGNOSTICS);\r\n\t\t\tthis._mconnect.start(args.program, !!args.stopOnEntry);\r\n\t\t\tthis._program = args.program;\r\n\t\t\tthis.sendResponse(response);\r\n\t\t}).catch((error) => {\r\n\t\t\tvscode.window.showErrorMessage(\"Connection to MDEBUG failed. \\nPlease start MDEBUG first.\");\r\n\t\t})\r\n\r\n\t}\r\n\tprotected setBreakPointsRequest(response: DebugProtocol.SetBreakpointsResponse, args: DebugProtocol.SetBreakpointsArguments): void {\r\n\r\n\t\tconst path = <string>args.source.path;\r\n\t\tconst clientLines = args.lines || [];\r\n\r\n\t\tthis._mconnect.clearBreakpoints(path);\r\n\t\t// set and verify breakpoint locations\r\n\t\tconst actualBreakpoints = clientLines.map(l => {\r\n\t\t\tlet { verified, line, id } = this._mconnect.setBreakPoint(path, this.convertClientLineToDebugger(l));\r\n\t\t\tconst bp = <DebugProtocol.Breakpoint>new Breakpoint(verified, this.convertDebuggerLineToClient(line));\r\n\t\t\tbp.id = id;\r\n\t\t\treturn bp;\r\n\t\t});\r\n\t\t// send back the actual breakpoint positions\r\n\t\tresponse.body = {\r\n\t\t\tbreakpoints: actualBreakpoints\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t\tthis._mconnect.requestBreakpoints();\r\n\t}\r\n\r\n\tprotected threadsRequest(response: DebugProtocol.ThreadsResponse): void {\r\n\r\n\t\t// runtime supports no threads so just return a default thread.\r\n\t\tresponse.body = {\r\n\t\t\tthreads: [\r\n\t\t\t\tnew Thread(MumpsDebugSession.THREAD_ID, \"thread 1\")\r\n\t\t\t]\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stackTraceRequest(response: DebugProtocol.StackTraceResponse, args: DebugProtocol.StackTraceArguments): void {\r\n\r\n\t\tconst startFrame = typeof args.startFrame === 'number' ? args.startFrame : 0;\r\n\t\tconst maxLevels = typeof args.levels === 'number' ? args.levels : 1000;\r\n\t\tconst endFrame = startFrame + maxLevels;\r\n\r\n\t\tconst stk = this._mconnect.stack(startFrame, endFrame);\r\n\r\n\t\tresponse.body = {\r\n\t\t\tstackFrames: stk.frames.map(f => new StackFrame(f.index, f.name, this.createSource(f.file), this.convertDebuggerLineToClient(f.line))),\r\n\t\t\ttotalFrames: stk.count\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected scopesRequest(response: DebugProtocol.ScopesResponse, args: DebugProtocol.ScopesArguments): void {\r\n\r\n\t\tresponse.body = {\r\n\t\t\tscopes: [\r\n\t\t\t\tnew Scope(\"Local\", this._variableHandles.create(\"local|0\"), true),\r\n\t\t\t\tnew Scope(\"System\", this._variableHandles.create(\"system\"), false)\r\n\t\t\t]\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected async variablesRequest(response: DebugProtocol.VariablesResponse, args: DebugProtocol.VariablesArguments, request?: DebugProtocol.Request) {\r\n\r\n\t\tconst variables: DebugProtocol.Variable[] = [];\r\n\t\tlet insertVariable: DebugProtocol.Variable | undefined;\r\n\t\tconst varId = this._variableHandles.get(args.variablesReference);\r\n\t\tif (varId === \"system\") {\r\n\t\t\tlet varObject = this._mconnect.getVariables(\"system\");\r\n\t\t\tfor (let varname in varObject) {\r\n\t\t\t\tvariables.push({\r\n\t\t\t\t\tname: varname,\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tvalue: varObject[varname],\r\n\t\t\t\t\tvariablesReference: 0\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst varparts: string[] = varId.split(\"|\");\r\n\t\t\tconst indexCount: number = parseInt(varparts.pop()!);\r\n\t\t\tconst varBase = varparts.join(\"|\");\r\n\t\t\tlet varObject = this._mconnect.getVariables(\"local\");\r\n\t\t\tlet lastVar: VarData;\r\n\t\t\tlet firstTime: boolean = true;\r\n\t\t\tlet lastRef: string = \"\";\r\n\t\t\tfor (let varname in varObject) {\r\n\t\t\t\tlet actualVar = this.varAnalyze(varname, varObject[varname]);\r\n\t\t\t\tif (firstTime) { //First Variable not processed\r\n\t\t\t\t\tlastVar = actualVar;\r\n\t\t\t\t\tfirstTime = false;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (insertVariable = this.checkVars(lastVar!, actualVar, indexCount, varBase, lastRef)) {\r\n\t\t\t\t\tif (insertVariable.variablesReference !== 0) { lastRef = lastVar!.bases[indexCount]; }\r\n\t\t\t\t\tvariables.push(insertVariable);\r\n\t\t\t\t}\r\n\t\t\t\tlastVar = actualVar;\r\n\t\t\t}\r\n\t\t\tif (!firstTime) { // process Last Variable if there was minimum one\r\n\t\t\t\tconst dummyVar: VarData = { name: \"\", \"indexCount\": 0, \"bases\": [], \"content\": \"\" }\r\n\t\t\t\tif (insertVariable = this.checkVars(lastVar!, dummyVar, indexCount, varBase, lastRef)) {\r\n\t\t\t\t\tvariables.push(insertVariable);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tresponse.body = {\r\n\t\t\tvariables: variables\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\t//checkVars checks if Variable has to be inserted in Var-Display and if it has descendants\r\n\tprivate checkVars(lastVar: VarData, actualVar: VarData, indexCount: number, varBase: string, lastRef: string): DebugProtocol.Variable | undefined {\r\n\t\tlet returnVar: DebugProtocol.Variable | undefined = undefined;\r\n\t\tlet actualReference: number = 0;\r\n\t\tif (indexCount === 0 || (lastVar.bases[indexCount - 1] === varBase && lastVar.indexCount > indexCount)) {\r\n\t\t\tif (lastVar.indexCount > indexCount + 1) {\r\n\t\t\t\tif (lastRef !== lastVar.bases[indexCount]) {\r\n\t\t\t\t\tlet name = lastVar.bases[indexCount];\r\n\t\t\t\t\tif (indexCount > 0) { name += \")\"; }\r\n\t\t\t\t\treturnVar = {\r\n\t\t\t\t\t\tname,\r\n\t\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\t\tvalue: 'undefined',\r\n\t\t\t\t\t\tvariablesReference: this._variableHandles.create(lastVar.bases[indexCount] + \"|\" + (indexCount + 1))\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t} else { //lastVar.indexCount==indexCount+1\r\n\t\t\t\tif (lastVar.bases[indexCount] === actualVar.bases[indexCount]) {\r\n\t\t\t\t\tactualReference = this._variableHandles.create(lastVar.bases[indexCount] + \"|\" + (indexCount + 1));\r\n\t\t\t\t}\r\n\t\t\t\treturnVar = {\r\n\t\t\t\t\tname: lastVar.name,\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tvalue: lastVar.content,\r\n\t\t\t\t\tvariablesReference: actualReference\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn returnVar\r\n\t}\r\n\tprotected continueRequest(response: DebugProtocol.ContinueResponse, args: DebugProtocol.ContinueArguments): void {\r\n\t\tthis._mconnect.continue();\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected nextRequest(response: DebugProtocol.NextResponse, args: DebugProtocol.NextArguments): void {\r\n\t\tthis._mconnect.step(\"OVER\");\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stepInRequest(response: DebugProtocol.StepInResponse, args: DebugProtocol.StepInArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.step(\"INTO\");\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stepOutRequest(response: DebugProtocol.StepOutResponse, args: DebugProtocol.StepOutArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.step(\"OUTOF\");\r\n\t}\r\n\r\n\tprotected async evaluateRequest(response: DebugProtocol.EvaluateResponse, args: DebugProtocol.EvaluateArguments) {\r\n\t\tif (args.context === \"hover\" || args.context === \"repl\") {\r\n\t\t\tthis._mconnect.getSingleVar(args.expression).then((varReply: VarData) => {\r\n\t\t\t\tresponse.body = {\r\n\t\t\t\t\tresult: varReply.name + \" := \" + varReply.content,\r\n\t\t\t\t\tvariablesReference: 0\r\n\t\t\t\t};\r\n\t\t\t\tthis.sendResponse(response);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected async restartRequest(args: DebugProtocol.RestartArguments) {\r\n\t\tlet sourceLines = readFileSync(this._program).toString().split('\\n');\r\n\t\tthis._mconnect.checkRoutine(sourceLines).then((errorLines: string[]) => {\r\n\t\t\tif (errorLines.length) {\r\n\t\t\t\tvscode.window.showErrorMessage(\"File contains Problems - No Restart possible!\");\r\n\t\t\t} else {\r\n\t\t\t\tthis._mconnect.restart(this._program);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tprotected disconnectRequest(response: DebugProtocol.DisconnectResponse, args: DebugProtocol.DisconnectArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.disconnect();\r\n\t\tthis.sendResponse(response);\r\n\t};\r\n\tprivate createSource(filePath: string): Source {\r\n\t\treturn new Source(basename(filePath), this.convertDebuggerPathToClient(filePath), undefined, undefined, 'mock-adapter-data');\r\n\t}\r\n\r\n\tprivate varAnalyze(varname: string, content: string): VarData {\r\n\t\tlet indexcount = 1;\r\n\t\tlet bases: string[] = [];\r\n\t\tlet length = varname.length;\r\n\t\tlet klammerpos = varname.indexOf(\"(\");\r\n\t\tlet countKomma = true;\r\n\t\t//let lastKommaPos = varname.length;\r\n\t\tif (klammerpos > 0) {\r\n\t\t\tbases.push(varname.substring(0, klammerpos));\r\n\t\t\tindexcount++;\r\n\t\t\t//lastKommaPos = klammerpos;\r\n\t\t\tfor (let i = klammerpos; i < length; i++) {\r\n\t\t\t\tif (varname.substring(i, i + 1) === \",\" && countKomma) {\r\n\t\t\t\t\tbases.push(varname.substring(0, i));\r\n\t\t\t\t\tindexcount++;\r\n\t\t\t\t\t//lastKommaPos = i;\r\n\t\t\t\t}\r\n\t\t\t\tif (varname.substring(i, i + 1) === '\"') { countKomma = !countKomma; }\r\n\t\t\t}\r\n\t\t\tbases.push(varname.substring(0, varname.length - 1));\r\n\t\t} else {\r\n\t\t\tbases.push(varname);\r\n\t\t}\r\n\t\treturn { \"name\": varname, \"indexCount\": indexcount, \"bases\": bases, content };\r\n\t}\r\n\tprivate refreshDiagnostics(doc: vscode.TextDocument | undefined, mumpsDiagnostics: vscode.DiagnosticCollection): void {\r\n\t\tlet diagnostics: vscode.Diagnostic[] = [];\r\n\t\tif (doc) {\r\n\t\t\tlet lines: string[] = []\r\n\t\t\tfor (let lineIndex = 0; lineIndex < doc.lineCount; lineIndex++) {\r\n\t\t\t\tconst lineOfText = doc.lineAt(lineIndex);\r\n\t\t\t\tlines.push(lineOfText.text);\r\n\t\t\t}\r\n\t\t\tthis._mconnect.checkRoutine(lines).then((errLines: string[]) => {\r\n\t\t\t\tfor (let i = 0; i < errLines.length; i++) {\r\n\t\t\t\t\tlet errData = errLines[i].split(\";\");\r\n\t\t\t\t\tlet column = parseInt(errData[0]) - 1;\r\n\t\t\t\t\tif (isNaN(column)) { column = 0 };\r\n\t\t\t\t\tlet line = parseInt(errData[1]) - 1;\r\n\t\t\t\t\tif (isNaN(line)) { line = 0 };\r\n\t\t\t\t\tlet endColumn = doc.lineAt(line).text.length\r\n\t\t\t\t\tif (line === 0 && column === 0) { endColumn = 0 };\r\n\t\t\t\t\tlet message = errData[2];\r\n\t\t\t\t\tlet range = new vscode.Range(line, column, line, endColumn);\r\n\t\t\t\t\tlet diagnostic = new vscode.Diagnostic(range, message, vscode.DiagnosticSeverity.Error);\r\n\t\t\t\t\tdiagnostic.code = message;\r\n\t\t\t\t\tdiagnostics.push(diagnostic);\r\n\t\t\t\t}\r\n\t\t\t\tmumpsDiagnostics.clear();\r\n\t\t\t\tmumpsDiagnostics.set(doc.uri, diagnostics);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst debugSession_1 = require(\"./debugSession\");\nexports.DebugSession = debugSession_1.DebugSession;\nexports.InitializedEvent = debugSession_1.InitializedEvent;\nexports.TerminatedEvent = debugSession_1.TerminatedEvent;\nexports.StoppedEvent = debugSession_1.StoppedEvent;\nexports.ContinuedEvent = debugSession_1.ContinuedEvent;\nexports.OutputEvent = debugSession_1.OutputEvent;\nexports.ThreadEvent = debugSession_1.ThreadEvent;\nexports.BreakpointEvent = debugSession_1.BreakpointEvent;\nexports.ModuleEvent = debugSession_1.ModuleEvent;\nexports.LoadedSourceEvent = debugSession_1.LoadedSourceEvent;\nexports.CapabilitiesEvent = debugSession_1.CapabilitiesEvent;\nexports.Thread = debugSession_1.Thread;\nexports.StackFrame = debugSession_1.StackFrame;\nexports.Scope = debugSession_1.Scope;\nexports.Variable = debugSession_1.Variable;\nexports.Breakpoint = debugSession_1.Breakpoint;\nexports.Source = debugSession_1.Source;\nexports.Module = debugSession_1.Module;\nexports.CompletionItem = debugSession_1.CompletionItem;\nexports.ErrorDestination = debugSession_1.ErrorDestination;\nconst loggingDebugSession_1 = require(\"./loggingDebugSession\");\nexports.LoggingDebugSession = loggingDebugSession_1.LoggingDebugSession;\nconst Logger = require(\"./logger\");\nexports.Logger = Logger;\nconst messages_1 = require(\"./messages\");\nexports.Event = messages_1.Event;\nexports.Response = messages_1.Response;\nconst handles_1 = require(\"./handles\");\nexports.Handles = handles_1.Handles;\nconst logger = Logger.logger;\nexports.logger = logger;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Z0dBR2dHO0FBQ2hHLFlBQVksQ0FBQzs7QUFFYixpREFNd0I7QUFTdkIsdUJBZEEsMkJBQVksQ0FjQTtBQUlaLDJCQWpCQSwrQkFBZ0IsQ0FpQkE7QUFBRSwwQkFqQkEsOEJBQWUsQ0FpQkE7QUFBRSx1QkFqQkEsMkJBQVksQ0FpQkE7QUFBRSx5QkFqQkEsNkJBQWMsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSwwQkFqQkEsOEJBQWUsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSw0QkFqQkEsZ0NBQWlCLENBaUJBO0FBQUUsNEJBakJBLGdDQUFpQixDQWlCQTtBQUM3SixpQkFqQkEscUJBQU0sQ0FpQkE7QUFBRSxxQkFqQkEseUJBQVUsQ0FpQkE7QUFBRSxnQkFqQkEsb0JBQUssQ0FpQkE7QUFBRSxtQkFqQkEsdUJBQVEsQ0FpQkE7QUFDbkMscUJBakJBLHlCQUFVLENBaUJBO0FBQUUsaUJBakJBLHFCQUFNLENBaUJBO0FBQUUsaUJBakJBLHFCQUFNLENBaUJBO0FBQUUseUJBakJBLDZCQUFjLENBaUJBO0FBQzFDLDJCQWpCQSwrQkFBZ0IsQ0FpQkE7QUFmakIsK0RBQTBEO0FBU3pELDhCQVRPLHlDQUFtQixDQVNQO0FBUnBCLG1DQUFtQztBQVNsQyx3QkFBTTtBQVJQLHlDQUE2QztBQWM1QyxnQkFkUSxnQkFBSyxDQWNSO0FBQUUsbUJBZFEsbUJBQVEsQ0FjUjtBQWJoQix1Q0FBb0M7QUFjbkMsa0JBZFEsaUJBQU8sQ0FjUjtBQVpSLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFNNUIsd0JBQU0iLCJzb3VyY2VzQ29udGVudCI6WyIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB7XG5cdERlYnVnU2Vzc2lvbixcblx0SW5pdGlhbGl6ZWRFdmVudCwgVGVybWluYXRlZEV2ZW50LCBTdG9wcGVkRXZlbnQsIENvbnRpbnVlZEV2ZW50LCBPdXRwdXRFdmVudCwgVGhyZWFkRXZlbnQsIEJyZWFrcG9pbnRFdmVudCwgTW9kdWxlRXZlbnQsIExvYWRlZFNvdXJjZUV2ZW50LCBDYXBhYmlsaXRpZXNFdmVudCxcblx0VGhyZWFkLCBTdGFja0ZyYW1lLCBTY29wZSwgVmFyaWFibGUsXG5cdEJyZWFrcG9pbnQsIFNvdXJjZSwgTW9kdWxlLCBDb21wbGV0aW9uSXRlbSxcblx0RXJyb3JEZXN0aW5hdGlvblxufSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5pbXBvcnQge0xvZ2dpbmdEZWJ1Z1Nlc3Npb259IGZyb20gJy4vbG9nZ2luZ0RlYnVnU2Vzc2lvbic7XG5pbXBvcnQgKiBhcyBMb2dnZXIgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgRXZlbnQsIFJlc3BvbnNlIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBIYW5kbGVzIH0gZnJvbSAnLi9oYW5kbGVzJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmxvZ2dlcjtcblxuZXhwb3J0IHtcblx0RGVidWdTZXNzaW9uLFxuXHRMb2dnaW5nRGVidWdTZXNzaW9uLFxuXHRMb2dnZXIsXG5cdGxvZ2dlcixcblx0SW5pdGlhbGl6ZWRFdmVudCwgVGVybWluYXRlZEV2ZW50LCBTdG9wcGVkRXZlbnQsIENvbnRpbnVlZEV2ZW50LCBPdXRwdXRFdmVudCwgVGhyZWFkRXZlbnQsIEJyZWFrcG9pbnRFdmVudCwgTW9kdWxlRXZlbnQsIExvYWRlZFNvdXJjZUV2ZW50LCBDYXBhYmlsaXRpZXNFdmVudCxcblx0VGhyZWFkLCBTdGFja0ZyYW1lLCBTY29wZSwgVmFyaWFibGUsXG5cdEJyZWFrcG9pbnQsIFNvdXJjZSwgTW9kdWxlLCBDb21wbGV0aW9uSXRlbSxcblx0RXJyb3JEZXN0aW5hdGlvbixcblx0RXZlbnQsIFJlc3BvbnNlLFxuXHRIYW5kbGVzXG59XG4iXX0=","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ee = require(\"events\");\nconst messages_1 = require(\"./messages\");\nclass Disposable0 {\n    dispose() {\n    }\n}\nclass Emitter {\n    get event() {\n        if (!this._event) {\n            this._event = (listener, thisArg) => {\n                this._listener = listener;\n                this._this = thisArg;\n                let result;\n                result = {\n                    dispose: () => {\n                        this._listener = undefined;\n                        this._this = undefined;\n                    }\n                };\n                return result;\n            };\n        }\n        return this._event;\n    }\n    fire(event) {\n        if (this._listener) {\n            try {\n                this._listener.call(this._this, event);\n            }\n            catch (e) {\n            }\n        }\n    }\n    hasListener() {\n        return !!this._listener;\n    }\n    dispose() {\n        this._listener = undefined;\n        this._this = undefined;\n    }\n}\nclass ProtocolServer extends ee.EventEmitter {\n    constructor() {\n        super();\n        this._sendMessage = new Emitter();\n        this._pendingRequests = new Map();\n        this.onDidSendMessage = this._sendMessage.event;\n    }\n    // ---- implements vscode.Debugadapter interface ---------------------------\n    dispose() {\n    }\n    handleMessage(msg) {\n        if (msg.type === 'request') {\n            this.dispatchRequest(msg);\n        }\n        else if (msg.type === 'response') {\n            const response = msg;\n            const clb = this._pendingRequests.get(response.request_seq);\n            if (clb) {\n                this._pendingRequests.delete(response.request_seq);\n                clb(response);\n            }\n        }\n    }\n    _isRunningInline() {\n        return this._sendMessage && this._sendMessage.hasListener();\n    }\n    //--------------------------------------------------------------------------\n    start(inStream, outStream) {\n        this._sequence = 1;\n        this._writableStream = outStream;\n        this._rawData = new Buffer(0);\n        inStream.on('data', (data) => this._handleData(data));\n        inStream.on('close', () => {\n            this._emitEvent(new messages_1.Event('close'));\n        });\n        inStream.on('error', (error) => {\n            this._emitEvent(new messages_1.Event('error', 'inStream error: ' + (error && error.message)));\n        });\n        outStream.on('error', (error) => {\n            this._emitEvent(new messages_1.Event('error', 'outStream error: ' + (error && error.message)));\n        });\n        inStream.resume();\n    }\n    stop() {\n        if (this._writableStream) {\n            this._writableStream.end();\n        }\n    }\n    sendEvent(event) {\n        this._send('event', event);\n    }\n    sendResponse(response) {\n        if (response.seq > 0) {\n            console.error(`attempt to send more than one response for command ${response.command}`);\n        }\n        else {\n            this._send('response', response);\n        }\n    }\n    sendRequest(command, args, timeout, cb) {\n        const request = {\n            command: command\n        };\n        if (args && Object.keys(args).length > 0) {\n            request.arguments = args;\n        }\n        if (!this._writableStream) {\n            this._emitEvent(new messages_1.Event('error', 'sendRequest: No writableStream'));\n            return;\n        }\n        this._send('request', request);\n        if (cb) {\n            this._pendingRequests.set(request.seq, cb);\n            const timer = setTimeout(() => {\n                clearTimeout(timer);\n                const clb = this._pendingRequests.get(request.seq);\n                if (clb) {\n                    this._pendingRequests.delete(request.seq);\n                    clb(new messages_1.Response(request, 'timeout'));\n                }\n            }, timeout);\n        }\n    }\n    // ---- protected ----------------------------------------------------------\n    dispatchRequest(request) {\n    }\n    // ---- private ------------------------------------------------------------\n    _emitEvent(event) {\n        this.emit(event.event, event);\n    }\n    _send(typ, message) {\n        message.type = typ;\n        message.seq = this._sequence++;\n        if (this._writableStream) {\n            const json = JSON.stringify(message);\n            this._writableStream.write(`Content-Length: ${Buffer.byteLength(json, 'utf8')}\\r\\n\\r\\n${json}`, 'utf8');\n        }\n        this._sendMessage.fire(message);\n    }\n    _handleData(data) {\n        this._rawData = Buffer.concat([this._rawData, data]);\n        while (true) {\n            if (this._contentLength >= 0) {\n                if (this._rawData.length >= this._contentLength) {\n                    const message = this._rawData.toString('utf8', 0, this._contentLength);\n                    this._rawData = this._rawData.slice(this._contentLength);\n                    this._contentLength = -1;\n                    if (message.length > 0) {\n                        try {\n                            let msg = JSON.parse(message);\n                            this.handleMessage(msg);\n                        }\n                        catch (e) {\n                            this._emitEvent(new messages_1.Event('error', 'Error handling data: ' + (e && e.message)));\n                        }\n                    }\n                    continue; // there may be more complete messages to process\n                }\n            }\n            else {\n                const idx = this._rawData.indexOf(ProtocolServer.TWO_CRLF);\n                if (idx !== -1) {\n                    const header = this._rawData.toString('utf8', 0, idx);\n                    const lines = header.split('\\r\\n');\n                    for (let i = 0; i < lines.length; i++) {\n                        const pair = lines[i].split(/: +/);\n                        if (pair[0] == 'Content-Length') {\n                            this._contentLength = +pair[1];\n                        }\n                    }\n                    this._rawData = this._rawData.slice(idx + ProtocolServer.TWO_CRLF.length);\n                    continue;\n                }\n            }\n            break;\n        }\n    }\n}\nProtocolServer.TWO_CRLF = '\\r\\n\\r\\n';\nexports.ProtocolServer = ProtocolServer;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdG9jb2wuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcHJvdG9jb2wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Z0dBR2dHOztBQUVoRyw2QkFBNkI7QUFFN0IseUNBQTZDO0FBUzdDLE1BQU0sV0FBVztJQUNoQixPQUFPO0lBQ1AsQ0FBQztDQUNEO0FBTUQsTUFBTSxPQUFPO0lBTVosSUFBSSxLQUFLO1FBQ1IsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDakIsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLFFBQXVCLEVBQUUsT0FBYSxFQUFFLEVBQUU7Z0JBRXhELElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDO2dCQUMxQixJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztnQkFFckIsSUFBSSxNQUFtQixDQUFDO2dCQUN4QixNQUFNLEdBQUc7b0JBQ1IsT0FBTyxFQUFFLEdBQUcsRUFBRTt3QkFDYixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQzt3QkFDM0IsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7b0JBQ3hCLENBQUM7aUJBQ0QsQ0FBQztnQkFDRixPQUFPLE1BQU0sQ0FBQztZQUNmLENBQUMsQ0FBQztTQUNGO1FBQ0QsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3BCLENBQUM7SUFFRCxJQUFJLENBQUMsS0FBUTtRQUNaLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNuQixJQUFJO2dCQUNILElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDdkM7WUFBQyxPQUFPLENBQUMsRUFBRTthQUNYO1NBQ0Q7SUFDRixDQUFDO0lBRUQsV0FBVztRQUNWLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDekIsQ0FBQztJQUVELE9BQU87UUFDTixJQUFJLENBQUMsU0FBUyxH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QyxFQUFFLEVBQUU7d0JBQ3RDLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQ25DLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLGdCQUFnQixFQUFFOzRCQUNoQyxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO3lCQUMvQjtxQkFDRDtvQkFDRCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxjQUFjLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO29CQUMxRSxTQUFTO2lCQUNUO2FBQ0Q7WUFDRCxNQUFNO1NBQ047SUFDRixDQUFDOztBQTFLYyx1QkFBUSxHQUFHLFVBQVUsQ0FBQztBQUZ0Qyx3Q0E2S0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0ICogYXMgZWUgZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7IERlYnVnUHJvdG9jb2wgfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5pbXBvcnQgeyBSZXNwb25zZSwgRXZlbnQgfSBmcm9tICcuL21lc3NhZ2VzJztcblxuaW50ZXJmYWNlIERlYnVnUHJvdG9jb2xNZXNzYWdlIHtcbn1cblxuaW50ZXJmYWNlIElEaXNwb3NhYmxlIHtcblx0ZGlzcG9zZSgpOiB2b2lkO1xufVxuXG5jbGFzcyBEaXNwb3NhYmxlMCBpbXBsZW1lbnRzIElEaXNwb3NhYmxlIHtcblx0ZGlzcG9zZSgpOiBhbnkge1xuXHR9XG59XG5cbmludGVyZmFjZSBFdmVudDA8VD4ge1xuXHQobGlzdGVuZXI6IChlOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpOiBEaXNwb3NhYmxlMDtcbn1cblxuY2xhc3MgRW1pdHRlcjxUPiB7XG5cblx0cHJpdmF0ZSBfZXZlbnQ/OiBFdmVudDA8VD47XG5cdHByaXZhdGUgX2xpc3RlbmVyPzogKGU6IFQpID0+IHZvaWQ7XG5cdHByaXZhdGUgX3RoaXM/OiBhbnk7XG5cblx0Z2V0IGV2ZW50KCk6IEV2ZW50MDxUPiB7XG5cdFx0aWYgKCF0aGlzLl9ldmVudCkge1xuXHRcdFx0dGhpcy5fZXZlbnQgPSAobGlzdGVuZXI6IChlOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpID0+IHtcblxuXHRcdFx0XHR0aGlzLl9saXN0ZW5lciA9IGxpc3RlbmVyO1xuXHRcdFx0XHR0aGlzLl90aGlzID0gdGhpc0FyZztcblxuXHRcdFx0XHRsZXQgcmVzdWx0OiBJRGlzcG9zYWJsZTtcblx0XHRcdFx0cmVzdWx0ID0ge1xuXHRcdFx0XHRcdGRpc3Bvc2U6ICgpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMuX2xpc3RlbmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0dGhpcy5fdGhpcyA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5fZXZlbnQ7XG5cdH1cblxuXHRmaXJlKGV2ZW50OiBUKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuX2xpc3RlbmVyKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR0aGlzLl9saXN0ZW5lci5jYWxsKHRoaXMuX3RoaXMsIGV2ZW50KTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRoYXNMaXN0ZW5lcigpIDogYm9vbGVhbiB7XG5cdFx0cmV0dXJuICEhdGhpcy5fbGlzdGVuZXI7XG5cdH1cblxuXHRkaXNwb3NlKCkge1xuXHRcdHRoaXMuX2xpc3RlbmVyID0gdW5kZWZpbmVkO1xuXHRcdHRoaXMuX3RoaXMgPSB1bmRlZmluZWQ7XG5cdH1cbn1cblxuLyoqXG4gKiBBIHN0cnVjdHVyYWxseSBlcXVpdmFsZW50IGNvcHkgb2YgdnNjb2RlLkRlYnVnQWRhcHRlclxuICovXG5pbnRlcmZhY2UgVlNDb2RlRGVidWdBZGFwdGVyIGV4dGVuZHMgRGlzcG9zYWJsZTAge1xuXG5cdHJlYWRvbmx5IG9uRGlkU2VuZE1lc3NhZ2U6IEV2ZW50MDxEZWJ1Z1Byb3RvY29sTWVzc2FnZT47XG5cblx0aGFuZGxlTWVzc2FnZShtZXNzYWdlOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBQcm90b2NvbFNlcnZlciBleHRlbmRzIGVlLkV2ZW50RW1pdHRlciBpbXBsZW1lbnRzIFZTQ29kZURlYnVnQWRhcHRlciB7XG5cblx0cHJpdmF0ZSBzdGF0aWMgVFdPX0NSTEYgPSAnXFxyXFxuXFxyXFxuJztcblxuXHRwcml2YXRlIF9zZW5kTWVzc2FnZSA9IG5ldyBFbWl0dGVyPERlYnVnUHJvdG9jb2xNZXNzYWdlPigpO1xuXG5cdHByaXZhdGUgX3Jhd0RhdGE6IEJ1ZmZlcjtcblx0cHJpdmF0ZSBfY29udGVudExlbmd0aDogbnVtYmVyO1xuXHRwcml2YXRlIF9zZXF1ZW5jZTogbnVtYmVyO1xuXHRwcml2YXRlIF93cml0YWJsZVN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtO1xuXHRwcml2YXRlIF9wZW5kaW5nUmVxdWVzdHMgPSBuZXcgTWFwPG51bWJlciwgKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlKSA9PiB2b2lkPigpO1xuXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHQvLyAtLS0tIGltcGxlbWVudHMgdnNjb2RlLkRlYnVnYWRhcHRlciBpbnRlcmZhY2UgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHVibGljIGRpc3Bvc2UoKTogYW55IHtcblx0fVxuXG5cdHB1YmxpYyBvbkRpZFNlbmRNZXNzYWdlOiBFdmVudDA8RGVidWdQcm90b2NvbE1lc3NhZ2U+ID0gdGhpcy5fc2VuZE1lc3NhZ2UuZXZlbnQ7XG5cblx0cHVibGljIGhhbmRsZU1lc3NhZ2UobXNnOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSk6IHZvaWQge1xuXHRcdGlmIChtc2cudHlwZSA9PT0gJ3JlcXVlc3QnKSB7XG5cdFx0XHR0aGlzLmRpc3BhdGNoUmVxdWVzdCg8RGVidWdQcm90b2NvbC5SZXF1ZXN0Pm1zZyk7XG5cdFx0fSBlbHNlIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJykge1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSA8RGVidWdQcm90b2NvbC5SZXNwb25zZT5tc2c7XG5cdFx0XHRjb25zdCBjbGIgPSB0aGlzLl9wZW5kaW5nUmVxdWVzdHMuZ2V0KHJlc3BvbnNlLnJlcXVlc3Rfc2VxKTtcblx0XHRcdGlmIChjbGIpIHtcblx0XHRcdFx0dGhpcy5fcGVuZGluZ1JlcXVlc3RzLmRlbGV0ZShyZXNwb25zZS5yZXF1ZXN0X3NlcSk7XG5cdFx0XHRcdGNsYihyZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJvdGVjdGVkIF9pc1J1bm5pbmdJbmxpbmUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlbmRNZXNzYWdlICYmIHRoaXMuX3NlbmRNZXNzYWdlLmhhc0xpc3RlbmVyKCk7XG5cdH1cblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHVibGljIHN0YXJ0KGluU3RyZWFtOiBOb2RlSlMuUmVhZGFibGVTdHJlYW0sIG91dFN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKTogdm9pZCB7XG5cdFx0dGhpcy5fc2VxdWVuY2UgPSAxO1xuXHRcdHRoaXMuX3dyaXRhYmxlU3RyZWFtID0gb3V0U3RyZWFtO1xuXHRcdHRoaXMuX3Jhd0RhdGEgPSBuZXcgQnVmZmVyKDApO1xuXG5cdFx0aW5TdHJlYW0ub24oJ2RhdGEnLCAoZGF0YTogQnVmZmVyKSA9PiB0aGlzLl9oYW5kbGVEYXRhKGRhdGEpKTtcblxuXHRcdGluU3RyZWFtLm9uKCdjbG9zZScsICgpID0+IHtcblx0XHRcdHRoaXMuX2VtaXRFdmVudChuZXcgRXZlbnQoJ2Nsb3NlJykpO1xuXHRcdH0pO1xuXHRcdGluU3RyZWFtLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuXHRcdFx0dGhpcy5fZW1pdEV2ZW50KG5ldyBFdmVudCgnZXJyb3InLCAnaW5TdHJlYW0gZXJyb3I6ICcgKyAoZXJyb3IgJiYgZXJyb3IubWVzc2FnZSkpKTtcblx0XHR9KTtcblxuXHRcdG91dFN0cmVhbS5vbignZXJyb3InLCAoZXJyb3IpID0+IHtcblx0XHRcdHRoaXMuX2VtaXRFdmVudChuZXcgRXZlbnQoJ2Vycm9yJywgJ291dFN0cmVhbSBlcnJvcjogJyArIChlcnJvciAmJiBlcnJvci5tZXNzYWdlKSkpO1xuXHRcdH0pO1xuXG5cdFx0aW5TdHJlYW0ucmVzdW1lKCk7XG5cdH1cblxuXHRwdWJsaWMgc3RvcCgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5fd3JpdGFibGVTdHJlYW0pIHtcblx0XHRcdHRoaXMuX3dyaXRhYmxlU3RyZWFtLmVuZCgpO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBzZW5kRXZlbnQoZXZlbnQ6IERlYnVnUHJvdG9jb2wuRXZlbnQpOiB2b2lkIHtcblx0XHR0aGlzLl9zZW5kKCdldmVudCcsIGV2ZW50KTtcblx0fVxuXG5cdHB1YmxpYyBzZW5kUmVzcG9uc2UocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzcG9uc2UpOiB2b2lkIHtcblx0XHRpZiAocmVzcG9uc2Uuc2VxID4gMCkge1xuXHRcdFx0Y29uc29sZS5lcnJvcihgYXR0ZW1wdCB0byBzZW5kIG1vcmUgdGhhbiBvbmUgcmVzcG9uc2UgZm9yIGNvbW1hbmQgJHtyZXNwb25zZS5jb21tYW5kfWApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zZW5kKCdyZXNwb25zZScsIHJlc3BvbnNlKTtcblx0XHR9XG5cdH1cblxuXHRwdWJsaWMgc2VuZFJlcXVlc3QoY29tbWFuZDogc3RyaW5nLCBhcmdzOiBhbnksIHRpbWVvdXQ6IG51bWJlciwgY2I6IChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXNwb25zZSkgPT4gdm9pZCkgOiB2b2lkIHtcblxuXHRcdGNvbnN0IHJlcXVlc3Q6IGFueSA9IHtcblx0XHRcdGNvbW1hbmQ6IGNvbW1hbmRcblx0XHR9O1xuXHRcdGlmIChhcmdzICYmIE9iamVjdC5rZXlzKGFyZ3MpLmxlbmd0aCA+IDApIHtcblx0XHRcdHJlcXVlc3QuYXJndW1lbnRzID0gYXJncztcblx0XHR9XG5cblx0XHRpZiAoIXRoaXMuX3dyaXRhYmxlU3RyZWFtKSB7XG5cdFx0XHR0aGlzLl9lbWl0RXZlbnQobmV3IEV2ZW50KCdlcnJvcicsICdzZW5kUmVxdWVzdDogTm8gd3JpdGFibGVTdHJlYW0nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5fc2VuZCgncmVxdWVzdCcsIHJlcXVlc3QpO1xuXG5cdFx0aWYgKGNiKSB7XG5cdFx0XHR0aGlzLl9wZW5kaW5nUmVxdWVzdHMuc2V0KHJlcXVlc3Quc2VxLCBjYik7XG5cblx0XHRcdGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdGNvbnN0IGNsYiA9IHRoaXMuX3BlbmRpbmdSZXF1ZXN0cy5nZXQocmVxdWVzdC5zZXEpO1xuXHRcdFx0XHRpZiAoY2xiKSB7XG5cdFx0XHRcdFx0dGhpcy5fcGVuZGluZ1JlcXVlc3RzLmRlbGV0ZShyZXF1ZXN0LnNlcSk7XG5cdFx0XHRcdFx0Y2xiKG5ldyBSZXNwb25zZShyZXF1ZXN0LCAndGltZW91dCcpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgdGltZW91dCk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gLS0tLSBwcm90ZWN0ZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHByb3RlY3RlZCBkaXNwYXRjaFJlcXVlc3QocmVxdWVzdDogRGVidWdQcm90b2NvbC5SZXF1ZXN0KTogdm9pZCB7XG5cdH1cblxuXHQvLyAtLS0tIHByaXZhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHJpdmF0ZSBfZW1pdEV2ZW50KGV2ZW50OiBEZWJ1Z1Byb3RvY29sLkV2ZW50KSB7XG5cdFx0dGhpcy5lbWl0KGV2ZW50LmV2ZW50LCBldmVudCk7XG5cdH1cblxuXHRwcml2YXRlIF9zZW5kKHR5cDogJ3JlcXVlc3QnIHwgJ3Jlc3BvbnNlJyB8ICdldmVudCcsIG1lc3NhZ2U6IERlYnVnUHJvdG9jb2wuUHJvdG9jb2xNZXNzYWdlKTogdm9pZCB7XG5cblx0XHRtZXNzYWdlLnR5cGUgPSB0eXA7XG5cdFx0bWVzc2FnZS5zZXEgPSB0aGlzLl9zZXF1ZW5jZSsrO1xuXG5cdFx0aWYgKHRoaXMuX3dyaXRhYmxlU3RyZWFtKSB7XG5cdFx0XHRjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG5cdFx0XHR0aGlzLl93cml0YWJsZVN0cmVhbS53cml0ZShgQ29udGVudC1MZW5ndGg6ICR7QnVmZmVyLmJ5dGVMZW5ndGgoanNvbiwgJ3V0ZjgnKX1cXHJcXG5cXHJcXG4ke2pzb259YCwgJ3V0ZjgnKTtcblx0XHR9XG5cdFx0dGhpcy5fc2VuZE1lc3NhZ2UuZmlyZShtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgX2hhbmRsZURhdGEoZGF0YTogQnVmZmVyKTogdm9pZCB7XG5cblx0XHR0aGlzLl9yYXdEYXRhID0gQnVmZmVyLmNvbmNhdChbdGhpcy5fcmF3RGF0YSwgZGF0YV0pO1xuXG5cdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdGlmICh0aGlzLl9jb250ZW50TGVuZ3RoID49IDApIHtcblx0XHRcdFx0aWYgKHRoaXMuX3Jhd0RhdGEubGVuZ3RoID49IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcblx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy5fcmF3RGF0YS50b1N0cmluZygndXRmOCcsIDAsIHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuXHRcdFx0XHRcdHRoaXMuX3Jhd0RhdGEgPSB0aGlzLl9yYXdEYXRhLnNsaWNlKHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnRMZW5ndGggPSAtMTtcblx0XHRcdFx0XHRpZiAobWVzc2FnZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRsZXQgbXNnOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZSk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuaGFuZGxlTWVzc2FnZShtc2cpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Y2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5fZW1pdEV2ZW50KG5ldyBFdmVudCgnZXJyb3InLCAnRXJyb3IgaGFuZGxpbmcgZGF0YTogJyArIChlICYmIGUubWVzc2FnZSkpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29udGludWU7XHQvLyB0aGVyZSBtYXkgYmUgbW9yZSBjb21wbGV0ZSBtZXNzYWdlcyB0byBwcm9jZXNzXG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGlkeCA9IHRoaXMuX3Jhd0RhdGEuaW5kZXhPZihQcm90b2NvbFNlcnZlci5UV09fQ1JMRik7XG5cdFx0XHRcdGlmIChpZHggIT09IC0xKSB7XG5cdFx0XHRcdFx0Y29uc3QgaGVhZGVyID0gdGhpcy5fcmF3RGF0YS50b1N0cmluZygndXRmOCcsIDAsIGlkeCk7XG5cdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBoZWFkZXIuc3BsaXQoJ1xcclxcbicpO1xuXHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGNvbnN0IHBhaXIgPSBsaW5lc1tpXS5zcGxpdCgvOiArLyk7XG5cdFx0XHRcdFx0XHRpZiAocGFpclswXSA9PSAnQ29udGVudC1MZW5ndGgnKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuX2NvbnRlbnRMZW5ndGggPSArcGFpclsxXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5fcmF3RGF0YSA9IHRoaXMuX3Jhd0RhdGEuc2xpY2UoaWR4ICsgUHJvdG9jb2xTZXJ2ZXIuVFdPX0NSTEYubGVuZ3RoKTtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG59XG4iXX0=","module.exports = require(\"url\");","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Logger = require(\"./logger\");\nconst logger = Logger.logger;\nconst debugSession_1 = require(\"./debugSession\");\nclass LoggingDebugSession extends debugSession_1.DebugSession {\n    constructor(obsolete_logFilePath, obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer) {\n        super(obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer);\n        this.obsolete_logFilePath = obsolete_logFilePath;\n        this.on('error', (event) => {\n            logger.error(event.body);\n        });\n    }\n    start(inStream, outStream) {\n        super.start(inStream, outStream);\n        logger.init(e => this.sendEvent(e), this.obsolete_logFilePath, this._isServer);\n    }\n    /**\n     * Overload sendEvent to log\n     */\n    sendEvent(event) {\n        if (!(event instanceof Logger.LogOutputEvent)) {\n            // Don't create an infinite loop...\n            let objectToLog = event;\n            if (event instanceof debugSession_1.OutputEvent && event.body && event.body.data && event.body.data.doNotLogOutput) {\n                delete event.body.data.doNotLogOutput;\n                objectToLog = Object.assign({}, event);\n                objectToLog.body = Object.assign({}, event.body, { output: '<output not logged>' });\n            }\n            logger.verbose(`To client: ${JSON.stringify(objectToLog)}`);\n        }\n        super.sendEvent(event);\n    }\n    /**\n     * Overload sendRequest to log\n     */\n    sendRequest(command, args, timeout, cb) {\n        logger.verbose(`To client: ${JSON.stringify(command)}(${JSON.stringify(args)}), timeout: ${timeout}`);\n        super.sendRequest(command, args, timeout, cb);\n    }\n    /**\n     * Overload sendResponse to log\n     */\n    sendResponse(response) {\n        logger.verbose(`To client: ${JSON.stringify(response)}`);\n        super.sendResponse(response);\n    }\n    dispatchRequest(request) {\n        logger.verbose(`From client: ${request.command}(${JSON.stringify(request.arguments)})`);\n        super.dispatchRequest(request);\n    }\n}\nexports.LoggingDebugSession = LoggingDebugSession;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2luZ0RlYnVnU2Vzc2lvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9sb2dnaW5nRGVidWdTZXNzaW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O2dHQUdnRzs7QUFJaEcsbUNBQW1DO0FBQ25DLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDN0IsaURBQXlEO0FBRXpELE1BQWEsbUJBQW9CLFNBQVEsMkJBQVk7SUFDcEQsWUFBMkIsb0JBQTZCLEVBQUUsd0NBQWtELEVBQUUsaUJBQTJCO1FBQ3hJLEtBQUssQ0FBQyx3Q0FBd0MsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO1FBRHpDLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBUztRQUd2RCxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQTBCLEVBQUUsRUFBRTtZQUMvQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFTSxLQUFLLENBQUMsUUFBK0IsRUFBRSxTQUFnQztRQUM3RSxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNqQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2hGLENBQUM7SUFFRDs7T0FFRztJQUNJLFNBQVMsQ0FBQyxLQUEwQjtRQUMxQyxJQUFJLENBQUMsQ0FBQyxLQUFLLFlBQVksTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQzlDLG1DQUFtQztZQUVuQyxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDeEIsSUFBSSxLQUFLLFlBQVksMEJBQVcsSUFBSSxLQUFLLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBRTtnQkFDcEcsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7Z0JBQ3RDLFdBQVcscUJBQVEsS0FBSyxDQUFFLENBQUM7Z0JBQzNCLFdBQVcsQ0FBQyxJQUFJLHFCQUFRLEtBQUssQ0FBQyxJQUFJLElBQUUsTUFBTSxFQUFFLHFCQUFxQixHQUFFLENBQUE7YUFDbkU7WUFFRCxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDNUQ7UUFFRCxLQUFLLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFFRDs7T0FFRztJQUNJLFdBQVcsQ0FBQyxPQUFlLEVBQUUsSUFBUyxFQUFFLE9BQWUsRUFBRSxFQUE4QztRQUM3RyxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxlQUFlLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFDdEcsS0FBSyxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxZQUFZLENBQUMsUUFBZ0M7UUFDbkQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELEtBQUssQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVTLGVBQWUsQ0FBQyxPQUE4QjtRQUN2RCxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixPQUFPLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBRSxHQUFHLENBQUMsQ0FBQztRQUN6RixLQUFLLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2hDLENBQUM7Q0FDRDtBQXRERCxrREFzREMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHtEZWJ1Z1Byb3RvY29sfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5cbmltcG9ydCAqIGFzIExvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5jb25zdCBsb2dnZXIgPSBMb2dnZXIubG9nZ2VyO1xuaW1wb3J0IHtEZWJ1Z1Nlc3Npb24sIE91dHB1dEV2ZW50fSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5cbmV4cG9ydCBjbGFzcyBMb2dnaW5nRGVidWdTZXNzaW9uIGV4dGVuZHMgRGVidWdTZXNzaW9uIHtcblx0cHVibGljIGNvbnN0cnVjdG9yKHByaXZhdGUgb2Jzb2xldGVfbG9nRmlsZVBhdGg/OiBzdHJpbmcsIG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDE/OiBib29sZWFuLCBvYnNvbGV0ZV9pc1NlcnZlcj86IGJvb2xlYW4pIHtcblx0XHRzdXBlcihvYnNvbGV0ZV9kZWJ1Z2dlckxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxLCBvYnNvbGV0ZV9pc1NlcnZlcik7XG5cblx0XHR0aGlzLm9uKCdlcnJvcicsIChldmVudDogRGVidWdQcm90b2NvbC5FdmVudCkgPT4ge1xuXHRcdFx0bG9nZ2VyLmVycm9yKGV2ZW50LmJvZHkpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIHN0YXJ0KGluU3RyZWFtOiBOb2RlSlMuUmVhZGFibGVTdHJlYW0sIG91dFN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKTogdm9pZCB7XG5cdFx0c3VwZXIuc3RhcnQoaW5TdHJlYW0sIG91dFN0cmVhbSk7XG5cdFx0bG9nZ2VyLmluaXQoZSA9PiB0aGlzLnNlbmRFdmVudChlKSwgdGhpcy5vYnNvbGV0ZV9sb2dGaWxlUGF0aCwgdGhpcy5faXNTZXJ2ZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIE92ZXJsb2FkIHNlbmRFdmVudCB0byBsb2dcblx0ICovXG5cdHB1YmxpYyBzZW5kRXZlbnQoZXZlbnQ6IERlYnVnUHJvdG9jb2wuRXZlbnQpOiB2b2lkIHtcblx0XHRpZiAoIShldmVudCBpbnN0YW5jZW9mIExvZ2dlci5Mb2dPdXRwdXRFdmVudCkpIHtcblx0XHRcdC8vIERvbid0IGNyZWF0ZSBhbiBpbmZpbml0ZSBsb29wLi4uXG5cblx0XHRcdGxldCBvYmplY3RUb0xvZyA9IGV2ZW50O1xuXHRcdFx0aWYgKGV2ZW50IGluc3RhbmNlb2YgT3V0cHV0RXZlbnQgJiYgZXZlbnQuYm9keSAmJiBldmVudC5ib2R5LmRhdGEgJiYgZXZlbnQuYm9keS5kYXRhLmRvTm90TG9nT3V0cHV0KSB7XG5cdFx0XHRcdGRlbGV0ZSBldmVudC5ib2R5LmRhdGEuZG9Ob3RMb2dPdXRwdXQ7XG5cdFx0XHRcdG9iamVjdFRvTG9nID0geyAuLi5ldmVudCB9O1xuXHRcdFx0XHRvYmplY3RUb0xvZy5ib2R5ID0geyAuLi5ldmVudC5ib2R5LCBvdXRwdXQ6ICc8b3V0cHV0IG5vdCBsb2dnZWQ+JyB9XG5cdFx0XHR9XG5cblx0XHRcdGxvZ2dlci52ZXJib3NlKGBUbyBjbGllbnQ6ICR7SlNPTi5zdHJpbmdpZnkob2JqZWN0VG9Mb2cpfWApO1xuXHRcdH1cblxuXHRcdHN1cGVyLnNlbmRFdmVudChldmVudCk7XG5cdH1cblxuXHQvKipcblx0ICogT3ZlcmxvYWQgc2VuZFJlcXVlc3QgdG8gbG9nXG5cdCAqL1xuXHRwdWJsaWMgc2VuZFJlcXVlc3QoY29tbWFuZDogc3RyaW5nLCBhcmdzOiBhbnksIHRpbWVvdXQ6IG51bWJlciwgY2I6IChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXNwb25zZSkgPT4gdm9pZCk6IHZvaWQge1xuXHRcdGxvZ2dlci52ZXJib3NlKGBUbyBjbGllbnQ6ICR7SlNPTi5zdHJpbmdpZnkoY29tbWFuZCl9KCR7SlNPTi5zdHJpbmdpZnkoYXJncyl9KSwgdGltZW91dDogJHt0aW1lb3V0fWApO1xuXHRcdHN1cGVyLnNlbmRSZXF1ZXN0KGNvbW1hbmQsIGFyZ3MsIHRpbWVvdXQsIGNiKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBPdmVybG9hZCBzZW5kUmVzcG9uc2UgdG8gbG9nXG5cdCAqL1xuXHRwdWJsaWMgc2VuZFJlc3BvbnNlKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlKTogdm9pZCB7XG5cdFx0bG9nZ2VyLnZlcmJvc2UoYFRvIGNsaWVudDogJHtKU09OLnN0cmluZ2lmeShyZXNwb25zZSl9YCk7XG5cdFx0c3VwZXIuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkaXNwYXRjaFJlcXVlc3QocmVxdWVzdDogRGVidWdQcm90b2NvbC5SZXF1ZXN0KTogdm9pZCB7XG5cdFx0bG9nZ2VyLnZlcmJvc2UoYEZyb20gY2xpZW50OiAke3JlcXVlc3QuY29tbWFuZH0oJHtKU09OLnN0cmluZ2lmeShyZXF1ZXN0LmFyZ3VtZW50cykgfSlgKTtcblx0XHRzdXBlci5kaXNwYXRjaFJlcXVlc3QocmVxdWVzdCk7XG5cdH1cbn1cbiJdfQ==","var path = require('path');\nvar fs = require('fs');\nvar _0777 = parseInt('0777', 8);\n\nmodule.exports = mkdirP.mkdirp = mkdirP.mkdirP = mkdirP;\n\nfunction mkdirP (p, opts, f, made) {\n    if (typeof opts === 'function') {\n        f = opts;\n        opts = {};\n    }\n    else if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n    \n    var cb = f || function () {};\n    p = path.resolve(p);\n    \n    xfs.mkdir(p, mode, function (er) {\n        if (!er) {\n            made = made || p;\n            return cb(null, made);\n        }\n        switch (er.code) {\n            case 'ENOENT':\n                mkdirP(path.dirname(p), opts, function (er, made) {\n                    if (er) cb(er, made);\n                    else mkdirP(p, opts, cb, made);\n                });\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                xfs.stat(p, function (er2, stat) {\n                    // if the stat fails, then that's super weird.\n                    // let the original error be the failure reason.\n                    if (er2 || !stat.isDirectory()) cb(er, made)\n                    else cb(null, made);\n                });\n                break;\n        }\n    });\n}\n\nmkdirP.sync = function sync (p, opts, made) {\n    if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n\n    p = path.resolve(p);\n\n    try {\n        xfs.mkdirSync(p, mode);\n        made = made || p;\n    }\n    catch (err0) {\n        switch (err0.code) {\n            case 'ENOENT' :\n                made = sync(path.dirname(p), opts, made);\n                sync(p, opts, made);\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                var stat;\n                try {\n                    stat = xfs.statSync(p);\n                }\n                catch (err1) {\n                    throw err0;\n                }\n                if (!stat.isDirectory()) throw err0;\n                break;\n        }\n    }\n\n    return made;\n};\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Handles {\n    constructor(startHandle) {\n        this.START_HANDLE = 1000;\n        this._handleMap = new Map();\n        this._nextHandle = typeof startHandle === 'number' ? startHandle : this.START_HANDLE;\n    }\n    reset() {\n        this._nextHandle = this.START_HANDLE;\n        this._handleMap = new Map();\n    }\n    create(value) {\n        var handle = this._nextHandle++;\n        this._handleMap.set(handle, value);\n        return handle;\n    }\n    get(handle, dflt) {\n        return this._handleMap.get(handle) || dflt;\n    }\n}\nexports.Handles = Handles;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9oYW5kbGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O2dHQUdnRzs7QUFFaEcsTUFBYSxPQUFPO0lBT25CLFlBQW1CLFdBQW9CO1FBTC9CLGlCQUFZLEdBQUcsSUFBSSxDQUFDO1FBR3BCLGVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFDO1FBR3pDLElBQUksQ0FBQyxXQUFXLEdBQUcsT0FBTyxXQUFXLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDdEYsQ0FBQztJQUVNLEtBQUs7UUFDWCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDckMsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFDO0lBQ3hDLENBQUM7SUFFTSxNQUFNLENBQUMsS0FBUTtRQUNyQixJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ25DLE9BQU8sTUFBTSxDQUFDO0lBQ2YsQ0FBQztJQUVNLEdBQUcsQ0FBQyxNQUFjLEVBQUUsSUFBUTtRQUNsQyxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQztJQUM1QyxDQUFDO0NBQ0Q7QUF6QkQsMEJBeUJDIiwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbmV4cG9ydCBjbGFzcyBIYW5kbGVzPFQ+IHtcblxuXHRwcml2YXRlIFNUQVJUX0hBTkRMRSA9IDEwMDA7XG5cblx0cHJpdmF0ZSBfbmV4dEhhbmRsZSA6IG51bWJlcjtcblx0cHJpdmF0ZSBfaGFuZGxlTWFwID0gbmV3IE1hcDxudW1iZXIsIFQ+KCk7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHN0YXJ0SGFuZGxlPzogbnVtYmVyKSB7XG5cdFx0dGhpcy5fbmV4dEhhbmRsZSA9IHR5cGVvZiBzdGFydEhhbmRsZSA9PT0gJ251bWJlcicgPyBzdGFydEhhbmRsZSA6IHRoaXMuU1RBUlRfSEFORExFO1xuXHR9XG5cblx0cHVibGljIHJlc2V0KCk6IHZvaWQge1xuXHRcdHRoaXMuX25leHRIYW5kbGUgPSB0aGlzLlNUQVJUX0hBTkRMRTtcblx0XHR0aGlzLl9oYW5kbGVNYXAgPSBuZXcgTWFwPG51bWJlciwgVD4oKTtcblx0fVxuXG5cdHB1YmxpYyBjcmVhdGUodmFsdWU6IFQpOiBudW1iZXIge1xuXHRcdHZhciBoYW5kbGUgPSB0aGlzLl9uZXh0SGFuZGxlKys7XG5cdFx0dGhpcy5faGFuZGxlTWFwLnNldChoYW5kbGUsIHZhbHVlKTtcblx0XHRyZXR1cm4gaGFuZGxlO1xuXHR9XG5cblx0cHVibGljIGdldChoYW5kbGU6IG51bWJlciwgZGZsdD86IFQpOiBUIHtcblx0XHRyZXR1cm4gdGhpcy5faGFuZGxlTWFwLmdldChoYW5kbGUpIHx8IGRmbHQ7XG5cdH1cbn1cbiJdfQ==","function Subject() {\n  this.waiters = [];\n}\n\nSubject.prototype.wait = function (timeout) {\n  var self = this;\n  var waiter = {};\n  this.waiters.push(waiter);\n  var promise = new Promise(function (resolve) {\n    var resolved = false;\n    waiter.resolve = function (noRemove) {\n      if (resolved) {\n        return;\n      }\n      resolved = true;\n      if (waiter.timeout) {\n        clearTimeout(waiter.timeout);\n        waiter.timeout = null;\n      }\n      if (!noRemove) {\n        var pos = self.waiters.indexOf(waiter);\n        if (pos > -1) {\n          self.waiters.splice(pos, 1);\n        }\n      }\n      resolve();\n    };\n  });\n  if (timeout > 0 && isFinite(timeout)) {\n    waiter.timeout = setTimeout(function () {\n      waiter.timeout = null;\n      waiter.resolve();\n    }, timeout);\n  }\n  return promise;\n};\n\nSubject.prototype.notify = function () {\n  if (this.waiters.length > 0) {\n    this.waiters.pop().resolve(true);\n  }\n};\n\nSubject.prototype.notifyAll = function () {\n  for (var i = this.waiters.length - 1; i >= 0; i--) {\n    this.waiters[i].resolve(true);\n  }\n  this.waiters = [];\n}\n\nexports.Subject = Subject;\n","/*\r\n\tConnector to MDEBUG-Server by Jens Wulf\r\n\tLicense: LGPL\r\n*/\r\nimport { Socket } from \"net\";\r\nimport { EventEmitter } from 'events';\r\nimport { readFileSync } from 'fs';\r\nexport interface MumpsBreakpoint {\r\n\tid: number;\r\n\tfile: string,\r\n\tline: number;\r\n\tverified: boolean;\r\n}\r\ninterface VarData {\r\n\tname: string,\r\n\tindexCount: number,\r\n\tbases: Array<string>,\r\n\tcontent: string\r\n}\r\n\r\nexport class MConnect extends EventEmitter {\r\n\tprivate _socket: Socket;\r\n\tprivate _connectState: string;\r\n\tprivate _readedData: string;\r\n\tprivate _mVars: Object;\r\n\tprivate _mStack: Array<string>;\r\n\tprivate _activeBreakpoints: Array<string>;\r\n\tprivate _event = new EventEmitter();\r\n\tprivate _hostname: string;\r\n\tprivate _port: number;\r\n\tprivate _sourceFile: string;\r\n\tprivate _sourceLines: string[];\r\n\tprivate _currentLine = 0;\r\n\tprivate _errorLines: string[];\r\n\tprivate _hints: string[];\r\n\tprivate _breakPoints: MumpsBreakpoint[];\r\n\tprivate _localRoutinesPath: string;\r\n\tprivate _breakpointId: number = 1;\r\n\tprivate _commandQueue: string[];\r\n\tprivate _logging: boolean = false;\r\n\tprivate _singleVar: string = \"\";\r\n\tprivate _singleVarContent: string = \"\";\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._commandQueue = [];\r\n\t\tthis._socket = new Socket();\r\n\t\tthis._connectState = \"waitingforStart\";\r\n\t\tthis._readedData = \"\";\r\n\t\tthis._mVars = {};\r\n\t\tthis._mStack = [];\r\n\t\tthis._activeBreakpoints = [];\r\n\t\tthis._breakPoints = [];\r\n\t\tthis._errorLines = [];\r\n\t\tthis._singleVar = \"\";\r\n\t\tthis._singleVarContent=\"\";\r\n\t\tthis._hints=[];\r\n\t\tthis._event.on('varsComplete', () => {\r\n\t\t\tif (typeof (this._mVars[\"I\"]) !== 'undefined') {\r\n\t\t\t\tlet internals = this._mVars[\"I\"];\r\n\t\t\t\tthis.checkEvents(internals[\"$ZPOSITION\"], internals[\"$ZSTATUS\"]);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic async init(hostname: string, port: number, localRoutinesPath: string) {\r\n\t\tthis._localRoutinesPath = localRoutinesPath;\r\n\t\tthis._hostname = hostname;\r\n\t\tthis._port = port;\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._socket.connect(this._port, this._hostname, () => {\r\n\t\t\t\tthis._log(\"Debug-Server connected\\n\");\r\n\t\t\t\tthis._socket.on('data', (chunk) => {\r\n\t\t\t\t\tthis._readedData += chunk.toString();\r\n\t\t\t\t\tlet n = this._readedData.indexOf('\\n');\r\n\t\t\t\t\twhile (n !== -1) {\r\n\t\t\t\t\t\tthis.processLine(this._readedData.substring(0, n))\r\n\t\t\t\t\t\tthis._readedData = this._readedData.substring(n + 1);\r\n\t\t\t\t\t\tn = this._readedData.indexOf('\\n');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tresolve(this._socket);\r\n\t\t\t});\r\n\t\t\tthis._socket.on('error', (error) => {\r\n\t\t\t\treject(error);\r\n\t\t\t});\r\n\t\t})\r\n\t\t// Put a friendly message on the terminal of the server.\r\n\t}\r\n\tprivate _log(msg) {\r\n\t\tif (this._logging) { console.log(msg); }\r\n\t}\r\n\tprivate processLine(line: string) {\r\n\t\tlet varname: string;\r\n\t\tlet value: string;\r\n\t\tlet vartype: string;\r\n\t\tswitch (this._connectState) {\r\n\t\t\tcase \"waitingforStart\": {\r\n\t\t\t\tif (line === \"***STARTVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforVars\";\r\n\t\t\t\t\tthis._mStack = [];\r\n\t\t\t\t\tthis._mVars = {};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***STARTBP\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforBreakpoints\";\r\n\t\t\t\t\tthis._activeBreakpoints = [];\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***SINGLEVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForSingleVar\";\r\n\t\t\t\t\tthis._singleVar = \"\";\r\n\t\t\t\t\tthis._singleVarContent=\"\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***ENDPROGRAM\") {\r\n\t\t\t\t\tthis.sendEvent(\"end\");\r\n\t\t\t\t\tthis._socket.end();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***BEGINERRCHK\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForErrorreport\";\r\n\t\t\t\t\tthis._errorLines = [];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line=== \"***STARTHINTS\") {\r\n\t\t\t\t\tthis._connectState=\"waitingForHints\";\r\n\t\t\t\t\tthis._hints=[];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingforVars\": {\r\n\t\t\t\tif (line === \"***ENDVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit(\"varsComplete\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvartype = line.substring(0, 1); //I=internal,V=local Variable,S=Stackframe\r\n\t\t\t\t\tif (vartype === \"S\") {\r\n\t\t\t\t\t\tthis._mStack.push(line.substring(2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvarname = line.substring(2, line.indexOf('='));\r\n\t\t\t\t\twhile ((varname.split('\"').length - 1) % 2 !== 0) {\r\n\t\t\t\t\t\tvarname = line.substring(0, line.indexOf('=', varname.length + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue = line.substring(varname.length + 3).replace(/^\"/, \"\").replace(/\"$/, \"\");\r\n\t\t\t\t\tif (typeof (this._mVars[vartype]) === 'undefined') { this._mVars[vartype] = {}; }\r\n\t\t\t\t\tthis._mVars[vartype][varname] = value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingforBreakpoints\": {\r\n\t\t\t\tif (line === \"***ENDBP\") {\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis.verifyBreakpoints();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tthis._activeBreakpoints.push(line);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForSingleVar\": {\r\n\t\t\t\tif (line === \"***SINGLEEND\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('SingleVarReceived', this._event, this._singleVar,this._singleVarContent);\r\n\t\t\t\t} else if (line=== \"***SINGLEVARCONTENT\") {\r\n\t\t\t\t\tthis._connectState=\"waitingForSingleVarContent\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._singleVar += line;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForSingleVarContent\": {\r\n\t\t\t\tif (line === \"***SINGLEEND\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('SingleVarReceived', this._event, this._singleVar,this._singleVarContent);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._singleVarContent+=line;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForErrorreport\": {\r\n\t\t\t\tif (line === \"***ENDERRCHK\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('ErrorreportReceived', this._event, this._errorLines);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._errorLines.push(line);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForHints\": {\r\n\t\t\t\tif (line===\"***ENDHINTS\") {\r\n\t\t\t\t\tthis._connectState=\"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('HintsReceived',this._event,this._hints);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._hints.push(line);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdefault: {\r\n\t\t\t\tconsole.error(\"Unexpected Message: \" + line);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate writeln(message: string): void {\r\n\t\tthis._commandQueue.push(message);\r\n\t\tif (this._commandQueue.length > 1000) {\r\n\t\t\tconsole.error(\"Too many Commands in Queue Check Debugger Connection\");\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tif (this._socket && this._socket.writable) {\r\n\t\t\twhile (this._commandQueue.length) {\r\n\t\t\t\tmessage = this._commandQueue.shift()!;\r\n\t\t\t\tthis._log(message);\r\n\t\t\t\tthis._socket.write(message + \"\\n\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate sendBreakpoint(file: string, line: number, onOff: boolean): void {\r\n\t\tif (onOff) { this.writeln(\"SETBP;\" + file + \";\" + line); }\r\n\t\telse { this.writeln(\"CLEARBP;\" + file + \";\" + line); }\r\n\t}\r\n\tpublic start(file: string, stopAtStart: boolean): void {\r\n\t\tif (stopAtStart) {\r\n\t\t\tif (file.indexOf(\"^\")) {\r\n\t\t\t\t//Stop direct at given Label not at first line\r\n\t\t\t\tthis.sendBreakpoint(file, 0, true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendBreakpoint(file, 1, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.requestBreakpoints();\r\n\t\tthis.writeln(\"START;\" + file);\r\n\t}\r\n\tpublic step(type: string): void {\r\n\t\tthis.writeln(type);\r\n\t}\r\n\tpublic continue(): void {\r\n\t\tthis.writeln(\"CONTINUE\");\r\n\t}\r\n\tpublic disconnect(): void {\r\n\t\tthis.writeln(\"RESET\");\r\n\t\tthis._socket.end();\r\n\t}\r\n\tpublic requestBreakpoints(): void {\r\n\t\tthis.writeln(\"REQUESTBP\");\r\n\t}\r\n\tpublic restart(file: string) {\r\n\t\tthis.writeln(\"RESTART;\" + file);\r\n\t}\r\n\t/**\r\n\t * Fire events if line has a breakpoint or hs stopped beacause of a different reason\r\n\t */\r\n\tprivate checkEvents(mumpsposition: string, mumpsstatus: string): void {\r\n\t\tconst parts = mumpsposition.split(\"^\");\r\n\t\tconst position = parts[0];\r\n\t\tconst program = parts[1];\r\n\t\tconst file = this._localRoutinesPath + program + \".m\";\r\n\t\tthis.loadSource(file);\r\n\t\tconst startlabel = position.split(\"+\")[0];\r\n\t\tlet offset = 0;\r\n\t\tif (position.split(\"+\")[1] !== undefined) {\r\n\t\t\toffset = parseInt(position.split(\"+\")[1]);\r\n\t\t}\r\n\t\tlet line = 0\r\n\t\tif (startlabel !== \"\") {\r\n\t\t\tfor (let ln = 0; ln < this._sourceLines.length; ln++) {\r\n\t\t\t\tif (this._sourceLines[ln].substring(0, startlabel.length) === startlabel) {\r\n\t\t\t\t\tline = ln;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._currentLine = line + offset;\r\n\t\tif (mumpsstatus !== \"\") {\r\n\t\t\tthis.sendEvent('stopOnException', mumpsstatus);\r\n\t\t} else {\r\n\t\t\tconst bps = this._breakPoints.filter(bp => bp.file === this._sourceFile && bp.line === this._currentLine);\r\n\t\t\tif (bps.length > 0) {\r\n\t\t\t\tthis.sendEvent('stopOnBreakpoint');\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendEvent('stopOnStep');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the actual Stack\r\n\t */\r\n\tpublic stack(startFrame: number, endFrame: number): any {\r\n\r\n\t\tconst frames = new Array<any>();\r\n\r\n\t\tfor (let i = startFrame; i < this._mStack.length; i++) {\r\n\t\t\tconst position = this._mStack[i];\r\n\t\t\tconst fileposition = this.convertMumpsPosition(position);\r\n\t\t\tfileposition.line++;\t//Correction 0/1 based in Editor/GT.M\r\n\t\t\tframes.push({\r\n\t\t\t\tindex: i,\r\n\t\t\t\tname: `${position}(${i})`,\r\n\t\t\t\tfile: fileposition.file,\r\n\t\t\t\tline: fileposition.line\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tframes: frames,\r\n\t\t\tcount: Math.min(this._mStack.length, endFrame)\r\n\t\t};\r\n\t}\r\n\r\n\r\n\t/*\r\n\t * Set breakpoint in file with given line.\r\n\t */\r\n\tpublic setBreakPoint(file: string, line: number): MumpsBreakpoint {\r\n\t\tconst bp = <MumpsBreakpoint>{ verified: false, file, line, id: this._breakpointId++ };\r\n\t\tthis._breakPoints.push(bp);\r\n\t\tthis.sendBreakpoint(file, bp.line + 1, true);\r\n\t\treturn bp;\r\n\t}\r\n\r\n\t/*\r\n\t * Clear breakpoint in file with given line.\r\n\t */\r\n\tpublic clearBreakPoint(file: string, line: number): MumpsBreakpoint | undefined {\r\n\t\tlet bps = this._breakPoints;\r\n\t\tif (bps) {\r\n\t\t\tconst index = bps.findIndex(bp => bp.file === file && bp.line === line);\r\n\t\t\tif (index >= 0) {\r\n\t\t\t\tconst bp = bps[index];\r\n\t\t\t\tthis.sendBreakpoint(file, bp.line, false);\r\n\t\t\t\tbps.splice(index, 1);\r\n\t\t\t\treturn bp;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/*\r\n\t * Clear all breakpoints\r\n\t */\r\n\tpublic clearBreakpoints(file: string): void {\r\n\t\tthis.writeln(\"CLEARBP;\"+file);\r\n\t}\r\n\r\n\tprivate verifyBreakpoints(): void {\r\n\t\tlet merk: boolean[] = [];\r\n\t\tthis._breakPoints.forEach(bp => {\r\n\t\t\tbp.verified = false;\r\n\t\t\tfor (let i = 0; i < this._activeBreakpoints.length; i++) {\r\n\t\t\t\tlet internalBp = this.convertMumpsPosition(this._activeBreakpoints[i])\r\n\t\t\t\tif (internalBp.file === bp.file && bp.line === internalBp.line) {\r\n\t\t\t\t\tbp.verified = true;\r\n\t\t\t\t\tthis.sendEvent('breakpointValidated', bp);\r\n\t\t\t\t\tmerk[i] = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!bp.verified) { this.sendEvent('breakpointValidated', bp); }\r\n\t\t});\r\n\t\tfor (let i = 0; i < this._activeBreakpoints.length; i++) {\r\n\t\t\tif (!merk[i]) {\r\n\t\t\t\tlet internalBp = this.convertMumpsPosition(this._activeBreakpoints[i])\r\n\t\t\t\tlet bp: MumpsBreakpoint = { 'verified': true, 'file': internalBp.file, 'line': internalBp.line, 'id': this._breakpointId++ }\r\n\t\t\t\tthis.sendEvent('breakpointValidated', bp);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getVariables(type: string) {\r\n\t\tif (type === \"system\") {\r\n\t\t\treturn this._mVars[\"I\"];\r\n\t\t} else if (type === \"local\") {\r\n\t\t\treturn this._mVars[\"V\"];\r\n\t\t}\r\n\t}\r\n\tpublic async requestHints(part:string) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._event.on('HintsReceived', function HintsReceived(event:EventEmitter, hints:string[]) {\r\n\t\t\t\tevent.removeListener('HintsReceived', HintsReceived);\r\n\t\t\t\tresolve(hints);\r\n\t\t\t});\r\n\t\t\tthis.writeln(\"GETHINTS;\"+part);\r\n\t\t})\r\n\t}\r\n\tpublic async checkRoutine(lines: string[]) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._event.on('ErrorreportReceived', function ErrorreportReceived(event:EventEmitter, errorLines:string[]) {\r\n\t\t\t\tevent.removeListener('ErrorreportReceived', ErrorreportReceived);\r\n\t\t\t\tresolve(errorLines);\r\n\t\t\t});\r\n\t\t\tthis.writeln(\"ERRCHK\");\r\n\t\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\t\tthis.writeln(lines[i]);\r\n\t\t\t}\r\n\t\t\tthis.writeln(\"***ENDPROGRAM\");\r\n\t\t})\r\n\t}\r\n\tpublic async getSingleVar(expression: string) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet reply:VarData={name: expression,indexCount: 0,content: \"undefined\",bases:[]}\r\n\t\t\tif (expression.substring(0, 1) === \"$\") {\r\n\t\t\t\treply.content=(this._mVars[\"I\"] !== undefined) ? this._mVars[\"I\"][expression] : \"undefined\";\r\n\t\t\t\tresolve(reply);\r\n\t\t\t} else {\r\n\t\t\t\tif (this._mVars[\"V\"] !== undefined) {\r\n\t\t\t\t\tif (this._mVars[\"V\"][expression] !== undefined) {\r\n\t\t\t\t\t\treply.content=this._mVars[\"V\"][expression];\r\n\t\t\t\t\t\tresolve(reply);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._event.on('SingleVarReceived', function SingleVarReceived(event, singleVar, singleVarContent) {\r\n\t\t\t\t\t\t\tevent.removeListener('SingleVarReceived', SingleVarReceived);\r\n\t\t\t\t\t\t\treply.name=singleVar;\r\n\t\t\t\t\t\t\treply.content=singleVarContent;\r\n\t\t\t\t\t\t\tresolve(reply);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.writeln(\"GETVAR;\" + expression);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve(reply);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// private methods\r\n\r\n\tprivate loadSource(file: string) {\r\n\t\tfile=file.replace(\"%\",\"_\");\r\n\t\tif (this._sourceFile !== file) {\r\n\t\t\tthis._sourceFile = file;\r\n\t\t\tthis._sourceLines = readFileSync(this._sourceFile).toString().split('\\n');\r\n\t\t}\r\n\t}\r\n\r\n\tprivate convertMumpsPosition(positionstring: string) {\r\n\t\tlet parts = positionstring.split(\"^\");\r\n\t\tlet position = parts[0];\r\n\t\tlet program = parts[1].split(\" \", 1)[0];\r\n\t\tlet file = (this._localRoutinesPath + program + \".m\").replace(\"%\",\"_\");\r\n\t\tlet filecontent = readFileSync(file).toString().split('\\n');\r\n\t\tlet startlabel = position.split(\"+\")[0];\r\n\t\tlet offset = 0;\r\n\t\tif (position.split(\"+\")[1] !== undefined) {\r\n\t\t\toffset = parseInt(position.split(\"+\")[1]);\r\n\t\t}\r\n\t\tlet line = 0;\r\n\t\tif (startlabel !== \"\") {\r\n\t\t\tfor (let ln = 0; ln < filecontent.length; ln++) {\r\n\t\t\t\tif (filecontent[ln].substring(0, startlabel.length) === startlabel) {\r\n\t\t\t\t\tline = ln;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { \"file\": file, \"line\": line + offset - 1 };\r\n\t}\r\n\r\n\tprivate sendEvent(event: string, ...args: any[]) {\r\n\t\tthis.emit(event,...args);\r\n\t\t/*\r\n\t\tsetImmediate(_ => {\r\n\t\t\tthis.emit(event, ...args);\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n}","import * as vscode from 'vscode';\r\nlet Hover = vscode.Hover;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\n\r\nclass MumpsHoverProvider {\r\n    provideHover(document, position) {\r\n        let token = new MumpsToken(document, position);\r\n\t\t\t\tif (!token.range) {return}\r\n        if (!token.mayBeCommand && !token.isIntrinsic && !token.isLabelReference) {\r\n            return;\r\n        }\r\n\r\n        if (token.definition) {\r\n            let definition = token.definition;\r\n            let snippet = { language: 'typescript', value: definition.functionSignature || definition.name };\r\n            return new Hover([snippet, definition.description]);\r\n        }\r\n    }\r\n}\r\n\r\nexport {MumpsHoverProvider}\r\n","let fs = require('fs');\r\nlet path = require('path');\r\nimport * as vscode from 'vscode';\r\nimport * as autoDoc from './mumps-documenter'\r\nlet Position = vscode.Position;\r\nlet Uri = vscode.Uri;\r\n\r\nconst EXTENSIONS = ['.M', '.INT', '.ZWR', '.m', '.int', '.zwr'];\r\n\r\nlet cache: any = {};\r\n\r\nfunction lookupLabelReference(token): MumpsLabel {\r\n\t//console.log(\"here\")\r\n\tlet uri = token.labelProgram ?\r\n\t\tsiblingUri(token.document, token.labelProgram) :\r\n\t\ttoken.document.uri;\r\n\tlet referredTo = findReferredToLabel(getText(uri, token.document), token.label);\r\n\t//console.log(referredTo)\r\n\tif (referredTo) {\r\n\t\treferredTo.position = new Position(referredTo.line + (token.labelOffset || 0), 0);\r\n\t} else {\r\n\t\treferredTo = {\r\n\t\t\ttext: '',\r\n\t\t\tposition: new Position(0, 0)\r\n\t\t};\r\n\t}\r\n\treferredTo.uri = uri;\r\n\treturn referredTo;\r\n}\r\n\r\nfunction siblingUri(document, fileName) {\r\n\tlet siblingPath = path.resolve(document.uri.fsPath, '../' + fileName);\r\n\tif (!fs.existsSync(siblingPath)) {\r\n\t\tif (fileName.charAt(0) === '%') {\r\n\t\t\treturn siblingUri(document, '_' + fileName.substring(1));\r\n\t\t}\r\n\r\n\t\tfor (let extension of EXTENSIONS) {\r\n\t\t\tlet extendedPath = siblingPath + extension;\r\n\t\t\tif (fs.existsSync(extendedPath)) {\r\n\t\t\t\tsiblingPath = extendedPath;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn Uri.file(siblingPath);\r\n}\r\n\r\nfunction getText(uri, document) {\r\n\tif (uri === document.uri) {\r\n\t\treturn document.getText();\r\n\t}\r\n\tif (uri.fsPath === cache.fsPath) {\r\n\t\treturn cache.text;\r\n\t}\r\n\ttry {\r\n\t\tcache.text = fs.readFileSync(uri.fsPath, 'utf8');\r\n\t\tcache.fsPath = uri.fsPath;\r\n\t\treturn cache.text;\r\n\t} catch (e) {\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nfunction findReferredToLabel(text: string, label): MumpsLabel | undefined {\r\n\tlet lines = text.split(\"\\n\");\r\n\tlet commentText = \"\";\r\n\tlet i=0;\r\n\tfor (i = 0; i < lines.length; i++) {\r\n\t\tif (lines[i].match(\"^\" + label) !== null) {\r\n\t\t\tcommentText += lines[i] + \"\\n\";\r\n\t\t\tfor (let j = i - 1; j > 0; j--) {\r\n\t\t\t\tif (lines[j].length === 0 || lines[j].charAt(1) === \";\") {\r\n\t\t\t\t\tcommentText += lines[j] + \"\\n\"\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (commentText.length > 0) {\r\n\t\treturn {\r\n\t\t\ttext: commentText,\r\n\t\t\tline: i\r\n\t\t};\r\n\t}\r\n}\r\n/*\r\nfunction countLines(text, index) {\r\n    if (index >= text.length) {\r\n        index = text.length - 1;\r\n    }\r\n    let re = /[\\r\\n]+/g;\r\n    let result;\r\n    let line = 0;\r\n    while ((result = re.exec(text)) && result.index >= 0 && result.index < index) {\r\n        ++line;\r\n    }\r\n    return line;\r\n}\r\n*/\r\nfunction createDefinitionForLabelReference(referredTo: MumpsLabel) {\r\n\t//console.log(\"CreateLabel\")\r\n\tif (!referredTo.text) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet definitionRegex = /^([%A-Z][A-Z0-9]*)(\\((,?[%A-Z][A-Z0-9]*)+\\))?/i;\r\n\tlet result = definitionRegex.exec(referredTo.text);\r\n\tif (!result) {\r\n\t\treturn;\r\n\t}\r\n\tlet commentText='';\r\n\tif (referredTo.text.indexOf(';')) {\r\n\t\tcommentText=referredTo.text.substring(referredTo.text.indexOf(';')+1);\r\n\t}\r\n\tlet parameters:any = [];\r\n\tlet parametersByName = {};\r\n\tif (result[2] !== undefined) {\r\n\t\tparameters = result[2].substring(1, result[2].length - 1).split(',');\r\n\t\tfor (let i = 0; i < parameters.length; i++) {\r\n\t\t\tparameters[i] = {\r\n\t\t\t\tname: parameters[i],\r\n\t\t\t\ttype: 'any'\r\n\t\t\t};\r\n\t\t\tparametersByName[parameters[i].name] = parameters[i];\r\n\t\t}\r\n\t}\r\n\tlet definition = {\r\n\t\tname: result[1],\r\n\t\ttype: 'function',\r\n\t\tparameters,\r\n\t\tcommentText\r\n\t};\r\n\r\n\t//extractDescriptionFromComments(referredTo, definition, parametersByName);\r\n\tautoDoc.getSigInfo(referredTo, definition, parametersByName);\r\n\r\n\treturn definition;\r\n}\r\n/*\r\nfunction extractDescriptionFromComments(referredTo:MumpsLabel, definition, parametersByName) {\r\n    let commentRegex = /;[ \\t]*(.*)$/gm;\r\n    let commentText = '';\r\n    let result;\r\n    while ((result = commentRegex.exec(referredTo.text)) !== null) {\r\n        commentText += result[1] + '\\n';\r\n    }\r\n    if (!commentText) {\r\n        return;\r\n    }\r\n\r\n    // don't look for parameters in the first line\r\n    let newlineResult = /\\n/m.exec(commentText);\r\n    if (newlineResult) {\r\n        let additionalLines = commentText.substring(newlineResult.index + 1);\r\n        for (let name in parametersByName) {\r\n            let parameterRegex = new RegExp('^((input|output|input/output)[ \\t:\\\\-]+)?' + name + '[ \\t:\\\\-]+(.+)\\n', 'm');\r\n            let result = parameterRegex.exec(additionalLines);\r\n            if (result) {\r\n                parametersByName[name].description = result[3] + \"ss\";\r\n                if (result[2]) {\r\n                    parametersByName[name].description = result[2] + parametersByName[name].description;\r\n                }\r\n                additionalLines = additionalLines.substring(0, result.index) + additionalLines.substring(result.index + result[0].length);\r\n            }\r\n        }\r\n        commentText = commentText.substring(0, newlineResult.index) + '\\n' + additionalLines;\r\n    }\r\n\r\n    definition.description = commentText;\r\n}\r\n*/\r\ninterface MumpsLabel { text: string, line?: number, position?: vscode.Position, uri?: string }\r\nexport { lookupLabelReference, createDefinitionForLabelReference, MumpsLabel };","import * as vscode from 'vscode';\r\nlet Location = vscode.Location;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\nclass MumpsDefinitionProvider {\r\n    provideDefinition(document, position) {\r\n        let token = new MumpsToken(document, position);\r\n        if (token.isLabelReference && token.referredToLabel) {\r\n            let position = token.referredToLabel.position;\r\n            return new Location(token.referredToLabel.uri, position);\r\n        }\r\n    }\r\n}\r\n\r\nexport {MumpsDefinitionProvider};","import * as vscode from 'vscode';\r\nlet ParameterInformation = vscode.ParameterInformation;\r\nlet Position = vscode.Position;\r\nlet SignatureHelp = vscode.SignatureHelp;\r\nlet SignatureInformation = vscode.SignatureInformation;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\n\r\nclass MumpsSignatureHelpProvider {\r\n    provideSignatureHelp(document, position) {\r\n        let line = document.lineAt(position);\r\n        if (!line) {\r\n            return;\r\n        }\r\n\r\n        let token = getFunctionToken(document, line, position);\r\n        if (!token || !token.definition) {\r\n            return;\r\n        }\r\n\r\n        let signature = createSignatureInformation(token.definition);\r\n\r\n        let help = new SignatureHelp();\r\n        help.signatures = [signature];\r\n        help.activeSignature = 0;\r\n        help.activeParameter = calculateActiveParameter(line.text, token.position.character + 1, position.character);\r\n        return help;\r\n    }\r\n}\r\nexport {MumpsSignatureHelpProvider};\r\n\r\nfunction getFunctionToken(document, line, position) {\r\n    let depth = 1;\r\n    let index;\r\n    for (index = position.character - 1; index > 0 && depth > 0; index--) {\r\n        let char = line.text.charAt(index);\r\n        if (char === ')') {\r\n            depth++;\r\n        } else if (char === '(') {\r\n            depth--;\r\n        }\r\n    }\r\n    if (depth > 0 || index <= 0) {\r\n        return;\r\n    }\r\n\r\n    return new MumpsToken(document, new Position(position.line, index));\r\n}\r\n\r\nfunction createSignatureInformation(definition) {\r\n    let signature = new SignatureInformation(definition.functionSignature, definition.description);\r\n    if (definition.parameters) {\r\n        signature.parameters = [];\r\n        for (let parameter of definition.parameters) {\r\n            let description = parameter.optional ? '(optional) ' : '';\r\n            description += parameter.description || parameter.name;\r\n            signature.parameters.push(new ParameterInformation(parameter.name, description));\r\n\t\t\t\t}\r\n\t\t\t\tsignature.documentation=definition.commentText;\r\n    }\r\n    return signature;\r\n}\r\n\r\nfunction calculateActiveParameter(lineText, parametersStartIndex, insertIndex) {\r\n    let active = 0;\r\n    let depth = 0;\r\n    for (let i = parametersStartIndex + 1; i < insertIndex; i++) {\r\n        let char = lineText.charAt(i);\r\n        if (char === '(') {\r\n            depth++;\r\n        } else if (char === ')') {\r\n            depth--;\r\n        } else if (char === ',' && depth === 0) {\r\n            active++;\r\n        }\r\n    }\r\n    return active;\r\n}\r\n","import * as vscode from 'vscode';\r\nimport * as parser from './parser/parser';\r\n\r\nexport class MumpsDocumentSymbolProvider implements vscode.DocumentSymbolProvider {\r\n\r\n\tpublic provideDocumentSymbols(document: vscode.TextDocument): Promise<vscode.SymbolInformation[]> {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tlet parsedDoc = parser.parseText(document.getText());\r\n            let symbols: vscode.SymbolInformation[] = [];\r\n\r\n\t\t\tparsedDoc.methods.forEach(method => {\r\n                let kind = vscode.SymbolKind.Function;\r\n\r\n\t\t\t\tlet startPosition = new vscode.Position(method.id.position.line, 0);\r\n\r\n\t\t\t\tlet endPostionLine = (method.endLine === -1) ? document.lineCount - 1 : method.endLine;\r\n                let endPosition = new vscode.Position(endPostionLine, 0);\r\n\r\n                let methodRange = new vscode.Location(document.uri, new vscode.Range(startPosition, endPosition));\r\n\r\n\t\t\t\tsymbols.push(new vscode.SymbolInformation(method.id.value, kind, '', methodRange));\r\n            });\r\n\r\n\t\t\tresolve(symbols);\r\n\t\t})\r\n\t}\r\n}","import { getTokens, Token, Type } from './tokenizer';\r\n\r\n// Code adapted from the vscode-psl extension by ing-bank\r\n\r\n/**\r\n * Used for checking the type of Member at runtime\r\n */\r\nexport enum MemberClass {\r\n\tmethod = 1,\r\n\tparameter = 2,\r\n\t// property = 3,\r\n\tdeclaration = 4,\r\n\tcolumn = 5,\r\n\ttable = 6,\r\n\tproc = 7,\r\n}\r\n\r\n/**\r\n * A generic type that abstracts Method, Parameter, Declaration, etc\r\n */\r\nexport interface IMember {\r\n\r\n\t/**\r\n\t * The Token representing the name of the member.\r\n\t */\r\n\tid: Token\r\n\r\n\tdocumentation?: string;\r\n}\r\n\r\n/**\r\n * Contains information about a Method\r\n */\r\nexport interface IMethod extends IMember {\r\n\r\n\t/**\r\n\t * The Token of the closing parenthesis after the declaration of all the Method's parameters.\r\n\t */\r\n\tcloseParen: Token\r\n\r\n\t/**\r\n\t * The parameters of the Method, each with their own typing and comment information.\r\n\t */\r\n\tparameters: IParameter[]\r\n\r\n\t/**\r\n\t * The zero-based line where the Method begins\r\n\t */\r\n\tline: number\r\n\r\n\t/**\r\n\t * The last line of the Method, right before the start of a new Method\r\n\t */\r\n\tendLine: number\r\n\r\n\t/**\r\n\t * Next Line of a method implementation\r\n\t */\r\n\tnextLine: number\r\n\r\n\t/**\r\n\t * Previous Line of a method implementation\r\n\t */\r\n\tprevLine: number;\r\n\r\n}\r\n\r\n/**\r\n * Represents a parameter, always belonging to a Method\r\n */\r\nexport interface IParameter extends IMember {\r\n\t/**\r\n\t * The contents of the comment for the parameter, i.e.\r\n\t * ```\r\n\t * public String name(\r\n\t * \t\tString p1 // a comment\r\n\t * \t\t)\r\n\t * ```\r\n\t */\r\n\tcomment: Token\r\n}\r\n\r\n/**\r\n * A type declaration, typically found within a method.\r\n */\r\nexport interface IDeclaration extends IMember {\r\n}\r\n\r\n\r\n/**\r\n * An abstract syntax tree of a PSL document\r\n */\r\nexport interface IParsedDocument {\r\n\r\n\t/**\r\n\t * An array of Declarations that are not contained within a method.\r\n\t * This will be empty for valid Profile 7.6 code but is maintained for compatibility.\r\n\t */\r\n\tdeclarations: IDeclaration[]\r\n\r\n\t/**\r\n\t * An array of the methods in the document\r\n\t */\r\n\tmethods: IMethod[]\r\n\r\n\t/**\r\n\t * All the tokens in the document, for reference.\r\n\t */\r\n\ttokens: Token[]\r\n}\r\n\r\nclass Method implements IMethod {\r\n\r\n\tnextLine: number;\r\n\tprevLine: number;\r\n\tcloseParen: Token;\r\n\tid: Token;\r\n\tparameters: Parameter[]\r\n\tdeclarations: IDeclaration[];\r\n\tline: number;\r\n\tendLine: number;\r\n\tmemberClass: MemberClass;\r\n\tdocumentation: string;\r\n\r\n\tconstructor() {\r\n\t\tthis.parameters = [];\r\n\t\tthis.line = -1;\r\n\t\tthis.declarations = [];\r\n\t\tthis.endLine = -1;\r\n\t\tthis.memberClass = MemberClass.method;\r\n\t\tthis.documentation = '';\r\n\t}\r\n}\r\n\r\nclass Parameter implements IParameter {\r\n\tid: Token\r\n\tcomment: Token\r\n\r\n\tconstructor() { }\r\n}\r\n\r\nexport function parseText(sourceText: string): IParsedDocument {\r\n\tlet parser = new Parser();\r\n\treturn parser.parseDocument(sourceText);\r\n}\r\n\r\nclass Parser {\r\n\r\n\tprivate tokenizer: IterableIterator<Token>;\r\n\tprivate activeToken: Token;\r\n\tprivate methods: Method[];\r\n\tprivate declarations: IDeclaration[];\r\n\tprivate activeMethod: Method;\r\n\tprivate tokens: Token[];\r\n\r\n\tconstructor(tokenizer?: IterableIterator<Token>) {\r\n\t\tthis.methods = [];\r\n\t\tthis.declarations = [];\r\n\t\tthis.tokens = [];\r\n\t\tif (tokenizer) { this.tokenizer = tokenizer; }\r\n\t}\r\n\r\n\tprivate next(): boolean {\r\n\t\tthis.activeToken = this.tokenizer.next().value;\r\n\t\tif (this.activeToken) { this.tokens.push(this.activeToken); }\r\n\t\treturn this.activeToken !== undefined;\r\n\t}\r\n\r\n\tparseDocument(documentText: string): IParsedDocument {\r\n\t\tthis.tokenizer = getTokens(documentText);\r\n\t\twhile (this.next()) {\r\n\t\t\tif (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tlet method = this.parseMethod();\r\n\t\t\t\tif (!method) { continue; }\r\n\t\t\t\tthis.methods.push(method);\r\n\t\t\t\tthis.activeMethod = method;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isTab() || this.activeToken.isSpace()) {\r\n\t\t\t\tlet lineNumber = this.activeToken.position.line;\r\n\t\t\t\tlet tokenBuffer = this.loadTokenBuffer();\r\n\t\t\t\tif (this.activeMethod && this.activeMethod.nextLine === lineNumber) {\r\n\t\t\t\t\tlet documentation = this.checkForDocumentation(tokenBuffer);\r\n\t\t\t\t\tif (documentation) { this.activeMethod.documentation = documentation; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isNewLine()) { continue; }\r\n\t\t\telse { this.throwAwayTokensTil(Type.NewLine); }\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tdeclarations: this.declarations,\r\n\t\t\tmethods: this.methods,\r\n\t\t\ttokens: this.tokens\r\n\t\t}\r\n\t}\r\n\r\n\tprivate checkForDocumentation(tokenBuffer: Token[]): string {\r\n\t\tlet i = 0;\r\n\t\twhile (i < tokenBuffer.length) {\r\n\t\t\tlet token = tokenBuffer[i];\r\n\t\t\tif (token.isSpace() || token.isTab()) {\r\n\t\t\t\ti++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (token.isLineCommentInit() && tokenBuffer[i + 1] && tokenBuffer[i + 1].isLineComment()) {\r\n\t\t\t\treturn tokenBuffer[i + 1].value;\r\n\t\t\t}\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tprivate loadTokenBuffer() {\r\n\t\tlet tokenBuffer: Token[] = []\r\n\t\twhile (this.next() && this.activeToken.type !== Type.NewLine) {\r\n\t\t\ttokenBuffer.push(this.activeToken);\r\n\t\t}\r\n\t\treturn tokenBuffer;\r\n\t}\r\n\r\n\tprivate parseMethod(): Method | undefined {\r\n\t\tlet method: Method = new Method();\r\n\t\tdo {\r\n\t\t\tif (!this.activeToken) { continue; }\r\n\t\t\tif (this.activeToken.isTab() || this.activeToken.isSpace()) { continue; }\r\n\t\t\telse if (this.activeToken.isNewLine()) { break; }\r\n\t\t\telse if (this.activeToken.isOpenParen()) {\r\n\t\t\t\tlet processed = this.processParameters(method);\r\n\t\t\t\tif (!processed) { return undefined; }\r\n\t\t\t\tmethod.parameters = processed;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tif (method.line === -1) {\r\n\t\t\t\t\tmethod.line = this.activeToken.position.line;\r\n\t\t\t\t\tmethod.prevLine = this.activeToken.position.line - 1;\r\n\t\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\t\tmethod.id = this.activeToken;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isLineCommentInit() || this.activeToken.isLineComment()) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.value === '\\r') { continue; }\r\n\t\t\telse if (this.activeToken.isCloseParen()) {\r\n\t\t\t\tif (!method.closeParen) {\r\n\t\t\t\t\tmethod.closeParen = this.activeToken;\r\n\t\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.throwAwayTokensTil(Type.NewLine);\r\n\t\t\t\tif (method.id) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\t\t} while (this.next());\r\n\r\n\t\tif (this.activeMethod) {\r\n\t\t\tthis.activeMethod.endLine = method.id.position.line - 1;\r\n\t\t}\r\n\t\tthis.activeMethod = method;\r\n\t\treturn method;\r\n\t}\r\n\r\n\tprivate processParameters(method: Method): Parameter[] | undefined {\r\n\t\tlet args: Parameter[] = [];\r\n\t\tlet param: Parameter | undefined;\r\n\t\tlet open = false;\r\n\t\twhile (this.next()) {\r\n\t\t\tif (this.activeToken.isTab() || this.activeToken.isSpace() || this.activeToken.isNewLine()) { continue; }\r\n\t\t\telse if (this.activeToken.isOpenParen()) {\r\n\t\t\t\topen = true;\r\n\t\t\t\tif (!param) { return undefined; }\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isCloseParen()) {\r\n\t\t\t\topen = false;\r\n\t\t\t\tmethod.closeParen = this.activeToken;\r\n\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\tif (!param) { break; }\r\n\t\t\t\targs.push(param);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tif (!param) { param = new Parameter(); }\r\n\t\t\t\tparam.id = this.activeToken;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isLineComment()) {\r\n\t\t\t\tif (param) {\r\n\t\t\t\t\tparam.comment = this.activeToken\r\n\t\t\t\t}\r\n\t\t\t\telse if (args.length >= 1) {\r\n\t\t\t\t\targs[args.length - 1].comment = this.activeToken;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isComma()) {\r\n\t\t\t\tif (!param) { return undefined; }\r\n\t\t\t\targs.push(param)\r\n\t\t\t\tparam = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (open) { return undefined; }\r\n\t\treturn args;\r\n\t}\r\n\r\n\tprivate throwAwayTokensTil(type: Type) {\r\n\t\tdo { } while (this.next() && this.activeToken.type !== type)\r\n\t}\r\n\r\n}","import { Position, Range } from \"vscode\";\r\n\r\n// Code adapted from the vscode-psl extension by ing-bank\r\n\r\nexport function* getTokens(documentContents: string): IterableIterator<Token> {\r\n\tlet tokenizer: Tokenizer = new Tokenizer()\r\n\r\n\tfor (let char of documentContents) {\r\n\t\ttokenizer.charType = getType(char);\r\n\t\tif (tokenizer.tokenType === 0) {\r\n\t\t\ttokenizer.tokenType = tokenizer.charType;\r\n\t\t}\r\n\t\twhile (!tokenizer.parsed) {\r\n\t\t\tif (tokenizer.parseCharacter(char)) {\r\n\t\t\t\tyield tokenizer.finalizedToken;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttokenizer.parsed = false;\r\n\t}\r\n\r\n\t// if there is an unfinished token left\r\n\tif (tokenizer.tokenType !== 0) {\r\n\t\ttokenizer.finalizeToken(0);\r\n\t\tyield tokenizer.finalizedToken;\r\n\t}\r\n}\r\n\r\nexport class Token {\r\n\ttype: Type;\r\n\tvalue: string;\r\n\tposition: Position;\r\n\r\n\tconstructor(type: Type, value: string, position: Position) {\r\n\t\tthis.type = type;\r\n\t\tthis.value = value;\r\n\t\tthis.position = position;\r\n\t}\r\n\r\n\tgetRange() {\r\n\t\tlet start: Position = this.position;\r\n\t\tlet end: Position = new Position(this.position.line, this.position.character + this.value.length);\r\n\t\treturn new Range(start, end);\r\n\t}\r\n\r\n\tisAlphanumeric() {\r\n\t\treturn this.type === Type.Alphanumeric;\r\n\t}\r\n\r\n\tisCloseParen() {\r\n\t\treturn this.type === Type.CloseParen;\r\n\t}\r\n\r\n\tisComma() {\r\n\t\treturn this.type === Type.Comma;\r\n\t}\r\n\r\n\tisLineComment() {\r\n\t\treturn this.type === Type.LineComment;\r\n\t}\r\n\r\n\tisLineCommentInit() {\r\n\t\treturn this.type === Type.LineCommentInit;\r\n\t}\r\n\r\n\tisNewLine() {\r\n\t\treturn this.type === Type.NewLine;\r\n\t}\r\n\r\n\tisNumeric() {\r\n\t\treturn this.type === Type.Numeric;\r\n\t}\r\n\r\n\tisOpenParen() {\r\n\t\treturn this.type === Type.OpenParen;\r\n\t}\r\n\r\n\tisSpace() {\r\n\t\treturn this.type === Type.Space;\r\n\t}\r\n\r\n\tisTab() {\r\n\t\treturn this.type === Type.Tab;\r\n\t}\r\n\r\n\tisWhiteSpace() {\r\n\t\treturn this.type === Type.Space || this.type === Type.Tab || this.type === Type.NewLine || this.type === Type.Undefined;\r\n\t}\r\n}\r\n\r\nclass Tokenizer {\r\n\tdocumentLine: number;\r\n\tdocumentColumn: number;\r\n\r\n\tcharType: number;\r\n\ttokenType: number;\r\n\ttokenValue: string;\r\n\ttokenPosition: Position;\r\n\tfinalizedToken: Token;\r\n\r\n\tparsed: boolean\r\n\tstringOpen: boolean;\r\n\tfirstSlash: boolean;\r\n\tasterisk: boolean;\r\n\r\n\tconstructor() {\r\n\t\tthis.documentLine = 0;\r\n\t\tthis.documentColumn = 0;\r\n\r\n\t\tthis.charType = 0;\r\n\t\tthis.tokenType = 0;\r\n\t\tthis.tokenValue = '';\r\n\t\tthis.tokenPosition = new Position(this.documentLine, this.documentColumn);\r\n\r\n\t\tthis.parsed = false;\r\n\t\tthis.stringOpen = false;\r\n\t\tthis.firstSlash = false;\r\n\t\tthis.asterisk = false;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param char current character being parsed\r\n\t * @returns true if token is finalized\r\n\t */\r\n\tparseCharacter(char: string): boolean {\r\n\t\tif (this.tokenType === Type.Alphanumeric) {\r\n\t\t\tif (this.charType === Type.Alphanumeric || this.charType === Type.Numeric) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(this.charType);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.Numeric) {\r\n\t\t\tif (this.charType === Type.Numeric) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(this.charType);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.LineComment) {\r\n\t\t\tif (this.charType !== Type.NewLine) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(Type.NewLine);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.String) {\r\n\t\t\tif (this.charType !== Type.DoubleQuotes) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(Type.DoubleQuotes);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.LineCommentInit) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tthis.finalizeToken(Type.LineComment);\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.SemiColon) {\r\n\t\t\tthis.tokenType = Type.LineCommentInit;\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.DoubleQuotes) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tif (this.stringOpen) {\r\n\t\t\t\tthis.stringOpen = false;\r\n\t\t\t\tthis.finalizeToken(0);\r\n\t\t\t} else {\r\n\t\t\t\tthis.stringOpen = true;\r\n\t\t\t\tthis.finalizeToken(Type.String);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.NewLine) {\r\n\t\t\tthis.tokenValue = this.tokenValue + char;\r\n\t\t\tthis.parsed = true;\r\n\t\t\tthis.documentLine++;\r\n\t\t\tthis.documentColumn = 0;\r\n\t\t\tthis.finalizeToken(0);\r\n\t\t\treturn true;\r\n\t\t} else if ((this.tokenType > 10) || (this.tokenType === -1)) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tthis.finalizeToken(0);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tupdateTokenAndAdvanceCursor(char: string) {\r\n\t\tthis.tokenValue = this.tokenValue + char;\r\n\t\tthis.parsed = true;\r\n\t\tthis.documentColumn++;\r\n\t}\r\n\r\n\tfinalizeToken(newType: number): void {\r\n\t\tthis.finalizedToken = new Token(this.tokenType, this.tokenValue, this.tokenPosition);\r\n\t\tthis.tokenType = newType;\r\n\t\tthis.tokenValue = '';\r\n\t\tthis.tokenPosition = new Position(this.documentLine, this.documentColumn);\r\n\t}\r\n}\r\n\r\nfunction getType(c: string): Type {\r\n\tlet charCode: number = c.charCodeAt(0);\r\n\tif (charCode >= 65 && charCode <= 90 || charCode >= 97 && charCode <= 122 || charCode === 37) {\r\n\t\treturn Type.Alphanumeric;\r\n\t} else if (charCode >= 48 && charCode <= 57) {\r\n\t\treturn Type.Numeric;\r\n\t} else if (charCode === 34) {\r\n\t\treturn Type.DoubleQuotes;\r\n\t} else if (charCode === 9) {\r\n\t\treturn Type.Tab;\r\n\t} else if (charCode === 10) {\r\n\t\treturn Type.NewLine;\r\n\t} else if (charCode === 32) {\r\n\t\treturn Type.Space;\r\n\t} else if (charCode === 33) {\r\n\t\treturn Type.ExclamationMark;\r\n\t} else if (charCode === 35) {\r\n\t\treturn Type.NumberSign;\r\n\t} else if (charCode === 36) {\r\n\t\treturn Type.DollarSign;\r\n\t\t// } else if (charCode === 37) {\r\n\t\t// \treturn Type.PercentSign;\r\n\t} else if (charCode === 38) {\r\n\t\treturn Type.Ampersand;\r\n\t} else if (charCode === 39) {\r\n\t\treturn Type.SingleQuote;\r\n\t} else if (charCode === 40) {\r\n\t\treturn Type.OpenParen;\r\n\t} else if (charCode === 41) {\r\n\t\treturn Type.CloseParen;\r\n\t} else if (charCode === 42) {\r\n\t\treturn Type.Asterisk;\r\n\t} else if (charCode === 43) {\r\n\t\treturn Type.PlusSign;\r\n\t} else if (charCode === 44) {\r\n\t\treturn Type.Comma;\r\n\t} else if (charCode === 45) {\r\n\t\treturn Type.MinusSign;\r\n\t} else if (charCode === 46) {\r\n\t\treturn Type.Period;\r\n\t} else if (charCode === 58) {\r\n\t\treturn Type.Colon;\r\n\t} else if (charCode === 59) {\r\n\t\treturn Type.SemiColon;\r\n\t} else if (charCode === 60) {\r\n\t\treturn Type.LessThan;\r\n\t} else if (charCode === 61) {\r\n\t\treturn Type.EqualSign;\r\n\t} else if (charCode === 62) {\r\n\t\treturn Type.GreaterThan;\r\n\t} else if (charCode === 63) {\r\n\t\treturn Type.QuestionMark;\r\n\t} else if (charCode === 64) {\r\n\t\treturn Type.AtSymbol;\r\n\t} else if (charCode === 91) {\r\n\t\treturn Type.OpenBracket;\r\n\t} else if (charCode === 92) {\r\n\t\treturn Type.Backslash;\r\n\t} else if (charCode === 93) {\r\n\t\treturn Type.CloseBracket;\r\n\t} else if (charCode === 94) {\r\n\t\treturn Type.Caret;\r\n\t} else if (charCode === 95) {\r\n\t\treturn Type.Underscore;\r\n\t} else if (charCode === 96) {\r\n\t\treturn Type.BackQuote;\r\n\t} else if (charCode === 123) {\r\n\t\treturn Type.OpenBrace;\r\n\t} else if (charCode === 124) {\r\n\t\treturn Type.Pipe;\r\n\t} else if (charCode === 125) {\r\n\t\treturn Type.CloseBrace;\r\n\t} else if (charCode === 126) {\r\n\t\treturn Type.Tilde;\r\n\t}\r\n\r\n\telse {\r\n\t\treturn -1;\r\n\t}\r\n}\r\n\r\nexport const enum Type {\r\n\tAlphanumeric = 1,\r\n\tNumeric = 2,\r\n\tLineComment = 3,\r\n\tBlockComment = 4,\r\n\tString = 5,\r\n\tLineCommentInit = 6,\r\n\tDoubleQuotes = 9,\r\n\r\n\tTab = 11,\r\n\tNewLine = 13,\r\n\tSpace = 32,\r\n\r\n\tExclamationMark = 33,\r\n\tNumberSign = 35,\r\n\tDollarSign = 36,\r\n\tAmpersand = 38,\r\n\tSingleQuote = 39,\r\n\tOpenParen = 40,\r\n\tCloseParen = 41,\r\n\tAsterisk = 42,\r\n\tPlusSign = 43,\r\n\tComma = 44,\r\n\tMinusSign = 45,\r\n\tPeriod = 46,\r\n\tColon = 58,\r\n\tSemiColon = 59,\r\n\tLessThan = 60,\r\n\tEqualSign = 61,\r\n\tGreaterThan = 62,\r\n\tQuestionMark = 63,\r\n\tAtSymbol = 64,\r\n\tOpenBracket = 91,\r\n\tBackslash = 92,\r\n\tCloseBracket = 93,\r\n\tCaret = 94,\r\n\tUnderscore = 95,\r\n\tBackQuote = 96,\r\n\tOpenBrace = 123,\r\n\tPipe = 124,\r\n\tCloseBrace = 125,\r\n\tTilde = 126,\r\n\r\n\tUndefined = -1\r\n}","import * as vscode from 'vscode';\r\nconst fs = require('fs');\r\n\r\n//let Location = vscode.Location;\r\n//let Position = vscode.Position;\r\ninterface ItemHint {\r\n\tlineStatus: string,\r\n\tstartstring: string\r\n}\r\ninterface LabelItem {\r\n\troutine: string,\r\n\tlabel: string,\r\n\tline: string\r\n}\r\ninterface DbItem {\r\n\tlabels: LabelItem[],\r\n\troutines: {}\r\n}\r\nexport class CompletionItemProvider {\r\n\t/**\r\n * Provides the completion items for the supplied words.\r\n *\r\n * @param {TextDocument} document\r\n * @param {Position} position\r\n * @param {CancellationToken} token\r\n * @returns\r\n */\r\n\tprivate _labelsReady: boolean;\r\n\tprivate _labelDB: DbItem;\r\n\tprivate _filesToCheck: number;\r\n\tprivate _dbfile: string;\r\n\tconstructor(labeldb: string) {\r\n\t\tthis._labelsReady = false;\r\n\t\tthis._dbfile = labeldb;\r\n\t\tthis._refreshLabelDB();\r\n\t}\r\n\tprovideCompletionItems(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken) {\r\n\t\t//let word = document.getText(document.getWordRangeAtPosition(position));\r\n\t\tlet line = document.getText(new vscode.Range(new vscode.Position(position.line, 0), position))\r\n\t\tlet status = getLineStatus(line, position.character);\r\n\t\tlet clean: Array<vscode.CompletionItem> = [];\r\n\r\n\t\tif (this._labelsReady && status.lineStatus === 'jumplabel' && status.startstring.length > 1) {\r\n\t\t\tlet replaceRange=new vscode.Range(new vscode.Position(position.line,position.character-status.startstring.length),position)\r\n\t\t\tclean = this._findLabel(status.startstring, clean, replaceRange);\r\n\t\t}\r\n\t\treturn clean;\r\n\t}\r\n\tprivate _refreshLabelDB() { // Look for all Labels in .m-Routines and them + Comments\r\n\t\tif (!fs.existsSync(this._dbfile)) {\r\n\t\t\tlet db = {\r\n\t\t\t\tlabels: [{ routine: '', label: '' }],\r\n\t\t\t\troutines: {}\r\n\t\t\t}\r\n\t\t\tfs.writeFileSync(this._dbfile, JSON.stringify(db));\r\n\t\t}\r\n\t\tfs.readFile(this._dbfile, (err, data) => {\r\n\t\t\tif (!err) {\r\n\t\t\t\tthis._labelDB = JSON.parse(data);\r\n\t\t\t\tlet dbChanged = false;\r\n\t\t\t\tvscode.workspace.findFiles('*.m').then((files) => {\r\n\t\t\t\t\tthis._filesToCheck = files.length;\r\n\t\t\t\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\t\t\t\tlet path = files[i].fsPath;\r\n\t\t\t\t\t\t\tfs.stat(path, false, (err, stats) => {\r\n\t\t\t\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\t\t\t\tlet ms = this._labelDB.routines[path];\r\n\t\t\t\t\t\t\t\t\tif (ms === undefined || stats.mtimeMs > ms) {\r\n\t\t\t\t\t\t\t\t\t\tthis._labelDB.routines[path] = stats.mtimeMs;\r\n\t\t\t\t\t\t\t\t\t\tdbChanged = true;\r\n\t\t\t\t\t\t\t\t\t\tif (stats.size < 50000) {  //parse only Files <50K\r\n\t\t\t\t\t\t\t\t\t\t\tthis._refreshFileLabels(path);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._labelsReady = true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tprivate _checkReady(dbChanged: boolean) {\t// Check if all .m Files are processed and save LabelDB then\r\n\t\tif (--this._filesToCheck === 0) {\r\n\t\t\tif (dbChanged) {\r\n\t\t\t\tfs.writeFile(this._dbfile, JSON.stringify(this._labelDB), (err) => {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tvscode.window.showErrorMessage(\"Error writing Label DB\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate _refreshFileLabels(path) {  // Refresh all Labels of a changed .m File\r\n\t\tlet routine = path.replace('\\\\', '/').split('/').pop();\r\n\t\troutine = routine!.split('.')[0].replace('_', '%');\r\n\t\tfs.readFile(path, 'utf8',(err,content)=>{\r\n\t\t\tif (!err) {\r\n\t\t\t\tlet lines=content.split('\\n');\r\n\t\t\t\tlet label = '';\r\n\t\t\t\tthis._labelDB.labels = this._labelDB.labels.filter((label) => {\r\n\t\t\t\t\treturn label.routine !== routine;\r\n\t\t\t\t})\r\n\t\t\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\t\t\tif (i===0) {\r\n\t\t\t\t\t\tthis._labelDB.labels.push({label:'*FL',routine,line:lines[0]});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (label = lines[i].match(/^[%A-Za-z0-9][A-Za-z0-9]{0,31}/)) {\r\n\t\t\t\t\t\tthis._labelDB.labels.push({ label: label[0], routine, line: lines[i] })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._checkReady(true);\r\n\t\t});\r\n\t}\r\n\tprivate _findLabel(startstring, list: Array<vscode.CompletionItem>, replaceRange:vscode.Range) {\r\n\t\t//let hits = 0;\r\n\t\tlet hitlist: LabelItem[];\r\n\t\tlet sortText='';\r\n\t\tif (startstring.charAt(0) === '^') {\r\n\t\t\tlet suchstring = startstring.substring(1);\r\n\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\treturn item.routine.startsWith(suchstring);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (startstring.indexOf('^')!==-1) {\r\n\t\t\t\tlet label=startstring.split('^')[0];\r\n\t\t\t\tlet routinepart=startstring.split('^')[1];\r\n\t\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\t\tlet fits = item.label===label && item.routine.startsWith(routinepart);\r\n\t\t\t\t\treturn fits;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\t\tlet fits = item.label.startsWith(startstring);\r\n\t\t\t\t\treturn fits;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < hitlist.length; i++) {\r\n\t\t\tlet item = hitlist[i];\r\n\t\t\tlet label = item.label + '^' + item.routine;\r\n\t\t\tif (label === startstring ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (item.label===\"*FL\") {\r\n\t\t\t\tif (!startstring.startsWith('^')) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlabel='^'+item.routine;\r\n\t\t\t\tsortText=\"100\";\r\n\t\t\t}\r\n\t\t\tlet detail = ''\r\n\t\t\tif (item.line.charAt(item.label.length) === '(') {\r\n\t\t\t\tif (item.line.indexOf(')') !== -1) {\r\n\t\t\t\t\tdetail = item.line.split(')')[0] + ')';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item.line.indexOf(';') !== -1) {\r\n\t\t\t\tdetail += item.line.substring(item.line.indexOf(';') + 1);\r\n\t\t\t}\r\n\t\t\tif (detail.length>0 && sortText!=='100') {sortText='099';}\r\n\t\t\tlist.push({ label, detail, sortText, range:replaceRange });\r\n\t\t}\r\n\t\treturn list;\r\n\t}\r\n}\r\nfunction getLineStatus(line: string | undefined, position: number): ItemHint {\r\n\tlet lineStatus = 'lineStart';\r\n\tlet lookPosition = 0;\r\n\tlet lastCommand = '';\r\n\tlet startstring = '';\r\n\tlet isInsidePostcond = false;\r\n\tif (line) {\r\n\t\twhile (lookPosition < position) {\r\n\t\t\tlet char = line.substring(lookPosition, ++lookPosition);\r\n\t\t\tlet isWhiteSpace = (char === \" \" || char === \"\\t\");\r\n\t\t\tlet isBeginOfVariable = char.match(/[A-Za-z%^]/);\r\n\t\t\tlet isAlphaChar = char.match(/[A-Za-z]/);\r\n\t\t\t//let isAlphanumeric=char.match(/[A-Za-z0-9%]/);\r\n\t\t\t//let isOperand = char.match(/[*+-/\\[\\]']/);\r\n\t\t\tif (lineStatus !== 'string' && char === ';') {\r\n\t\t\t\treturn { lineStatus: 'comment', startstring: '' };\r\n\t\t\t}\r\n\t\t\tif (!isBeginOfVariable) {\r\n\t\t\t\tif (startstring !== '' && char.match(/[0-9]/)) {\r\n\t\t\t\t\tstartstring += char\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstartstring = '';\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartstring += char;\r\n\t\t\t}\r\n\t\t\tswitch (lineStatus) {\r\n\t\t\t\tcase 'argument': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t\tif (lastCommand.match(/[D|DO|G|GOTO|J|JOB]/i)) {\r\n\t\t\t\t\t\t\t\tlineStatus = 'jumplabel'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (char === '\"') {\r\n\t\t\t\t\t\tlineStatus = 'string';\r\n\t\t\t\t\t} else if (isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'variable';\r\n\t\t\t\t\t} else if (char === \"$\") {\r\n\t\t\t\t\t\tlineStatus = 'function';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'command': {\r\n\t\t\t\t\tif (char === \":\") {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\tisInsidePostcond = true;\r\n\t\t\t\t\t} else if (isAlphaChar) {\r\n\t\t\t\t\t\tlastCommand += char;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\tif (lastCommand.match(/[D|DO|G|GOTO|J|JOB]/i)) {\r\n\t\t\t\t\t\t\tlineStatus = 'jumplabel'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlineStatus = 'error';\r\n\t\t\t\t\t\treturn { lineStatus: 'error', startstring: '' };\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'function': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (char === \"$\") {\r\n\t\t\t\t\t\tlineStatus = 'jumplabel';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'jumplabel': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t} else if (char === \":\") {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t} else if (char===\"(\") {\r\n\t\t\t\t\t\tlineStatus='argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'label': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t} else if (char = '(') {\r\n\t\t\t\t\t\tlineStatus = 'variable';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'lineStart': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlineStatus = 'label';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'string': {\r\n\t\t\t\t\tif (char === '\"') {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'variable': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (!isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn { lineStatus, startstring };\r\n}\r\n","import * as vscode from 'vscode';\r\nlet em = require('emcellent');\r\n//let tabSize = vscode.workspace.getConfiguration().get(\"editor.tabSize\")\r\n//var prevfin = true;\r\n\r\nasync function autoSpaceEnter() {\r\n\t//await vscode.commands.executeCommand(\"acceptSelectedSuggestion\");\r\n\tlet editor = vscode.window.activeTextEditor\r\n\tif (editor) {\r\n\t\tlet pos = editor.selection.active\r\n\t\tlet currentLine = editor.document.lineAt(pos.line).text;\r\n\t\tlet parsed = em.parse(currentLine);\r\n\t\tlet newLine = '';\r\n\t\tif (pos.character !== 0) {\r\n\t\t\t//check for removing a trailing .\r\n\t\t\tif ((parsed[0].lineRoutines === undefined || parsed[0].lineRoutines.length === 0) && currentLine.indexOf(\";\") === -1 && parsed[0].lineIndentationArray !== undefined && parsed[0].lineIndentationArray.length > 0) {\r\n\t\t\t\tparsed[0].lineIndentationArray.splice(-1)\r\n\t\t\t\teditor.edit((editBuilder) => {\r\n\t\t\t\t\teditBuilder.replace(new vscode.Range(pos.with(pos.line, 0), pos.with(pos.line, currentLine.length)), em.render(parsed))\r\n\t\t\t\t})\r\n\t\t\t\t//check for adding indentation to the new line\r\n\t\t\t} else {\r\n\t\t\t\tif (parsed[0].lineIndentationArray === undefined) {\r\n\t\t\t\t\tparsed[0].lineIndentationArray = []\r\n\t\t\t\t}\r\n\t\t\t\tif (lineContainsNoParamDo(parsed[0])) {\r\n\t\t\t\t\tparsed[0].lineIndentationArray.push(\" \")\r\n\t\t\t\t}\r\n\t\t\t\tparsed[0].lineRoutines = []\r\n\t\t\t\tdelete parsed[0].lineComment\r\n\t\t\t\tdelete parsed[0].lineLabel\r\n\t\t\t\tnewLine = em.render(parsed);\r\n\t\t\t}\r\n\t\t}\r\n\t\teditor.edit((editBuilder) => {\r\n\t\t\teditBuilder.insert(pos, \"\\n\" + newLine);\r\n\t\t})\r\n\t}\r\n}\r\n\r\nfunction lineContainsNoParamDo(parsed) {\r\n\tlet cmds = parsed.lineRoutines;\r\n\tif (cmds = parsed.lineRoutines) {\r\n\t\tfor (let i = 0; i < cmds.length; i++) {\r\n\t\t\tif (cmds[i].mRoutine.match(/(d|do)/i) && !cmds[i].mArguments) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nasync function autoSpaceTab() {\r\n\r\n\tlet editor = vscode.window.activeTextEditor\r\n\tif (editor) {\r\n\t\tlet pos = editor.selection.active\r\n\t\tlet currentLine = editor.document.lineAt(pos.line).text;\r\n\t\tlet parsed = em.parse(currentLine);\r\n\r\n\t\t//vscode.commands.executeCommand(\"acceptSelectedSuggestion\").then((test)=>{\r\n\t\t//\tconsole.log(test);\r\n\t\t//});\r\n\r\n\t\tif ((parsed[0].lineRoutines === undefined || parsed[0].lineRoutines.length === 0) &&\r\n\t\t\tcurrentLine.indexOf(\";\") === -1 && parsed[0].lineIndentationArray !== undefined &&\r\n\t\t\tparsed[0].lineIndentationArray.length > 0) {\r\n\t\t\tparsed[0].lineIndentationArray.push(\" \")\r\n\t\t\teditor.edit((editBuilder) => {\r\n\t\t\t\tif (currentLine.charAt(pos.character - 1) === \" \") {\r\n\t\t\t\t\teditBuilder.insert(pos.with(pos.line, pos.character), \". \")\r\n\t\t\t\t} else {\r\n\t\t\t\t\teditBuilder.insert(pos.with(pos.line, pos.character), \" . \")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\teditor.edit((eb) => {\r\n\t\t\t\teb.insert(pos, \"\\t\")\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { autoSpaceTab, autoSpaceEnter };","\"use strict\";\n\nvar parser = require('./lib/parse.js');\nvar renderer = require('./lib/render.js');\n\nfunction parseLine(inputString) {\n\n    var tmpObject = {};\n\n    //Parsing must be performed sequentially.\n    tmpObject = parser.extractLabel(inputString, tmpObject);\n    tmpObject = parser.extractComment(tmpObject.lineExpression, tmpObject);\n    tmpObject = parser.extractIndentation(tmpObject.lineExpression, tmpObject);\n    tmpObject = parser.extractRoutines(tmpObject.lineExpression, tmpObject);\n\n    //Line Expression is no longer needed.\n    delete tmpObject.lineExpression;\n    return tmpObject;\n}\n\nfunction renderLine(inputObject) {\n\n    var tmpLine = \"\";\n\n    //Rendering must be performed sequentially.\n    tmpLine = renderer.appendLabel(inputObject, tmpLine);\n    tmpLine = renderer.appendIndentation(inputObject, tmpLine);\n    tmpLine = renderer.appendRoutines(inputObject, tmpLine);\n    tmpLine = renderer.appendComment(inputObject, tmpLine);\n\n    return tmpLine;\n\n}\n\nfunction parse(inputString) {\n\n    //Strip out carriage returns.\n    inputString = inputString.replace(\"\\r\", \"\");\n    var inputArray = inputString.split('\\n');\n    var returnArray = [];\n\n    for (var i = 0; i < inputArray.length; i++) {\n        var tmpLineObject = parseLine(inputArray[i]);\n        tmpLineObject.lineNumber = i + 1;\n        returnArray.push(tmpLineObject);\n    }\n    return returnArray;\n}\n\nfunction render(inputObject) {\n\n    var response = \"\";\n    var parseArray = [];\n\n    if (!Array.isArray(inputObject)) {\n        parseArray.push(inputObject);\n    } else {\n        parseArray = inputObject;\n    }\n\n    for (var i = 0; i < parseArray.length; i++) {\n        var tmpLine = renderLine(parseArray[i]);\n        if (i === (parseArray.length - 1)) {\n            response = response + tmpLine;\n        } else {\n            response = response + tmpLine + \"\\n\";\n        }\n    }\n\n    return response;\n\n}\n\nmodule.exports.parse = parse;\nmodule.exports.render = render;\n","\"use strict\";\n\n//Extract Labels and Lead Spacing.\nfunction extractLabel(inputLine, inputObject) {\n\n    for (var i = 0; i <= inputLine.length; i++) {\n        if (inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\n            //If no leading chars, label.\n            if (i === 0) {\n                inputObject.lineLabel = inputLine.split(/[ \\t]/, 1)[0];\n                for (var ii = inputObject.lineLabel.length; ii <= inputLine.length; ii++) {\n                    //After label spacing.\n                    if (inputLine[ii] !== \" \" && inputLine[ii] !== \"\\t\") {\n                        inputObject.lineLeadSpace = inputLine.substring(inputObject.lineLabel.length, ii);\n                        inputObject.lineExpression = inputLine.substring(ii);\n                        break;\n                    }\n                    //After label spacing for empty lines.\n                    if (ii === (inputLine.length - 1)) {\n                        inputObject.lineLeadSpace = inputLine.substring(inputObject.lineLabel.length);\n                        inputObject.lineExpression = \"\";\n                        break;\n                    }\n                }\n                break;\n                //Unlabeled spacing with code.\n            } else {\n                inputObject.lineLeadSpace = inputLine.substring(0, i);\n                inputObject.lineExpression = inputLine.substring(i);\n                break;\n            }\n        }\n        //Unlabeled spacing without code.\n        if (i === (inputLine.length - 1)) {\n            inputObject.lineLeadSpace = inputLine;\n            inputObject.lineExpression = \"\";\n            break;\n        }\n    }\n    return inputObject;\n}\n\n//Extract Comments.\nfunction extractComment(inputLine, inputObject) {\n\n    //Semicolon identifies comments.\n    if (inputLine.search(\";\") >= 0) {\n        for (var i = 0; i < inputLine.length; i++) {\n            if (inputLine[i] === \";\") {\n                //Check if semicolon is double quoted.\n                if ((inputLine.substring(0, i).split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 !== 0)) {\n                    inputObject.lineExpression = inputLine.substring(0, i);\n                    inputObject.lineComment = inputLine.substring(i).substring(1);\n                    break;\n                } else {\n                    //Check if semicolon has only trailing quote.\n                    if (((inputLine.substring(0, i).replace(\"\").split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 === 0))) {\n                        inputObject.lineExpression = inputLine.substring(0, i);\n                        inputObject.lineComment = inputLine.substring(i).substring(1);\n                        break;\n                    }\n                    //If only quoted semicolons, set expression.\n                    inputObject.lineExpression = inputLine;\n                }\n            }\n        }\n        return inputObject;\n        //If no comments, set expression.\n    } else {\n        inputObject.lineExpression = inputLine;\n        return inputObject;\n    }\n}\n\n//Extract Indentation.\n//Assumes inputLine has extracted comments/spacing.\nfunction extractIndentation(inputLine, inputObject) {\n\n    var lineIndentationArray = [];\n    var lineIndentation = 0;\n    var tmpPosStart = 0;\n    var tmpPosEnd = 0;\n\n    for (var i = 0; i <= inputLine.length; i++) {\n        //Period identifies indentation.\n        if (inputLine[i] === \".\") {\n            //Second period identifies sub-indentation, push to array.\n            if (lineIndentation !== 0) {\n                tmpPosEnd = i;\n                lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n            }\n            //Flag start position and presence.\n            tmpPosStart = i + 1;\n            lineIndentation++;\n        } else {\n            //End of indentation with code.\n            if (inputLine[i] !== \".\" && inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\n                //Make sure a period was found.\n                if (lineIndentation !== 0) {\n                    tmpPosEnd = i;\n                    lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n                    inputObject.lineExpression = inputLine.substring(i);\n                }\n                break;\n            }\n            //End of indentation without code.\n            if (i === (inputLine.length - 1)) {\n                tmpPosEnd = i + 1;\n                lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n                inputObject.lineExpression = inputLine.substring(i + 1);\n                break;\n            }\n        }\n    }\n    //Only assign array if present.\n    if (lineIndentationArray.length > 0) {\n        inputObject.lineIndentationArray = lineIndentationArray;\n    } else {\n        inputObject.lineExpression = inputLine;\n    }\n    return inputObject;\n}\n\n//Divide routines and arguments into array, used by extractRoutines.\nfunction splitRoutinesAndArguments(inputLine) {\n\n    var lineCommands = [];\n    var tmpCursor = 0;\n\n    for (var i = 0; i <= inputLine.length; i++) {\n\n        //Flag spaces/tabs as dividers.\n        if (inputLine[i] === \" \" || inputLine[i] === \"\\t\") {\n            //Ensure space isn't quoted.\n            if ((inputLine.substring(0, i).split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 !== 0)) {\n                //If has content, push.\n                if (inputLine.substring(tmpCursor, i).length > 0) {\n                    lineCommands.push(inputLine.substring(tmpCursor, i));\n                    //Otherwise, push empty commands.\n                } else if (inputLine.substring(tmpCursor, i).length === 0 && (inputLine.substring(tmpCursor - 1, tmpCursor) === \" \" || inputLine.substring(tmpCursor - 1, tmpCursor) === \"\\t\")) {\n                    lineCommands.push(inputLine.substring(tmpCursor, i));\n                }\n                tmpCursor = i + 1;\n            }\n            //Flag splits at line end.\n        } else if (i === inputLine.length) {\n            //If has content, push.\n            if (inputLine.substring(tmpCursor, i).length > 0) {\n                lineCommands.push(inputLine.substring(tmpCursor, i));\n                //Gather empty commands from end of line.\n            } else if (i === tmpCursor && (inputLine.substring(i - 1, i) === \" \" || inputLine.substring(i - 1, i) === \"/t\")) {\n                lineCommands.push('');\n            }\n            //tmpCursor = 0;\n        }\n    }\n    return lineCommands;\n}\n\n//Extracts Post-Conditionals from Routines, used by extractRoutines.\nfunction extractPostConditional(inputObject) {\n\n    //Assign to new variable to truncate Routines.\n    var tmpObject = inputObject;\n    for (var i = 0; i < tmpObject.length; i++) {\n        if (tmpObject[i].mRoutine) {\n            //Semicolon indicates Post-Conditionals.\n            var tmpIndex = tmpObject[i].mRoutine.indexOf(\":\");\n            if (tmpIndex > -1) {\n                tmpObject[i].mPostConditional = tmpObject[i].mRoutine.substring(tmpIndex + 1);\n                tmpObject[i].mRoutine = tmpObject[i].mRoutine.substring(0, tmpIndex);\n            }\n        }\n    }\n    return tmpObject;\n}\n\n//Extract Routines.\n//Assumes inputLine has extracted comments/spacing/indentation.\nfunction extractRoutines(inputLine, inputObject) {\n\n    var tmpFunction = {};\n    var tmpFunctionArray = [];\n\n    //Divide Routines and Arguments.\n    var splitLine = splitRoutinesAndArguments(inputLine);\n\n    //Loop, even is function, odd is arguments.\n    var i = 0;\n    while (i < splitLine.length) {\n\n        if (i % 2 === 0) {\n            tmpFunction.mRoutine = splitLine[i];\n        } else {\n\n            tmpFunction.mArguments = splitLine[i];\n\n            //Custom handler for trailing argument spacing.\n            //Go until splitline hits a non empty val.\n            var ii = i + 1;\n            while (ii < splitLine.length) {\n                if (splitLine[ii] === \"\") {\n                    splitLine.splice(ii, 1);\n                    tmpFunction.mArguments = tmpFunction.mArguments + \" \";\n                } else {\n                    break;\n                }\n            }\n\n            tmpFunctionArray.push(tmpFunction);\n            tmpFunction = {};\n\n        }\n\n        //Last command doesn't always require parameter, so if odd number of pairs, push it.\n        if (splitLine.length % 2 !== 0 && splitLine.length > 0 && i === (splitLine.length - 1)) {\n            tmpFunction.mRoutine = splitLine[i];\n            tmpFunctionArray.push(tmpFunction);\n            tmpFunction = {};\n        }\n\n        i++;\n\n    }\n\n    //Extract and output Post Conditionals.\n    var postConditionFunctionArray = extractPostConditional(tmpFunctionArray);\n    if (postConditionFunctionArray.length > 0) {\n        inputObject.lineRoutines = postConditionFunctionArray;\n    }\n    return inputObject;\n}\n\n//Export all routines.\nmodule.exports.extractLabel = extractLabel;\nmodule.exports.extractComment = extractComment;\nmodule.exports.extractIndentation = extractIndentation;\nmodule.exports.splitRoutinesAndArguments = splitRoutinesAndArguments;\nmodule.exports.extractPostConditional = extractPostConditional;\nmodule.exports.extractRoutines = extractRoutines;\n","\"use strict\";\n\n//Append Line Label and Lead Spacing.\nfunction appendLabel(inputObject, inputLine) {\n    if (inputObject.lineLabel) {\n        inputLine = inputLine + inputObject.lineLabel;\n    }\n    if (inputObject.lineLeadSpace) {\n        inputLine = inputLine + inputObject.lineLeadSpace;\n    }\n    return inputLine;\n}\n\n//Append Indentation to Label/Spacing.\nfunction appendIndentation(inputObject, inputLine) {\n    var tmpIndentation = \"\";\n    if (inputObject.lineIndentationArray) {\n        if (inputObject.lineIndentationArray.length > 0) {\n            for (var i in inputObject.lineIndentationArray) {\n                tmpIndentation = tmpIndentation + \".\" + inputObject.lineIndentationArray[i];\n            }\n            inputLine = inputLine + tmpIndentation;\n        }\n    }\n    return inputLine;\n}\n\n//Append Routines to Label/Spacing/Indentation.\nfunction appendRoutines(inputObject, inputLine) {\n    if (inputObject.lineRoutines) {\n        for (var i in inputObject.lineRoutines) {\n            if (inputObject.lineRoutines[i].mRoutine || inputObject.lineRoutines[i].mRoutine === \"\") {\n                //Leave off interval spacing for first Routine.\n                if (i === \"0\") {\n                    inputLine = inputLine + inputObject.lineRoutines[i].mRoutine;\n                } else {\n                    inputLine = inputLine + \" \" + inputObject.lineRoutines[i].mRoutine;\n                }\n                //Append Post-Conditional.\n                if (inputObject.lineRoutines[i].mPostConditional) {\n                    inputLine = inputLine + \":\" + inputObject.lineRoutines[i].mPostConditional;\n                }\n                //Append Arguments.\n                if (inputObject.lineRoutines[i].hasOwnProperty(\"mArguments\")) {\n                    inputLine = inputLine + \" \" + inputObject.lineRoutines[i].mArguments;\n                }\n            }\n        }\n    }\n    return inputLine;\n}\n\n//Append Comment.\nfunction appendComment(inputObject, inputLine) {\n    if (inputObject.hasOwnProperty(\"lineComment\")) {\n        inputLine = inputLine + \";\" + inputObject.lineComment;\n    }\n    return inputLine;\n}\n\n//Export all Routines.\nmodule.exports.appendLabel = appendLabel;\nmodule.exports.appendIndentation = appendIndentation;\nmodule.exports.appendRoutines = appendRoutines;\nmodule.exports.appendComment = appendComment;\n","import * as vscode from 'vscode';\r\nimport {TokenType, MumpsLineParser} from './mumpsLineParser'\r\nconst tokenModifiers = ['standard'];\r\nconst subtype=\"standard\";\r\nconst tokentypes:string[]=Object.values(TokenType);\r\nconst SemanticTokens = new vscode.SemanticTokensLegend(tokentypes, tokenModifiers);\r\nconst parser = new MumpsLineParser();\r\n//type: \"global\" | \"local\" | \"exfunction\" | \"nonMfunction\" | \"entryref\" | \"operator\" |\r\n//      \"keyword\" | \"ifunction\" | \"label\" | \"comment\" | \"sysvariable\" | \"string\" | \"number\",\r\n\r\n\r\nconst MumpsHighlighter: vscode.DocumentSemanticTokensProvider = {\r\n  provideDocumentSemanticTokens(\r\n    document: vscode.TextDocument\r\n  ): vscode.ProviderResult<vscode.SemanticTokens> {\r\n    // analyze the document and return semantic tokens\r\n\t\tconst text = document.getText();\r\n\t\tconst result = parser.analyzeLines(text);\r\n\t\tconst tokensBuilder = new vscode.SemanticTokensBuilder(SemanticTokens);\r\n\t\tfor (let line=0;line<result.length;line++) {\r\n\t\t\tlet tokens=result[line];\r\n\t\t\tfor (let tokenId=0;tokenId<tokens.length;tokenId++) {\r\n\t\t\t\tlet t=tokens[tokenId];\r\n\t\t\t\tlet type=t.type;\r\n\t\t\t\tif (type===\"exfunction\") {\r\n\t\t\t\t\tt.position-=2;\t\t\t//Correct Position because of leading $$\r\n\t\t\t\t\tt.name=\"$$\"+t.name;\r\n\t\t\t\t}\r\n\t\t\t\tif (t.position<0) {\r\n\t\t\t\t\tconsole.log(tokens);\r\n\t\t\t\t}\r\n\t\t\t\ttokensBuilder.push(\r\n\t\t\t\t\tnew vscode.Range(new vscode.Position(line,t.position), new vscode.Position(line, t.position+t.name.length)),\r\n\t\t\t\t  type, [subtype]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n    return tokensBuilder.build();\r\n  }\r\n};\r\n\r\nexport {MumpsHighlighter, SemanticTokens}\r\n"],"sourceRoot":""}