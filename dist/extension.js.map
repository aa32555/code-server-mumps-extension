{"version":3,"sources":["../webpack/bootstrap","../external \"vscode\"","../external \"fs\"","../external \"path\"",".././node_modules/vscode-debugadapter/lib/debugSession.js",".././node_modules/vscode-debugadapter/lib/messages.js",".././src/mumps-language-token.ts","../external \"events\"","../external \"net\"",".././node_modules/vscode-debugadapter/lib/logger.js",".././src/mumps-documenter.ts",".././src/extension.ts",".././src/mumpsDebug.ts",".././node_modules/vscode-debugadapter/lib/main.js",".././node_modules/vscode-debugadapter/lib/protocol.js","../external \"url\"",".././node_modules/vscode-debugadapter/lib/loggingDebugSession.js",".././node_modules/mkdirp/index.js",".././node_modules/vscode-debugadapter/lib/handles.js",".././node_modules/await-notify/index.js",".././src/mconnect.ts",".././src/mumps-hover-provider.ts",".././src/mumps-label-lookup.ts",".././src/mumps-definition-provider.ts",".././src/mumps-signature-help-provider.ts",".././src/mumps-document.ts",".././src/parser/parser.ts",".././src/parser/tokenizer.ts",".././src/mumps-completion-item-provider.ts",".././src/mumps-autospace.ts",".././node_modules/emcellent/index.js",".././node_modules/emcellent/lib/parse.js",".././node_modules/emcellent/lib/render.js",".././src/mumpsLineParser.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","protocol_1","messages_1","Net","url_1","Source","path","id","origin","data","this","sourceReference","adapterData","Scope","reference","expensive","variablesReference","StackFrame","nm","src","ln","col","source","line","column","Thread","Variable","ref","indexedVariables","namedVariables","Breakpoint","verified","e","Module","CompletionItem","label","start","length","StoppedEvent","Event","reason","threadId","exceptionText","super","body","text","ContinuedEvent","allThreadsContinued","InitializedEvent","TerminatedEvent","restart","OutputEvent","output","category","undefined","ThreadEvent","BreakpointEvent","breakpoint","ModuleEvent","LoadedSourceEvent","CapabilitiesEvent","capabilities","ErrorDestination","DebugSession","ProtocolServer","obsolete_debuggerLinesAndColumnsStartAt1","obsolete_isServer","linesAndColumnsStartAt1","_debuggerLinesStartAt1","_debuggerColumnsStartAt1","_debuggerPathsAreURIs","_clientLinesStartAt1","_clientColumnsStartAt1","_clientPathsAreURIs","_isServer","on","shutdown","error","format","enable","debugSession","port","process","argv","slice","forEach","val","index","array","portMatch","exec","parseInt","console","createServer","socket","session","setRunAsServer","listen","stdin","stdout","_isRunningInline","setTimeout","exit","response","codeOrMessage","variables","dest","User","msg","showUser","Telemetry","sendTelemetry","success","message","formatPII","sendResponse","args","timeout","cb","sendRequest","request","Response","command","arguments","linesStartAt1","columnsStartAt1","pathFormat","sendErrorResponse","initializeResponse","initializeRequest","launchRequest","attachRequest","disconnectRequest","terminateRequest","restartRequest","setBreakPointsRequest","setFunctionBreakPointsRequest","setExceptionBreakPointsRequest","configurationDoneRequest","continueRequest","nextRequest","stepInRequest","stepOutRequest","stepBackRequest","reverseContinueRequest","restartFrameRequest","gotoRequest","pauseRequest","stackTraceRequest","scopesRequest","variablesRequest","setVariableRequest","setExpressionRequest","sourceRequest","threadsRequest","terminateThreadsRequest","evaluateRequest","stepInTargetsRequest","gotoTargetsRequest","completionsRequest","exceptionInfoRequest","loadedSourcesRequest","dataBreakpointInfoRequest","setDataBreakpointsRequest","readMemoryRequest","disassembleRequest","cancelRequest","breakpointLocationsRequest","customRequest","_exception","_stack","stack","supportsConditionalBreakpoints","supportsHitConditionalBreakpoints","supportsFunctionBreakpoints","supportsConfigurationDoneRequest","supportsEvaluateForHovers","supportsStepBack","supportsSetVariable","supportsRestartFrame","supportsStepInTargetsRequest","supportsGotoTargetsRequest","supportsCompletionsRequest","supportsRestartRequest","supportsExceptionOptions","supportsValueFormattingOptions","supportsExceptionInfoRequest","supportTerminateDebuggee","supportsDelayedStackTraceLoading","supportsLoadedSourcesRequest","supportsLogPoints","supportsTerminateThreadsRequest","supportsSetExpression","supportsTerminateRequest","supportsDataBreakpoints","supportsReadMemoryRequest","supportsDisassembleRequest","supportsCancelRequest","supportsBreakpointLocationsRequest","clientPath","uri2path","path2uri","debuggerPath","platform","test","toLowerCase","substr","replace","encodeURI","uri","URL","pathname","toString","sourceUri","decodeURIComponent","excludePII","_formatPIIRegexp","match","paramName","Message","type","seq","request_seq","event","definitionsArray","definitions","isWhitespace","char","withoutFirstCharacter","string","substring","formatParameter","parameter","first","optional","addDefinition","definition","push","MumpsToken","document","position","range","getWordRangeAtPosition","word","getText","surroundWord","character","vscode","Position","end","Range","charAt","extendedWord","getWordWithSurrounds","isIntrinsic","lastChar","_isLabelReference","lineAt","RegExp","fullLabel","parts","labelOffset","Number","labelProgram","referredToLabel","lookupLabelReference","_definition","matches","toUpperCase","isFunctionCall","isLabelReference","createDefinitionForLabelReference","functionSignature","signature","parameters","returns","formatFunctionSignature","abbreviation","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","apply","fs","mkdirp","debugSession_1","LogLevel","Logger","_pendingLogQ","level","Log","_write","log","Verbose","Warn","Error","_currentLogger","disposeP","dispose","consoleMinLogLevel","_logFilePath","prependTimestamp","logFilePath","_logFilePathFromInit","options","setup","logQ","item","logCallback","logToConsole","InternalLogger","logger","isServer","beforeExitCallback","_logCallback","_logToConsole","_minLogLevel","disposeCallback","signal","code","_prependTimestamp","isAbsolute","handleError","err","sendLog","folder","dirname","_logFileStream","createWriteStream","logDateTime","setupShutdownListeners","Date","timeAndDateStamp","getUTCFullYear","getUTCMonth","getUTCDate","getFormattedTimeString","addListener","removeListener","removeShutdownListeners","Stop","logFn","warn","trimLastNewline","write","endsInNewline","LogOutputEvent","str","_padZeroes","String","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","minDesiredLength","numberToPad","repeat","lineIsFunctionSig","makeSignature","labelLine","Signature","split","element","DocumentFunction","editor","window","activeTextEditor","InsertPosition","selection","with","lineCount","translate","txt","edit","editBuilder","insert","getSigInfo","referredTo","parametersByName","description","param","paramDescription","parser","MumpsLineParser","context","MUMPS_MODE","language","scheme","mumpsDiagnostics","languages","createDiagnosticCollection","subscriptions","commands","registerCommand","showInputBox","placeHolder","storage","storagePath","existsSync","mkdirSync","dbfile","AutospaceFunction","autoSpaceEnter","autoSpaceTab","registerHoverProvider","MumpsHoverProvider","registerDefinitionProvider","MumpsDefinitionProvider","registerSignatureHelpProvider","MumpsSignatureHelpProvider","registerDocumentSymbolProvider","MumpsDocumentSymbolProvider","registerCompletionItemProvider","CompletionItemProvider","registerDocumentFormattingEditProvider","provideDocumentFormattingEdits","token","textEdits","formatDocumentLine","registerDocumentRangeFormattingEditProvider","provideDocumentRangeFormattingEdits","debug","registerDebugConfigurationProvider","MumpsConfigurationProvider","registerDebugAdapterDescriptorFactory","InlineDebugAdapterFactory","onDidChangeActiveTextEditor","triggerUpdateDiagnostics","workspace","onDidChangeTextDocument","registerEvaluatableExpressionProvider","diags","find","diag","contains","lineContent","expression","EvaluatableExpression","config","languageId","program","stopOnEntry","hostname","localRoutinesPath","showInformationMessage","_","_session","DebugAdapterInlineImplementation","MumpsDebugSession","lineNumber","TextEdit","endsWith","startsWith","endSpace","collection","clearTimeout","clear","checkLine","set","severity","DiagnosticSeverity","updateDiagnostics","Subject","MUMPSDIAGNOSTICS","LoggingDebugSession","_variableHandles","Handles","_configurationDone","setDebuggerLinesStartAt1","setDebuggerColumnsStartAt1","_program","_mconnect","MConnect","sendEvent","THREAD_ID","errortext","bp","filePath","createSource","convertDebuggerLineToClient","convertDebuggerColumnToClient","completionTriggerCharacters","notify","trace","wait","init","refreshDiagnostics","catch","showErrorMessage","clientLines","lines","clearBreakpoints","actualBreakpoints","map","setBreakPoint","convertClientLineToDebugger","breakpoints","requestBreakpoints","threads","startFrame","endFrame","levels","stk","stackFrames","frames","f","file","totalFrames","count","scopes","insertVariable","varId","varObject","getVariables","varname","varparts","indexCount","pop","varBase","join","lastVar","firstTime","lastRef","actualVar","varAnalyze","checkVars","bases","dummyVar","returnVar","actualReference","content","continue","getSingleVar","varReply","sourceLines","readFileSync","checkRoutine","errorLines","disconnect","basename","convertDebuggerPathToClient","indexcount","klammerpos","indexOf","countKomma","doc","diagnostics","lineIndex","lineOfText","errLines","errData","isNaN","endColumn","diagnostic","Diagnostic","loggingDebugSession_1","handles_1","ee","Emitter","_event","listener","_listener","_this","EventEmitter","_sendMessage","_pendingRequests","Map","onDidSendMessage","dispatchRequest","clb","delete","hasListener","inStream","outStream","_sequence","_writableStream","_rawData","Buffer","_handleData","_emitEvent","resume","_send","keys","timer","emit","typ","json","JSON","stringify","byteLength","fire","concat","_contentLength","parse","handleMessage","idx","TWO_CRLF","pair","obsolete_logFilePath","objectToLog","doNotLogOutput","assign","verbose","_0777","mkdirP","opts","made","xfs","umask","mkdir","er","stat","er2","isDirectory","sync","err0","statSync","err1","startHandle","START_HANDLE","_handleMap","_nextHandle","handle","dflt","waiters","self","waiter","promise","resolved","noRemove","pos","splice","isFinite","notifyAll","_currentLine","_breakpointId","_logging","_singleVar","_singleVarContent","_commandQueue","_socket","Socket","_connectState","_readedData","_mVars","_mStack","_activeBreakpoints","_breakPoints","_errorLines","_hints","internals","checkEvents","_localRoutinesPath","_hostname","_port","connect","_log","chunk","processLine","vartype","verifyBreakpoints","writable","shift","onOff","writeln","stopAtStart","sendBreakpoint","mumpsposition","mumpsstatus","loadSource","startlabel","offset","_sourceLines","filter","_sourceFile","Array","fileposition","convertMumpsPosition","Math","min","bps","findIndex","merk","internalBp","part","HintsReceived","hints","ErrorreportReceived","reply","SingleVarReceived","singleVar","singleVarContent","positionstring","filecontent","setImmediate","Hover","mayBeCommand","snippet","Uri","EXTENSIONS","cache","siblingUri","fileName","siblingPath","fsPath","extension","extendedPath","commentText","j","findReferredToLabel","autoDoc","Location","ParameterInformation","SignatureHelp","SignatureInformation","depth","getFunctionToken","documentation","createSignatureInformation","help","signatures","activeSignature","activeParameter","lineText","parametersStartIndex","insertIndex","active","calculateActiveParameter","parsedDoc","parseText","symbols","methods","method","kind","SymbolKind","Function","startPosition","endPostionLine","endLine","endPosition","methodRange","SymbolInformation","MemberClass","Method","declarations","memberClass","Parameter","sourceText","Parser","parseDocument","tokenizer","tokens","activeToken","documentText","getTokens","isAlphanumeric","parseMethod","activeMethod","isTab","isSpace","tokenBuffer","loadTokenBuffer","nextLine","checkForDocumentation","isNewLine","throwAwayTokensTil","isLineCommentInit","isLineComment","isOpenParen","processed","processParameters","prevLine","isCloseParen","closeParen","open","comment","isComma","documentContents","Tokenizer","charType","getType","tokenType","parsed","parseCharacter","finalizedToken","finalizeToken","Token","documentLine","documentColumn","tokenValue","tokenPosition","stringOpen","firstSlash","asterisk","updateTokenAndAdvanceCursor","newType","charCode","charCodeAt","Type","labeldb","_labelsReady","_dbfile","_refreshLabelDB","status","lineStatus","lookPosition","lastCommand","startstring","isInsidePostcond","isWhiteSpace","isBeginOfVariable","isAlphaChar","getLineStatus","clean","_findLabel","db","labels","routine","routines","writeFileSync","readFile","_labelDB","dbChanged","findFiles","files","_filesToCheck","stats","_checkReady","ms","mtimeMs","size","_refreshFileLabels","writeFile","list","hitlist","sortText","suchstring","routinepart","detail","em","currentLine","newLine","lineRoutines","lineIndentationArray","render","cmds","mRoutine","mArguments","lineContainsNoParamDo","lineComment","lineLabel","eb","renderer","parseLine","inputString","tmpObject","extractLabel","extractComment","lineExpression","extractIndentation","extractRoutines","renderLine","inputObject","tmpLine","appendLabel","appendIndentation","appendRoutines","appendComment","inputArray","returnArray","tmpLineObject","parseArray","isArray","splitRoutinesAndArguments","inputLine","lineCommands","tmpCursor","extractPostConditional","tmpIndex","mPostConditional","ii","lineLeadSpace","search","lineIndentation","tmpPosStart","tmpPosEnd","tmpFunction","tmpFunctionArray","splitLine","postConditionFunctionArray","tmpIndentation","lvn","gvn","isv","ifunction","nonMfunction","entryref","routineref","numlit","strlit","binoperator","unaryoperator","patcode","repititionCount","openkeywords","usekeywords","closekeywords","jobkeywords","tstartkeywords","cmdExpansions","funcExpansions","cmdParams","funcParams","expressiontype","names","pattern","patternComplete","evaluateExpression","repCount","_evaluatePattern","exType","expressionComplete","startposition","lastExpression","subExType","evalString","localname","_insertName","operator","provResult","_checkVar","_checkEntryRef","functionname","_checkFunction","expressionPosition","errorText","errorPosition","isInsideString","spacer","_splitCommandsAndArguments","mCommand","mPostCondition","cmdPosition","argPosition","pcPosition","_extractPostConditional","_extractLabel","_extractComment","_extractIndentation","_extractCommands","filename","errlist","info","cmd","longcmd","_checkCommand","arg","withParams","globalOk","indexOk","indexFound","globalFound","indirectionFound","varFound","global","local","keywords","keyword","braceComplete","_checkKeyword","argNumber","stringlit","_checkJobKeyword","isLock","mat","starDetected","isBraced","_checkWriteSocket","fname","maxparams","paramCount","para","postcondPossible","postcondition","argFormat","argCount","_checkBreak","_checkOUC","_checkEntryRefAndPostcondition","_checkFor","_checkJob","_checkKill","_checkLock","_checkMerge","_checkNew","_checkRead","_checkSet","_checkTstart","_checkView","_checkWrite","_checkXecute","_checkZbreak","_checkZprint","_checkZstep","longfunc","params","minArguments","minparams","formats"],"mappings":"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","file":"extension.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","module.exports = require(\"vscode\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst protocol_1 = require(\"./protocol\");\nconst messages_1 = require(\"./messages\");\nconst Net = require(\"net\");\nconst url_1 = require(\"url\");\nclass Source {\n    constructor(name, path, id = 0, origin, data) {\n        this.name = name;\n        this.path = path;\n        this.sourceReference = id;\n        if (origin) {\n            this.origin = origin;\n        }\n        if (data) {\n            this.adapterData = data;\n        }\n    }\n}\nexports.Source = Source;\nclass Scope {\n    constructor(name, reference, expensive = false) {\n        this.name = name;\n        this.variablesReference = reference;\n        this.expensive = expensive;\n    }\n}\nexports.Scope = Scope;\nclass StackFrame {\n    constructor(i, nm, src, ln = 0, col = 0) {\n        this.id = i;\n        this.source = src;\n        this.line = ln;\n        this.column = col;\n        this.name = nm;\n    }\n}\nexports.StackFrame = StackFrame;\nclass Thread {\n    constructor(id, name) {\n        this.id = id;\n        if (name) {\n            this.name = name;\n        }\n        else {\n            this.name = 'Thread #' + id;\n        }\n    }\n}\nexports.Thread = Thread;\nclass Variable {\n    constructor(name, value, ref = 0, indexedVariables, namedVariables) {\n        this.name = name;\n        this.value = value;\n        this.variablesReference = ref;\n        if (typeof namedVariables === 'number') {\n            this.namedVariables = namedVariables;\n        }\n        if (typeof indexedVariables === 'number') {\n            this.indexedVariables = indexedVariables;\n        }\n    }\n}\nexports.Variable = Variable;\nclass Breakpoint {\n    constructor(verified, line, column, source) {\n        this.verified = verified;\n        const e = this;\n        if (typeof line === 'number') {\n            e.line = line;\n        }\n        if (typeof column === 'number') {\n            e.column = column;\n        }\n        if (source) {\n            e.source = source;\n        }\n    }\n}\nexports.Breakpoint = Breakpoint;\nclass Module {\n    constructor(id, name) {\n        this.id = id;\n        this.name = name;\n    }\n}\nexports.Module = Module;\nclass CompletionItem {\n    constructor(label, start, length = 0) {\n        this.label = label;\n        this.start = start;\n        this.length = length;\n    }\n}\nexports.CompletionItem = CompletionItem;\nclass StoppedEvent extends messages_1.Event {\n    constructor(reason, threadId, exceptionText) {\n        super('stopped');\n        this.body = {\n            reason: reason\n        };\n        if (typeof threadId === 'number') {\n            this.body.threadId = threadId;\n        }\n        if (typeof exceptionText === 'string') {\n            this.body.text = exceptionText;\n        }\n    }\n}\nexports.StoppedEvent = StoppedEvent;\nclass ContinuedEvent extends messages_1.Event {\n    constructor(threadId, allThreadsContinued) {\n        super('continued');\n        this.body = {\n            threadId: threadId\n        };\n        if (typeof allThreadsContinued === 'boolean') {\n            this.body.allThreadsContinued = allThreadsContinued;\n        }\n    }\n}\nexports.ContinuedEvent = ContinuedEvent;\nclass InitializedEvent extends messages_1.Event {\n    constructor() {\n        super('initialized');\n    }\n}\nexports.InitializedEvent = InitializedEvent;\nclass TerminatedEvent extends messages_1.Event {\n    constructor(restart) {\n        super('terminated');\n        if (typeof restart === 'boolean' || restart) {\n            const e = this;\n            e.body = {\n                restart: restart\n            };\n        }\n    }\n}\nexports.TerminatedEvent = TerminatedEvent;\nclass OutputEvent extends messages_1.Event {\n    constructor(output, category = 'console', data) {\n        super('output');\n        this.body = {\n            category: category,\n            output: output\n        };\n        if (data !== undefined) {\n            this.body.data = data;\n        }\n    }\n}\nexports.OutputEvent = OutputEvent;\nclass ThreadEvent extends messages_1.Event {\n    constructor(reason, threadId) {\n        super('thread');\n        this.body = {\n            reason: reason,\n            threadId: threadId\n        };\n    }\n}\nexports.ThreadEvent = ThreadEvent;\nclass BreakpointEvent extends messages_1.Event {\n    constructor(reason, breakpoint) {\n        super('breakpoint');\n        this.body = {\n            reason: reason,\n            breakpoint: breakpoint\n        };\n    }\n}\nexports.BreakpointEvent = BreakpointEvent;\nclass ModuleEvent extends messages_1.Event {\n    constructor(reason, module) {\n        super('module');\n        this.body = {\n            reason: reason,\n            module: module\n        };\n    }\n}\nexports.ModuleEvent = ModuleEvent;\nclass LoadedSourceEvent extends messages_1.Event {\n    constructor(reason, source) {\n        super('loadedSource');\n        this.body = {\n            reason: reason,\n            source: source\n        };\n    }\n}\nexports.LoadedSourceEvent = LoadedSourceEvent;\nclass CapabilitiesEvent extends messages_1.Event {\n    constructor(capabilities) {\n        super('capabilities');\n        this.body = {\n            capabilities: capabilities\n        };\n    }\n}\nexports.CapabilitiesEvent = CapabilitiesEvent;\nvar ErrorDestination;\n(function (ErrorDestination) {\n    ErrorDestination[ErrorDestination[\"User\"] = 1] = \"User\";\n    ErrorDestination[ErrorDestination[\"Telemetry\"] = 2] = \"Telemetry\";\n})(ErrorDestination = exports.ErrorDestination || (exports.ErrorDestination = {}));\n;\nclass DebugSession extends protocol_1.ProtocolServer {\n    constructor(obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer) {\n        super();\n        const linesAndColumnsStartAt1 = typeof obsolete_debuggerLinesAndColumnsStartAt1 === 'boolean' ? obsolete_debuggerLinesAndColumnsStartAt1 : false;\n        this._debuggerLinesStartAt1 = linesAndColumnsStartAt1;\n        this._debuggerColumnsStartAt1 = linesAndColumnsStartAt1;\n        this._debuggerPathsAreURIs = false;\n        this._clientLinesStartAt1 = true;\n        this._clientColumnsStartAt1 = true;\n        this._clientPathsAreURIs = false;\n        this._isServer = typeof obsolete_isServer === 'boolean' ? obsolete_isServer : false;\n        this.on('close', () => {\n            this.shutdown();\n        });\n        this.on('error', (error) => {\n            this.shutdown();\n        });\n    }\n    setDebuggerPathFormat(format) {\n        this._debuggerPathsAreURIs = format !== 'path';\n    }\n    setDebuggerLinesStartAt1(enable) {\n        this._debuggerLinesStartAt1 = enable;\n    }\n    setDebuggerColumnsStartAt1(enable) {\n        this._debuggerColumnsStartAt1 = enable;\n    }\n    setRunAsServer(enable) {\n        this._isServer = enable;\n    }\n    /**\n     * A virtual constructor...\n     */\n    static run(debugSession) {\n        // parse arguments\n        let port = 0;\n        const args = process.argv.slice(2);\n        args.forEach(function (val, index, array) {\n            const portMatch = /^--server=(\\d{4,5})$/.exec(val);\n            if (portMatch) {\n                port = parseInt(portMatch[1], 10);\n            }\n        });\n        if (port > 0) {\n            // start as a server\n            console.error(`waiting for debug protocol on port ${port}`);\n            Net.createServer((socket) => {\n                console.error('>> accepted connection from client');\n                socket.on('end', () => {\n                    console.error('>> client connection closed\\n');\n                });\n                const session = new debugSession(false, true);\n                session.setRunAsServer(true);\n                session.start(socket, socket);\n            }).listen(port);\n        }\n        else {\n            // start a session\n            //console.error('waiting for debug protocol on stdin/stdout');\n            const session = new debugSession(false);\n            process.on('SIGTERM', () => {\n                session.shutdown();\n            });\n            session.start(process.stdin, process.stdout);\n        }\n    }\n    shutdown() {\n        if (this._isServer || this._isRunningInline()) {\n            // shutdown ignored in server mode\n        }\n        else {\n            // wait a bit before shutting down\n            setTimeout(() => {\n                process.exit(0);\n            }, 100);\n        }\n    }\n    sendErrorResponse(response, codeOrMessage, format, variables, dest = ErrorDestination.User) {\n        let msg;\n        if (typeof codeOrMessage === 'number') {\n            msg = {\n                id: codeOrMessage,\n                format: format\n            };\n            if (variables) {\n                msg.variables = variables;\n            }\n            if (dest & ErrorDestination.User) {\n                msg.showUser = true;\n            }\n            if (dest & ErrorDestination.Telemetry) {\n                msg.sendTelemetry = true;\n            }\n        }\n        else {\n            msg = codeOrMessage;\n        }\n        response.success = false;\n        response.message = DebugSession.formatPII(msg.format, true, msg.variables);\n        if (!response.body) {\n            response.body = {};\n        }\n        response.body.error = msg;\n        this.sendResponse(response);\n    }\n    runInTerminalRequest(args, timeout, cb) {\n        this.sendRequest('runInTerminal', args, timeout, cb);\n    }\n    dispatchRequest(request) {\n        const response = new messages_1.Response(request);\n        try {\n            if (request.command === 'initialize') {\n                var args = request.arguments;\n                if (typeof args.linesStartAt1 === 'boolean') {\n                    this._clientLinesStartAt1 = args.linesStartAt1;\n                }\n                if (typeof args.columnsStartAt1 === 'boolean') {\n                    this._clientColumnsStartAt1 = args.columnsStartAt1;\n                }\n                if (args.pathFormat !== 'path') {\n                    this.sendErrorResponse(response, 2018, 'debug adapter only supports native paths', null, ErrorDestination.Telemetry);\n                }\n                else {\n                    const initializeResponse = response;\n                    initializeResponse.body = {};\n                    this.initializeRequest(initializeResponse, args);\n                }\n            }\n            else if (request.command === 'launch') {\n                this.launchRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'attach') {\n                this.attachRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'disconnect') {\n                this.disconnectRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'terminate') {\n                this.terminateRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'restart') {\n                this.restartRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setBreakpoints') {\n                this.setBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setFunctionBreakpoints') {\n                this.setFunctionBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setExceptionBreakpoints') {\n                this.setExceptionBreakPointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'configurationDone') {\n                this.configurationDoneRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'continue') {\n                this.continueRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'next') {\n                this.nextRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepIn') {\n                this.stepInRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepOut') {\n                this.stepOutRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepBack') {\n                this.stepBackRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'reverseContinue') {\n                this.reverseContinueRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'restartFrame') {\n                this.restartFrameRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'goto') {\n                this.gotoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'pause') {\n                this.pauseRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stackTrace') {\n                this.stackTraceRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'scopes') {\n                this.scopesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'variables') {\n                this.variablesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setVariable') {\n                this.setVariableRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setExpression') {\n                this.setExpressionRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'source') {\n                this.sourceRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'threads') {\n                this.threadsRequest(response, request);\n            }\n            else if (request.command === 'terminateThreads') {\n                this.terminateThreadsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'evaluate') {\n                this.evaluateRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'stepInTargets') {\n                this.stepInTargetsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'gotoTargets') {\n                this.gotoTargetsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'completions') {\n                this.completionsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'exceptionInfo') {\n                this.exceptionInfoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'loadedSources') {\n                this.loadedSourcesRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'dataBreakpointInfo') {\n                this.dataBreakpointInfoRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'setDataBreakpoints') {\n                this.setDataBreakpointsRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'readMemory') {\n                this.readMemoryRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'disassemble') {\n                this.disassembleRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'cancel') {\n                this.cancelRequest(response, request.arguments, request);\n            }\n            else if (request.command === 'breakpointLocations') {\n                this.breakpointLocationsRequest(response, request.arguments, request);\n            }\n            else {\n                this.customRequest(request.command, response, request.arguments, request);\n            }\n        }\n        catch (e) {\n            this.sendErrorResponse(response, 1104, '{_stack}', { _exception: e.message, _stack: e.stack }, ErrorDestination.Telemetry);\n        }\n    }\n    initializeRequest(response, args) {\n        // This default debug adapter does not support conditional breakpoints.\n        response.body.supportsConditionalBreakpoints = false;\n        // This default debug adapter does not support hit conditional breakpoints.\n        response.body.supportsHitConditionalBreakpoints = false;\n        // This default debug adapter does not support function breakpoints.\n        response.body.supportsFunctionBreakpoints = false;\n        // This default debug adapter implements the 'configurationDone' request.\n        response.body.supportsConfigurationDoneRequest = true;\n        // This default debug adapter does not support hovers based on the 'evaluate' request.\n        response.body.supportsEvaluateForHovers = false;\n        // This default debug adapter does not support the 'stepBack' request.\n        response.body.supportsStepBack = false;\n        // This default debug adapter does not support the 'setVariable' request.\n        response.body.supportsSetVariable = false;\n        // This default debug adapter does not support the 'restartFrame' request.\n        response.body.supportsRestartFrame = false;\n        // This default debug adapter does not support the 'stepInTargets' request.\n        response.body.supportsStepInTargetsRequest = false;\n        // This default debug adapter does not support the 'gotoTargets' request.\n        response.body.supportsGotoTargetsRequest = false;\n        // This default debug adapter does not support the 'completions' request.\n        response.body.supportsCompletionsRequest = false;\n        // This default debug adapter does not support the 'restart' request.\n        response.body.supportsRestartRequest = false;\n        // This default debug adapter does not support the 'exceptionOptions' attribute on the 'setExceptionBreakpoints' request.\n        response.body.supportsExceptionOptions = false;\n        // This default debug adapter does not support the 'format' attribute on the 'variables', 'evaluate', and 'stackTrace' request.\n        response.body.supportsValueFormattingOptions = false;\n        // This debug adapter does not support the 'exceptionInfo' request.\n        response.body.supportsExceptionInfoRequest = false;\n        // This debug adapter does not support the 'TerminateDebuggee' attribute on the 'disconnect' request.\n        response.body.supportTerminateDebuggee = false;\n        // This debug adapter does not support delayed loading of stack frames.\n        response.body.supportsDelayedStackTraceLoading = false;\n        // This debug adapter does not support the 'loadedSources' request.\n        response.body.supportsLoadedSourcesRequest = false;\n        // This debug adapter does not support the 'logMessage' attribute of the SourceBreakpoint.\n        response.body.supportsLogPoints = false;\n        // This debug adapter does not support the 'terminateThreads' request.\n        response.body.supportsTerminateThreadsRequest = false;\n        // This debug adapter does not support the 'setExpression' request.\n        response.body.supportsSetExpression = false;\n        // This debug adapter does not support the 'terminate' request.\n        response.body.supportsTerminateRequest = false;\n        // This debug adapter does not support data breakpoints.\n        response.body.supportsDataBreakpoints = false;\n        /** This debug adapter does not support the 'readMemory' request. */\n        response.body.supportsReadMemoryRequest = false;\n        /** The debug adapter does not support the 'disassemble' request. */\n        response.body.supportsDisassembleRequest = false;\n        /** The debug adapter does not support the 'cancel' request. */\n        response.body.supportsCancelRequest = false;\n        /** The debug adapter does not support the 'breakpointLocations' request. */\n        response.body.supportsBreakpointLocationsRequest = false;\n        this.sendResponse(response);\n    }\n    disconnectRequest(response, args, request) {\n        this.sendResponse(response);\n        this.shutdown();\n    }\n    launchRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    attachRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    terminateRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    restartRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setFunctionBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setExceptionBreakPointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    configurationDoneRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    continueRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    nextRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepInRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepOutRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepBackRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    reverseContinueRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    restartFrameRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    gotoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    pauseRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    sourceRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    threadsRequest(response, request) {\n        this.sendResponse(response);\n    }\n    terminateThreadsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stackTraceRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    scopesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    variablesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setVariableRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setExpressionRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    evaluateRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    stepInTargetsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    gotoTargetsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    completionsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    exceptionInfoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    loadedSourcesRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    dataBreakpointInfoRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    setDataBreakpointsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    readMemoryRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    disassembleRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    cancelRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    breakpointLocationsRequest(response, args, request) {\n        this.sendResponse(response);\n    }\n    /**\n     * Override this hook to implement custom requests.\n     */\n    customRequest(command, response, args, request) {\n        this.sendErrorResponse(response, 1014, 'unrecognized request', null, ErrorDestination.Telemetry);\n    }\n    //---- protected -------------------------------------------------------------------------------------------------\n    convertClientLineToDebugger(line) {\n        if (this._debuggerLinesStartAt1) {\n            return this._clientLinesStartAt1 ? line : line + 1;\n        }\n        return this._clientLinesStartAt1 ? line - 1 : line;\n    }\n    convertDebuggerLineToClient(line) {\n        if (this._debuggerLinesStartAt1) {\n            return this._clientLinesStartAt1 ? line : line - 1;\n        }\n        return this._clientLinesStartAt1 ? line + 1 : line;\n    }\n    convertClientColumnToDebugger(column) {\n        if (this._debuggerColumnsStartAt1) {\n            return this._clientColumnsStartAt1 ? column : column + 1;\n        }\n        return this._clientColumnsStartAt1 ? column - 1 : column;\n    }\n    convertDebuggerColumnToClient(column) {\n        if (this._debuggerColumnsStartAt1) {\n            return this._clientColumnsStartAt1 ? column : column - 1;\n        }\n        return this._clientColumnsStartAt1 ? column + 1 : column;\n    }\n    convertClientPathToDebugger(clientPath) {\n        if (this._clientPathsAreURIs !== this._debuggerPathsAreURIs) {\n            if (this._clientPathsAreURIs) {\n                return DebugSession.uri2path(clientPath);\n            }\n            else {\n                return DebugSession.path2uri(clientPath);\n            }\n        }\n        return clientPath;\n    }\n    convertDebuggerPathToClient(debuggerPath) {\n        if (this._debuggerPathsAreURIs !== this._clientPathsAreURIs) {\n            if (this._debuggerPathsAreURIs) {\n                return DebugSession.uri2path(debuggerPath);\n            }\n            else {\n                return DebugSession.path2uri(debuggerPath);\n            }\n        }\n        return debuggerPath;\n    }\n    //---- private -------------------------------------------------------------------------------\n    static path2uri(path) {\n        if (process.platform === 'win32') {\n            if (/^[A-Z]:/.test(path)) {\n                path = path[0].toLowerCase() + path.substr(1);\n            }\n            path = path.replace(/\\\\/g, '/');\n        }\n        path = encodeURI(path);\n        let uri = new url_1.URL(`file:`); // ignore 'path' for now\n        uri.pathname = path; // now use 'path' to get the correct percent encoding (see https://url.spec.whatwg.org)\n        return uri.toString();\n    }\n    static uri2path(sourceUri) {\n        let uri = new url_1.URL(sourceUri);\n        let s = decodeURIComponent(uri.pathname);\n        if (process.platform === 'win32') {\n            if (/^\\/[a-zA-Z]:/.test(s)) {\n                s = s[1].toLowerCase() + s.substr(2);\n            }\n            s = s.replace(/\\//g, '\\\\');\n        }\n        return s;\n    }\n    /*\n    * If argument starts with '_' it is OK to send its value to telemetry.\n    */\n    static formatPII(format, excludePII, args) {\n        return format.replace(DebugSession._formatPIIRegexp, function (match, paramName) {\n            if (excludePII && paramName.length > 0 && paramName[0] !== '_') {\n                return match;\n            }\n            return args[paramName] && args.hasOwnProperty(paramName) ?\n                args[paramName] :\n                match;\n        });\n    }\n}\nDebugSession._formatPIIRegexp = /{([^}]+)}/g;\nexports.DebugSession = DebugSession;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWdTZXNzaW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2RlYnVnU2Vzc2lvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OztnR0FHZ0c7O0FBR2hHLHlDQUEwQztBQUMxQyx5Q0FBMkM7QUFDM0MsMkJBQTJCO0FBQzNCLDZCQUF3QjtBQUd4QixNQUFhLE1BQU07SUFLbEIsWUFBbUIsSUFBWSxFQUFFLElBQWEsRUFBRSxLQUFhLENBQUMsRUFBRSxNQUFlLEVBQUUsSUFBVTtRQUMxRixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsZUFBZSxHQUFHLEVBQUUsQ0FBQztRQUMxQixJQUFJLE1BQU0sRUFBRTtZQUNMLElBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1NBQzVCO1FBQ0QsSUFBSSxJQUFJLEVBQUU7WUFDSCxJQUFLLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztTQUMvQjtJQUNGLENBQUM7Q0FDRDtBQWhCRCx3QkFnQkM7QUFFRCxNQUFhLEtBQUs7SUFLakIsWUFBbUIsSUFBWSxFQUFFLFNBQWlCLEVBQUUsWUFBcUIsS0FBSztRQUM3RSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsU0FBUyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO0lBQzVCLENBQUM7Q0FDRDtBQVZELHNCQVVDO0FBRUQsTUFBYSxVQUFVO0lBT3RCLFlBQW1CLENBQVMsRUFBRSxFQUFVLEVBQUUsR0FBWSxFQUFFLEtBQWEsQ0FBQyxFQUFFLE1BQWMsQ0FBQztRQUN0RixJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNaLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxD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SSxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxFQUFFO2dCQUMvRCxPQUFPLEtBQUssQ0FBQzthQUNiO1lBQ0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2dCQUN6RCxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztnQkFDakIsS0FBSyxDQUFDO1FBQ1IsQ0FBQyxDQUFDLENBQUE7SUFDSCxDQUFDOztBQWRjLDZCQUFnQixHQUFHLFlBQVksQ0FBQztBQWhtQmhELG9DQSttQkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHtEZWJ1Z1Byb3RvY29sfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5pbXBvcnQge1Byb3RvY29sU2VydmVyfSBmcm9tICcuL3Byb3RvY29sJztcbmltcG9ydCB7UmVzcG9uc2UsIEV2ZW50fSBmcm9tICcuL21lc3NhZ2VzJztcbmltcG9ydCAqIGFzIE5ldCBmcm9tICduZXQnO1xuaW1wb3J0IHtVUkx9IGZyb20gJ3VybCc7XG5cblxuZXhwb3J0IGNsYXNzIFNvdXJjZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU291cmNlIHtcblx0bmFtZTogc3RyaW5nO1xuXHRwYXRoOiBzdHJpbmc7XG5cdHNvdXJjZVJlZmVyZW5jZTogbnVtYmVyO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHBhdGg/OiBzdHJpbmcsIGlkOiBudW1iZXIgPSAwLCBvcmlnaW4/OiBzdHJpbmcsIGRhdGE/OiBhbnkpIHtcblx0XHR0aGlzLm5hbWUgPSBuYW1lO1xuXHRcdHRoaXMucGF0aCA9IHBhdGg7XG5cdFx0dGhpcy5zb3VyY2VSZWZlcmVuY2UgPSBpZDtcblx0XHRpZiAob3JpZ2luKSB7XG5cdFx0XHQoPGFueT50aGlzKS5vcmlnaW4gPSBvcmlnaW47XG5cdFx0fVxuXHRcdGlmIChkYXRhKSB7XG5cdFx0XHQoPGFueT50aGlzKS5hZGFwdGVyRGF0YSA9IGRhdGE7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBTY29wZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU2NvcGUge1xuXHRuYW1lOiBzdHJpbmc7XG5cdHZhcmlhYmxlc1JlZmVyZW5jZTogbnVtYmVyO1xuXHRleHBlbnNpdmU6IGJvb2xlYW47XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgcmVmZXJlbmNlOiBudW1iZXIsIGV4cGVuc2l2ZTogYm9vbGVhbiA9IGZhbHNlKSB7XG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcblx0XHR0aGlzLnZhcmlhYmxlc1JlZmVyZW5jZSA9IHJlZmVyZW5jZTtcblx0XHR0aGlzLmV4cGVuc2l2ZSA9IGV4cGVuc2l2ZTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgU3RhY2tGcmFtZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuU3RhY2tGcmFtZSB7XG5cdGlkOiBudW1iZXI7XG5cdHNvdXJjZTogU291cmNlO1xuXHRsaW5lOiBudW1iZXI7XG5cdGNvbHVtbjogbnVtYmVyO1xuXHRuYW1lOiBzdHJpbmc7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGk6IG51bWJlciwgbm06IHN0cmluZywgc3JjPzogU291cmNlLCBsbjogbnVtYmVyID0gMCwgY29sOiBudW1iZXIgPSAwKSB7XG5cdFx0dGhpcy5pZCA9IGk7XG5cdFx0dGhpcy5zb3VyY2UgPSBzcmM7XG5cdFx0dGhpcy5saW5lID0gbG47XG5cdFx0dGhpcy5jb2x1bW4gPSBjb2w7XG5cdFx0dGhpcy5uYW1lID0gbm07XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFRocmVhZCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuVGhyZWFkIHtcblx0aWQ6IG51bWJlcjtcblx0bmFtZTogc3RyaW5nO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCBuYW1lOiBzdHJpbmcpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0aWYgKG5hbWUpIHtcblx0XHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMubmFtZSA9ICdUaHJlYWQgIycgKyBpZDtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlIGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5WYXJpYWJsZSB7XG5cdG5hbWU6IHN0cmluZztcblx0dmFsdWU6IHN0cmluZztcblx0dmFyaWFibGVzUmVmZXJlbmNlOiBudW1iZXI7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgcmVmOiBudW1iZXIgPSAwLCBpbmRleGVkVmFyaWFibGVzPzogbnVtYmVyLCBuYW1lZFZhcmlhYmxlcz86IG51bWJlcikge1xuXHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdFx0dGhpcy52YWx1ZSA9IHZhbHVlO1xuXHRcdHRoaXMudmFyaWFibGVzUmVmZXJlbmNlID0gcmVmO1xuXHRcdGlmICh0eXBlb2YgbmFtZWRWYXJpYWJsZXMgPT09ICdudW1iZXInKSB7XG5cdFx0XHQoPERlYnVnUHJvdG9jb2wuVmFyaWFibGU+dGhpcykubmFtZWRWYXJpYWJsZXMgPSBuYW1lZFZhcmlhYmxlcztcblx0XHR9XG5cdFx0aWYgKHR5cGVvZiBpbmRleGVkVmFyaWFibGVzID09PSAnbnVtYmVyJykge1xuXHRcdFx0KDxEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlPnRoaXMpLmluZGV4ZWRWYXJpYWJsZXMgPSBpbmRleGVkVmFyaWFibGVzO1xuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQnJlYWtwb2ludCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuQnJlYWtwb2ludCB7XG5cdHZlcmlmaWVkOiBib29sZWFuO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3Rvcih2ZXJpZmllZDogYm9vbGVhbiwgbGluZT86IG51bWJlciwgY29sdW1uPzogbnVtYmVyLCBzb3VyY2U/OiBTb3VyY2UpIHtcblx0XHR0aGlzLnZlcmlmaWVkID0gdmVyaWZpZWQ7XG5cdFx0Y29uc3QgZTogRGVidWdQcm90b2NvbC5CcmVha3BvaW50ID0gdGhpcztcblx0XHRpZiAodHlwZW9mIGxpbmUgPT09ICdudW1iZXInKSB7XG5cdFx0XHRlLmxpbmUgPSBsaW5lO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGNvbHVtbiA9PT0gJ251bWJlcicpIHtcblx0XHRcdGUuY29sdW1uID0gY29sdW1uO1xuXHRcdH1cblx0XHRpZiAoc291cmNlKSB7XG5cdFx0XHRlLnNvdXJjZSA9IHNvdXJjZTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vZHVsZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuTW9kdWxlIHtcblx0aWQ6IG51bWJlciB8IHN0cmluZztcblx0bmFtZTogc3RyaW5nO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihpZDogbnVtYmVyIHwgc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQ29tcGxldGlvbkl0ZW0gaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkNvbXBsZXRpb25JdGVtIHtcblx0bGFiZWw6IHN0cmluZztcblx0c3RhcnQ6IG51bWJlcjtcblx0bGVuZ3RoOiBudW1iZXI7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGxhYmVsOiBzdHJpbmcsIHN0YXJ0OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyID0gMCkge1xuXHRcdHRoaXMubGFiZWwgPSBsYWJlbDtcblx0XHR0aGlzLnN0YXJ0ID0gc3RhcnQ7XG5cdFx0dGhpcy5sZW5ndGggPSBsZW5ndGg7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0b3BwZWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5TdG9wcGVkRXZlbnQge1xuXHRib2R5OiB7XG5cdFx0cmVhc29uOiBzdHJpbmc7XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCB0aHJlYWRJZD86IG51bWJlciwgZXhjZXB0aW9uVGV4dD86IHN0cmluZykge1xuXHRcdHN1cGVyKCdzdG9wcGVkJyk7XG5cdFx0dGhpcy5ib2R5ID0ge1xuXHRcdFx0cmVhc29uOiByZWFzb25cblx0XHR9O1xuXHRcdGlmICh0eXBlb2YgdGhyZWFkSWQgPT09ICdudW1iZXInKSB7XG5cdFx0XHQodGhpcyBhcyBEZWJ1Z1Byb3RvY29sLlN0b3BwZWRFdmVudCkuYm9keS50aHJlYWRJZCA9IHRocmVhZElkO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGV4Y2VwdGlvblRleHQgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHQodGhpcyBhcyBEZWJ1Z1Byb3RvY29sLlN0b3BwZWRFdmVudCkuYm9keS50ZXh0ID0gZXhjZXB0aW9uVGV4dDtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbnRpbnVlZEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlZEV2ZW50IHtcblx0Ym9keToge1xuXHRcdHRocmVhZElkOiBudW1iZXI7XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHRocmVhZElkOiBudW1iZXIsIGFsbFRocmVhZHNDb250aW51ZWQ/OiBib29sZWFuKSB7XG5cdFx0c3VwZXIoJ2NvbnRpbnVlZCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHRocmVhZElkOiB0aHJlYWRJZFxuXHRcdH07XG5cblx0XHRpZiAodHlwZW9mIGFsbFRocmVhZHNDb250aW51ZWQgPT09ICdib29sZWFuJykge1xuXHRcdFx0KDxEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlZEV2ZW50PnRoaXMpLmJvZHkuYWxsVGhyZWFkc0NvbnRpbnVlZCA9IGFsbFRocmVhZHNDb250aW51ZWQ7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBJbml0aWFsaXplZEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkluaXRpYWxpemVkRXZlbnQge1xuXHRwdWJsaWMgY29uc3RydWN0b3IoKSB7XG5cdFx0c3VwZXIoJ2luaXRpYWxpemVkJyk7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFRlcm1pbmF0ZWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5UZXJtaW5hdGVkRXZlbnQge1xuXHRwdWJsaWMgY29uc3RydWN0b3IocmVzdGFydD86IGFueSkge1xuXHRcdHN1cGVyKCd0ZXJtaW5hdGVkJyk7XG5cdFx0aWYgKHR5cGVvZiByZXN0YXJ0ID09PSAnYm9vbGVhbicgfHwgcmVzdGFydCkge1xuXHRcdFx0Y29uc3QgZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVkRXZlbnQgPSB0aGlzO1xuXHRcdFx0ZS5ib2R5ID0ge1xuXHRcdFx0XHRyZXN0YXJ0OiByZXN0YXJ0XG5cdFx0XHR9O1xuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgY2xhc3MgT3V0cHV0RXZlbnQgZXh0ZW5kcyBFdmVudCBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuT3V0cHV0RXZlbnQge1xuXHRib2R5OiB7XG5cdFx0Y2F0ZWdvcnk6IHN0cmluZyxcblx0XHRvdXRwdXQ6IHN0cmluZyxcblx0XHRkYXRhPzogYW55XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKG91dHB1dDogc3RyaW5nLCBjYXRlZ29yeTogc3RyaW5nID0gJ2NvbnNvbGUnLCBkYXRhPzogYW55KSB7XG5cdFx0c3VwZXIoJ291dHB1dCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdGNhdGVnb3J5OiBjYXRlZ29yeSxcblx0XHRcdG91dHB1dDogb3V0cHV0XG5cdFx0fTtcblx0XHRpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHR0aGlzLmJvZHkuZGF0YSA9IGRhdGE7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBUaHJlYWRFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5UaHJlYWRFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246IHN0cmluZyxcblx0XHR0aHJlYWRJZDogbnVtYmVyXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCB0aHJlYWRJZDogbnVtYmVyKSB7XG5cdFx0c3VwZXIoJ3RocmVhZCcpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0dGhyZWFkSWQ6IHRocmVhZElkXG5cdFx0fTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQnJlYWtwb2ludEV2ZW50IGV4dGVuZHMgRXZlbnQgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkJyZWFrcG9pbnRFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246IHN0cmluZyxcblx0XHRicmVha3BvaW50OiBCcmVha3BvaW50XG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nLCBicmVha3BvaW50OiBCcmVha3BvaW50KSB7XG5cdFx0c3VwZXIoJ2JyZWFrcG9pbnQnKTtcblx0XHR0aGlzLmJvZHkgPSB7XG5cdFx0XHRyZWFzb246IHJlYXNvbixcblx0XHRcdGJyZWFrcG9pbnQ6IGJyZWFrcG9pbnRcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBNb2R1bGVFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5Nb2R1bGVFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246ICduZXcnIHwgJ2NoYW5nZWQnIHwgJ3JlbW92ZWQnLFxuXHRcdG1vZHVsZTogTW9kdWxlXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogJ25ldycgfCAnY2hhbmdlZCcgfCAncmVtb3ZlZCcsIG1vZHVsZTogTW9kdWxlKSB7XG5cdFx0c3VwZXIoJ21vZHVsZScpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0bW9kdWxlOiBtb2R1bGVcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBMb2FkZWRTb3VyY2VFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRyZWFzb246ICduZXcnIHwgJ2NoYW5nZWQnIHwgJ3JlbW92ZWQnLFxuXHRcdHNvdXJjZTogU291cmNlXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlYXNvbjogJ25ldycgfCAnY2hhbmdlZCcgfCAncmVtb3ZlZCcsIHNvdXJjZTogU291cmNlKSB7XG5cdFx0c3VwZXIoJ2xvYWRlZFNvdXJjZScpO1xuXHRcdHRoaXMuYm9keSA9IHtcblx0XHRcdHJlYXNvbjogcmVhc29uLFxuXHRcdFx0c291cmNlOiBzb3VyY2Vcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBDYXBhYmlsaXRpZXNFdmVudCBleHRlbmRzIEV2ZW50IGltcGxlbWVudHMgRGVidWdQcm90b2NvbC5DYXBhYmlsaXRpZXNFdmVudCB7XG5cdGJvZHk6IHtcblx0XHRjYXBhYmlsaXRpZXM6IERlYnVnUHJvdG9jb2wuQ2FwYWJpbGl0aWVzXG5cdH07XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKGNhcGFiaWxpdGllczogRGVidWdQcm90b2NvbC5DYXBhYmlsaXRpZXMpIHtcblx0XHRzdXBlcignY2FwYWJpbGl0aWVzJyk7XG5cdFx0dGhpcy5ib2R5ID0ge1xuXHRcdFx0Y2FwYWJpbGl0aWVzOiBjYXBhYmlsaXRpZXNcblx0XHR9O1xuXHR9XG59XG5cbmV4cG9ydCBlbnVtIEVycm9yRGVzdGluYXRpb24ge1xuXHRVc2VyID0gMSxcblx0VGVsZW1ldHJ5ID0gMlxufTtcblxuZXhwb3J0IGNsYXNzIERlYnVnU2Vzc2lvbiBleHRlbmRzIFByb3RvY29sU2VydmVyIHtcblxuXHRwcml2YXRlIF9kZWJ1Z2dlckxpbmVzU3RhcnRBdDE6IGJvb2xlYW47XG5cdHByaXZhdGUgX2RlYnVnZ2VyQ29sdW1uc1N0YXJ0QXQxOiBib29sZWFuO1xuXHRwcml2YXRlIF9kZWJ1Z2dlclBhdGhzQXJlVVJJczogYm9vbGVhbjtcblxuXHRwcml2YXRlIF9jbGllbnRMaW5lc1N0YXJ0QXQxOiBib29sZWFuO1xuXHRwcml2YXRlIF9jbGllbnRDb2x1bW5zU3RhcnRBdDE6IGJvb2xlYW47XG5cdHByaXZhdGUgX2NsaWVudFBhdGhzQXJlVVJJczogYm9vbGVhbjtcblxuXHRwcm90ZWN0ZWQgX2lzU2VydmVyOiBib29sZWFuO1xuXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihvYnNvbGV0ZV9kZWJ1Z2dlckxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxPzogYm9vbGVhbiwgb2Jzb2xldGVfaXNTZXJ2ZXI/OiBib29sZWFuKSB7XG5cdFx0c3VwZXIoKTtcblxuXHRcdGNvbnN0IGxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxID0gdHlwZW9mIG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDEgPT09ICdib29sZWFuJyA/IG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDEgOiBmYWxzZTtcblx0XHR0aGlzLl9kZWJ1Z2dlckxpbmVzU3RhcnRBdDEgPSBsaW5lc0FuZENvbHVtbnNTdGFydEF0MTtcblx0XHR0aGlzLl9kZWJ1Z2dlckNvbHVtbnNTdGFydEF0MSA9IGxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxO1xuXHRcdHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzID0gZmFsc2U7XG5cblx0XHR0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID0gdHJ1ZTtcblx0XHR0aGlzLl9jbGllbnRDb2x1bW5zU3RhcnRBdDEgPSB0cnVlO1xuXHRcdHRoaXMuX2NsaWVudFBhdGhzQXJlVVJJcyA9IGZhbHNlO1xuXG5cdFx0dGhpcy5faXNTZXJ2ZXIgPSB0eXBlb2Ygb2Jzb2xldGVfaXNTZXJ2ZXIgPT09ICdib29sZWFuJyA/IG9ic29sZXRlX2lzU2VydmVyIDogZmFsc2U7XG5cblx0XHR0aGlzLm9uKCdjbG9zZScsICgpID0+IHtcblx0XHRcdHRoaXMuc2h1dGRvd24oKTtcblx0XHR9KTtcblx0XHR0aGlzLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuXHRcdFx0dGhpcy5zaHV0ZG93bigpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIHNldERlYnVnZ2VyUGF0aEZvcm1hdChmb3JtYXQ6IHN0cmluZykge1xuXHRcdHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzID0gZm9ybWF0ICE9PSAncGF0aCc7XG5cdH1cblxuXHRwdWJsaWMgc2V0RGVidWdnZXJMaW5lc1N0YXJ0QXQxKGVuYWJsZTogYm9vbGVhbikge1xuXHRcdHRoaXMuX2RlYnVnZ2VyTGluZXNTdGFydEF0MSA9IGVuYWJsZTtcblx0fVxuXG5cdHB1YmxpYyBzZXREZWJ1Z2dlckNvbHVtbnNTdGFydEF0MShlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9kZWJ1Z2dlckNvbHVtbnNTdGFydEF0MSA9IGVuYWJsZTtcblx0fVxuXG5cdHB1YmxpYyBzZXRSdW5Bc1NlcnZlcihlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9pc1NlcnZlciA9IGVuYWJsZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBBIHZpcnR1YWwgY29uc3RydWN0b3IuLi5cblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgcnVuKGRlYnVnU2Vzc2lvbjogdHlwZW9mIERlYnVnU2Vzc2lvbikge1xuXG5cdFx0Ly8gcGFyc2UgYXJndW1lbnRzXG5cdFx0bGV0IHBvcnQgPSAwO1xuXHRcdGNvbnN0IGFyZ3MgPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMik7XG5cdFx0YXJncy5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGluZGV4LCBhcnJheSkge1xuXHRcdFx0Y29uc3QgcG9ydE1hdGNoID0gL14tLXNlcnZlcj0oXFxkezQsNX0pJC8uZXhlYyh2YWwpO1xuXHRcdFx0aWYgKHBvcnRNYXRjaCkge1xuXHRcdFx0XHRwb3J0ID0gcGFyc2VJbnQocG9ydE1hdGNoWzFdLCAxMCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAocG9ydCA+IDApIHtcblx0XHRcdC8vIHN0YXJ0IGFzIGEgc2VydmVyXG5cdFx0XHRjb25zb2xlLmVycm9yKGB3YWl0aW5nIGZvciBkZWJ1ZyBwcm90b2NvbCBvbiBwb3J0ICR7cG9ydH1gKTtcblx0XHRcdE5ldC5jcmVhdGVTZXJ2ZXIoKHNvY2tldCkgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCc+PiBhY2NlcHRlZCBjb25uZWN0aW9uIGZyb20gY2xpZW50Jyk7XG5cdFx0XHRcdHNvY2tldC5vbignZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoJz4+IGNsaWVudCBjb25uZWN0aW9uIGNsb3NlZFxcbicpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0Y29uc3Qgc2Vzc2lvbiA9IG5ldyBkZWJ1Z1Nlc3Npb24oZmFsc2UsIHRydWUpO1xuXHRcdFx0XHRzZXNzaW9uLnNldFJ1bkFzU2VydmVyKHRydWUpO1xuXHRcdFx0XHRzZXNzaW9uLnN0YXJ0KHNvY2tldCwgc29ja2V0KTtcblx0XHRcdH0pLmxpc3Rlbihwb3J0KTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvLyBzdGFydCBhIHNlc3Npb25cblx0XHRcdC8vY29uc29sZS5lcnJvcignd2FpdGluZyBmb3IgZGVidWcgcHJvdG9jb2wgb24gc3RkaW4vc3Rkb3V0Jyk7XG5cdFx0XHRjb25zdCBzZXNzaW9uID0gbmV3IGRlYnVnU2Vzc2lvbihmYWxzZSk7XG5cdFx0XHRwcm9jZXNzLm9uKCdTSUdURVJNJywgKCkgPT4ge1xuXHRcdFx0XHRzZXNzaW9uLnNodXRkb3duKCk7XG5cdFx0XHR9KTtcblx0XHRcdHNlc3Npb24uc3RhcnQocHJvY2Vzcy5zdGRpbiwgcHJvY2Vzcy5zdGRvdXQpO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBzaHV0ZG93bigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5faXNTZXJ2ZXIgfHwgdGhpcy5faXNSdW5uaW5nSW5saW5lKCkpIHtcblx0XHRcdC8vIHNodXRkb3duIGlnbm9yZWQgaW4gc2VydmVyIG1vZGVcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gd2FpdCBhIGJpdCBiZWZvcmUgc2h1dHRpbmcgZG93blxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHByb2Nlc3MuZXhpdCgwKTtcblx0XHRcdH0sIDEwMCk7XG5cdFx0fVxuXHR9XG5cblx0cHJvdGVjdGVkIHNlbmRFcnJvclJlc3BvbnNlKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlLCBjb2RlT3JNZXNzYWdlOiBudW1iZXIgfCBEZWJ1Z1Byb3RvY29sLk1lc3NhZ2UsIGZvcm1hdD86IHN0cmluZywgdmFyaWFibGVzPzogYW55LCBkZXN0OiBFcnJvckRlc3RpbmF0aW9uID0gRXJyb3JEZXN0aW5hdGlvbi5Vc2VyKTogdm9pZCB7XG5cblx0XHRsZXQgbXNnIDogRGVidWdQcm90b2NvbC5NZXNzYWdlO1xuXHRcdGlmICh0eXBlb2YgY29kZU9yTWVzc2FnZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdG1zZyA9IDxEZWJ1Z1Byb3RvY29sLk1lc3NhZ2U+IHtcblx0XHRcdFx0aWQ6IDxudW1iZXI+IGNvZGVPck1lc3NhZ2UsXG5cdFx0XHRcdGZvcm1hdDogZm9ybWF0XG5cdFx0XHR9O1xuXHRcdFx0aWYgKHZhcmlhYmxlcykge1xuXHRcdFx0XHRtc2cudmFyaWFibGVzID0gdmFyaWFibGVzO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGRlc3QgJiBFcnJvckRlc3RpbmF0aW9uLlVzZXIpIHtcblx0XHRcdFx0bXNnLnNob3dVc2VyID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGlmIChkZXN0ICYgRXJyb3JEZXN0aW5hdGlvbi5UZWxlbWV0cnkpIHtcblx0XHRcdFx0bXNnLnNlbmRUZWxlbWV0cnkgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRtc2cgPSBjb2RlT3JNZXNzYWdlO1xuXHRcdH1cblxuXHRcdHJlc3BvbnNlLnN1Y2Nlc3MgPSBmYWxzZTtcblx0XHRyZXNwb25zZS5tZXNzYWdlID0gRGVidWdTZXNzaW9uLmZvcm1hdFBJSShtc2cuZm9ybWF0LCB0cnVlLCBtc2cudmFyaWFibGVzKTtcblx0XHRpZiAoIXJlc3BvbnNlLmJvZHkpIHtcblx0XHRcdHJlc3BvbnNlLmJvZHkgPSB7IH07XG5cdFx0fVxuXHRcdHJlc3BvbnNlLmJvZHkuZXJyb3IgPSBtc2c7XG5cblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwdWJsaWMgcnVuSW5UZXJtaW5hbFJlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5SdW5JblRlcm1pbmFsUmVxdWVzdEFyZ3VtZW50cywgdGltZW91dDogbnVtYmVyLCBjYjogKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJ1bkluVGVybWluYWxSZXNwb25zZSkgPT4gdm9pZCkge1xuXHRcdHRoaXMuc2VuZFJlcXVlc3QoJ3J1bkluVGVybWluYWwnLCBhcmdzLCB0aW1lb3V0LCBjYik7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZGlzcGF0Y2hSZXF1ZXN0KHJlcXVlc3Q6IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBuZXcgUmVzcG9uc2UocmVxdWVzdCk7XG5cblx0XHR0cnkge1xuXHRcdFx0aWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2luaXRpYWxpemUnKSB7XG5cdFx0XHRcdHZhciBhcmdzID0gPERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlcXVlc3RBcmd1bWVudHM+IHJlcXVlc3QuYXJndW1lbnRzO1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgYXJncy5saW5lc1N0YXJ0QXQxID09PSAnYm9vbGVhbicpIHtcblx0XHRcdFx0XHR0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID0gYXJncy5saW5lc1N0YXJ0QXQxO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0eXBlb2YgYXJncy5jb2x1bW5zU3RhcnRBdDEgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRcdHRoaXMuX2NsaWVudENvbHVtbnNTdGFydEF0MSA9IGFyZ3MuY29sdW1uc1N0YXJ0QXQxO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGFyZ3MucGF0aEZvcm1hdCAhPT0gJ3BhdGgnKSB7XG5cdFx0XHRcdFx0dGhpcy5zZW5kRXJyb3JSZXNwb25zZShyZXNwb25zZSwgMjAxOCwgJ2RlYnVnIGFkYXB0ZXIgb25seSBzdXBwb3J0cyBuYXRpdmUgcGF0aHMnLCBudWxsLCBFcnJvckRlc3RpbmF0aW9uLlRlbGVtZXRyeSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc3QgaW5pdGlhbGl6ZVJlc3BvbnNlID0gPERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlc3BvbnNlPiByZXNwb25zZTtcblx0XHRcdFx0XHRpbml0aWFsaXplUmVzcG9uc2UuYm9keSA9IHt9O1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZVJlcXVlc3QoaW5pdGlhbGl6ZVJlc3BvbnNlLCBhcmdzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2xhdW5jaCcpIHtcblx0XHRcdFx0dGhpcy5sYXVuY2hSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkxhdW5jaFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2F0dGFjaCcpIHtcblx0XHRcdFx0dGhpcy5hdHRhY2hSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2Rpc2Nvbm5lY3QnKSB7XG5cdFx0XHRcdHRoaXMuZGlzY29ubmVjdFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuRGlzY29ubmVjdFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Rlcm1pbmF0ZScpIHtcblx0XHRcdFx0dGhpcy50ZXJtaW5hdGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlRlcm1pbmF0ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Jlc3RhcnQnKSB7XG5cdFx0XHRcdHRoaXMucmVzdGFydFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuUmVzdGFydFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldEJyZWFrUG9pbnRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRCcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEZ1bmN0aW9uQnJlYWtwb2ludHMnKSB7XG5cdFx0XHRcdHRoaXMuc2V0RnVuY3Rpb25CcmVha1BvaW50c1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RnVuY3Rpb25CcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEV4Y2VwdGlvbkJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldEV4Y2VwdGlvbkJyZWFrUG9pbnRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRFeGNlcHRpb25CcmVha3BvaW50c1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2NvbmZpZ3VyYXRpb25Eb25lJykge1xuXHRcdFx0XHR0aGlzLmNvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Db25maWd1cmF0aW9uRG9uZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2NvbnRpbnVlJykge1xuXHRcdFx0XHR0aGlzLmNvbnRpbnVlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Db250aW51ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ25leHQnKSB7XG5cdFx0XHRcdHRoaXMubmV4dFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuTmV4dFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBJbicpIHtcblx0XHRcdFx0dGhpcy5zdGVwSW5SZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlN0ZXBJblJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBPdXQnKSB7XG5cdFx0XHRcdHRoaXMuc3RlcE91dFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU3RlcE91dFJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0ZXBCYWNrJykge1xuXHRcdFx0XHR0aGlzLnN0ZXBCYWNrUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TdGVwQmFja1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3JldmVyc2VDb250aW51ZScpIHtcblx0XHRcdFx0dGhpcy5yZXZlcnNlQ29udGludWVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Jlc3RhcnRGcmFtZScpIHtcblx0XHRcdFx0dGhpcy5yZXN0YXJ0RnJhbWVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlJlc3RhcnRGcmFtZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ2dvdG8nKSB7XG5cdFx0XHRcdHRoaXMuZ290b1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuR290b1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3BhdXNlJykge1xuXHRcdFx0XHR0aGlzLnBhdXNlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5QYXVzZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3N0YWNrVHJhY2UnKSB7XG5cdFx0XHRcdHRoaXMuc3RhY2tUcmFjZVJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU3RhY2tUcmFjZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3Njb3BlcycpIHtcblx0XHRcdFx0dGhpcy5zY29wZXNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlNjb3Blc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3ZhcmlhYmxlcycpIHtcblx0XHRcdFx0dGhpcy52YXJpYWJsZXNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldFZhcmlhYmxlJykge1xuXHRcdFx0XHR0aGlzLnNldFZhcmlhYmxlUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TZXRWYXJpYWJsZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NldEV4cHJlc3Npb24nKSB7XG5cdFx0XHRcdHRoaXMuc2V0RXhwcmVzc2lvblJlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RXhwcmVzc2lvblJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3NvdXJjZScpIHtcblx0XHRcdFx0dGhpcy5zb3VyY2VSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLlNvdXJjZVJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHJlcXVlc3QuY29tbWFuZCA9PT0gJ3RocmVhZHMnKSB7XG5cdFx0XHRcdHRoaXMudGhyZWFkc1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuVGhyZWFkc1Jlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAndGVybWluYXRlVGhyZWFkcycpIHtcblx0XHRcdFx0dGhpcy50ZXJtaW5hdGVUaHJlYWRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5UZXJtaW5hdGVUaHJlYWRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZXZhbHVhdGUnKSB7XG5cdFx0XHRcdHRoaXMuZXZhbHVhdGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkV2YWx1YXRlUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnc3RlcEluVGFyZ2V0cycpIHtcblx0XHRcdFx0dGhpcy5zdGVwSW5UYXJnZXRzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5TdGVwSW5UYXJnZXRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZ290b1RhcmdldHMnKSB7XG5cdFx0XHRcdHRoaXMuZ290b1RhcmdldHNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkdvdG9UYXJnZXRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnY29tcGxldGlvbnMnKSB7XG5cdFx0XHRcdHRoaXMuY29tcGxldGlvbnNSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkNvbXBsZXRpb25zUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZXhjZXB0aW9uSW5mbycpIHtcblx0XHRcdFx0dGhpcy5leGNlcHRpb25JbmZvUmVxdWVzdCg8RGVidWdQcm90b2NvbC5FeGNlcHRpb25JbmZvUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnbG9hZGVkU291cmNlcycpIHtcblx0XHRcdFx0dGhpcy5sb2FkZWRTb3VyY2VzUmVxdWVzdCg8RGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZGF0YUJyZWFrcG9pbnRJbmZvJykge1xuXHRcdFx0XHR0aGlzLmRhdGFCcmVha3BvaW50SW5mb1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuRGF0YUJyZWFrcG9pbnRJbmZvUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnc2V0RGF0YUJyZWFrcG9pbnRzJykge1xuXHRcdFx0XHR0aGlzLnNldERhdGFCcmVha3BvaW50c1JlcXVlc3QoPERlYnVnUHJvdG9jb2wuU2V0RGF0YUJyZWFrcG9pbnRzUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAncmVhZE1lbW9yeScpIHtcblx0XHRcdFx0dGhpcy5yZWFkTWVtb3J5UmVxdWVzdCg8RGVidWdQcm90b2NvbC5SZWFkTWVtb3J5UmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnZGlzYXNzZW1ibGUnKSB7XG5cdFx0XHRcdHRoaXMuZGlzYXNzZW1ibGVSZXF1ZXN0KDxEZWJ1Z1Byb3RvY29sLkRpc2Fzc2VtYmxlUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnY2FuY2VsJykge1xuXHRcdFx0XHR0aGlzLmNhbmNlbFJlcXVlc3QoPERlYnVnUHJvdG9jb2wuQ2FuY2VsUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSBpZiAocmVxdWVzdC5jb21tYW5kID09PSAnYnJlYWtwb2ludExvY2F0aW9ucycpIHtcblx0XHRcdFx0dGhpcy5icmVha3BvaW50TG9jYXRpb25zUmVxdWVzdCg8RGVidWdQcm90b2NvbC5CcmVha3BvaW50TG9jYXRpb25zUmVzcG9uc2U+IHJlc3BvbnNlLCByZXF1ZXN0LmFyZ3VtZW50cywgcmVxdWVzdCk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY3VzdG9tUmVxdWVzdChyZXF1ZXN0LmNvbW1hbmQsIDxEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlPiByZXNwb25zZSwgcmVxdWVzdC5hcmd1bWVudHMsIHJlcXVlc3QpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdHRoaXMuc2VuZEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDExMDQsICd7X3N0YWNrfScsIHsgX2V4Y2VwdGlvbjogZS5tZXNzYWdlLCBfc3RhY2s6IGUuc3RhY2sgfSwgRXJyb3JEZXN0aW5hdGlvbi5UZWxlbWV0cnkpO1xuXHRcdH1cblx0fVxuXG5cdHByb3RlY3RlZCBpbml0aWFsaXplUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Jbml0aWFsaXplUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlcXVlc3RBcmd1bWVudHMpOiB2b2lkIHtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgY29uZGl0aW9uYWwgYnJlYWtwb2ludHMuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbmRpdGlvbmFsQnJlYWtwb2ludHMgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgaGl0IGNvbmRpdGlvbmFsIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNIaXRDb25kaXRpb25hbEJyZWFrcG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IGZ1bmN0aW9uIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNGdW5jdGlvbkJyZWFrcG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBpbXBsZW1lbnRzIHRoZSAnY29uZmlndXJhdGlvbkRvbmUnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCA9IHRydWU7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IGhvdmVycyBiYXNlZCBvbiB0aGUgJ2V2YWx1YXRlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNFdmFsdWF0ZUZvckhvdmVycyA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3N0ZXBCYWNrJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNTdGVwQmFjayA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3NldFZhcmlhYmxlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNTZXRWYXJpYWJsZSA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Jlc3RhcnRGcmFtZScgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzUmVzdGFydEZyYW1lID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnc3RlcEluVGFyZ2V0cycgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzU3RlcEluVGFyZ2V0c1JlcXVlc3QgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdnb3RvVGFyZ2V0cycgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzR290b1RhcmdldHNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnY29tcGxldGlvbnMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbXBsZXRpb25zUmVxdWVzdCA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWZhdWx0IGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Jlc3RhcnQnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1Jlc3RhcnRSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlZmF1bHQgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnZXhjZXB0aW9uT3B0aW9ucycgYXR0cmlidXRlIG9uIHRoZSAnc2V0RXhjZXB0aW9uQnJlYWtwb2ludHMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0V4Y2VwdGlvbk9wdGlvbnMgPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVmYXVsdCBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdmb3JtYXQnIGF0dHJpYnV0ZSBvbiB0aGUgJ3ZhcmlhYmxlcycsICdldmFsdWF0ZScsIGFuZCAnc3RhY2tUcmFjZScgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzVmFsdWVGb3JtYXR0aW5nT3B0aW9ucyA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdleGNlcHRpb25JbmZvJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNFeGNlcHRpb25JbmZvUmVxdWVzdCA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgdGhlICdUZXJtaW5hdGVEZWJ1Z2dlZScgYXR0cmlidXRlIG9uIHRoZSAnZGlzY29ubmVjdCcgcmVxdWVzdC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRUZXJtaW5hdGVEZWJ1Z2dlZSA9IGZhbHNlO1xuXG5cdFx0Ly8gVGhpcyBkZWJ1ZyBhZGFwdGVyIGRvZXMgbm90IHN1cHBvcnQgZGVsYXllZCBsb2FkaW5nIG9mIHN0YWNrIGZyYW1lcy5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzRGVsYXllZFN0YWNrVHJhY2VMb2FkaW5nID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2xvYWRlZFNvdXJjZXMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0xvYWRlZFNvdXJjZXNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2xvZ01lc3NhZ2UnIGF0dHJpYnV0ZSBvZiB0aGUgU291cmNlQnJlYWtwb2ludC5cblx0XHRyZXNwb25zZS5ib2R5LnN1cHBvcnRzTG9nUG9pbnRzID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3Rlcm1pbmF0ZVRocmVhZHMnIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1Rlcm1pbmF0ZVRocmVhZHNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3NldEV4cHJlc3Npb24nIHJlcXVlc3QuXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1NldEV4cHJlc3Npb24gPSBmYWxzZTtcblxuXHRcdC8vIFRoaXMgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAndGVybWluYXRlJyByZXF1ZXN0LlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNUZXJtaW5hdGVSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvLyBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCBkYXRhIGJyZWFrcG9pbnRzLlxuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNEYXRhQnJlYWtwb2ludHMgPSBmYWxzZTtcblxuXHRcdC8qKiBUaGlzIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ3JlYWRNZW1vcnknIHJlcXVlc3QuICovXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c1JlYWRNZW1vcnlSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvKiogVGhlIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2Rpc2Fzc2VtYmxlJyByZXF1ZXN0LiAqL1xuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNEaXNhc3NlbWJsZVJlcXVlc3QgPSBmYWxzZTtcblxuXHRcdC8qKiBUaGUgZGVidWcgYWRhcHRlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSAnY2FuY2VsJyByZXF1ZXN0LiAqL1xuXHRcdHJlc3BvbnNlLmJvZHkuc3VwcG9ydHNDYW5jZWxSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHQvKiogVGhlIGRlYnVnIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgJ2JyZWFrcG9pbnRMb2NhdGlvbnMnIHJlcXVlc3QuICovXG5cdFx0cmVzcG9uc2UuYm9keS5zdXBwb3J0c0JyZWFrcG9pbnRMb2NhdGlvbnNSZXF1ZXN0ID0gZmFsc2U7XG5cblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZGlzY29ubmVjdFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRGlzY29ubmVjdFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkRpc2Nvbm5lY3RBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdFx0dGhpcy5zaHV0ZG93bigpO1xuXHR9XG5cblx0cHJvdGVjdGVkIGxhdW5jaFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuTGF1bmNoUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuTGF1bmNoUmVxdWVzdEFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBhdHRhY2hSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkF0dGFjaFJlcXVlc3RBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgdGVybWluYXRlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcmVzdGFydFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzdGFydFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlJlc3RhcnRBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0QnJlYWtQb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldEJyZWFrcG9pbnRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0QnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0RnVuY3Rpb25CcmVha1BvaW50c1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU2V0RnVuY3Rpb25CcmVha3BvaW50c1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldEZ1bmN0aW9uQnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc2V0RXhjZXB0aW9uQnJlYWtQb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldEV4Y2VwdGlvbkJyZWFrcG9pbnRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RXhjZXB0aW9uQnJlYWtwb2ludHNBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29uZmlndXJhdGlvbkRvbmVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNvbmZpZ3VyYXRpb25Eb25lUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQ29uZmlndXJhdGlvbkRvbmVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udGludWVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNvbnRpbnVlUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQ29udGludWVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIG5leHRSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLk5leHRSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5OZXh0QXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGVwSW5SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlN0ZXBJblJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBJbkFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc3RlcE91dFJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU3RlcE91dFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBPdXRBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHN0ZXBCYWNrUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGVwQmFja1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlN0ZXBCYWNrQXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCByZXZlcnNlQ29udGludWVSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZVJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgcmVzdGFydEZyYW1lUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXN0YXJ0RnJhbWVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5SZXN0YXJ0RnJhbWVBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIGdvdG9SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkdvdG9SZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Hb3RvQXJndW1lbnRzLCByZXF1ZXN0PzogRGVidWdQcm90b2NvbC5SZXF1ZXN0KSA6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBwYXVzZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUGF1c2VSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5QYXVzZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCkgOiB2b2lkIHtcblx0XHR0aGlzLnNlbmRSZXNwb25zZShyZXNwb25zZSk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc291cmNlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Tb3VyY2VSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Tb3VyY2VBcmd1bWVudHMsIHJlcXVlc3Q/OiBEZWJ1Z1Byb3RvY29sLlJlcXVlc3QpIDogdm9pZCB7XG5cdFx0dGhpcy5zZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuXHR9XG5cblx0cHJvdGVjdGVkIHRocmVhZHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlRocmVhZHNSZXNwb25zZSwgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCB0ZXJtaW5hdGVUaHJlYWRzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVUaHJlYWRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuVGVybWluYXRlVGhyZWFkc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGFja1RyYWNlUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGFja1RyYWNlUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU3RhY2tUcmFjZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzY29wZXNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNjb3Blc1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNjb3Blc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCB2YXJpYWJsZXNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXRWYXJpYWJsZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuU2V0VmFyaWFibGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5TZXRWYXJpYWJsZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXRFeHByZXNzaW9uUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TZXRFeHByZXNzaW9uUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RXhwcmVzc2lvbkFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBldmFsdWF0ZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRXZhbHVhdGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5FdmFsdWF0ZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzdGVwSW5UYXJnZXRzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5TdGVwSW5UYXJnZXRzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuU3RlcEluVGFyZ2V0c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBnb3RvVGFyZ2V0c1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuR290b1RhcmdldHNSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Hb3RvVGFyZ2V0c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBjb21wbGV0aW9uc1JlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuQ29tcGxldGlvbnNSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5Db21wbGV0aW9uc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBleGNlcHRpb25JbmZvUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5FeGNlcHRpb25JbmZvUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuRXhjZXB0aW9uSW5mb0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBsb2FkZWRTb3VyY2VzUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5Mb2FkZWRTb3VyY2VzUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuTG9hZGVkU291cmNlc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkYXRhQnJlYWtwb2ludEluZm9SZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkRhdGFCcmVha3BvaW50SW5mb1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkRhdGFCcmVha3BvaW50SW5mb0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBzZXREYXRhQnJlYWtwb2ludHNSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlNldERhdGFCcmVha3BvaW50c1Jlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldERhdGFCcmVha3BvaW50c0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCByZWFkTWVtb3J5UmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZWFkTWVtb3J5UmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuUmVhZE1lbW9yeUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkaXNhc3NlbWJsZVJlcXVlc3QocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuRGlzYXNzZW1ibGVSZXNwb25zZSwgYXJnczogRGVidWdQcm90b2NvbC5EaXNhc3NlbWJsZUFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBjYW5jZWxSZXF1ZXN0KHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLkNhbmNlbFJlc3BvbnNlLCBhcmdzOiBEZWJ1Z1Byb3RvY29sLkNhbmNlbEFyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBicmVha3BvaW50TG9jYXRpb25zUmVxdWVzdChyZXNwb25zZTogRGVidWdQcm90b2NvbC5CcmVha3BvaW50TG9jYXRpb25zUmVzcG9uc2UsIGFyZ3M6IERlYnVnUHJvdG9jb2wuQnJlYWtwb2ludExvY2F0aW9uc0FyZ3VtZW50cywgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBPdmVycmlkZSB0aGlzIGhvb2sgdG8gaW1wbGVtZW50IGN1c3RvbSByZXF1ZXN0cy5cblx0ICovXG5cdHByb3RlY3RlZCBjdXN0b21SZXF1ZXN0KGNvbW1hbmQ6IHN0cmluZywgcmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzcG9uc2UsIGFyZ3M6IGFueSwgcmVxdWVzdD86IERlYnVnUHJvdG9jb2wuUmVxdWVzdCk6IHZvaWQge1xuXHRcdHRoaXMuc2VuZEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDEwMTQsICd1bnJlY29nbml6ZWQgcmVxdWVzdCcsIG51bGwsIEVycm9yRGVzdGluYXRpb24uVGVsZW1ldHJ5KTtcblx0fVxuXG5cdC8vLS0tLSBwcm90ZWN0ZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHByb3RlY3RlZCBjb252ZXJ0Q2xpZW50TGluZVRvRGVidWdnZXIobGluZTogbnVtYmVyKTogbnVtYmVyIHtcblx0XHRpZiAodGhpcy5fZGVidWdnZXJMaW5lc1N0YXJ0QXQxKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2xpZW50TGluZXNTdGFydEF0MSA/IGxpbmUgOiBsaW5lICsgMTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuX2NsaWVudExpbmVzU3RhcnRBdDEgPyBsaW5lIC0gMSA6IGxpbmU7XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udmVydERlYnVnZ2VyTGluZVRvQ2xpZW50KGxpbmU6IG51bWJlcik6IG51bWJlciB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyTGluZXNTdGFydEF0MSkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2NsaWVudExpbmVzU3RhcnRBdDEgPyBsaW5lIDogbGluZSAtIDE7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLl9jbGllbnRMaW5lc1N0YXJ0QXQxID8gbGluZSArIDEgOiBsaW5lO1xuXHR9XG5cblx0cHJvdGVjdGVkIGNvbnZlcnRDbGllbnRDb2x1bW5Ub0RlYnVnZ2VyKGNvbHVtbjogbnVtYmVyKTogbnVtYmVyIHtcblx0XHRpZiAodGhpcy5fZGVidWdnZXJDb2x1bW5zU3RhcnRBdDEpIHtcblx0XHRcdHJldHVybiB0aGlzLl9jbGllbnRDb2x1bW5zU3RhcnRBdDEgPyBjb2x1bW4gOiBjb2x1bW4gKyAxO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5fY2xpZW50Q29sdW1uc1N0YXJ0QXQxID8gY29sdW1uIC0gMSA6IGNvbHVtbjtcblx0fVxuXG5cdHByb3RlY3RlZCBjb252ZXJ0RGVidWdnZXJDb2x1bW5Ub0NsaWVudChjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyQ29sdW1uc1N0YXJ0QXQxKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2xpZW50Q29sdW1uc1N0YXJ0QXQxID8gY29sdW1uIDogY29sdW1uIC0gMTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuX2NsaWVudENvbHVtbnNTdGFydEF0MSA/IGNvbHVtbiArIDEgOiBjb2x1bW47XG5cdH1cblxuXHRwcm90ZWN0ZWQgY29udmVydENsaWVudFBhdGhUb0RlYnVnZ2VyKGNsaWVudFBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMuX2NsaWVudFBhdGhzQXJlVVJJcyAhPT0gdGhpcy5fZGVidWdnZXJQYXRoc0FyZVVSSXMpIHtcblx0XHRcdGlmICh0aGlzLl9jbGllbnRQYXRoc0FyZVVSSXMpIHtcblx0XHRcdFx0cmV0dXJuIERlYnVnU2Vzc2lvbi51cmkycGF0aChjbGllbnRQYXRoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBEZWJ1Z1Nlc3Npb24ucGF0aDJ1cmkoY2xpZW50UGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBjbGllbnRQYXRoO1xuXHR9XG5cblx0cHJvdGVjdGVkIGNvbnZlcnREZWJ1Z2dlclBhdGhUb0NsaWVudChkZWJ1Z2dlclBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMuX2RlYnVnZ2VyUGF0aHNBcmVVUklzICE9PSB0aGlzLl9jbGllbnRQYXRoc0FyZVVSSXMpIHtcblx0XHRcdGlmICh0aGlzLl9kZWJ1Z2dlclBhdGhzQXJlVVJJcykge1xuXHRcdFx0XHRyZXR1cm4gRGVidWdTZXNzaW9uLnVyaTJwYXRoKGRlYnVnZ2VyUGF0aCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gRGVidWdTZXNzaW9uLnBhdGgydXJpKGRlYnVnZ2VyUGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBkZWJ1Z2dlclBhdGg7XG5cdH1cblxuXHQvLy0tLS0gcHJpdmF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHJpdmF0ZSBzdGF0aWMgcGF0aDJ1cmkocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcblxuXHRcdGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XG5cdFx0XHRpZiAoL15bQS1aXTovLnRlc3QocGF0aCkpIHtcblx0XHRcdFx0cGF0aCA9IHBhdGhbMF0udG9Mb3dlckNhc2UoKSArIHBhdGguc3Vic3RyKDEpO1xuXHRcdFx0fVxuXHRcdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFxcXC9nLCAnLycpO1xuXHRcdH1cblx0XHRwYXRoID0gZW5jb2RlVVJJKHBhdGgpO1xuXG5cdFx0bGV0IHVyaSA9IG5ldyBVUkwoYGZpbGU6YCk7XHQvLyBpZ25vcmUgJ3BhdGgnIGZvciBub3dcblx0XHR1cmkucGF0aG5hbWUgPSBwYXRoO1x0Ly8gbm93IHVzZSAncGF0aCcgdG8gZ2V0IHRoZSBjb3JyZWN0IHBlcmNlbnQgZW5jb2RpbmcgKHNlZSBodHRwczovL3VybC5zcGVjLndoYXR3Zy5vcmcpXG5cdFx0cmV0dXJuIHVyaS50b1N0cmluZygpO1xuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgdXJpMnBhdGgoc291cmNlVXJpOiBzdHJpbmcpOiBzdHJpbmcge1xuXG5cdFx0bGV0IHVyaSA9IG5ldyBVUkwoc291cmNlVXJpKTtcblx0XHRsZXQgcyA9IGRlY29kZVVSSUNvbXBvbmVudCh1cmkucGF0aG5hbWUpO1xuXHRcdGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XG5cdFx0XHRpZiAoL15cXC9bYS16QS1aXTovLnRlc3QocykpIHtcblx0XHRcdFx0cyA9IHNbMV0udG9Mb3dlckNhc2UoKSArIHMuc3Vic3RyKDIpO1xuXHRcdFx0fVxuXHRcdFx0cyA9IHMucmVwbGFjZSgvXFwvL2csICdcXFxcJyk7XG5cdFx0fVxuXHRcdHJldHVybiBzO1xuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgX2Zvcm1hdFBJSVJlZ2V4cCA9IC97KFtefV0rKX0vZztcblxuXHQvKlxuXHQqIElmIGFyZ3VtZW50IHN0YXJ0cyB3aXRoICdfJyBpdCBpcyBPSyB0byBzZW5kIGl0cyB2YWx1ZSB0byB0ZWxlbWV0cnkuXG5cdCovXG5cdHByaXZhdGUgc3RhdGljIGZvcm1hdFBJSShmb3JtYXQ6c3RyaW5nLCBleGNsdWRlUElJOiBib29sZWFuLCBhcmdzOiB7W2tleTogc3RyaW5nXTogc3RyaW5nfSk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIGZvcm1hdC5yZXBsYWNlKERlYnVnU2Vzc2lvbi5fZm9ybWF0UElJUmVnZXhwLCBmdW5jdGlvbihtYXRjaCwgcGFyYW1OYW1lKSB7XG5cdFx0XHRpZiAoZXhjbHVkZVBJSSAmJiBwYXJhbU5hbWUubGVuZ3RoID4gMCAmJiBwYXJhbU5hbWVbMF0gIT09ICdfJykge1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gYXJnc1twYXJhbU5hbWVdICYmIGFyZ3MuaGFzT3duUHJvcGVydHkocGFyYW1OYW1lKSA/XG5cdFx0XHRcdGFyZ3NbcGFyYW1OYW1lXSA6XG5cdFx0XHRcdG1hdGNoO1xuXHRcdH0pXG5cdH1cbn1cbiJdfQ==","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Message {\n    constructor(type) {\n        this.seq = 0;\n        this.type = type;\n    }\n}\nexports.Message = Message;\nclass Response extends Message {\n    constructor(request, message) {\n        super('response');\n        this.request_seq = request.seq;\n        this.command = request.command;\n        if (message) {\n            this.success = false;\n            this.message = message;\n        }\n        else {\n            this.success = true;\n        }\n    }\n}\nexports.Response = Response;\nclass Event extends Message {\n    constructor(event, body) {\n        super('event');\n        this.event = event;\n        if (body) {\n            this.body = body;\n        }\n    }\n}\nexports.Event = Event;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvbWVzc2FnZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Z0dBR2dHOztBQUtoRyxNQUFhLE9BQU87SUFJbkIsWUFBbUIsSUFBWTtRQUM5QixJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztRQUNiLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ2xCLENBQUM7Q0FDRDtBQVJELDBCQVFDO0FBRUQsTUFBYSxRQUFTLFNBQVEsT0FBTztJQUtwQyxZQUFtQixPQUE4QixFQUFFLE9BQWdCO1FBQ2xFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNsQixJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDL0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQy9CLElBQUksT0FBTyxFQUFFO1lBQ1osSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDZixJQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztTQUM5QjthQUFNO1lBQ04sSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7U0FDcEI7SUFDRixDQUFDO0NBQ0Q7QUFoQkQsNEJBZ0JDO0FBRUQsTUFBYSxLQUFNLFNBQVEsT0FBTztJQUdqQyxZQUFtQixLQUFhLEVBQUUsSUFBVTtRQUMzQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLElBQUksRUFBRTtZQUNILElBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1NBQ3hCO0lBQ0YsQ0FBQztDQUNEO0FBVkQsc0JBVUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHsgRGVidWdQcm90b2NvbCB9IGZyb20gJ3ZzY29kZS1kZWJ1Z3Byb3RvY29sJztcblxuXG5leHBvcnQgY2xhc3MgTWVzc2FnZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuUHJvdG9jb2xNZXNzYWdlIHtcblx0c2VxOiBudW1iZXI7XG5cdHR5cGU6IHN0cmluZztcblxuXHRwdWJsaWMgY29uc3RydWN0b3IodHlwZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5zZXEgPSAwO1xuXHRcdHRoaXMudHlwZSA9IHR5cGU7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlc3BvbnNlIGV4dGVuZHMgTWVzc2FnZSBpbXBsZW1lbnRzIERlYnVnUHJvdG9jb2wuUmVzcG9uc2Uge1xuXHRyZXF1ZXN0X3NlcTogbnVtYmVyO1xuXHRzdWNjZXNzOiBib29sZWFuO1xuXHRjb21tYW5kOiBzdHJpbmc7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHJlcXVlc3Q6IERlYnVnUHJvdG9jb2wuUmVxdWVzdCwgbWVzc2FnZT86IHN0cmluZykge1xuXHRcdHN1cGVyKCdyZXNwb25zZScpO1xuXHRcdHRoaXMucmVxdWVzdF9zZXEgPSByZXF1ZXN0LnNlcTtcblx0XHR0aGlzLmNvbW1hbmQgPSByZXF1ZXN0LmNvbW1hbmQ7XG5cdFx0aWYgKG1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuc3VjY2VzcyA9IGZhbHNlO1xuXHRcdFx0KDxhbnk+dGhpcykubWVzc2FnZSA9IG1lc3NhZ2U7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc3VjY2VzcyA9IHRydWU7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBFdmVudCBleHRlbmRzIE1lc3NhZ2UgaW1wbGVtZW50cyBEZWJ1Z1Byb3RvY29sLkV2ZW50IHtcblx0ZXZlbnQ6IHN0cmluZztcblxuXHRwdWJsaWMgY29uc3RydWN0b3IoZXZlbnQ6IHN0cmluZywgYm9keT86IGFueSkge1xuXHRcdHN1cGVyKCdldmVudCcpO1xuXHRcdHRoaXMuZXZlbnQgPSBldmVudDtcblx0XHRpZiAoYm9keSkge1xuXHRcdFx0KDxhbnk+dGhpcykuYm9keSA9IGJvZHk7XG5cdFx0fVxuXHR9XG59XG4iXX0=","import * as vscode from 'vscode';\r\nimport { lookupLabelReference, createDefinitionForLabelReference, MumpsLabel } from './mumps-label-lookup';\r\nconst definitionsArray = require('./../language-definitions.json');\r\n\r\nconst definitions = {};\r\nexports.definitions = definitions;\r\n\r\nclass MumpsToken {\r\n    _definition: any;\r\n    referredToLabel:MumpsLabel;\r\n    labelProgram: String;\r\n    labelOffset: number;\r\n    label: string;\r\n    _isLabelReference: Boolean;\r\n    document: vscode.TextDocument;\r\n    position:vscode.Position;\r\n    range:vscode.Range;\r\n    word:String;\r\n    surroundWord:String;\r\n\r\n    constructor(document, position) {\r\n        this.document = document;\r\n        this.position = position;\r\n\r\n        this.range = document.getWordRangeAtPosition(position);\r\n        if (!this.range) {\r\n            return;\r\n        }\r\n\r\n        this.word = document.getText(this.range);\r\n        if (!this.word) {\r\n            return;\r\n        }\r\n\r\n        this.surroundWord = getWordWithSurrounds(document, this.range) || this.word;\r\n\r\n        if (this.isIntrinsic) {\r\n            this.word = '$' + this.word;\r\n        }\r\n    }\r\n\r\n    get mayBeCommand() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        let lastChar = this.surroundWord.charAt(this.surroundWord.length - 1);\r\n        return (isWhitespace(this.surroundWord.charAt(0)) ||this.surroundWord.charAt(0)===\".\") &&\r\n            (lastChar === ':' ||\r\n                isWhitespace(lastChar) ||\r\n                this.surroundWord.length === this.word.length + 1);   // end-of-line\r\n    }\r\n\r\n    get isIntrinsic() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        return this.surroundWord.charAt(0) === '$' && this.surroundWord.charAt(1) !== '$';\r\n    }\r\n\r\n    get isFunctionCall() {\r\n        if (!this.surroundWord) {\r\n            return false;\r\n        }\r\n        return this.surroundWord.charAt(this.surroundWord.length - 1) === '(';\r\n    }\r\n\r\n    get isLabelReference() {\r\n        if (this._isLabelReference === undefined) {\r\n            let line = this.document.lineAt(this.range.start);\r\n            let word = this.isIntrinsic ? this.word.substring(1) : this.word;\r\n            let regex = new RegExp('(([ \\t](D|DO|G|GOTO)[ \\t]+)|\\\\$\\\\$)([%\\\\^\\\\+A-Z0-9]*' + word + '[%\\\\^\\\\+A-Z0-9]*)', 'i');\r\n            let match = regex.exec(line.text);\r\n            this._isLabelReference = match !== null;\r\n            if (match) {\r\n                let fullLabel = match[4];\r\n                let partsRegex = /([%A-Z][%A-Z0-9]*)?(\\+\\d+)?(\\^[%A-Z][%A-Z0-9]*)?/gi;\r\n\t\t\t\t\t\t\t\tlet parts = partsRegex.exec(fullLabel);\r\n\t\t\t\t\t\t\t\tif (parts) {\r\n\t\t\t\t\t\t\t\t\tthis.label = parts[1];\r\n\t\t\t\t\t\t\t\t\tthis.labelOffset = Number(withoutFirstCharacter(parts[2]));\r\n\t\t\t\t\t\t\t\t\tthis.labelProgram = withoutFirstCharacter(parts[3]);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n                this.referredToLabel = lookupLabelReference(this);\r\n            }\r\n        }\r\n        return this._isLabelReference;\r\n    }\r\n\r\n    get definition() {\r\n        if (this._definition === undefined) {\r\n            this._definition = false;\r\n            let matches = definitions[this.word.toUpperCase()];\r\n            if (matches) {\r\n                for (let definition of matches) {\r\n                    if (this.isFunctionCall && definition.type !== 'function') {\r\n                        continue;\r\n                    }\r\n                    this._definition = definition;\r\n                    break;\r\n                }\r\n            } else if (this.isLabelReference) {\r\n                this._definition = createDefinitionForLabelReference(this.referredToLabel);\r\n            }\r\n            if (this._definition && this._definition.type === 'function') {\r\n                this._definition.functionSignature = formatFunctionSignature(this._definition);\r\n            }\r\n        }\r\n        return this._definition;\r\n    }\r\n}\r\n\r\n\r\nfunction getWordWithSurrounds(document, range) {\r\n    if (range.start.character <= 0) {\r\n        return;\r\n    }\r\n    let start = new vscode.Position(range.start.line, range.start.character - 1);\r\n    let end = new vscode.Position(range.end.line, range.end.character + 1);\r\n    let surroundWord = document.getText(new vscode.Range(start, end));\r\n\r\n    // check for two dollar signs\r\n    if (surroundWord.charAt(0) === '$') {\r\n        start = new vscode.Position(start.line, start.character - 1);\r\n        let extendedWord = document.getText(new vscode.Range(start, end));\r\n        if (extendedWord.charAt(0) === '$') {\r\n            surroundWord = extendedWord;\r\n        }\r\n    }\r\n    return surroundWord;\r\n}\r\n\r\nfunction isWhitespace(char) {\r\n    return /\\s+/.test(char);\r\n}\r\n\r\nfunction withoutFirstCharacter(string) {\r\n    return string ? string.substring(1) : string;\r\n}\r\n\r\nfunction formatFunctionSignature(definition) {\r\n    let signature = definition.name + '(';\r\n    if (definition.parameters) {\r\n        for (let i = 0; i < definition.parameters.length; i++) {\r\n            signature += formatParameter(definition.parameters[i], i === 0);\r\n        }\r\n    }\r\n    signature += ')';\r\n    if (definition.returns) {\r\n        signature += ':' + definition.returns.type;\r\n    }\r\n    return signature;\r\n}\r\n\r\nfunction formatParameter(parameter, first) {\r\n    let s = (first ? '' : ',');\r\n    s += parameter.name;\r\n    s += ':' + parameter.type;\r\n    if (parameter.optional) {\r\n        s = '[' + s + ']';\r\n    }\r\n    return s;\r\n}\r\n\r\nfunction addDefinition(name, definition) {\r\n    if (!definitions[name]) {\r\n        definitions[name] = [definition];\r\n    } else {\r\n        definitions[name].push(definition);\r\n    }\r\n}\r\n\r\nfor (let definition of definitionsArray) {\r\n    addDefinition(definition.name, definition);\r\n    if (definition.abbreviation) {\r\n        addDefinition(definition.abbreviation, definition);\r\n    }\r\n}\r\nexport {MumpsToken};","module.exports = require(\"events\");","module.exports = require(\"net\");","\"use strict\";\n/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\nconst path = require(\"path\");\nconst mkdirp = require(\"mkdirp\");\nconst debugSession_1 = require(\"./debugSession\");\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"Verbose\"] = 0] = \"Verbose\";\n    LogLevel[LogLevel[\"Log\"] = 1] = \"Log\";\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\n    LogLevel[LogLevel[\"Stop\"] = 4] = \"Stop\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\nclass Logger {\n    constructor() {\n        this._pendingLogQ = [];\n    }\n    log(msg, level = LogLevel.Log) {\n        msg = msg + '\\n';\n        this._write(msg, level);\n    }\n    verbose(msg) {\n        this.log(msg, LogLevel.Verbose);\n    }\n    warn(msg) {\n        this.log(msg, LogLevel.Warn);\n    }\n    error(msg) {\n        this.log(msg, LogLevel.Error);\n    }\n    dispose() {\n        if (this._currentLogger) {\n            const disposeP = this._currentLogger.dispose();\n            this._currentLogger = null;\n            return disposeP;\n        }\n        else {\n            return Promise.resolve();\n        }\n    }\n    /**\n     * `log` adds a newline, `write` doesn't\n     */\n    _write(msg, level = LogLevel.Log) {\n        // [null, undefined] => string\n        msg = msg + '';\n        if (this._pendingLogQ) {\n            this._pendingLogQ.push({ msg, level });\n        }\n        else if (this._currentLogger) {\n            this._currentLogger.log(msg, level);\n        }\n    }\n    /**\n     * Set the logger's minimum level to log in the console, and whether to log to the file. Log messages are queued before this is\n     * called the first time, because minLogLevel defaults to Warn.\n     */\n    setup(consoleMinLogLevel, _logFilePath, prependTimestamp = true) {\n        const logFilePath = typeof _logFilePath === 'string' ?\n            _logFilePath :\n            (_logFilePath && this._logFilePathFromInit);\n        if (this._currentLogger) {\n            const options = {\n                consoleMinLogLevel,\n                logFilePath,\n                prependTimestamp\n            };\n            this._currentLogger.setup(options).then(() => {\n                // Now that we have a minimum logLevel, we can clear out the queue of pending messages\n                if (this._pendingLogQ) {\n                    const logQ = this._pendingLogQ;\n                    this._pendingLogQ = null;\n                    logQ.forEach(item => this._write(item.msg, item.level));\n                }\n            });\n        }\n    }\n    init(logCallback, logFilePath, logToConsole) {\n        // Re-init, create new global Logger\n        this._pendingLogQ = this._pendingLogQ || [];\n        this._currentLogger = new InternalLogger(logCallback, logToConsole);\n        this._logFilePathFromInit = logFilePath;\n    }\n}\nexports.Logger = Logger;\nexports.logger = new Logger();\n/**\n * Manages logging, whether to console.log, file, or VS Code console.\n * Encapsulates the state specific to each logging session\n */\nclass InternalLogger {\n    constructor(logCallback, isServer) {\n        /** Dispose and allow exit to continue normally */\n        this.beforeExitCallback = () => this.dispose();\n        this._logCallback = logCallback;\n        this._logToConsole = isServer;\n        this._minLogLevel = LogLevel.Warn;\n        this.disposeCallback = (signal, code) => {\n            this.dispose();\n            // Exit with 128 + value of the signal code.\n            // https://nodejs.org/api/process.html#process_exit_codes\n            code = code || 2; // SIGINT\n            code += 128;\n            process.exit(code);\n        };\n    }\n    setup(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._minLogLevel = options.consoleMinLogLevel;\n            this._prependTimestamp = options.prependTimestamp;\n            // Open a log file in the specified location. Overwritten on each run.\n            if (options.logFilePath) {\n                if (!path.isAbsolute(options.logFilePath)) {\n                    this.log(`logFilePath must be an absolute path: ${options.logFilePath}`, LogLevel.Error);\n                }\n                else {\n                    const handleError = err => this.sendLog(`Error creating log file at path: ${options.logFilePath}. Error: ${err.toString()}\\n`, LogLevel.Error);\n                    try {\n                        yield mkdirpPromise(path.dirname(options.logFilePath));\n                        this.log(`Verbose logs are written to:\\n`, LogLevel.Warn);\n                        this.log(options.logFilePath + '\\n', LogLevel.Warn);\n                        this._logFileStream = fs.createWriteStream(options.logFilePath);\n                        this.logDateTime();\n                        this.setupShutdownListeners();\n                        this._logFileStream.on('error', err => {\n                            handleError(err);\n                        });\n                    }\n                    catch (err) {\n                        handleError(err);\n                    }\n                }\n            }\n        });\n    }\n    logDateTime() {\n        let d = new Date();\n        let dateString = d.getUTCFullYear() + '-' + `${d.getUTCMonth() + 1}` + '-' + d.getUTCDate();\n        const timeAndDateStamp = dateString + ', ' + getFormattedTimeString();\n        this.log(timeAndDateStamp + '\\n', LogLevel.Verbose, false);\n    }\n    setupShutdownListeners() {\n        process.addListener('beforeExit', this.beforeExitCallback);\n        process.addListener('SIGTERM', this.disposeCallback);\n        process.addListener('SIGINT', this.disposeCallback);\n    }\n    removeShutdownListeners() {\n        process.removeListener('beforeExit', this.beforeExitCallback);\n        process.removeListener('SIGTERM', this.disposeCallback);\n        process.removeListener('SIGINT', this.disposeCallback);\n    }\n    dispose() {\n        return new Promise(resolve => {\n            this.removeShutdownListeners();\n            if (this._logFileStream) {\n                this._logFileStream.end(resolve);\n                this._logFileStream = null;\n            }\n            else {\n                resolve();\n            }\n        });\n    }\n    log(msg, level, prependTimestamp = true) {\n        if (this._minLogLevel === LogLevel.Stop) {\n            return;\n        }\n        if (level >= this._minLogLevel) {\n            this.sendLog(msg, level);\n        }\n        if (this._logToConsole) {\n            const logFn = level === LogLevel.Error ? console.error :\n                level === LogLevel.Warn ? console.warn :\n                    null;\n            if (logFn) {\n                logFn(trimLastNewline(msg));\n            }\n        }\n        // If an error, prepend with '[Error]'\n        if (level === LogLevel.Error) {\n            msg = `[${LogLevel[level]}] ${msg}`;\n        }\n        if (this._prependTimestamp && prependTimestamp) {\n            msg = '[' + getFormattedTimeString() + '] ' + msg;\n        }\n        if (this._logFileStream) {\n            this._logFileStream.write(msg);\n        }\n    }\n    sendLog(msg, level) {\n        // Truncate long messages, they can hang VS Code\n        if (msg.length > 1500) {\n            const endsInNewline = !!msg.match(/(\\n|\\r\\n)$/);\n            msg = msg.substr(0, 1500) + '[...]';\n            if (endsInNewline) {\n                msg = msg + '\\n';\n            }\n        }\n        if (this._logCallback) {\n            const event = new LogOutputEvent(msg, level);\n            this._logCallback(event);\n        }\n    }\n}\nfunction mkdirpPromise(folder) {\n    return new Promise((resolve, reject) => {\n        mkdirp(folder, err => {\n            if (err) {\n                reject(err);\n            }\n            else {\n                resolve();\n            }\n        });\n    });\n}\nclass LogOutputEvent extends debugSession_1.OutputEvent {\n    constructor(msg, level) {\n        const category = level === LogLevel.Error ? 'stderr' :\n            level === LogLevel.Warn ? 'console' :\n                'stdout';\n        super(msg, category);\n    }\n}\nexports.LogOutputEvent = LogOutputEvent;\nfunction trimLastNewline(str) {\n    return str.replace(/(\\n|\\r\\n)$/, '');\n}\nexports.trimLastNewline = trimLastNewline;\nfunction getFormattedTimeString() {\n    let d = new Date();\n    let hourString = _padZeroes(2, String(d.getUTCHours()));\n    let minuteString = _padZeroes(2, String(d.getUTCMinutes()));\n    let secondString = _padZeroes(2, String(d.getUTCSeconds()));\n    let millisecondString = _padZeroes(3, String(d.getUTCMilliseconds()));\n    return hourString + ':' + minuteString + ':' + secondString + '.' + millisecondString + ' UTC';\n}\nfunction _padZeroes(minDesiredLength, numberToPad) {\n    if (numberToPad.length >= minDesiredLength) {\n        return numberToPad;\n    }\n    else {\n        return String('0'.repeat(minDesiredLength) + numberToPad).slice(-minDesiredLength);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2xvZ2dlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OzREQUU0RDs7Ozs7Ozs7OztBQUU1RCx5QkFBeUI7QUFDekIsNkJBQTZCO0FBQzdCLGlDQUFpQztBQUNqQyxpREFBMkM7QUFFM0MsSUFBWSxRQU1YO0FBTkQsV0FBWSxRQUFRO0lBQ25CLDZDQUFXLENBQUE7SUFDWCxxQ0FBTyxDQUFBO0lBQ1AsdUNBQVEsQ0FBQTtJQUNSLHlDQUFTLENBQUE7SUFDVCx1Q0FBUSxDQUFBO0FBQ1QsQ0FBQyxFQU5XLFFBQVEsR0FBUixnQkFBUSxLQUFSLGdCQUFRLFFBTW5CO0FBZ0JELE1BQWEsTUFBTTtJQUFuQjtRQUlTLGlCQUFZLEdBQWUsRUFBRSxDQUFDO0lBMkV2QyxDQUFDO0lBekVBLEdBQUcsQ0FBQyxHQUFXLEVBQUUsS0FBSyxHQUFHLFFBQVEsQ0FBQyxHQUFHO1FBQ3BDLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3pCLENBQUM7SUFFRCxPQUFPLENBQUMsR0FBVztRQUNsQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVELElBQUksQ0FBQyxHQUFXO1FBQ2YsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxLQUFLLENBQUMsR0FBVztRQUNoQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVELE9BQU87UUFDTixJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDeEIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FB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QUcsR0FBRyxHQUFHLFlBQVksR0FBRyxHQUFHLEdBQUcsaUJBQWlCLEdBQUcsTUFBTSxDQUFDO0FBQ2hHLENBQUM7QUFFRCxTQUFTLFVBQVUsQ0FBQyxnQkFBd0IsRUFBRSxXQUFtQjtJQUNoRSxJQUFJLFdBQVcsQ0FBQyxNQUFNLElBQUksZ0JBQWdCLEVBQUU7UUFDM0MsT0FBTyxXQUFXLENBQUM7S0FDbkI7U0FBTTtRQUNOLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0tBQ25GO0FBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBDb3B5cmlnaHQgKEMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgbWtkaXJwIGZyb20gJ21rZGlycCc7XG5pbXBvcnQge091dHB1dEV2ZW50fSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5cbmV4cG9ydCBlbnVtIExvZ0xldmVsIHtcblx0VmVyYm9zZSA9IDAsXG5cdExvZyA9IDEsXG5cdFdhcm4gPSAyLFxuXHRFcnJvciA9IDMsXG5cdFN0b3AgPSA0XG59XG5cbmV4cG9ydCB0eXBlIElMb2dDYWxsYmFjayA9IChvdXRwdXRFdmVudDogT3V0cHV0RXZlbnQpID0+IHZvaWQ7XG5cbmludGVyZmFjZSBJTG9nSXRlbSB7XG5cdG1zZzogc3RyaW5nO1xuXHRsZXZlbDogTG9nTGV2ZWw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUxvZ2dlciB7XG5cdGxvZyhtc2c6IHN0cmluZywgbGV2ZWw/OiBMb2dMZXZlbCk6IHZvaWQ7XG5cdHZlcmJvc2UobXNnOiBzdHJpbmcpOiB2b2lkO1xuXHR3YXJuKG1zZzogc3RyaW5nKTogdm9pZDtcblx0ZXJyb3IobXNnOiBzdHJpbmcpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgTG9nZ2VyIHtcblx0cHJpdmF0ZSBfbG9nRmlsZVBhdGhGcm9tSW5pdDogc3RyaW5nO1xuXG5cdHByaXZhdGUgX2N1cnJlbnRMb2dnZXI6IEludGVybmFsTG9nZ2VyO1xuXHRwcml2YXRlIF9wZW5kaW5nTG9nUTogSUxvZ0l0ZW1bXSA9IFtdO1xuXG5cdGxvZyhtc2c6IHN0cmluZywgbGV2ZWwgPSBMb2dMZXZlbC5Mb2cpOiB2b2lkIHtcblx0XHRtc2cgPSBtc2cgKyAnXFxuJztcblx0XHR0aGlzLl93cml0ZShtc2csIGxldmVsKTtcblx0fVxuXG5cdHZlcmJvc2UobXNnOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmxvZyhtc2csIExvZ0xldmVsLlZlcmJvc2UpO1xuXHR9XG5cblx0d2Fybihtc2c6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMubG9nKG1zZywgTG9nTGV2ZWwuV2Fybik7XG5cdH1cblxuXHRlcnJvcihtc2c6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMubG9nKG1zZywgTG9nTGV2ZWwuRXJyb3IpO1xuXHR9XG5cblx0ZGlzcG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAodGhpcy5fY3VycmVudExvZ2dlcikge1xuXHRcdFx0Y29uc3QgZGlzcG9zZVAgPSB0aGlzLl9jdXJyZW50TG9nZ2VyLmRpc3Bvc2UoKTtcblx0XHRcdHRoaXMuX2N1cnJlbnRMb2dnZXIgPSBudWxsO1xuXHRcdFx0cmV0dXJuIGRpc3Bvc2VQO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIGBsb2dgIGFkZHMgYSBuZXdsaW5lLCBgd3JpdGVgIGRvZXNuJ3Rcblx0ICovXG5cdHByaXZhdGUgX3dyaXRlKG1zZzogc3RyaW5nLCBsZXZlbCA9IExvZ0xldmVsLkxvZyk6IHZvaWQge1xuXHRcdC8vIFtudWxsLCB1bmRlZmluZWRdID0+IHN0cmluZ1xuXHRcdG1zZyA9IG1zZyArICcnO1xuXHRcdGlmICh0aGlzLl9wZW5kaW5nTG9nUSkge1xuXHRcdFx0dGhpcy5fcGVuZGluZ0xvZ1EucHVzaCh7IG1zZywgbGV2ZWwgfSk7XG5cdFx0fSBlbHNlIGlmICh0aGlzLl9jdXJyZW50TG9nZ2VyKSB7XG5cdFx0XHR0aGlzLl9jdXJyZW50TG9nZ2VyLmxvZyhtc2csIGxldmVsKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU2V0IHRoZSBsb2dnZXIncyBtaW5pbXVtIGxldmVsIHRvIGxvZyBpbiB0aGUgY29uc29sZSwgYW5kIHdoZXRoZXIgdG8gbG9nIHRvIHRoZSBmaWxlLiBMb2cgbWVzc2FnZXMgYXJlIHF1ZXVlZCBiZWZvcmUgdGhpcyBpc1xuXHQgKiBjYWxsZWQgdGhlIGZpcnN0IHRpbWUsIGJlY2F1c2UgbWluTG9nTGV2ZWwgZGVmYXVsdHMgdG8gV2Fybi5cblx0ICovXG5cdHNldHVwKGNvbnNvbGVNaW5Mb2dMZXZlbDogTG9nTGV2ZWwsIF9sb2dGaWxlUGF0aD86IHN0cmluZ3xib29sZWFuLCBwcmVwZW5kVGltZXN0YW1wOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuXHRcdGNvbnN0IGxvZ0ZpbGVQYXRoID0gdHlwZW9mIF9sb2dGaWxlUGF0aCA9PT0gJ3N0cmluZycgP1xuXHRcdFx0X2xvZ0ZpbGVQYXRoIDpcblx0XHRcdChfbG9nRmlsZVBhdGggJiYgdGhpcy5fbG9nRmlsZVBhdGhGcm9tSW5pdCk7XG5cblx0XHRpZiAodGhpcy5fY3VycmVudExvZ2dlcikge1xuXHRcdFx0Y29uc3Qgb3B0aW9ucyA9IHtcblx0XHRcdFx0Y29uc29sZU1pbkxvZ0xldmVsLFxuXHRcdFx0XHRsb2dGaWxlUGF0aCxcblx0XHRcdFx0cHJlcGVuZFRpbWVzdGFtcFxuXHRcdFx0fTtcblx0XHRcdHRoaXMuX2N1cnJlbnRMb2dnZXIuc2V0dXAob3B0aW9ucykudGhlbigoKSA9PiB7XG5cdFx0XHRcdC8vIE5vdyB0aGF0IHdlIGhhdmUgYSBtaW5pbXVtIGxvZ0xldmVsLCB3ZSBjYW4gY2xlYXIgb3V0IHRoZSBxdWV1ZSBvZiBwZW5kaW5nIG1lc3NhZ2VzXG5cdFx0XHRcdGlmICh0aGlzLl9wZW5kaW5nTG9nUSkge1xuXHRcdFx0XHRcdGNvbnN0IGxvZ1EgPSB0aGlzLl9wZW5kaW5nTG9nUTtcblx0XHRcdFx0XHR0aGlzLl9wZW5kaW5nTG9nUSA9IG51bGw7XG5cdFx0XHRcdFx0bG9nUS5mb3JFYWNoKGl0ZW0gPT4gdGhpcy5fd3JpdGUoaXRlbS5tc2csIGl0ZW0ubGV2ZWwpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHR9XG5cdH1cblxuXHRpbml0KGxvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2ssIGxvZ0ZpbGVQYXRoPzogc3RyaW5nLCBsb2dUb0NvbnNvbGU/OiBib29sZWFuKTogdm9pZCB7XG5cdFx0Ly8gUmUtaW5pdCwgY3JlYXRlIG5ldyBnbG9iYWwgTG9nZ2VyXG5cdFx0dGhpcy5fcGVuZGluZ0xvZ1EgPSB0aGlzLl9wZW5kaW5nTG9nUSB8fCBbXTtcblx0XHR0aGlzLl9jdXJyZW50TG9nZ2VyID0gbmV3IEludGVybmFsTG9nZ2VyKGxvZ0NhbGxiYWNrLCBsb2dUb0NvbnNvbGUpO1xuXHRcdHRoaXMuX2xvZ0ZpbGVQYXRoRnJvbUluaXQgPSBsb2dGaWxlUGF0aDtcblx0fVxufVxuXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcigpO1xuXG5pbnRlcmZhY2UgSUludGVybmFsTG9nZ2VyT3B0aW9ucyB7XG5cdGNvbnNvbGVNaW5Mb2dMZXZlbDogTG9nTGV2ZWw7XG5cdGxvZ0ZpbGVQYXRoPzogc3RyaW5nO1xuXHRwcmVwZW5kVGltZXN0YW1wPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIGxvZ2dpbmcsIHdoZXRoZXIgdG8gY29uc29sZS5sb2csIGZpbGUsIG9yIFZTIENvZGUgY29uc29sZS5cbiAqIEVuY2Fwc3VsYXRlcyB0aGUgc3RhdGUgc3BlY2lmaWMgdG8gZWFjaCBsb2dnaW5nIHNlc3Npb25cbiAqL1xuY2xhc3MgSW50ZXJuYWxMb2dnZXIge1xuXHRwcml2YXRlIF9taW5Mb2dMZXZlbDogTG9nTGV2ZWw7XG5cdHByaXZhdGUgX2xvZ1RvQ29uc29sZTogYm9vbGVhbjtcblxuXHQvKiogTG9nIGluZm8gdGhhdCBtZWV0cyBtaW5Mb2dMZXZlbCBpcyBzZW50IHRvIHRoaXMgY2FsbGJhY2suICovXG5cdHByaXZhdGUgX2xvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2s7XG5cblx0LyoqIFdyaXRlIHN0ZWFtIGZvciBsb2cgZmlsZSAqL1xuXHRwcml2YXRlIF9sb2dGaWxlU3RyZWFtOiBmcy5Xcml0ZVN0cmVhbTtcblxuXHQvKiogRGlzcG9zZSBhbmQgYWxsb3cgZXhpdCB0byBjb250aW51ZSBub3JtYWxseSAqL1xuXHRwcml2YXRlIGJlZm9yZUV4aXRDYWxsYmFjayA9ICgpID0+IHRoaXMuZGlzcG9zZSgpO1xuXG5cdC8qKiBEaXNwb3NlIGFuZCBleGl0ICovXG5cdHByaXZhdGUgZGlzcG9zZUNhbGxiYWNrO1xuXG5cdC8qKiBXaGV0aGVyIHRvIGFkZCBhIHRpbWVzdGFtcCB0byBtZXNzYWdlcyBpbiB0aGUgbG9nZmlsZSAqL1xuXHRwcml2YXRlIF9wcmVwZW5kVGltZXN0YW1wOiBib29sZWFuO1xuXG5cdGNvbnN0cnVjdG9yKGxvZ0NhbGxiYWNrOiBJTG9nQ2FsbGJhY2ssIGlzU2VydmVyPzogYm9vbGVhbikge1xuXHRcdHRoaXMuX2xvZ0NhbGxiYWNrID0gbG9nQ2FsbGJhY2s7XG5cdFx0dGhpcy5fbG9nVG9Db25zb2xlID0gaXNTZXJ2ZXI7XG5cblx0XHR0aGlzLl9taW5Mb2dMZXZlbCA9IExvZ0xldmVsLldhcm47XG5cblx0XHR0aGlzLmRpc3Bvc2VDYWxsYmFjayA9IChzaWduYWw6IHN0cmluZywgY29kZTogbnVtYmVyKSA9PiB7XG5cdFx0XHR0aGlzLmRpc3Bvc2UoKTtcblxuXHRcdFx0Ly8gRXhpdCB3aXRoIDEyOCArIHZhbHVlIG9mIHRoZSBzaWduYWwgY29kZS5cblx0XHRcdC8vIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvcHJvY2Vzcy5odG1sI3Byb2Nlc3NfZXhpdF9jb2Rlc1xuXHRcdFx0Y29kZSA9IGNvZGUgfHwgMjsgLy8gU0lHSU5UXG5cdFx0XHRjb2RlICs9IDEyODtcblxuXHRcdFx0cHJvY2Vzcy5leGl0KGNvZGUpO1xuXHRcdH07XG5cdH1cblxuXHRwdWJsaWMgYXN5bmMgc2V0dXAob3B0aW9uczogSUludGVybmFsTG9nZ2VyT3B0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMuX21pbkxvZ0xldmVsID0gb3B0aW9ucy5jb25zb2xlTWluTG9nTGV2ZWw7XG5cdFx0dGhpcy5fcHJlcGVuZFRpbWVzdGFtcCA9IG9wdGlvbnMucHJlcGVuZFRpbWVzdGFtcDtcblxuXHRcdC8vIE9wZW4gYSBsb2cgZmlsZSBpbiB0aGUgc3BlY2lmaWVkIGxvY2F0aW9uLiBPdmVyd3JpdHRlbiBvbiBlYWNoIHJ1bi5cblx0XHRpZiAob3B0aW9ucy5sb2dGaWxlUGF0aCkge1xuXHRcdFx0aWYgKCFwYXRoLmlzQWJzb2x1dGUob3B0aW9ucy5sb2dGaWxlUGF0aCkpIHtcblx0XHRcdFx0dGhpcy5sb2coYGxvZ0ZpbGVQYXRoIG11c3QgYmUgYW4gYWJzb2x1dGUgcGF0aDogJHtvcHRpb25zLmxvZ0ZpbGVQYXRofWAsIExvZ0xldmVsLkVycm9yKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGhhbmRsZUVycm9yID0gZXJyID0+IHRoaXMuc2VuZExvZyhgRXJyb3IgY3JlYXRpbmcgbG9nIGZpbGUgYXQgcGF0aDogJHtvcHRpb25zLmxvZ0ZpbGVQYXRofS4gRXJyb3I6ICR7ZXJyLnRvU3RyaW5nKCl9XFxuYCwgTG9nTGV2ZWwuRXJyb3IpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0YXdhaXQgbWtkaXJwUHJvbWlzZShwYXRoLmRpcm5hbWUob3B0aW9ucy5sb2dGaWxlUGF0aCkpO1xuXHRcdFx0XHRcdHRoaXMubG9nKGBWZXJib3NlIGxvZ3MgYXJlIHdyaXR0ZW4gdG86XFxuYCwgTG9nTGV2ZWwuV2Fybik7XG5cdFx0XHRcdFx0dGhpcy5sb2cob3B0aW9ucy5sb2dGaWxlUGF0aCArICdcXG4nLCBMb2dMZXZlbC5XYXJuKTtcblxuXHRcdFx0XHRcdHRoaXMuX2xvZ0ZpbGVTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShvcHRpb25zLmxvZ0ZpbGVQYXRoKTtcblx0XHRcdFx0XHR0aGlzLmxvZ0RhdGVUaW1lKCk7XG5cdFx0XHRcdFx0dGhpcy5zZXR1cFNodXRkb3duTGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbS5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRcdFx0XHRcdFx0aGFuZGxlRXJyb3IoZXJyKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdFx0aGFuZGxlRXJyb3IoZXJyKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgbG9nRGF0ZVRpbWUoKTogdm9pZCB7XG5cdFx0bGV0IGQgPSBuZXcgRGF0ZSgpO1xuXHRcdGxldCBkYXRlU3RyaW5nID0gZC5nZXRVVENGdWxsWWVhcigpICsgJy0nICsgYCR7ZC5nZXRVVENNb250aCgpICsgMX1gICsgJy0nICsgZC5nZXRVVENEYXRlKCk7XG5cdFx0Y29uc3QgdGltZUFuZERhdGVTdGFtcCA9IGRhdGVTdHJpbmcgKyAnLCAnICsgZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpO1xuXHRcdHRoaXMubG9nKHRpbWVBbmREYXRlU3RhbXAgKyAnXFxuJywgTG9nTGV2ZWwuVmVyYm9zZSwgZmFsc2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBzZXR1cFNodXRkb3duTGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHByb2Nlc3MuYWRkTGlzdGVuZXIoJ2JlZm9yZUV4aXQnLCB0aGlzLmJlZm9yZUV4aXRDYWxsYmFjayk7XG5cdFx0cHJvY2Vzcy5hZGRMaXN0ZW5lcignU0lHVEVSTScsIHRoaXMuZGlzcG9zZUNhbGxiYWNrKTtcblx0XHRwcm9jZXNzLmFkZExpc3RlbmVyKCdTSUdJTlQnLCB0aGlzLmRpc3Bvc2VDYWxsYmFjayk7XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZVNodXRkb3duTGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHByb2Nlc3MucmVtb3ZlTGlzdGVuZXIoJ2JlZm9yZUV4aXQnLCB0aGlzLmJlZm9yZUV4aXRDYWxsYmFjayk7XG5cdFx0cHJvY2Vzcy5yZW1vdmVMaXN0ZW5lcignU0lHVEVSTScsIHRoaXMuZGlzcG9zZUNhbGxiYWNrKTtcblx0XHRwcm9jZXNzLnJlbW92ZUxpc3RlbmVyKCdTSUdJTlQnLCB0aGlzLmRpc3Bvc2VDYWxsYmFjayk7XG5cdH1cblxuXHRwdWJsaWMgZGlzcG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG5cdFx0XHR0aGlzLnJlbW92ZVNodXRkb3duTGlzdGVuZXJzKCk7XG5cdFx0XHRpZiAodGhpcy5fbG9nRmlsZVN0cmVhbSkge1xuXHRcdFx0XHR0aGlzLl9sb2dGaWxlU3RyZWFtLmVuZChyZXNvbHZlKTtcblx0XHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbSA9IG51bGw7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwdWJsaWMgbG9nKG1zZzogc3RyaW5nLCBsZXZlbDogTG9nTGV2ZWwsIHByZXBlbmRUaW1lc3RhbXAgPSB0cnVlKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuX21pbkxvZ0xldmVsID09PSBMb2dMZXZlbC5TdG9wKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKGxldmVsID49IHRoaXMuX21pbkxvZ0xldmVsKSB7XG5cdFx0XHR0aGlzLnNlbmRMb2cobXNnLCBsZXZlbCk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX2xvZ1RvQ29uc29sZSkge1xuXHRcdFx0Y29uc3QgbG9nRm4gPVxuXHRcdFx0XHRsZXZlbCA9PT0gTG9nTGV2ZWwuRXJyb3IgPyBjb25zb2xlLmVycm9yIDpcblx0XHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLldhcm4gPyBjb25zb2xlLndhcm4gOlxuXHRcdFx0XHRudWxsO1xuXG5cdFx0XHRpZiAobG9nRm4pIHtcblx0XHRcdFx0bG9nRm4odHJpbUxhc3ROZXdsaW5lKG1zZykpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIGFuIGVycm9yLCBwcmVwZW5kIHdpdGggJ1tFcnJvcl0nXG5cdFx0aWYgKGxldmVsID09PSBMb2dMZXZlbC5FcnJvcikge1xuXHRcdFx0bXNnID0gYFske0xvZ0xldmVsW2xldmVsXX1dICR7bXNnfWA7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX3ByZXBlbmRUaW1lc3RhbXAgJiYgcHJlcGVuZFRpbWVzdGFtcCkge1xuXHRcdFx0bXNnID0gJ1snICsgZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpICsgJ10gJyArIG1zZztcblx0XHR9XG5cblx0XHRpZiAodGhpcy5fbG9nRmlsZVN0cmVhbSkge1xuXHRcdFx0dGhpcy5fbG9nRmlsZVN0cmVhbS53cml0ZShtc2cpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2VuZExvZyhtc2c6IHN0cmluZywgbGV2ZWw6IExvZ0xldmVsKTogdm9pZCB7XG5cdFx0Ly8gVHJ1bmNhdGUgbG9uZyBtZXNzYWdlcywgdGhleSBjYW4gaGFuZyBWUyBDb2RlXG5cdFx0aWYgKG1zZy5sZW5ndGggPiAxNTAwKSB7XG5cdFx0XHRjb25zdCBlbmRzSW5OZXdsaW5lID0gISFtc2cubWF0Y2goLyhcXG58XFxyXFxuKSQvKTtcblx0XHRcdG1zZyA9IG1zZy5zdWJzdHIoMCwgMTUwMCkgKyAnWy4uLl0nO1xuXHRcdFx0aWYgKGVuZHNJbk5ld2xpbmUpIHtcblx0XHRcdFx0bXNnID0gbXNnICsgJ1xcbic7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX2xvZ0NhbGxiYWNrKSB7XG5cdFx0XHRjb25zdCBldmVudCA9IG5ldyBMb2dPdXRwdXRFdmVudChtc2csIGxldmVsKTtcblx0XHRcdHRoaXMuX2xvZ0NhbGxiYWNrKGV2ZW50KTtcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gbWtkaXJwUHJvbWlzZShmb2xkZXI6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdG1rZGlycChmb2xkZXIsIGVyciA9PiB7XG5cdFx0XHRpZiAoZXJyKSB7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn1cblxuZXhwb3J0IGNsYXNzIExvZ091dHB1dEV2ZW50IGV4dGVuZHMgT3V0cHV0RXZlbnQge1xuXHRjb25zdHJ1Y3Rvcihtc2c6IHN0cmluZywgbGV2ZWw6IExvZ0xldmVsKSB7XG5cdFx0Y29uc3QgY2F0ZWdvcnkgPVxuXHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLkVycm9yID8gJ3N0ZGVycicgOlxuXHRcdFx0bGV2ZWwgPT09IExvZ0xldmVsLldhcm4gPyAnY29uc29sZScgOlxuXHRcdFx0J3N0ZG91dCc7XG5cdFx0c3VwZXIobXNnLCBjYXRlZ29yeSk7XG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyaW1MYXN0TmV3bGluZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdHJldHVybiBzdHIucmVwbGFjZSgvKFxcbnxcXHJcXG4pJC8sICcnKTtcbn1cblxuZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkVGltZVN0cmluZygpOiBzdHJpbmcge1xuXHRsZXQgZCA9IG5ldyBEYXRlKCk7XG5cdGxldCBob3VyU3RyaW5nID0gX3BhZFplcm9lcygyLCBTdHJpbmcoZC5nZXRVVENIb3VycygpKSk7XG5cdGxldCBtaW51dGVTdHJpbmcgPSBfcGFkWmVyb2VzKDIsIFN0cmluZyhkLmdldFVUQ01pbnV0ZXMoKSkpO1xuXHRsZXQgc2Vjb25kU3RyaW5nID0gX3BhZFplcm9lcygyLCBTdHJpbmcoZC5nZXRVVENTZWNvbmRzKCkpKTtcblx0bGV0IG1pbGxpc2Vjb25kU3RyaW5nID0gX3BhZFplcm9lcygzLCBTdHJpbmcoZC5nZXRVVENNaWxsaXNlY29uZHMoKSkpO1xuXHRyZXR1cm4gaG91clN0cmluZyArICc6JyArIG1pbnV0ZVN0cmluZyArICc6JyArIHNlY29uZFN0cmluZyArICcuJyArIG1pbGxpc2Vjb25kU3RyaW5nICsgJyBVVEMnO1xufVxuXG5mdW5jdGlvbiBfcGFkWmVyb2VzKG1pbkRlc2lyZWRMZW5ndGg6IG51bWJlciwgbnVtYmVyVG9QYWQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdGlmIChudW1iZXJUb1BhZC5sZW5ndGggPj0gbWluRGVzaXJlZExlbmd0aCkge1xuXHRcdHJldHVybiBudW1iZXJUb1BhZDtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gU3RyaW5nKCcwJy5yZXBlYXQobWluRGVzaXJlZExlbmd0aCkgKyBudW1iZXJUb1BhZCkuc2xpY2UoLW1pbkRlc2lyZWRMZW5ndGgpO1xuXHR9XG59XG4iXX0=","import * as vscode from 'vscode';\r\nimport { MumpsLabel } from \"./mumps-label-lookup\";\r\nconst DIVIDERLINE = \"\\t;****************\\n\"\r\n\r\nfunction DocumentFunction(){\r\n\t\tlet editor = vscode.window.activeTextEditor\r\n\t\tif (editor) {\r\n\t\t\tlet document = editor.document\r\n\t\t\tlet InsertPosition = editor.selection.start.with(editor.selection.start.line,0)\r\n\r\n\t\t\t//if the line is empty look down for the label\r\n\t\t\twhile(InsertPosition.line < document.lineCount){\r\n\t\t\t\tlet txt = editor.document.lineAt(InsertPosition.line).text\r\n\t\t\t\tif (txt.replace(/\\t|\\ /i,\"\")===\"\"){\r\n\t\t\t\t\tInsertPosition = InsertPosition.translate(1,0)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(InsertPosition.line === document.lineCount){\r\n\t\t\t\tInsertPosition = InsertPosition.translate(-1,0)\r\n\t\t\t}\r\n\t\t\t//start moving up the file looking for the label header\r\n\t\t\twhile(InsertPosition.line >= 0){\r\n\t\t\t\tlet txt = editor.document.lineAt(InsertPosition.line).text\r\n\t\t\t\tlet functionSig = lineIsFunctionSig(txt)\r\n\t\t\t\tif (functionSig){\r\n\t\t\t\t\teditor.edit((editBuilder) =>{\r\n\t\t\t\t\t\teditBuilder.insert(InsertPosition, makeSignature(txt))\r\n\t\t\t\t\t})\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tInsertPosition = InsertPosition.translate(-1,0)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n};\r\n\r\n/**\r\n * @description this will assume if there is code on the first position of the line that it is a function\r\n * @param {text to search} text\r\n * @return {returns false if there is none, true otherwise}\r\n */\r\nfunction lineIsFunctionSig(text){\r\n  if(text.length ===0 || text.charAt(0)===\" \" || text.charAt(0)==='\\t' || text.charAt(0)===';'){\r\n    return false;\r\n  }\r\n  return true\r\n}\r\n\r\nfunction makeSignature(labelLine:string){\r\n  let Signature = \"\"\r\n\r\n  Signature+=DIVIDERLINE\r\n  Signature+=\"\\t; DESCRIPTION: \\n\"\r\n  let parameters = labelLine.match(/\\(.*\\)/)\r\n  if(parameters !== null && parameters.length> 0){\r\n    parameters = parameters[0].substring(1, parameters[0].length-1).split(\",\")\r\n    if(parameters.length > 0){\r\n      Signature+=\"\\t; PARAMETERS: \\n\"\r\n      parameters.forEach(function(element:string) {\r\n        Signature+=\"\\t;    \" + element + \"(I/O,REQ): \\n\"\r\n      });\r\n    }\r\n  }\r\n\r\n  Signature+=\"\\t; RETURNS: \\n\"\r\n  Signature+=\"\\t; REVISIONS: \\n\"\r\n  Signature+=DIVIDERLINE\r\n  return Signature;\r\n}\r\n\r\nfunction getSigInfo(referredTo:MumpsLabel, definition, parametersByName){\r\n\tif (referredTo.text) {\r\n\t\tlet description = referredTo.text.match(/DESCRIPTION:.*/i)\r\n\t\tif(description!==null) {definition.description = description[0];}\r\n\t\t//console.log(definition.description)\r\n\t\t//console.log(parametersByName)\r\n\r\n\t\tfor(let param in parametersByName){\r\n\t\t\t//console.log(param)\r\n\t\t\tlet paramDescription = referredTo.text.match(new RegExp(param+\"\\\\(.*\\\\):.*\",'i'))\r\n\t\t\tif(paramDescription !== null) {parametersByName[param].description=paramDescription}\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport {getSigInfo, DocumentFunction};","/*\r\nMumps-Debug-Extension for Visual Studio Code by Jens Wulf\r\n*/\r\n\r\n'use strict';\r\n\r\nimport * as vscode from 'vscode';\r\nimport { WorkspaceFolder, ProviderResult, DebugConfiguration, CancellationToken } from 'vscode';\r\nimport { MumpsDebugSession } from './mumpsDebug';\r\nimport { MumpsHoverProvider } from './mumps-hover-provider'\r\nimport { MumpsDefinitionProvider } from './mumps-definition-provider'\r\nimport { MumpsSignatureHelpProvider } from './mumps-signature-help-provider'\r\nimport { DocumentFunction } from './mumps-documenter'\r\nimport { MumpsDocumentSymbolProvider } from './mumps-document';\r\nimport { CompletionItemProvider } from './mumps-completion-item-provider';\r\nimport * as AutospaceFunction from './mumps-autospace'\r\nimport { MumpsLineParser } from './mumpsLineParser';\r\nconst parser = new MumpsLineParser;\r\n\r\nconst fs = require('fs');\r\nlet timeout: ReturnType<typeof setTimeout> | undefined;\r\nlet entryRef: string | undefined = \"\";\r\nexport async function activate(context: vscode.ExtensionContext) {\r\n\tconst MUMPS_MODE: vscode.DocumentFilter = { language: 'mumps', scheme: 'file' };\r\n\t// register a configuration provider for 'mumps' debug type\r\n\tconst mumpsDiagnostics = vscode.languages.createDiagnosticCollection(\"mumps\");\r\n\tcontext.subscriptions.push(\r\n\t\tvscode.commands.registerCommand('mumps.getEntryRef', () => {\r\n\t\t\treturn vscode.window.showInputBox({\r\n\t\t\t\tplaceHolder: \"Please enter the Entry-Reference to start Debugging\",\r\n\t\t\t\tvalue: entryRef\r\n\t\t\t});\r\n\t\t})\r\n\t);\r\n\tlet storage = context.storagePath;\r\n\tif (!fs.existsSync(storage)) {\r\n\t\tfs.mkdirSync(storage);\r\n\t}\r\n\tconst dbfile = storage + \"/labeldb.json\";\r\n\tcontext.subscriptions.push(\r\n\t\tmumpsDiagnostics,\r\n\t\tvscode.commands.registerCommand(\"mumps.documentFunction\", () => { DocumentFunction(); }),\r\n\t\tvscode.commands.registerCommand(\"mumps.autoSpaceEnter\", () => { AutospaceFunction.autoSpaceEnter(); }),\r\n\t\tvscode.commands.registerCommand(\"mumps.autoSpaceTab\", () => { AutospaceFunction.autoSpaceTab(); }),\r\n\t\tvscode.languages.registerHoverProvider(MUMPS_MODE, new MumpsHoverProvider()),\r\n\t\tvscode.languages.registerDefinitionProvider(MUMPS_MODE, new MumpsDefinitionProvider()),\r\n\t\tvscode.languages.registerSignatureHelpProvider(MUMPS_MODE, new MumpsSignatureHelpProvider(), '(', ','),\r\n\t\tvscode.languages.registerDocumentSymbolProvider(MUMPS_MODE, new MumpsDocumentSymbolProvider()),\r\n\t\tvscode.languages.registerCompletionItemProvider(MUMPS_MODE, new CompletionItemProvider(dbfile)),\r\n\t\tvscode.languages.registerDocumentFormattingEditProvider(MUMPS_MODE, {\r\n\t\t\tprovideDocumentFormattingEdits: (document, options, token) => {\r\n\t\t\t\tlet textEdits: vscode.TextEdit[] = []\r\n\t\t\t\tfor (let i = 0; i < document.lineCount; i++) {\r\n\t\t\t\t\tlet line = document.lineAt(i).text;\r\n\t\t\t\t\tformatDocumentLine(line, i, textEdits);\r\n\t\t\t\t}\r\n\t\t\t\treturn textEdits;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tvscode.languages.registerDocumentRangeFormattingEditProvider(MUMPS_MODE, {\r\n\t\t\tprovideDocumentRangeFormattingEdits: (document, range, options, token) => {\r\n\t\t\t\tlet textEdits: vscode.TextEdit[] = []\r\n\t\t\t\tfor (let i = range.start.line; i <= range.end.line; i++) {\r\n\t\t\t\t\tlet line = document.lineAt(i).text;\r\n\t\t\t\t\tformatDocumentLine(line, i, textEdits);\r\n\t\t\t\t}\r\n\t\t\t\treturn textEdits;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tvscode.debug.registerDebugConfigurationProvider('mumps', new MumpsConfigurationProvider()),\r\n\t\tvscode.debug.registerDebugAdapterDescriptorFactory('mumps', new InlineDebugAdapterFactory()),\r\n\t\tvscode.window.onDidChangeActiveTextEditor(editor => { if (editor) {triggerUpdateDiagnostics(editor.document, mumpsDiagnostics)} }),\r\n\t\tvscode.workspace.onDidChangeTextDocument(editor => { if (editor) {triggerUpdateDiagnostics(editor.document, mumpsDiagnostics)} })\r\n\t);\r\n\t//vscode.debug.onDidStartDebugSession(()=>refreshDiagnostics(vscode.window.activeTextEditor!.document, mumpsDiagnostics))\r\n\t//vscode.(context, mumpsDiagnostics);\r\n\t//vscode.languages.registerCodeActionsProvider({scheme:'file', language:'mumps'},new MumpsSpellChecker(),{providedCodeActionKinds:MumpsSpellChecker.providedCodeActionKinds})\r\n\tvscode.languages.registerEvaluatableExpressionProvider(MUMPS_MODE, {\r\n\t\tprovideEvaluatableExpression(document: vscode.TextDocument, position: vscode.Position): vscode.ProviderResult<vscode.EvaluatableExpression> {\r\n\t\t\tconst diags: readonly vscode.Diagnostic[] | undefined = mumpsDiagnostics.get(document.uri);\r\n\t\t\t//If Position is inside Error-marked Area then no Check for Variables is performed\r\n\t\t\tif (diags) {\r\n\t\t\t\tconst found = diags.find(diag => diag.range.contains(position))\r\n\t\t\t\tif (found) {\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst lineContent = document.lineAt(position.line).text;\r\n\t\t\tlet expression = /([ (,+\\-\\*_:=])(\\^?%?[a-zA-Z][a-zA-Z\\d]*(\\(.[^\\)]+\\))?)/g;\r\n\t\t\tif (lineContent.substring(position.character, position.character + 1) !== \")\") {\r\n\t\t\t\texpression = /([ (,+\\-\\*_:=])(\\^?%?[a-zA-Z][a-zA-Z\\d]*)/g;\r\n\t\t\t}\r\n\t\t\tlet result: RegExpExecArray | null = null;\r\n\r\n\t\t\t// find the word under the cursor\r\n\t\t\twhile (result = expression.exec(lineContent)) {\r\n\t\t\t\tlet start = result.index;\r\n\t\t\t\tstart += result[0].length - result[2].length; // ignore first part of expression\r\n\t\t\t\tlet end = start + result[2].length - 1;\r\n\r\n\t\t\t\tif (start <= position.character && end >= position.character) {\r\n\t\t\t\t\treturn new vscode.EvaluatableExpression(new vscode.Range(position.line, start, position.line, end), result[2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\t\t\t//\tconst wordRange = document.getWordRangeAtPosition(position);\r\n\t\t\t//return wordRange ? new vscode.EvaluatableExpression(wordRange) : undefined;\r\n\t\t}\r\n\t});\r\n}\r\n\r\nexport function deactivate() {\r\n\t// nothing to do\r\n}\r\n\r\nclass MumpsConfigurationProvider implements vscode.DebugConfigurationProvider {\r\n\r\n\t/**\r\n\t * Massage a debug configuration just before a debug session is being launched,\r\n\t * e.g. add all missing attributes to the debug configuration.\r\n\t*/\r\n\tresolveDebugConfiguration(folder: WorkspaceFolder | undefined, config: DebugConfiguration, token?: CancellationToken): ProviderResult<DebugConfiguration> {\r\n\r\n\t\t// if launch.json is missing or empty\r\n\t\tif (!config.type && !config.request && !config.name) {\r\n\t\t\tconst editor = vscode.window.activeTextEditor;\r\n\t\t\tif (editor && editor.document.languageId === 'mumps') {\r\n\t\t\t\tconfig.type = 'mumps';\r\n\t\t\t\tconfig.name = 'Launch';\r\n\t\t\t\tconfig.request = 'launch';\r\n\t\t\t\tconfig.program = '${file}';\r\n\t\t\t\tconfig.stopOnEntry = true;\r\n\t\t\t\tconfig.hostname = '127.0.0.1';\r\n\t\t\t\tconfig.localRoutinesPath = 'y:\\\\',\r\n\t\t\t\t\tconfig.port = 9000\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!config.program) {\r\n\t\t\treturn vscode.window.showInformationMessage(\"Cannot find a program to debug\").then(_ => {\r\n\t\t\t\treturn undefined;\t// abort launch\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn config;\r\n\t}\r\n}\r\nclass InlineDebugAdapterFactory implements vscode.DebugAdapterDescriptorFactory {\r\n\r\n\tcreateDebugAdapterDescriptor(_session: vscode.DebugSession): ProviderResult<vscode.DebugAdapterDescriptor> {\r\n\t\treturn new vscode.DebugAdapterInlineImplementation(new MumpsDebugSession());\r\n\t}\r\n}\r\nfunction formatDocumentLine(line: string, lineNumber, textEdits) {\r\n\tlet emptyLine = line.replace(/(\\ |\\t)/ig, \"\");\r\n\tif (emptyLine.length === 0) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, 0), \"\\t;\"))\r\n\t}\r\n\tif (line.endsWith(\". \")) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, line.length), \";\"))\r\n\t} else if (line.endsWith(\".\")) {\r\n\t\ttextEdits.push(vscode.TextEdit.insert(new vscode.Position(lineNumber, line.length), \" ;\"))\r\n\t}\r\n\tif (line.startsWith(\" \")) {\r\n\t\tlet endSpace: number;\r\n\t\t//console.log(\"start\")\r\n\t\tfor (endSpace = 0; endSpace < line.length; endSpace++) {\r\n\t\t\tif (line.charAt(endSpace) !== \" \") {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttextEdits.push(vscode.TextEdit.replace(new vscode.Range(new vscode.Position(lineNumber, 0), new vscode.Position(lineNumber, endSpace)), \"\\t\"));\r\n\t}\r\n}\r\nfunction updateDiagnostics(document: vscode.TextDocument, collection: vscode.DiagnosticCollection): void {\r\n\tif (document) {\r\n\t\tcollection.clear();\r\n\t\tfor (let i = 0; i < document.lineCount; i++) {\r\n\t\t\tlet line = document.lineAt(i);\r\n\t\t\tlet diag = parser.checkLine(line.text);\r\n\t\t\tif (diag.text !== '') {\r\n\t\t\t\tcollection.set(document.uri, [{\r\n\t\t\t\t\tcode: '',\r\n\t\t\t\t\tmessage: diag.text,\r\n\t\t\t\t\trange: new vscode.Range(new vscode.Position(i, diag.position), new vscode.Position(i, line.text.length)),\r\n\t\t\t\t\tseverity: vscode.DiagnosticSeverity.Error,\r\n\t\t\t\t\tsource: '',\r\n\t\t\t\t}]);\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction triggerUpdateDiagnostics(document: vscode.TextDocument, collection: vscode.DiagnosticCollection) {\r\n\tif (timeout) {\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = undefined;\r\n\t}\r\n\ttimeout = setTimeout(()=>updateDiagnostics(document, collection), 500);\r\n}\r\n","/*\r\n\tImplementation of DebugProtocol-Server for GT.M, Yottadb by Jens Wulf\r\n\tbased on Mock-Debug by Microsoft Corp.\r\n\tLicense: LGPL\r\n*/\r\n\r\nimport {\r\n\tLogger, logger,\r\n\tLoggingDebugSession,\r\n\tInitializedEvent, TerminatedEvent, StoppedEvent, BreakpointEvent, OutputEvent,\r\n\tThread, StackFrame, Scope, Source, Handles, Breakpoint\r\n} from 'vscode-debugadapter';\r\nimport { DebugProtocol } from 'vscode-debugprotocol';\r\nimport { basename } from 'path';\r\nconst { Subject } = require('await-notify');\r\nimport { MConnect, MumpsBreakpoint } from './mconnect';\r\nimport * as vscode from 'vscode';\r\nimport { readFileSync } from 'fs';\r\nconst MUMPSDIAGNOSTICS = vscode.languages.createDiagnosticCollection(\"mumps\");\r\n/**\r\n * This interface describes the mumps-debug specific launch attributes\r\n * The schema for these attributes lives in the package.json of the mumps-debug extension.\r\n * The interface should always match this schema.\r\n */\r\ninterface LaunchRequestArguments extends DebugProtocol.LaunchRequestArguments {\r\n\t/** An absolute path to the \"program\" to debug. */\r\n\tprogram: string;\r\n\t/** Automatically stop target after launch. If not specified, target does not stop. */\r\n\tstopOnEntry?: boolean;\r\n\t/** enable logging the Debug Adapter Protocol */\r\n\ttrace?: boolean;\r\n\t/** The Port on which MDEBUG listens */\r\n\tport: number;\r\n\t/**The Hostname of the MDEBUG-Server */\r\n\thostname: string;\r\n\t/**Map Local-Routines to Host-Routines */\r\n\tlocalRoutinesPath: string;\r\n\r\n}\r\ninterface VarData {\r\n\tname: string,\r\n\tindexCount: number,\r\n\tbases: Array<string>,\r\n\tcontent: string\r\n}\r\nexport class MumpsDebugSession extends LoggingDebugSession {\r\n\r\n\t// we don't support multiple threads, so we can use a hardcoded ID for the default thread\r\n\tprivate static THREAD_ID = 1;\r\n\t//private _mconnect: MConnect;\r\n\r\n\tprivate _variableHandles = new Handles<string>();\r\n\r\n\tprivate _configurationDone = new Subject();\r\n\r\n\tprivate _program: string;\r\n\r\n\tprivate _mconnect: MConnect;\r\n\t/**\r\n\t * Creates a new debug adapter that is used for one debug session.\r\n\t * We configure the default implementation of a debug adapter here.\r\n\t */\r\n\tpublic constructor() {\r\n\t\tsuper();\r\n\r\n\t\t// this debugger uses zero-based lines and columns\r\n\t\tthis.setDebuggerLinesStartAt1(false);\r\n\t\tthis.setDebuggerColumnsStartAt1(false);\r\n\t\tthis._program = \"\";\r\n\t\tthis._mconnect = new MConnect();\r\n\r\n\t\t// setup event handlers\r\n\t\tthis._mconnect.on('stopOnEntry', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('entry', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnStep', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('step', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnBreakpoint', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('breakpoint', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnDataBreakpoint', () => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('data breakpoint', MumpsDebugSession.THREAD_ID));\r\n\t\t});\r\n\t\tthis._mconnect.on('stopOnException', (errortext) => {\r\n\t\t\tthis.sendEvent(new StoppedEvent('exception', MumpsDebugSession.THREAD_ID, errortext));\r\n\t\t});\r\n\t\tthis._mconnect.on('breakpointValidated', (bp: MumpsBreakpoint) => {\r\n\t\t\tthis.sendEvent(new BreakpointEvent('changed', <DebugProtocol.Breakpoint>{ verified: bp.verified, id: bp.id }));\r\n\t\t});\r\n\t\tthis._mconnect.on('output', (text, filePath, line, column) => {\r\n\t\t\tconst e: DebugProtocol.OutputEvent = new OutputEvent(`${text}\\n`);\r\n\t\t\te.body.source = this.createSource(filePath);\r\n\t\t\te.body.line = this.convertDebuggerLineToClient(line);\r\n\t\t\te.body.column = this.convertDebuggerColumnToClient(column);\r\n\t\t\tthis.sendEvent(e);\r\n\t\t});\r\n\t\tthis._mconnect.on('end', () => {\r\n\t\t\tthis.sendEvent(new TerminatedEvent());\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * The 'initialize' request is the first request called by the frontend\r\n\t * to interrogate the features the debug adapter provides.\r\n\t */\r\n\tprotected initializeRequest(response: DebugProtocol.InitializeResponse, args: DebugProtocol.InitializeRequestArguments): void {\r\n\r\n\t\t// build and return the capabilities of this debug adapter:\r\n\t\tresponse.body = response.body || {};\r\n\r\n\t\t// the adapter implements the configurationDoneRequest.\r\n\t\tresponse.body.supportsConfigurationDoneRequest = true;\r\n\r\n\t\t// make VS Code to use 'evaluate' when hovering over source\r\n\t\tresponse.body.supportsEvaluateForHovers = true;\r\n\r\n\t\t// make VS Code to support data breakpoints\r\n\t\tresponse.body.supportsDataBreakpoints = false;\r\n\r\n\t\t// make VS Code to support completion in REPL\r\n\t\tresponse.body.supportsCompletionsRequest = false;\r\n\t\tresponse.body.completionTriggerCharacters = [\".\", \"[\"];\r\n\r\n\t\t// make VS Code to send cancelRequests\r\n\t\tresponse.body.supportsCancelRequest = false;\r\n\r\n\t\t// make VS Code send the breakpointLocations request\r\n\t\tresponse.body.supportsBreakpointLocationsRequest = true;\r\n\t\tresponse.body.supportsExceptionInfoRequest = true;\r\n\t\tresponse.body.supportsRestartRequest = true;\r\n\r\n\r\n\t\t// since this debug adapter can accept configuration requests like 'setBreakpoint' at any time,\r\n\t\t// we request them early by sending an 'initializeRequest' to the frontend.\r\n\t\t// The frontend will end the configuration sequence by calling 'configurationDone' request.\r\n\t\tthis.sendResponse(response);\r\n\t\tthis.sendEvent(new InitializedEvent());\r\n\t}\r\n\r\n\t/**\r\n\t * Called at the end of the configuration sequence.\r\n\t * Indicates that all breakpoints etc. have been sent to the DA and that the 'launch' can start.\r\n\t */\r\n\tprotected configurationDoneRequest(response: DebugProtocol.ConfigurationDoneResponse, args: DebugProtocol.ConfigurationDoneArguments): void {\r\n\t\tsuper.configurationDoneRequest(response, args);\r\n\r\n\t\t// notify the launchRequest that configuration has finished\r\n\r\n\t\tthis._configurationDone.notify();\r\n\t}\r\n\r\n\tprotected async launchRequest(response: DebugProtocol.LaunchResponse, args: LaunchRequestArguments) {\r\n\r\n\t\t// make sure to 'Stop' the buffered logging if 'trace' is not set\r\n\t\tlogger.setup(args.trace ? Logger.LogLevel.Verbose : Logger.LogLevel.Stop, false);\r\n\r\n\t\t// wait until configuration has finished (and configurationDoneRequest has been called)\r\n\t\tawait this._configurationDone.wait(1000);\r\n\r\n\t\t// start the program in the runtime\r\n\t\tthis._mconnect.init(args.hostname, args.port, args.localRoutinesPath).then(async () => {\r\n\t\t\tthis.refreshDiagnostics(vscode.window.activeTextEditor!.document, MUMPSDIAGNOSTICS);\r\n\t\t\tthis._mconnect.start(args.program, !!args.stopOnEntry);\r\n\t\t\tthis._program = args.program;\r\n\t\t\tthis.sendResponse(response);\r\n\t\t}).catch((error) => {\r\n\t\t\tvscode.window.showErrorMessage(\"Connection to MDEBUG failed. \\nPlease start MDEBUG first.\");\r\n\t\t})\r\n\r\n\t}\r\n\tprotected setBreakPointsRequest(response: DebugProtocol.SetBreakpointsResponse, args: DebugProtocol.SetBreakpointsArguments): void {\r\n\r\n\t\tconst path = <string>args.source.path;\r\n\t\tconst clientLines = args.lines || [];\r\n\r\n\t\tthis._mconnect.clearBreakpoints(path);\r\n\t\t// set and verify breakpoint locations\r\n\t\tconst actualBreakpoints = clientLines.map(l => {\r\n\t\t\tlet { verified, line, id } = this._mconnect.setBreakPoint(path, this.convertClientLineToDebugger(l));\r\n\t\t\tconst bp = <DebugProtocol.Breakpoint>new Breakpoint(verified, this.convertDebuggerLineToClient(line));\r\n\t\t\tbp.id = id;\r\n\t\t\treturn bp;\r\n\t\t});\r\n\t\t// send back the actual breakpoint positions\r\n\t\tresponse.body = {\r\n\t\t\tbreakpoints: actualBreakpoints\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t\tthis._mconnect.requestBreakpoints();\r\n\t}\r\n\r\n\tprotected threadsRequest(response: DebugProtocol.ThreadsResponse): void {\r\n\r\n\t\t// runtime supports no threads so just return a default thread.\r\n\t\tresponse.body = {\r\n\t\t\tthreads: [\r\n\t\t\t\tnew Thread(MumpsDebugSession.THREAD_ID, \"thread 1\")\r\n\t\t\t]\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stackTraceRequest(response: DebugProtocol.StackTraceResponse, args: DebugProtocol.StackTraceArguments): void {\r\n\r\n\t\tconst startFrame = typeof args.startFrame === 'number' ? args.startFrame : 0;\r\n\t\tconst maxLevels = typeof args.levels === 'number' ? args.levels : 1000;\r\n\t\tconst endFrame = startFrame + maxLevels;\r\n\r\n\t\tconst stk = this._mconnect.stack(startFrame, endFrame);\r\n\r\n\t\tresponse.body = {\r\n\t\t\tstackFrames: stk.frames.map(f => new StackFrame(f.index, f.name, this.createSource(f.file), this.convertDebuggerLineToClient(f.line))),\r\n\t\t\ttotalFrames: stk.count\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected scopesRequest(response: DebugProtocol.ScopesResponse, args: DebugProtocol.ScopesArguments): void {\r\n\r\n\t\tresponse.body = {\r\n\t\t\tscopes: [\r\n\t\t\t\tnew Scope(\"Local\", this._variableHandles.create(\"local|0\"), true),\r\n\t\t\t\tnew Scope(\"System\", this._variableHandles.create(\"system\"), false)\r\n\t\t\t]\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected async variablesRequest(response: DebugProtocol.VariablesResponse, args: DebugProtocol.VariablesArguments, request?: DebugProtocol.Request) {\r\n\r\n\t\tconst variables: DebugProtocol.Variable[] = [];\r\n\t\tlet insertVariable: DebugProtocol.Variable | undefined;\r\n\t\tconst varId = this._variableHandles.get(args.variablesReference);\r\n\t\tif (varId === \"system\") {\r\n\t\t\tlet varObject = this._mconnect.getVariables(\"system\");\r\n\t\t\tfor (let varname in varObject) {\r\n\t\t\t\tvariables.push({\r\n\t\t\t\t\tname: varname,\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tvalue: varObject[varname],\r\n\t\t\t\t\tvariablesReference: 0\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst varparts: string[] = varId.split(\"|\");\r\n\t\t\tconst indexCount: number = parseInt(varparts.pop()!);\r\n\t\t\tconst varBase = varparts.join(\"|\");\r\n\t\t\tlet varObject = this._mconnect.getVariables(\"local\");\r\n\t\t\tlet lastVar: VarData;\r\n\t\t\tlet firstTime: boolean = true;\r\n\t\t\tlet lastRef: string = \"\";\r\n\t\t\tfor (let varname in varObject) {\r\n\t\t\t\tlet actualVar = this.varAnalyze(varname, varObject[varname]);\r\n\t\t\t\tif (firstTime) { //First Variable not processed\r\n\t\t\t\t\tlastVar = actualVar;\r\n\t\t\t\t\tfirstTime = false;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (insertVariable = this.checkVars(lastVar!, actualVar, indexCount, varBase, lastRef)) {\r\n\t\t\t\t\tif (insertVariable.variablesReference !== 0) { lastRef = lastVar!.bases[indexCount]; }\r\n\t\t\t\t\tvariables.push(insertVariable);\r\n\t\t\t\t}\r\n\t\t\t\tlastVar = actualVar;\r\n\t\t\t}\r\n\t\t\tif (!firstTime) { // process Last Variable if there was minimum one\r\n\t\t\t\tconst dummyVar: VarData = { name: \"\", \"indexCount\": 0, \"bases\": [], \"content\": \"\" }\r\n\t\t\t\tif (insertVariable = this.checkVars(lastVar!, dummyVar, indexCount, varBase, lastRef)) {\r\n\t\t\t\t\tvariables.push(insertVariable);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tresponse.body = {\r\n\t\t\tvariables: variables\r\n\t\t};\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\t//checkVars checks if Variable has to be inserted in Var-Display and if it has descendants\r\n\tprivate checkVars(lastVar: VarData, actualVar: VarData, indexCount: number, varBase: string, lastRef: string): DebugProtocol.Variable | undefined {\r\n\t\tlet returnVar: DebugProtocol.Variable | undefined = undefined;\r\n\t\tlet actualReference: number = 0;\r\n\t\tif (indexCount === 0 || (lastVar.bases[indexCount - 1] === varBase && lastVar.indexCount > indexCount)) {\r\n\t\t\tif (lastVar.indexCount > indexCount + 1) {\r\n\t\t\t\tif (lastRef !== lastVar.bases[indexCount]) {\r\n\t\t\t\t\tlet name = lastVar.bases[indexCount];\r\n\t\t\t\t\tif (indexCount > 0) { name += \")\"; }\r\n\t\t\t\t\treturnVar = {\r\n\t\t\t\t\t\tname,\r\n\t\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\t\tvalue: 'undefined',\r\n\t\t\t\t\t\tvariablesReference: this._variableHandles.create(lastVar.bases[indexCount] + \"|\" + (indexCount + 1))\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t} else { //lastVar.indexCount==indexCount+1\r\n\t\t\t\tif (lastVar.bases[indexCount] === actualVar.bases[indexCount]) {\r\n\t\t\t\t\tactualReference = this._variableHandles.create(lastVar.bases[indexCount] + \"|\" + (indexCount + 1));\r\n\t\t\t\t}\r\n\t\t\t\treturnVar = {\r\n\t\t\t\t\tname: lastVar.name,\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tvalue: lastVar.content,\r\n\t\t\t\t\tvariablesReference: actualReference\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn returnVar\r\n\t}\r\n\tprotected continueRequest(response: DebugProtocol.ContinueResponse, args: DebugProtocol.ContinueArguments): void {\r\n\t\tthis._mconnect.continue();\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected nextRequest(response: DebugProtocol.NextResponse, args: DebugProtocol.NextArguments): void {\r\n\t\tthis._mconnect.step(\"OVER\");\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stepInRequest(response: DebugProtocol.StepInResponse, args: DebugProtocol.StepInArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.step(\"INTO\");\r\n\t\tthis.sendResponse(response);\r\n\t}\r\n\r\n\tprotected stepOutRequest(response: DebugProtocol.StepOutResponse, args: DebugProtocol.StepOutArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.step(\"OUTOF\");\r\n\t}\r\n\r\n\tprotected async evaluateRequest(response: DebugProtocol.EvaluateResponse, args: DebugProtocol.EvaluateArguments) {\r\n\t\tif (args.context === \"hover\" || args.context === \"repl\") {\r\n\t\t\tthis._mconnect.getSingleVar(args.expression).then((varReply: VarData) => {\r\n\t\t\t\tresponse.body = {\r\n\t\t\t\t\tresult: varReply.name + \" := \" + varReply.content,\r\n\t\t\t\t\tvariablesReference: 0\r\n\t\t\t\t};\r\n\t\t\t\tthis.sendResponse(response);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected async restartRequest(args: DebugProtocol.RestartArguments) {\r\n\t\tlet sourceLines = readFileSync(this._program).toString().split('\\n');\r\n\t\tthis._mconnect.checkRoutine(sourceLines).then((errorLines: string[]) => {\r\n\t\t\tif (errorLines.length) {\r\n\t\t\t\tvscode.window.showErrorMessage(\"File contains Problems - No Restart possible!\");\r\n\t\t\t} else {\r\n\t\t\t\tthis._mconnect.restart(this._program);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tprotected disconnectRequest(response: DebugProtocol.DisconnectResponse, args: DebugProtocol.DisconnectArguments, request?: DebugProtocol.Request): void {\r\n\t\tthis._mconnect.disconnect();\r\n\t\tthis.sendResponse(response);\r\n\t};\r\n\tprivate createSource(filePath: string): Source {\r\n\t\treturn new Source(basename(filePath), this.convertDebuggerPathToClient(filePath), undefined, undefined, 'mock-adapter-data');\r\n\t}\r\n\r\n\tprivate varAnalyze(varname: string, content: string): VarData {\r\n\t\tlet indexcount = 1;\r\n\t\tlet bases: string[] = [];\r\n\t\tlet length = varname.length;\r\n\t\tlet klammerpos = varname.indexOf(\"(\");\r\n\t\tlet countKomma = true;\r\n\t\t//let lastKommaPos = varname.length;\r\n\t\tif (klammerpos > 0) {\r\n\t\t\tbases.push(varname.substring(0, klammerpos));\r\n\t\t\tindexcount++;\r\n\t\t\t//lastKommaPos = klammerpos;\r\n\t\t\tfor (let i = klammerpos; i < length; i++) {\r\n\t\t\t\tif (varname.substring(i, i + 1) === \",\" && countKomma) {\r\n\t\t\t\t\tbases.push(varname.substring(0, i));\r\n\t\t\t\t\tindexcount++;\r\n\t\t\t\t\t//lastKommaPos = i;\r\n\t\t\t\t}\r\n\t\t\t\tif (varname.substring(i, i + 1) === '\"') { countKomma = !countKomma; }\r\n\t\t\t}\r\n\t\t\tbases.push(varname.substring(0, varname.length - 1));\r\n\t\t} else {\r\n\t\t\tbases.push(varname);\r\n\t\t}\r\n\t\treturn { \"name\": varname, \"indexCount\": indexcount, \"bases\": bases, content };\r\n\t}\r\n\tprivate refreshDiagnostics(doc: vscode.TextDocument | undefined, mumpsDiagnostics: vscode.DiagnosticCollection): void {\r\n\t\tlet diagnostics: vscode.Diagnostic[] = [];\r\n\t\tif (doc) {\r\n\t\t\tlet lines: string[] = []\r\n\t\t\tfor (let lineIndex = 0; lineIndex < doc.lineCount; lineIndex++) {\r\n\t\t\t\tconst lineOfText = doc.lineAt(lineIndex);\r\n\t\t\t\tlines.push(lineOfText.text);\r\n\t\t\t}\r\n\t\t\tthis._mconnect.checkRoutine(lines).then((errLines: string[]) => {\r\n\t\t\t\tfor (let i = 0; i < errLines.length; i++) {\r\n\t\t\t\t\tlet errData = errLines[i].split(\";\");\r\n\t\t\t\t\tlet column = parseInt(errData[0]) - 1;\r\n\t\t\t\t\tif (isNaN(column)) { column = 0 };\r\n\t\t\t\t\tlet line = parseInt(errData[1]) - 1;\r\n\t\t\t\t\tif (isNaN(line)) { line = 0 };\r\n\t\t\t\t\tlet endColumn = doc.lineAt(line).text.length\r\n\t\t\t\t\tif (line === 0 && column === 0) { endColumn = 0 };\r\n\t\t\t\t\tlet message = errData[2];\r\n\t\t\t\t\tlet range = new vscode.Range(line, column, line, endColumn);\r\n\t\t\t\t\tlet diagnostic = new vscode.Diagnostic(range, message, vscode.DiagnosticSeverity.Error);\r\n\t\t\t\t\tdiagnostic.code = message;\r\n\t\t\t\t\tdiagnostics.push(diagnostic);\r\n\t\t\t\t}\r\n\t\t\t\tmumpsDiagnostics.clear();\r\n\t\t\t\tmumpsDiagnostics.set(doc.uri, diagnostics);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst debugSession_1 = require(\"./debugSession\");\nexports.DebugSession = debugSession_1.DebugSession;\nexports.InitializedEvent = debugSession_1.InitializedEvent;\nexports.TerminatedEvent = debugSession_1.TerminatedEvent;\nexports.StoppedEvent = debugSession_1.StoppedEvent;\nexports.ContinuedEvent = debugSession_1.ContinuedEvent;\nexports.OutputEvent = debugSession_1.OutputEvent;\nexports.ThreadEvent = debugSession_1.ThreadEvent;\nexports.BreakpointEvent = debugSession_1.BreakpointEvent;\nexports.ModuleEvent = debugSession_1.ModuleEvent;\nexports.LoadedSourceEvent = debugSession_1.LoadedSourceEvent;\nexports.CapabilitiesEvent = debugSession_1.CapabilitiesEvent;\nexports.Thread = debugSession_1.Thread;\nexports.StackFrame = debugSession_1.StackFrame;\nexports.Scope = debugSession_1.Scope;\nexports.Variable = debugSession_1.Variable;\nexports.Breakpoint = debugSession_1.Breakpoint;\nexports.Source = debugSession_1.Source;\nexports.Module = debugSession_1.Module;\nexports.CompletionItem = debugSession_1.CompletionItem;\nexports.ErrorDestination = debugSession_1.ErrorDestination;\nconst loggingDebugSession_1 = require(\"./loggingDebugSession\");\nexports.LoggingDebugSession = loggingDebugSession_1.LoggingDebugSession;\nconst Logger = require(\"./logger\");\nexports.Logger = Logger;\nconst messages_1 = require(\"./messages\");\nexports.Event = messages_1.Event;\nexports.Response = messages_1.Response;\nconst handles_1 = require(\"./handles\");\nexports.Handles = handles_1.Handles;\nconst logger = Logger.logger;\nexports.logger = logger;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Z0dBR2dHO0FBQ2hHLFlBQVksQ0FBQzs7QUFFYixpREFNd0I7QUFTdkIsdUJBZEEsMkJBQVksQ0FjQTtBQUlaLDJCQWpCQSwrQkFBZ0IsQ0FpQkE7QUFBRSwwQkFqQkEsOEJBQWUsQ0FpQkE7QUFBRSx1QkFqQkEsMkJBQVksQ0FpQkE7QUFBRSx5QkFqQkEsNkJBQWMsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSwwQkFqQkEsOEJBQWUsQ0FpQkE7QUFBRSxzQkFqQkEsMEJBQVcsQ0FpQkE7QUFBRSw0QkFqQkEsZ0NBQWlCLENBaUJBO0FBQUUsNEJBakJBLGdDQUFpQixDQWlCQTtBQUM3SixpQkFqQkEscUJBQU0sQ0FpQkE7QUFBRSxxQkFqQkEseUJBQVUsQ0FpQkE7QUFBRSxnQkFqQkEsb0JBQUssQ0FpQkE7QUFBRSxtQkFqQkEsdUJBQVEsQ0FpQkE7QUFDbkMscUJBakJBLHlCQUFVLENBaUJBO0FBQUUsaUJBakJBLHFCQUFNLENBaUJBO0FBQUUsaUJBakJBLHFCQUFNLENBaUJBO0FBQUUseUJBakJBLDZCQUFjLENBaUJBO0FBQzFDLDJCQWpCQSwrQkFBZ0IsQ0FpQkE7QUFmakIsK0RBQTBEO0FBU3pELDhCQVRPLHlDQUFtQixDQVNQO0FBUnBCLG1DQUFtQztBQVNsQyx3QkFBTTtBQVJQLHlDQUE2QztBQWM1QyxnQkFkUSxnQkFBSyxDQWNSO0FBQUUsbUJBZFEsbUJBQVEsQ0FjUjtBQWJoQix1Q0FBb0M7QUFjbkMsa0JBZFEsaUJBQU8sQ0FjUjtBQVpSLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFNNUIsd0JBQU0iLCJzb3VyY2VzQ29udGVudCI6WyIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB7XG5cdERlYnVnU2Vzc2lvbixcblx0SW5pdGlhbGl6ZWRFdmVudCwgVGVybWluYXRlZEV2ZW50LCBTdG9wcGVkRXZlbnQsIENvbnRpbnVlZEV2ZW50LCBPdXRwdXRFdmVudCwgVGhyZWFkRXZlbnQsIEJyZWFrcG9pbnRFdmVudCwgTW9kdWxlRXZlbnQsIExvYWRlZFNvdXJjZUV2ZW50LCBDYXBhYmlsaXRpZXNFdmVudCxcblx0VGhyZWFkLCBTdGFja0ZyYW1lLCBTY29wZSwgVmFyaWFibGUsXG5cdEJyZWFrcG9pbnQsIFNvdXJjZSwgTW9kdWxlLCBDb21wbGV0aW9uSXRlbSxcblx0RXJyb3JEZXN0aW5hdGlvblxufSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5pbXBvcnQge0xvZ2dpbmdEZWJ1Z1Nlc3Npb259IGZyb20gJy4vbG9nZ2luZ0RlYnVnU2Vzc2lvbic7XG5pbXBvcnQgKiBhcyBMb2dnZXIgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgRXZlbnQsIFJlc3BvbnNlIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBIYW5kbGVzIH0gZnJvbSAnLi9oYW5kbGVzJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmxvZ2dlcjtcblxuZXhwb3J0IHtcblx0RGVidWdTZXNzaW9uLFxuXHRMb2dnaW5nRGVidWdTZXNzaW9uLFxuXHRMb2dnZXIsXG5cdGxvZ2dlcixcblx0SW5pdGlhbGl6ZWRFdmVudCwgVGVybWluYXRlZEV2ZW50LCBTdG9wcGVkRXZlbnQsIENvbnRpbnVlZEV2ZW50LCBPdXRwdXRFdmVudCwgVGhyZWFkRXZlbnQsIEJyZWFrcG9pbnRFdmVudCwgTW9kdWxlRXZlbnQsIExvYWRlZFNvdXJjZUV2ZW50LCBDYXBhYmlsaXRpZXNFdmVudCxcblx0VGhyZWFkLCBTdGFja0ZyYW1lLCBTY29wZSwgVmFyaWFibGUsXG5cdEJyZWFrcG9pbnQsIFNvdXJjZSwgTW9kdWxlLCBDb21wbGV0aW9uSXRlbSxcblx0RXJyb3JEZXN0aW5hdGlvbixcblx0RXZlbnQsIFJlc3BvbnNlLFxuXHRIYW5kbGVzXG59XG4iXX0=","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ee = require(\"events\");\nconst messages_1 = require(\"./messages\");\nclass Disposable0 {\n    dispose() {\n    }\n}\nclass Emitter {\n    get event() {\n        if (!this._event) {\n            this._event = (listener, thisArg) => {\n                this._listener = listener;\n                this._this = thisArg;\n                let result;\n                result = {\n                    dispose: () => {\n                        this._listener = undefined;\n                        this._this = undefined;\n                    }\n                };\n                return result;\n            };\n        }\n        return this._event;\n    }\n    fire(event) {\n        if (this._listener) {\n            try {\n                this._listener.call(this._this, event);\n            }\n            catch (e) {\n            }\n        }\n    }\n    hasListener() {\n        return !!this._listener;\n    }\n    dispose() {\n        this._listener = undefined;\n        this._this = undefined;\n    }\n}\nclass ProtocolServer extends ee.EventEmitter {\n    constructor() {\n        super();\n        this._sendMessage = new Emitter();\n        this._pendingRequests = new Map();\n        this.onDidSendMessage = this._sendMessage.event;\n    }\n    // ---- implements vscode.Debugadapter interface ---------------------------\n    dispose() {\n    }\n    handleMessage(msg) {\n        if (msg.type === 'request') {\n            this.dispatchRequest(msg);\n        }\n        else if (msg.type === 'response') {\n            const response = msg;\n            const clb = this._pendingRequests.get(response.request_seq);\n            if (clb) {\n                this._pendingRequests.delete(response.request_seq);\n                clb(response);\n            }\n        }\n    }\n    _isRunningInline() {\n        return this._sendMessage && this._sendMessage.hasListener();\n    }\n    //--------------------------------------------------------------------------\n    start(inStream, outStream) {\n        this._sequence = 1;\n        this._writableStream = outStream;\n        this._rawData = new Buffer(0);\n        inStream.on('data', (data) => this._handleData(data));\n        inStream.on('close', () => {\n            this._emitEvent(new messages_1.Event('close'));\n        });\n        inStream.on('error', (error) => {\n            this._emitEvent(new messages_1.Event('error', 'inStream error: ' + (error && error.message)));\n        });\n        outStream.on('error', (error) => {\n            this._emitEvent(new messages_1.Event('error', 'outStream error: ' + (error && error.message)));\n        });\n        inStream.resume();\n    }\n    stop() {\n        if (this._writableStream) {\n            this._writableStream.end();\n        }\n    }\n    sendEvent(event) {\n        this._send('event', event);\n    }\n    sendResponse(response) {\n        if (response.seq > 0) {\n            console.error(`attempt to send more than one response for command ${response.command}`);\n        }\n        else {\n            this._send('response', response);\n        }\n    }\n    sendRequest(command, args, timeout, cb) {\n        const request = {\n            command: command\n        };\n        if (args && Object.keys(args).length > 0) {\n            request.arguments = args;\n        }\n        if (!this._writableStream) {\n            this._emitEvent(new messages_1.Event('error', 'sendRequest: No writableStream'));\n            return;\n        }\n        this._send('request', request);\n        if (cb) {\n            this._pendingRequests.set(request.seq, cb);\n            const timer = setTimeout(() => {\n                clearTimeout(timer);\n                const clb = this._pendingRequests.get(request.seq);\n                if (clb) {\n                    this._pendingRequests.delete(request.seq);\n                    clb(new messages_1.Response(request, 'timeout'));\n                }\n            }, timeout);\n        }\n    }\n    // ---- protected ----------------------------------------------------------\n    dispatchRequest(request) {\n    }\n    // ---- private ------------------------------------------------------------\n    _emitEvent(event) {\n        this.emit(event.event, event);\n    }\n    _send(typ, message) {\n        message.type = typ;\n        message.seq = this._sequence++;\n        if (this._writableStream) {\n            const json = JSON.stringify(message);\n            this._writableStream.write(`Content-Length: ${Buffer.byteLength(json, 'utf8')}\\r\\n\\r\\n${json}`, 'utf8');\n        }\n        this._sendMessage.fire(message);\n    }\n    _handleData(data) {\n        this._rawData = Buffer.concat([this._rawData, data]);\n        while (true) {\n            if (this._contentLength >= 0) {\n                if (this._rawData.length >= this._contentLength) {\n                    const message = this._rawData.toString('utf8', 0, this._contentLength);\n                    this._rawData = this._rawData.slice(this._contentLength);\n                    this._contentLength = -1;\n                    if (message.length > 0) {\n                        try {\n                            let msg = JSON.parse(message);\n                            this.handleMessage(msg);\n                        }\n                        catch (e) {\n                            this._emitEvent(new messages_1.Event('error', 'Error handling data: ' + (e && e.message)));\n                        }\n                    }\n                    continue; // there may be more complete messages to process\n                }\n            }\n            else {\n                const idx = this._rawData.indexOf(ProtocolServer.TWO_CRLF);\n                if (idx !== -1) {\n                    const header = this._rawData.toString('utf8', 0, idx);\n                    const lines = header.split('\\r\\n');\n                    for (let i = 0; i < lines.length; i++) {\n                        const pair = lines[i].split(/: +/);\n                        if (pair[0] == 'Content-Length') {\n                            this._contentLength = +pair[1];\n                        }\n                    }\n                    this._rawData = this._rawData.slice(idx + ProtocolServer.TWO_CRLF.length);\n                    continue;\n                }\n            }\n            break;\n        }\n    }\n}\nProtocolServer.TWO_CRLF = '\\r\\n\\r\\n';\nexports.ProtocolServer = ProtocolServer;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdG9jb2wuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcHJvdG9jb2wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Z0dBR2dHOztBQUVoRyw2QkFBNkI7QUFFN0IseUNBQTZDO0FBUzdDLE1BQU0sV0FBVztJQUNoQixPQUFPO0lBQ1AsQ0FBQztDQUNEO0FBTUQsTUFBTSxPQUFPO0lBTVosSUFBSSxLQUFLO1FBQ1IsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDakIsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLFFBQXVCLEVBQUUsT0FBYSxFQUFFLEVBQUU7Z0JBRXhELElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDO2dCQUMxQixJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztnQkFFckIsSUFBSSxNQUFtQixDQUFDO2dCQUN4QixNQUFNLEdBQUc7b0JBQ1IsT0FBTyxFQUFFLEdBQUcsRUFBRTt3QkFDYixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQzt3QkFDM0IsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7b0JBQ3hCLENBQUM7aUJBQ0QsQ0FBQztnQkFDRixPQUFPLE1BQU0sQ0FBQztZQUNmLENBQUMsQ0FBQztTQUNGO1FBQ0QsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3BCLENBQUM7SUFFRCxJQUFJLENBQUMsS0FBUTtRQUNaLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNuQixJQUFJO2dCQUNILElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDdkM7WUFBQyxPQUFPLENBQUMsRUFBRTthQUNYO1NBQ0Q7SUFDRixDQUFDO0lBRUQsV0FBVztRQUNWLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDekIsQ0FBQztJQUVELE9BQU87UUFDTixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUMzQixJQUFJLENBQUMsS0FBSyxHQUFHLFNBQVMsQ0FBQztJQUN4QixDQUFDO0NBQ0Q7QUFZRCxNQUFhLGNBQWUsU0FBUSxFQUFFLENBQUMsWUFBWTtJQVlsRDtRQUNDLEtBQUssRUFBRSxDQUFDO1FBVEQsaUJBQVksR0FBRyxJQUFJLE9BQU8sRUFBd0IsQ0FBQztRQU1uRCxxQkFBZ0IsR0FBRyxJQUFJLEdBQUcsRUFBc0QsQ0FBQztRQVdsRixxQkFBZ0IsR0FBaUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUM7SUFQaEYsQ0FBQztJQUVELDRFQUE0RTtJQUVyRSxPQUFPO0lBQ2QsQ0FBQztJQUlNLGFBQWEsQ0FBQyxHQUFrQztRQUN0RCxJQUFJLEdBQUcsQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO1lBQzNCLElBQUksQ0FBQyxlQUFlLENBQXdCLEdBQUcsQ0FBQyxDQUFDO1NBQ2pEO2FBQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxLQUFLLFVBQVUsRUFBRTtZQUNuQyxNQUFNLFFBQVEsR0FBMkIsR0FBRyxDQUFDO1lBQzdDLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzVELElBQUksR0FBRyxFQUFFO2dCQUNSLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUNuRCxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7YUFDZDtTQUNEO0lBQ0YsQ0FBQztJQUVTLGdCQUFnQjtRQUN6QixPQUFPLElBQUksQ0FBQyxZQUFZLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUM3RCxDQUFDO0lBRUQsNEVBQTRFO0lBRXJFLEtBQUssQ0FBQyxRQUErQixFQUFFLFNBQWdDO1FBQzdFLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxlQUFlLEdBQUcsU0FBUyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFOUIsUUFBUSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFZLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUU5RCxRQUFRLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDekIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLGdCQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUNyQyxDQUFDLENBQUMsQ0FBQztRQUNILFFBQVEsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDOUIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLGdCQUFLLENBQUMsT0FBTyxFQUFFLGtCQUFrQixHQUFHLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDcEYsQ0FBQyxDQUFDLENBQUM7UUFFSCxTQUFTLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQy9CLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxnQkFBSyxDQUFDLE9BQU8sRUFBRSxtQkFBbUIsR0FBRyxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JGLENBQUMsQ0FBQyxDQUFDO1FBRUgsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ25CLENBQUM7SUFFTSxJQUFJO1FBQ1YsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3pCLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFFLENBQUM7U0FDM0I7SUFDRixDQUFDO0lBRU0sU0FBUyxDQUFDLEtBQTBCO1FBQzFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFTSxZQUFZLENBQUMsUUFBZ0M7UUFDbkQsSUFBSSxRQUFRLENBQUMsR0FBRyxHQUFHLENBQUMsRUFBRTtZQUNyQixPQUFPLENBQUMsS0FBSyxDQUFDLHNEQUFzRCxRQUFRLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztTQUN4RjthQUFNO1lBQ04sSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7U0FDakM7SUFDRixDQUFDO0lBRU0sV0FBVyxDQUFDLE9BQWUsRUFBRSxJQUFTLEVBQUUsT0FBZSxFQUFFLEVBQThDO1FBRTdHLE1BQU0sT0FBTyxHQUFRO1lBQ3BCLE9BQU8sRUFBRSxPQUFPO1NBQ2hCLENBQUM7UUFDRixJQUFJLElBQUksSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDekMsT0FBTyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7U0FDekI7UUFFRCxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRTtZQUMxQixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksZ0JBQUssQ0FBQyxPQUFPLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQyxDQUFDO1lBQ3RFLE9BQU87U0FDUDtRQUVELElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRS9CLElBQUksRUFBRSxFQUFFO1lBQ1AsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBRTNDLE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxHQUFHLEVBQUU7Z0JBQzdCLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDcEIsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ25ELElBQUksR0FBRyxFQUFFO29CQUNSLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO29CQUMxQyxHQUFHLENBQUMsSUFBSSxtQkFBUSxDQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDO2lCQUN0QztZQUNGLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUNaO0lBQ0YsQ0FBQztJQUVELDRFQUE0RTtJQUVsRSxlQUFlLENBQUMsT0FBOEI7SUFDeEQsQ0FBQztJQUVELDRFQUE0RTtJQUVwRSxVQUFVLENBQUMsS0FBMEI7UUFDNUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQy9CLENBQUM7SUFFTyxLQUFLLENBQUMsR0FBcUMsRUFBRSxPQUFzQztRQUUxRixPQUFPLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQztRQUNuQixPQUFPLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUUvQixJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFDekIsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUNyQyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLFdBQVcsSUFBSSxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDeEc7UUFDRCxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRU8sV0FBVyxDQUFDLElBQVk7UUFFL0IsSUFBSSxDQUFDLFFBQVEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBRXJELE9BQU8sSUFBSSxFQUFFO1lBQ1osSUFBSSxJQUFJLENBQUMsY0FBYyxJQUFJLENBQUMsRUFBRTtnQkFDN0IsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO29CQUNoRCxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztvQkFDdkUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7b0JBQ3pELElBQUksQ0FBQyxjQUFjLEdBQUcsQ0FBQyxDQUFDLENBQUM7b0JBQ3pCLElBQUksT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7d0JBQ3ZCLElBQUk7NEJBQ0gsSUFBSSxHQUFHLEdBQWtDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7NEJBQzdELElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUM7eUJBQ3hCO3dCQUNELE9BQU8sQ0FBQyxFQUFFOzRCQUNULElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxnQkFBSyxDQUFDLE9BQU8sRUFBRSx1QkFBdUIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO3lCQUNoRjtxQkFDRDtvQkFDRCxTQUFTLENBQUMsaURBQWlEO2lCQUMzRDthQUNEO2lCQUFNO2dCQUNOLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDM0QsSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLEVBQUU7b0JBQ2YsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztvQkFDdEQsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztvQkFDbkMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7d0JBQ3RDLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQ25DLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLGdCQUFnQixFQUFFOzRCQUNoQyxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO3lCQUMvQjtxQkFDRDtvQkFDRCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxjQUFjLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO29CQUMxRSxTQUFTO2lCQUNUO2FBQ0Q7WUFDRCxNQUFNO1NBQ047SUFDRixDQUFDOztBQTFLYyx1QkFBUSxHQUFHLFVBQVUsQ0FBQztBQUZ0Qyx3Q0E2S0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0ICogYXMgZWUgZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7IERlYnVnUHJvdG9jb2wgfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5pbXBvcnQgeyBSZXNwb25zZSwgRXZlbnQgfSBmcm9tICcuL21lc3NhZ2VzJztcblxuaW50ZXJmYWNlIERlYnVnUHJvdG9jb2xNZXNzYWdlIHtcbn1cblxuaW50ZXJmYWNlIElEaXNwb3NhYmxlIHtcblx0ZGlzcG9zZSgpOiB2b2lkO1xufVxuXG5jbGFzcyBEaXNwb3NhYmxlMCBpbXBsZW1lbnRzIElEaXNwb3NhYmxlIHtcblx0ZGlzcG9zZSgpOiBhbnkge1xuXHR9XG59XG5cbmludGVyZmFjZSBFdmVudDA8VD4ge1xuXHQobGlzdGVuZXI6IChlOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpOiBEaXNwb3NhYmxlMDtcbn1cblxuY2xhc3MgRW1pdHRlcjxUPiB7XG5cblx0cHJpdmF0ZSBfZXZlbnQ/OiBFdmVudDA8VD47XG5cdHByaXZhdGUgX2xpc3RlbmVyPzogKGU6IFQpID0+IHZvaWQ7XG5cdHByaXZhdGUgX3RoaXM/OiBhbnk7XG5cblx0Z2V0IGV2ZW50KCk6IEV2ZW50MDxUPiB7XG5cdFx0aWYgKCF0aGlzLl9ldmVudCkge1xuXHRcdFx0dGhpcy5fZXZlbnQgPSAobGlzdGVuZXI6IChlOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpID0+IHtcblxuXHRcdFx0XHR0aGlzLl9saXN0ZW5lciA9IGxpc3RlbmVyO1xuXHRcdFx0XHR0aGlzLl90aGlzID0gdGhpc0FyZztcblxuXHRcdFx0XHRsZXQgcmVzdWx0OiBJRGlzcG9zYWJsZTtcblx0XHRcdFx0cmVzdWx0ID0ge1xuXHRcdFx0XHRcdGRpc3Bvc2U6ICgpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMuX2xpc3RlbmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0dGhpcy5fdGhpcyA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5fZXZlbnQ7XG5cdH1cblxuXHRmaXJlKGV2ZW50OiBUKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuX2xpc3RlbmVyKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR0aGlzLl9saXN0ZW5lci5jYWxsKHRoaXMuX3RoaXMsIGV2ZW50KTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRoYXNMaXN0ZW5lcigpIDogYm9vbGVhbiB7XG5cdFx0cmV0dXJuICEhdGhpcy5fbGlzdGVuZXI7XG5cdH1cblxuXHRkaXNwb3NlKCkge1xuXHRcdHRoaXMuX2xpc3RlbmVyID0gdW5kZWZpbmVkO1xuXHRcdHRoaXMuX3RoaXMgPSB1bmRlZmluZWQ7XG5cdH1cbn1cblxuLyoqXG4gKiBBIHN0cnVjdHVyYWxseSBlcXVpdmFsZW50IGNvcHkgb2YgdnNjb2RlLkRlYnVnQWRhcHRlclxuICovXG5pbnRlcmZhY2UgVlNDb2RlRGVidWdBZGFwdGVyIGV4dGVuZHMgRGlzcG9zYWJsZTAge1xuXG5cdHJlYWRvbmx5IG9uRGlkU2VuZE1lc3NhZ2U6IEV2ZW50MDxEZWJ1Z1Byb3RvY29sTWVzc2FnZT47XG5cblx0aGFuZGxlTWVzc2FnZShtZXNzYWdlOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBQcm90b2NvbFNlcnZlciBleHRlbmRzIGVlLkV2ZW50RW1pdHRlciBpbXBsZW1lbnRzIFZTQ29kZURlYnVnQWRhcHRlciB7XG5cblx0cHJpdmF0ZSBzdGF0aWMgVFdPX0NSTEYgPSAnXFxyXFxuXFxyXFxuJztcblxuXHRwcml2YXRlIF9zZW5kTWVzc2FnZSA9IG5ldyBFbWl0dGVyPERlYnVnUHJvdG9jb2xNZXNzYWdlPigpO1xuXG5cdHByaXZhdGUgX3Jhd0RhdGE6IEJ1ZmZlcjtcblx0cHJpdmF0ZSBfY29udGVudExlbmd0aDogbnVtYmVyO1xuXHRwcml2YXRlIF9zZXF1ZW5jZTogbnVtYmVyO1xuXHRwcml2YXRlIF93cml0YWJsZVN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtO1xuXHRwcml2YXRlIF9wZW5kaW5nUmVxdWVzdHMgPSBuZXcgTWFwPG51bWJlciwgKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlKSA9PiB2b2lkPigpO1xuXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHQvLyAtLS0tIGltcGxlbWVudHMgdnNjb2RlLkRlYnVnYWRhcHRlciBpbnRlcmZhY2UgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHVibGljIGRpc3Bvc2UoKTogYW55IHtcblx0fVxuXG5cdHB1YmxpYyBvbkRpZFNlbmRNZXNzYWdlOiBFdmVudDA8RGVidWdQcm90b2NvbE1lc3NhZ2U+ID0gdGhpcy5fc2VuZE1lc3NhZ2UuZXZlbnQ7XG5cblx0cHVibGljIGhhbmRsZU1lc3NhZ2UobXNnOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSk6IHZvaWQge1xuXHRcdGlmIChtc2cudHlwZSA9PT0gJ3JlcXVlc3QnKSB7XG5cdFx0XHR0aGlzLmRpc3BhdGNoUmVxdWVzdCg8RGVidWdQcm90b2NvbC5SZXF1ZXN0Pm1zZyk7XG5cdFx0fSBlbHNlIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJykge1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSA8RGVidWdQcm90b2NvbC5SZXNwb25zZT5tc2c7XG5cdFx0XHRjb25zdCBjbGIgPSB0aGlzLl9wZW5kaW5nUmVxdWVzdHMuZ2V0KHJlc3BvbnNlLnJlcXVlc3Rfc2VxKTtcblx0XHRcdGlmIChjbGIpIHtcblx0XHRcdFx0dGhpcy5fcGVuZGluZ1JlcXVlc3RzLmRlbGV0ZShyZXNwb25zZS5yZXF1ZXN0X3NlcSk7XG5cdFx0XHRcdGNsYihyZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJvdGVjdGVkIF9pc1J1bm5pbmdJbmxpbmUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlbmRNZXNzYWdlICYmIHRoaXMuX3NlbmRNZXNzYWdlLmhhc0xpc3RlbmVyKCk7XG5cdH1cblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHVibGljIHN0YXJ0KGluU3RyZWFtOiBOb2RlSlMuUmVhZGFibGVTdHJlYW0sIG91dFN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKTogdm9pZCB7XG5cdFx0dGhpcy5fc2VxdWVuY2UgPSAxO1xuXHRcdHRoaXMuX3dyaXRhYmxlU3RyZWFtID0gb3V0U3RyZWFtO1xuXHRcdHRoaXMuX3Jhd0RhdGEgPSBuZXcgQnVmZmVyKDApO1xuXG5cdFx0aW5TdHJlYW0ub24oJ2RhdGEnLCAoZGF0YTogQnVmZmVyKSA9PiB0aGlzLl9oYW5kbGVEYXRhKGRhdGEpKTtcblxuXHRcdGluU3RyZWFtLm9uKCdjbG9zZScsICgpID0+IHtcblx0XHRcdHRoaXMuX2VtaXRFdmVudChuZXcgRXZlbnQoJ2Nsb3NlJykpO1xuXHRcdH0pO1xuXHRcdGluU3RyZWFtLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuXHRcdFx0dGhpcy5fZW1pdEV2ZW50KG5ldyBFdmVudCgnZXJyb3InLCAnaW5TdHJlYW0gZXJyb3I6ICcgKyAoZXJyb3IgJiYgZXJyb3IubWVzc2FnZSkpKTtcblx0XHR9KTtcblxuXHRcdG91dFN0cmVhbS5vbignZXJyb3InLCAoZXJyb3IpID0+IHtcblx0XHRcdHRoaXMuX2VtaXRFdmVudChuZXcgRXZlbnQoJ2Vycm9yJywgJ291dFN0cmVhbSBlcnJvcjogJyArIChlcnJvciAmJiBlcnJvci5tZXNzYWdlKSkpO1xuXHRcdH0pO1xuXG5cdFx0aW5TdHJlYW0ucmVzdW1lKCk7XG5cdH1cblxuXHRwdWJsaWMgc3RvcCgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5fd3JpdGFibGVTdHJlYW0pIHtcblx0XHRcdHRoaXMuX3dyaXRhYmxlU3RyZWFtLmVuZCgpO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBzZW5kRXZlbnQoZXZlbnQ6IERlYnVnUHJvdG9jb2wuRXZlbnQpOiB2b2lkIHtcblx0XHR0aGlzLl9zZW5kKCdldmVudCcsIGV2ZW50KTtcblx0fVxuXG5cdHB1YmxpYyBzZW5kUmVzcG9uc2UocmVzcG9uc2U6IERlYnVnUHJvdG9jb2wuUmVzcG9uc2UpOiB2b2lkIHtcblx0XHRpZiAocmVzcG9uc2Uuc2VxID4gMCkge1xuXHRcdFx0Y29uc29sZS5lcnJvcihgYXR0ZW1wdCB0byBzZW5kIG1vcmUgdGhhbiBvbmUgcmVzcG9uc2UgZm9yIGNvbW1hbmQgJHtyZXNwb25zZS5jb21tYW5kfWApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zZW5kKCdyZXNwb25zZScsIHJlc3BvbnNlKTtcblx0XHR9XG5cdH1cblxuXHRwdWJsaWMgc2VuZFJlcXVlc3QoY29tbWFuZDogc3RyaW5nLCBhcmdzOiBhbnksIHRpbWVvdXQ6IG51bWJlciwgY2I6IChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXNwb25zZSkgPT4gdm9pZCkgOiB2b2lkIHtcblxuXHRcdGNvbnN0IHJlcXVlc3Q6IGFueSA9IHtcblx0XHRcdGNvbW1hbmQ6IGNvbW1hbmRcblx0XHR9O1xuXHRcdGlmIChhcmdzICYmIE9iamVjdC5rZXlzKGFyZ3MpLmxlbmd0aCA+IDApIHtcblx0XHRcdHJlcXVlc3QuYXJndW1lbnRzID0gYXJncztcblx0XHR9XG5cblx0XHRpZiAoIXRoaXMuX3dyaXRhYmxlU3RyZWFtKSB7XG5cdFx0XHR0aGlzLl9lbWl0RXZlbnQobmV3IEV2ZW50KCdlcnJvcicsICdzZW5kUmVxdWVzdDogTm8gd3JpdGFibGVTdHJlYW0nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5fc2VuZCgncmVxdWVzdCcsIHJlcXVlc3QpO1xuXG5cdFx0aWYgKGNiKSB7XG5cdFx0XHR0aGlzLl9wZW5kaW5nUmVxdWVzdHMuc2V0KHJlcXVlc3Quc2VxLCBjYik7XG5cblx0XHRcdGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdGNvbnN0IGNsYiA9IHRoaXMuX3BlbmRpbmdSZXF1ZXN0cy5nZXQocmVxdWVzdC5zZXEpO1xuXHRcdFx0XHRpZiAoY2xiKSB7XG5cdFx0XHRcdFx0dGhpcy5fcGVuZGluZ1JlcXVlc3RzLmRlbGV0ZShyZXF1ZXN0LnNlcSk7XG5cdFx0XHRcdFx0Y2xiKG5ldyBSZXNwb25zZShyZXF1ZXN0LCAndGltZW91dCcpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgdGltZW91dCk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gLS0tLSBwcm90ZWN0ZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHByb3RlY3RlZCBkaXNwYXRjaFJlcXVlc3QocmVxdWVzdDogRGVidWdQcm90b2NvbC5SZXF1ZXN0KTogdm9pZCB7XG5cdH1cblxuXHQvLyAtLS0tIHByaXZhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0cHJpdmF0ZSBfZW1pdEV2ZW50KGV2ZW50OiBEZWJ1Z1Byb3RvY29sLkV2ZW50KSB7XG5cdFx0dGhpcy5lbWl0KGV2ZW50LmV2ZW50LCBldmVudCk7XG5cdH1cblxuXHRwcml2YXRlIF9zZW5kKHR5cDogJ3JlcXVlc3QnIHwgJ3Jlc3BvbnNlJyB8ICdldmVudCcsIG1lc3NhZ2U6IERlYnVnUHJvdG9jb2wuUHJvdG9jb2xNZXNzYWdlKTogdm9pZCB7XG5cblx0XHRtZXNzYWdlLnR5cGUgPSB0eXA7XG5cdFx0bWVzc2FnZS5zZXEgPSB0aGlzLl9zZXF1ZW5jZSsrO1xuXG5cdFx0aWYgKHRoaXMuX3dyaXRhYmxlU3RyZWFtKSB7XG5cdFx0XHRjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG5cdFx0XHR0aGlzLl93cml0YWJsZVN0cmVhbS53cml0ZShgQ29udGVudC1MZW5ndGg6ICR7QnVmZmVyLmJ5dGVMZW5ndGgoanNvbiwgJ3V0ZjgnKX1cXHJcXG5cXHJcXG4ke2pzb259YCwgJ3V0ZjgnKTtcblx0XHR9XG5cdFx0dGhpcy5fc2VuZE1lc3NhZ2UuZmlyZShtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgX2hhbmRsZURhdGEoZGF0YTogQnVmZmVyKTogdm9pZCB7XG5cblx0XHR0aGlzLl9yYXdEYXRhID0gQnVmZmVyLmNvbmNhdChbdGhpcy5fcmF3RGF0YSwgZGF0YV0pO1xuXG5cdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdGlmICh0aGlzLl9jb250ZW50TGVuZ3RoID49IDApIHtcblx0XHRcdFx0aWYgKHRoaXMuX3Jhd0RhdGEubGVuZ3RoID49IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcblx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy5fcmF3RGF0YS50b1N0cmluZygndXRmOCcsIDAsIHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuXHRcdFx0XHRcdHRoaXMuX3Jhd0RhdGEgPSB0aGlzLl9yYXdEYXRhLnNsaWNlKHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnRMZW5ndGggPSAtMTtcblx0XHRcdFx0XHRpZiAobWVzc2FnZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRsZXQgbXNnOiBEZWJ1Z1Byb3RvY29sLlByb3RvY29sTWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZSk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuaGFuZGxlTWVzc2FnZShtc2cpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Y2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5fZW1pdEV2ZW50KG5ldyBFdmVudCgnZXJyb3InLCAnRXJyb3IgaGFuZGxpbmcgZGF0YTogJyArIChlICYmIGUubWVzc2FnZSkpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29udGludWU7XHQvLyB0aGVyZSBtYXkgYmUgbW9yZSBjb21wbGV0ZSBtZXNzYWdlcyB0byBwcm9jZXNzXG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGlkeCA9IHRoaXMuX3Jhd0RhdGEuaW5kZXhPZihQcm90b2NvbFNlcnZlci5UV09fQ1JMRik7XG5cdFx0XHRcdGlmIChpZHggIT09IC0xKSB7XG5cdFx0XHRcdFx0Y29uc3QgaGVhZGVyID0gdGhpcy5fcmF3RGF0YS50b1N0cmluZygndXRmOCcsIDAsIGlkeCk7XG5cdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBoZWFkZXIuc3BsaXQoJ1xcclxcbicpO1xuXHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGNvbnN0IHBhaXIgPSBsaW5lc1tpXS5zcGxpdCgvOiArLyk7XG5cdFx0XHRcdFx0XHRpZiAocGFpclswXSA9PSAnQ29udGVudC1MZW5ndGgnKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuX2NvbnRlbnRMZW5ndGggPSArcGFpclsxXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5fcmF3RGF0YSA9IHRoaXMuX3Jhd0RhdGEuc2xpY2UoaWR4ICsgUHJvdG9jb2xTZXJ2ZXIuVFdPX0NSTEYubGVuZ3RoKTtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG59XG4iXX0=","module.exports = require(\"url\");","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Logger = require(\"./logger\");\nconst logger = Logger.logger;\nconst debugSession_1 = require(\"./debugSession\");\nclass LoggingDebugSession extends debugSession_1.DebugSession {\n    constructor(obsolete_logFilePath, obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer) {\n        super(obsolete_debuggerLinesAndColumnsStartAt1, obsolete_isServer);\n        this.obsolete_logFilePath = obsolete_logFilePath;\n        this.on('error', (event) => {\n            logger.error(event.body);\n        });\n    }\n    start(inStream, outStream) {\n        super.start(inStream, outStream);\n        logger.init(e => this.sendEvent(e), this.obsolete_logFilePath, this._isServer);\n    }\n    /**\n     * Overload sendEvent to log\n     */\n    sendEvent(event) {\n        if (!(event instanceof Logger.LogOutputEvent)) {\n            // Don't create an infinite loop...\n            let objectToLog = event;\n            if (event instanceof debugSession_1.OutputEvent && event.body && event.body.data && event.body.data.doNotLogOutput) {\n                delete event.body.data.doNotLogOutput;\n                objectToLog = Object.assign({}, event);\n                objectToLog.body = Object.assign({}, event.body, { output: '<output not logged>' });\n            }\n            logger.verbose(`To client: ${JSON.stringify(objectToLog)}`);\n        }\n        super.sendEvent(event);\n    }\n    /**\n     * Overload sendRequest to log\n     */\n    sendRequest(command, args, timeout, cb) {\n        logger.verbose(`To client: ${JSON.stringify(command)}(${JSON.stringify(args)}), timeout: ${timeout}`);\n        super.sendRequest(command, args, timeout, cb);\n    }\n    /**\n     * Overload sendResponse to log\n     */\n    sendResponse(response) {\n        logger.verbose(`To client: ${JSON.stringify(response)}`);\n        super.sendResponse(response);\n    }\n    dispatchRequest(request) {\n        logger.verbose(`From client: ${request.command}(${JSON.stringify(request.arguments)})`);\n        super.dispatchRequest(request);\n    }\n}\nexports.LoggingDebugSession = LoggingDebugSession;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2luZ0RlYnVnU2Vzc2lvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9sb2dnaW5nRGVidWdTZXNzaW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O2dHQUdnRzs7QUFJaEcsbUNBQW1DO0FBQ25DLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDN0IsaURBQXlEO0FBRXpELE1BQWEsbUJBQW9CLFNBQVEsMkJBQVk7SUFDcEQsWUFBMkIsb0JBQTZCLEVBQUUsd0NBQWtELEVBQUUsaUJBQTJCO1FBQ3hJLEtBQUssQ0FBQyx3Q0FBd0MsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO1FBRHpDLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBUztRQUd2RCxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQTBCLEVBQUUsRUFBRTtZQUMvQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFTSxLQUFLLENBQUMsUUFBK0IsRUFBRSxTQUFnQztRQUM3RSxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNqQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2hGLENBQUM7SUFFRDs7T0FFRztJQUNJLFNBQVMsQ0FBQyxLQUEwQjtRQUMxQyxJQUFJLENBQUMsQ0FBQyxLQUFLLFlBQVksTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQzlDLG1DQUFtQztZQUVuQyxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDeEIsSUFBSSxLQUFLLFlBQVksMEJBQVcsSUFBSSxLQUFLLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBRTtnQkFDcEcsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7Z0JBQ3RDLFdBQVcscUJBQVEsS0FBSyxDQUFFLENBQUM7Z0JBQzNCLFdBQVcsQ0FBQyxJQUFJLHFCQUFRLEtBQUssQ0FBQyxJQUFJLElBQUUsTUFBTSxFQUFFLHFCQUFxQixHQUFFLENBQUE7YUFDbkU7WUFFRCxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDNUQ7UUFFRCxLQUFLLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFFRDs7T0FFRztJQUNJLFdBQVcsQ0FBQyxPQUFlLEVBQUUsSUFBUyxFQUFFLE9BQWUsRUFBRSxFQUE4QztRQUM3RyxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxlQUFlLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFDdEcsS0FBSyxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxZQUFZLENBQUMsUUFBZ0M7UUFDbkQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELEtBQUssQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVTLGVBQWUsQ0FBQyxPQUE4QjtRQUN2RCxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixPQUFPLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBRSxHQUFHLENBQUMsQ0FBQztRQUN6RixLQUFLLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2hDLENBQUM7Q0FDRDtBQXRERCxrREFzREMiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuaW1wb3J0IHtEZWJ1Z1Byb3RvY29sfSBmcm9tICd2c2NvZGUtZGVidWdwcm90b2NvbCc7XG5cbmltcG9ydCAqIGFzIExvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5jb25zdCBsb2dnZXIgPSBMb2dnZXIubG9nZ2VyO1xuaW1wb3J0IHtEZWJ1Z1Nlc3Npb24sIE91dHB1dEV2ZW50fSBmcm9tICcuL2RlYnVnU2Vzc2lvbic7XG5cbmV4cG9ydCBjbGFzcyBMb2dnaW5nRGVidWdTZXNzaW9uIGV4dGVuZHMgRGVidWdTZXNzaW9uIHtcblx0cHVibGljIGNvbnN0cnVjdG9yKHByaXZhdGUgb2Jzb2xldGVfbG9nRmlsZVBhdGg/OiBzdHJpbmcsIG9ic29sZXRlX2RlYnVnZ2VyTGluZXNBbmRDb2x1bW5zU3RhcnRBdDE/OiBib29sZWFuLCBvYnNvbGV0ZV9pc1NlcnZlcj86IGJvb2xlYW4pIHtcblx0XHRzdXBlcihvYnNvbGV0ZV9kZWJ1Z2dlckxpbmVzQW5kQ29sdW1uc1N0YXJ0QXQxLCBvYnNvbGV0ZV9pc1NlcnZlcik7XG5cblx0XHR0aGlzLm9uKCdlcnJvcicsIChldmVudDogRGVidWdQcm90b2NvbC5FdmVudCkgPT4ge1xuXHRcdFx0bG9nZ2VyLmVycm9yKGV2ZW50LmJvZHkpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIHN0YXJ0KGluU3RyZWFtOiBOb2RlSlMuUmVhZGFibGVTdHJlYW0sIG91dFN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKTogdm9pZCB7XG5cdFx0c3VwZXIuc3RhcnQoaW5TdHJlYW0sIG91dFN0cmVhbSk7XG5cdFx0bG9nZ2VyLmluaXQoZSA9PiB0aGlzLnNlbmRFdmVudChlKSwgdGhpcy5vYnNvbGV0ZV9sb2dGaWxlUGF0aCwgdGhpcy5faXNTZXJ2ZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIE92ZXJsb2FkIHNlbmRFdmVudCB0byBsb2dcblx0ICovXG5cdHB1YmxpYyBzZW5kRXZlbnQoZXZlbnQ6IERlYnVnUHJvdG9jb2wuRXZlbnQpOiB2b2lkIHtcblx0XHRpZiAoIShldmVudCBpbnN0YW5jZW9mIExvZ2dlci5Mb2dPdXRwdXRFdmVudCkpIHtcblx0XHRcdC8vIERvbid0IGNyZWF0ZSBhbiBpbmZpbml0ZSBsb29wLi4uXG5cblx0XHRcdGxldCBvYmplY3RUb0xvZyA9IGV2ZW50O1xuXHRcdFx0aWYgKGV2ZW50IGluc3RhbmNlb2YgT3V0cHV0RXZlbnQgJiYgZXZlbnQuYm9keSAmJiBldmVudC5ib2R5LmRhdGEgJiYgZXZlbnQuYm9keS5kYXRhLmRvTm90TG9nT3V0cHV0KSB7XG5cdFx0XHRcdGRlbGV0ZSBldmVudC5ib2R5LmRhdGEuZG9Ob3RMb2dPdXRwdXQ7XG5cdFx0XHRcdG9iamVjdFRvTG9nID0geyAuLi5ldmVudCB9O1xuXHRcdFx0XHRvYmplY3RUb0xvZy5ib2R5ID0geyAuLi5ldmVudC5ib2R5LCBvdXRwdXQ6ICc8b3V0cHV0IG5vdCBsb2dnZWQ+JyB9XG5cdFx0XHR9XG5cblx0XHRcdGxvZ2dlci52ZXJib3NlKGBUbyBjbGllbnQ6ICR7SlNPTi5zdHJpbmdpZnkob2JqZWN0VG9Mb2cpfWApO1xuXHRcdH1cblxuXHRcdHN1cGVyLnNlbmRFdmVudChldmVudCk7XG5cdH1cblxuXHQvKipcblx0ICogT3ZlcmxvYWQgc2VuZFJlcXVlc3QgdG8gbG9nXG5cdCAqL1xuXHRwdWJsaWMgc2VuZFJlcXVlc3QoY29tbWFuZDogc3RyaW5nLCBhcmdzOiBhbnksIHRpbWVvdXQ6IG51bWJlciwgY2I6IChyZXNwb25zZTogRGVidWdQcm90b2NvbC5SZXNwb25zZSkgPT4gdm9pZCk6IHZvaWQge1xuXHRcdGxvZ2dlci52ZXJib3NlKGBUbyBjbGllbnQ6ICR7SlNPTi5zdHJpbmdpZnkoY29tbWFuZCl9KCR7SlNPTi5zdHJpbmdpZnkoYXJncyl9KSwgdGltZW91dDogJHt0aW1lb3V0fWApO1xuXHRcdHN1cGVyLnNlbmRSZXF1ZXN0KGNvbW1hbmQsIGFyZ3MsIHRpbWVvdXQsIGNiKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBPdmVybG9hZCBzZW5kUmVzcG9uc2UgdG8gbG9nXG5cdCAqL1xuXHRwdWJsaWMgc2VuZFJlc3BvbnNlKHJlc3BvbnNlOiBEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlKTogdm9pZCB7XG5cdFx0bG9nZ2VyLnZlcmJvc2UoYFRvIGNsaWVudDogJHtKU09OLnN0cmluZ2lmeShyZXNwb25zZSl9YCk7XG5cdFx0c3VwZXIuc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0fVxuXG5cdHByb3RlY3RlZCBkaXNwYXRjaFJlcXVlc3QocmVxdWVzdDogRGVidWdQcm90b2NvbC5SZXF1ZXN0KTogdm9pZCB7XG5cdFx0bG9nZ2VyLnZlcmJvc2UoYEZyb20gY2xpZW50OiAke3JlcXVlc3QuY29tbWFuZH0oJHtKU09OLnN0cmluZ2lmeShyZXF1ZXN0LmFyZ3VtZW50cykgfSlgKTtcblx0XHRzdXBlci5kaXNwYXRjaFJlcXVlc3QocmVxdWVzdCk7XG5cdH1cbn1cbiJdfQ==","var path = require('path');\nvar fs = require('fs');\nvar _0777 = parseInt('0777', 8);\n\nmodule.exports = mkdirP.mkdirp = mkdirP.mkdirP = mkdirP;\n\nfunction mkdirP (p, opts, f, made) {\n    if (typeof opts === 'function') {\n        f = opts;\n        opts = {};\n    }\n    else if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n    \n    var cb = f || function () {};\n    p = path.resolve(p);\n    \n    xfs.mkdir(p, mode, function (er) {\n        if (!er) {\n            made = made || p;\n            return cb(null, made);\n        }\n        switch (er.code) {\n            case 'ENOENT':\n                mkdirP(path.dirname(p), opts, function (er, made) {\n                    if (er) cb(er, made);\n                    else mkdirP(p, opts, cb, made);\n                });\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                xfs.stat(p, function (er2, stat) {\n                    // if the stat fails, then that's super weird.\n                    // let the original error be the failure reason.\n                    if (er2 || !stat.isDirectory()) cb(er, made)\n                    else cb(null, made);\n                });\n                break;\n        }\n    });\n}\n\nmkdirP.sync = function sync (p, opts, made) {\n    if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n\n    p = path.resolve(p);\n\n    try {\n        xfs.mkdirSync(p, mode);\n        made = made || p;\n    }\n    catch (err0) {\n        switch (err0.code) {\n            case 'ENOENT' :\n                made = sync(path.dirname(p), opts, made);\n                sync(p, opts, made);\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                var stat;\n                try {\n                    stat = xfs.statSync(p);\n                }\n                catch (err1) {\n                    throw err0;\n                }\n                if (!stat.isDirectory()) throw err0;\n                break;\n        }\n    }\n\n    return made;\n};\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Handles {\n    constructor(startHandle) {\n        this.START_HANDLE = 1000;\n        this._handleMap = new Map();\n        this._nextHandle = typeof startHandle === 'number' ? startHandle : this.START_HANDLE;\n    }\n    reset() {\n        this._nextHandle = this.START_HANDLE;\n        this._handleMap = new Map();\n    }\n    create(value) {\n        var handle = this._nextHandle++;\n        this._handleMap.set(handle, value);\n        return handle;\n    }\n    get(handle, dflt) {\n        return this._handleMap.get(handle) || dflt;\n    }\n}\nexports.Handles = Handles;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9oYW5kbGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O2dHQUdnRzs7QUFFaEcsTUFBYSxPQUFPO0lBT25CLFlBQW1CLFdBQW9CO1FBTC9CLGlCQUFZLEdBQUcsSUFBSSxDQUFDO1FBR3BCLGVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFDO1FBR3pDLElBQUksQ0FBQyxXQUFXLEdBQUcsT0FBTyxXQUFXLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDdEYsQ0FBQztJQUVNLEtBQUs7UUFDWCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDckMsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFDO0lBQ3hDLENBQUM7SUFFTSxNQUFNLENBQUMsS0FBUTtRQUNyQixJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ25DLE9BQU8sTUFBTSxDQUFDO0lBQ2YsQ0FBQztJQUVNLEdBQUcsQ0FBQyxNQUFjLEVBQUUsSUFBUTtRQUNsQyxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQztJQUM1QyxDQUFDO0NBQ0Q7QUF6QkQsMEJBeUJDIiwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbmV4cG9ydCBjbGFzcyBIYW5kbGVzPFQ+IHtcblxuXHRwcml2YXRlIFNUQVJUX0hBTkRMRSA9IDEwMDA7XG5cblx0cHJpdmF0ZSBfbmV4dEhhbmRsZSA6IG51bWJlcjtcblx0cHJpdmF0ZSBfaGFuZGxlTWFwID0gbmV3IE1hcDxudW1iZXIsIFQ+KCk7XG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHN0YXJ0SGFuZGxlPzogbnVtYmVyKSB7XG5cdFx0dGhpcy5fbmV4dEhhbmRsZSA9IHR5cGVvZiBzdGFydEhhbmRsZSA9PT0gJ251bWJlcicgPyBzdGFydEhhbmRsZSA6IHRoaXMuU1RBUlRfSEFORExFO1xuXHR9XG5cblx0cHVibGljIHJlc2V0KCk6IHZvaWQge1xuXHRcdHRoaXMuX25leHRIYW5kbGUgPSB0aGlzLlNUQVJUX0hBTkRMRTtcblx0XHR0aGlzLl9oYW5kbGVNYXAgPSBuZXcgTWFwPG51bWJlciwgVD4oKTtcblx0fVxuXG5cdHB1YmxpYyBjcmVhdGUodmFsdWU6IFQpOiBudW1iZXIge1xuXHRcdHZhciBoYW5kbGUgPSB0aGlzLl9uZXh0SGFuZGxlKys7XG5cdFx0dGhpcy5faGFuZGxlTWFwLnNldChoYW5kbGUsIHZhbHVlKTtcblx0XHRyZXR1cm4gaGFuZGxlO1xuXHR9XG5cblx0cHVibGljIGdldChoYW5kbGU6IG51bWJlciwgZGZsdD86IFQpOiBUIHtcblx0XHRyZXR1cm4gdGhpcy5faGFuZGxlTWFwLmdldChoYW5kbGUpIHx8IGRmbHQ7XG5cdH1cbn1cbiJdfQ==","function Subject() {\n  this.waiters = [];\n}\n\nSubject.prototype.wait = function (timeout) {\n  var self = this;\n  var waiter = {};\n  this.waiters.push(waiter);\n  var promise = new Promise(function (resolve) {\n    var resolved = false;\n    waiter.resolve = function (noRemove) {\n      if (resolved) {\n        return;\n      }\n      resolved = true;\n      if (waiter.timeout) {\n        clearTimeout(waiter.timeout);\n        waiter.timeout = null;\n      }\n      if (!noRemove) {\n        var pos = self.waiters.indexOf(waiter);\n        if (pos > -1) {\n          self.waiters.splice(pos, 1);\n        }\n      }\n      resolve();\n    };\n  });\n  if (timeout > 0 && isFinite(timeout)) {\n    waiter.timeout = setTimeout(function () {\n      waiter.timeout = null;\n      waiter.resolve();\n    }, timeout);\n  }\n  return promise;\n};\n\nSubject.prototype.notify = function () {\n  if (this.waiters.length > 0) {\n    this.waiters.pop().resolve(true);\n  }\n};\n\nSubject.prototype.notifyAll = function () {\n  for (var i = this.waiters.length - 1; i >= 0; i--) {\n    this.waiters[i].resolve(true);\n  }\n  this.waiters = [];\n}\n\nexports.Subject = Subject;\n","/*\r\n\tConnector to MDEBUG-Server by Jens Wulf\r\n\tLicense: LGPL\r\n*/\r\nimport { Socket } from \"net\";\r\nimport { EventEmitter } from 'events';\r\nimport { readFileSync } from 'fs';\r\nexport interface MumpsBreakpoint {\r\n\tid: number;\r\n\tfile: string,\r\n\tline: number;\r\n\tverified: boolean;\r\n}\r\ninterface VarData {\r\n\tname: string,\r\n\tindexCount: number,\r\n\tbases: Array<string>,\r\n\tcontent: string\r\n}\r\n\r\nexport class MConnect extends EventEmitter {\r\n\tprivate _socket: Socket;\r\n\tprivate _connectState: string;\r\n\tprivate _readedData: string;\r\n\tprivate _mVars: Object;\r\n\tprivate _mStack: Array<string>;\r\n\tprivate _activeBreakpoints: Array<string>;\r\n\tprivate _event = new EventEmitter();\r\n\tprivate _hostname: string;\r\n\tprivate _port: number;\r\n\tprivate _sourceFile: string;\r\n\tprivate _sourceLines: string[];\r\n\tprivate _currentLine = 0;\r\n\tprivate _errorLines: string[];\r\n\tprivate _hints: string[];\r\n\tprivate _breakPoints: MumpsBreakpoint[];\r\n\tprivate _localRoutinesPath: string;\r\n\tprivate _breakpointId: number = 1;\r\n\tprivate _commandQueue: string[];\r\n\tprivate _logging: boolean = false;\r\n\tprivate _singleVar: string = \"\";\r\n\tprivate _singleVarContent: string = \"\";\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._commandQueue = [];\r\n\t\tthis._socket = new Socket();\r\n\t\tthis._connectState = \"waitingforStart\";\r\n\t\tthis._readedData = \"\";\r\n\t\tthis._mVars = {};\r\n\t\tthis._mStack = [];\r\n\t\tthis._activeBreakpoints = [];\r\n\t\tthis._breakPoints = [];\r\n\t\tthis._errorLines = [];\r\n\t\tthis._singleVar = \"\";\r\n\t\tthis._singleVarContent=\"\";\r\n\t\tthis._hints=[];\r\n\t\tthis._event.on('varsComplete', () => {\r\n\t\t\tif (typeof (this._mVars[\"I\"]) !== 'undefined') {\r\n\t\t\t\tlet internals = this._mVars[\"I\"];\r\n\t\t\t\tthis.checkEvents(internals[\"$ZPOSITION\"], internals[\"$ZSTATUS\"]);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic async init(hostname: string, port: number, localRoutinesPath: string) {\r\n\t\tthis._localRoutinesPath = localRoutinesPath;\r\n\t\tthis._hostname = hostname;\r\n\t\tthis._port = port;\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._socket.connect(this._port, this._hostname, () => {\r\n\t\t\t\tthis._log(\"Debug-Server connected\\n\");\r\n\t\t\t\tthis._socket.on('data', (chunk) => {\r\n\t\t\t\t\tthis._readedData += chunk.toString();\r\n\t\t\t\t\tlet n = this._readedData.indexOf('\\n');\r\n\t\t\t\t\twhile (n !== -1) {\r\n\t\t\t\t\t\tthis.processLine(this._readedData.substring(0, n))\r\n\t\t\t\t\t\tthis._readedData = this._readedData.substring(n + 1);\r\n\t\t\t\t\t\tn = this._readedData.indexOf('\\n');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tresolve(this._socket);\r\n\t\t\t});\r\n\t\t\tthis._socket.on('error', (error) => {\r\n\t\t\t\treject(error);\r\n\t\t\t});\r\n\t\t})\r\n\t\t// Put a friendly message on the terminal of the server.\r\n\t}\r\n\tprivate _log(msg) {\r\n\t\tif (this._logging) { console.log(msg); }\r\n\t}\r\n\tprivate processLine(line: string) {\r\n\t\tlet varname: string;\r\n\t\tlet value: string;\r\n\t\tlet vartype: string;\r\n\t\tswitch (this._connectState) {\r\n\t\t\tcase \"waitingforStart\": {\r\n\t\t\t\tif (line === \"***STARTVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforVars\";\r\n\t\t\t\t\tthis._mStack = [];\r\n\t\t\t\t\tthis._mVars = {};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***STARTBP\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforBreakpoints\";\r\n\t\t\t\t\tthis._activeBreakpoints = [];\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***SINGLEVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForSingleVar\";\r\n\t\t\t\t\tthis._singleVar = \"\";\r\n\t\t\t\t\tthis._singleVarContent=\"\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***ENDPROGRAM\") {\r\n\t\t\t\t\tthis.sendEvent(\"end\");\r\n\t\t\t\t\tthis._socket.end();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line === \"***BEGINERRCHK\") {\r\n\t\t\t\t\tthis._connectState = \"waitingForErrorreport\";\r\n\t\t\t\t\tthis._errorLines = [];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (line=== \"***STARTHINTS\") {\r\n\t\t\t\t\tthis._connectState=\"waitingForHints\";\r\n\t\t\t\t\tthis._hints=[];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingforVars\": {\r\n\t\t\t\tif (line === \"***ENDVAR\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit(\"varsComplete\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvartype = line.substring(0, 1); //I=internal,V=local Variable,S=Stackframe\r\n\t\t\t\t\tif (vartype === \"S\") {\r\n\t\t\t\t\t\tthis._mStack.push(line.substring(2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvarname = line.substring(2, line.indexOf('='));\r\n\t\t\t\t\twhile ((varname.split('\"').length - 1) % 2 !== 0) {\r\n\t\t\t\t\t\tvarname = line.substring(0, line.indexOf('=', varname.length + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue = line.substring(varname.length + 3).replace(/^\"/, \"\").replace(/\"$/, \"\");\r\n\t\t\t\t\tif (typeof (this._mVars[vartype]) === 'undefined') { this._mVars[vartype] = {}; }\r\n\t\t\t\t\tthis._mVars[vartype][varname] = value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingforBreakpoints\": {\r\n\t\t\t\tif (line === \"***ENDBP\") {\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis.verifyBreakpoints();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._log(line);\r\n\t\t\t\t\tthis._activeBreakpoints.push(line);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForSingleVar\": {\r\n\t\t\t\tif (line === \"***SINGLEEND\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('SingleVarReceived', this._event, this._singleVar,this._singleVarContent);\r\n\t\t\t\t} else if (line=== \"***SINGLEVARCONTENT\") {\r\n\t\t\t\t\tthis._connectState=\"waitingForSingleVarContent\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._singleVar += line;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForSingleVarContent\": {\r\n\t\t\t\tif (line === \"***SINGLEEND\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('SingleVarReceived', this._event, this._singleVar,this._singleVarContent);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._singleVarContent+=line;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForErrorreport\": {\r\n\t\t\t\tif (line === \"***ENDERRCHK\") {\r\n\t\t\t\t\tthis._connectState = \"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('ErrorreportReceived', this._event, this._errorLines);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._errorLines.push(line);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"waitingForHints\": {\r\n\t\t\t\tif (line===\"***ENDHINTS\") {\r\n\t\t\t\t\tthis._connectState=\"waitingforStart\";\r\n\t\t\t\t\tthis._event.emit('HintsReceived',this._event,this._hints);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._hints.push(line);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdefault: {\r\n\t\t\t\tconsole.error(\"Unexpected Message: \" + line);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate writeln(message: string): void {\r\n\t\tthis._commandQueue.push(message);\r\n\t\tif (this._commandQueue.length > 1000) {\r\n\t\t\tconsole.error(\"Too many Commands in Queue Check Debugger Connection\");\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tif (this._socket && this._socket.writable) {\r\n\t\t\twhile (this._commandQueue.length) {\r\n\t\t\t\tmessage = this._commandQueue.shift()!;\r\n\t\t\t\tthis._log(message);\r\n\t\t\t\tthis._socket.write(message + \"\\n\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate sendBreakpoint(file: string, line: number, onOff: boolean): void {\r\n\t\tif (onOff) { this.writeln(\"SETBP;\" + file + \";\" + line); }\r\n\t\telse { this.writeln(\"CLEARBP;\" + file + \";\" + line); }\r\n\t}\r\n\tpublic start(file: string, stopAtStart: boolean): void {\r\n\t\tif (stopAtStart) {\r\n\t\t\tif (file.indexOf(\"^\")) {\r\n\t\t\t\t//Stop direct at given Label not at first line\r\n\t\t\t\tthis.sendBreakpoint(file, 0, true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendBreakpoint(file, 1, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.requestBreakpoints();\r\n\t\tthis.writeln(\"START;\" + file);\r\n\t}\r\n\tpublic step(type: string): void {\r\n\t\tthis.writeln(type);\r\n\t}\r\n\tpublic continue(): void {\r\n\t\tthis.writeln(\"CONTINUE\");\r\n\t}\r\n\tpublic disconnect(): void {\r\n\t\tthis.writeln(\"RESET\");\r\n\t\tthis._socket.end();\r\n\t}\r\n\tpublic requestBreakpoints(): void {\r\n\t\tthis.writeln(\"REQUESTBP\");\r\n\t}\r\n\tpublic restart(file: string) {\r\n\t\tthis.writeln(\"RESTART;\" + file);\r\n\t}\r\n\t/**\r\n\t * Fire events if line has a breakpoint or hs stopped beacause of a different reason\r\n\t */\r\n\tprivate checkEvents(mumpsposition: string, mumpsstatus: string): void {\r\n\t\tconst parts = mumpsposition.split(\"^\");\r\n\t\tconst position = parts[0];\r\n\t\tconst program = parts[1];\r\n\t\tconst file = this._localRoutinesPath + program + \".m\";\r\n\t\tthis.loadSource(file);\r\n\t\tconst startlabel = position.split(\"+\")[0];\r\n\t\tlet offset = 0;\r\n\t\tif (position.split(\"+\")[1] !== \"undefined\") {\r\n\t\t\toffset = parseInt(position.split(\"+\")[1]);\r\n\t\t}\r\n\t\tlet line = 0\r\n\t\tif (startlabel !== \"\") {\r\n\t\t\tfor (let ln = 0; ln < this._sourceLines.length; ln++) {\r\n\t\t\t\tif (this._sourceLines[ln].substring(0, startlabel.length) === startlabel) {\r\n\t\t\t\t\tline = ln;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._currentLine = line + offset;\r\n\t\tif (mumpsstatus !== \"\") {\r\n\t\t\tthis.sendEvent('stopOnException', mumpsstatus);\r\n\t\t} else {\r\n\t\t\tconst bps = this._breakPoints.filter(bp => bp.file === this._sourceFile && bp.line === this._currentLine);\r\n\t\t\tif (bps.length > 0) {\r\n\t\t\t\tthis.sendEvent('stopOnBreakpoint');\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendEvent('stopOnStep');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the actual Stack\r\n\t */\r\n\tpublic stack(startFrame: number, endFrame: number): any {\r\n\r\n\t\tconst frames = new Array<any>();\r\n\r\n\t\tfor (let i = startFrame; i < this._mStack.length; i++) {\r\n\t\t\tconst position = this._mStack[i];\r\n\t\t\tconst fileposition = this.convertMumpsPosition(position);\r\n\t\t\tfileposition.line++;\t//Correction 0/1 based in Editor/GT.M\r\n\t\t\tframes.push({\r\n\t\t\t\tindex: i,\r\n\t\t\t\tname: `${position}(${i})`,\r\n\t\t\t\tfile: fileposition.file,\r\n\t\t\t\tline: fileposition.line\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tframes: frames,\r\n\t\t\tcount: Math.min(this._mStack.length, endFrame)\r\n\t\t};\r\n\t}\r\n\r\n\r\n\t/*\r\n\t * Set breakpoint in file with given line.\r\n\t */\r\n\tpublic setBreakPoint(file: string, line: number): MumpsBreakpoint {\r\n\t\tconst bp = <MumpsBreakpoint>{ verified: false, file, line, id: this._breakpointId++ };\r\n\t\tthis._breakPoints.push(bp);\r\n\t\tthis.sendBreakpoint(file, bp.line + 1, true);\r\n\t\treturn bp;\r\n\t}\r\n\r\n\t/*\r\n\t * Clear breakpoint in file with given line.\r\n\t */\r\n\tpublic clearBreakPoint(file: string, line: number): MumpsBreakpoint | undefined {\r\n\t\tlet bps = this._breakPoints;\r\n\t\tif (bps) {\r\n\t\t\tconst index = bps.findIndex(bp => bp.file === file && bp.line === line);\r\n\t\t\tif (index >= 0) {\r\n\t\t\t\tconst bp = bps[index];\r\n\t\t\t\tthis.sendBreakpoint(file, bp.line, false);\r\n\t\t\t\tbps.splice(index, 1);\r\n\t\t\t\treturn bp;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/*\r\n\t * Clear all breakpoints\r\n\t */\r\n\tpublic clearBreakpoints(file: string): void {\r\n\t\tthis.writeln(\"CLEARBP;\"+file);\r\n\t}\r\n\r\n\tprivate verifyBreakpoints(): void {\r\n\t\tlet merk: boolean[] = [];\r\n\t\tthis._breakPoints.forEach(bp => {\r\n\t\t\tbp.verified = false;\r\n\t\t\tfor (let i = 0; i < this._activeBreakpoints.length; i++) {\r\n\t\t\t\tlet internalBp = this.convertMumpsPosition(this._activeBreakpoints[i])\r\n\t\t\t\tif (internalBp.file === bp.file && bp.line === internalBp.line) {\r\n\t\t\t\t\tbp.verified = true;\r\n\t\t\t\t\tthis.sendEvent('breakpointValidated', bp);\r\n\t\t\t\t\tmerk[i] = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!bp.verified) { this.sendEvent('breakpointValidated', bp); }\r\n\t\t});\r\n\t\tfor (let i = 0; i < this._activeBreakpoints.length; i++) {\r\n\t\t\tif (!merk[i]) {\r\n\t\t\t\tlet internalBp = this.convertMumpsPosition(this._activeBreakpoints[i])\r\n\t\t\t\tlet bp: MumpsBreakpoint = { 'verified': true, 'file': internalBp.file, 'line': internalBp.line, 'id': this._breakpointId++ }\r\n\t\t\t\tthis.sendEvent('breakpointValidated', bp);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getVariables(type: string) {\r\n\t\tif (type === \"system\") {\r\n\t\t\treturn this._mVars[\"I\"];\r\n\t\t} else if (type === \"local\") {\r\n\t\t\treturn this._mVars[\"V\"];\r\n\t\t}\r\n\t}\r\n\tpublic async requestHints(part:string) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._event.on('HintsReceived', function HintsReceived(event:EventEmitter, hints:string[]) {\r\n\t\t\t\tevent.removeListener('HintsReceived', HintsReceived);\r\n\t\t\t\tresolve(hints);\r\n\t\t\t});\r\n\t\t\tthis.writeln(\"GETHINTS;\"+part);\r\n\t\t})\r\n\t}\r\n\tpublic async checkRoutine(lines: string[]) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis._event.on('ErrorreportReceived', function ErrorreportReceived(event:EventEmitter, errorLines:string[]) {\r\n\t\t\t\tevent.removeListener('ErrorreportReceived', ErrorreportReceived);\r\n\t\t\t\tresolve(errorLines);\r\n\t\t\t});\r\n\t\t\tthis.writeln(\"ERRCHK\");\r\n\t\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\t\tthis.writeln(lines[i]);\r\n\t\t\t}\r\n\t\t\tthis.writeln(\"***ENDPROGRAM\");\r\n\t\t})\r\n\t}\r\n\tpublic async getSingleVar(expression: string) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet reply:VarData={name: expression,indexCount: 0,content: \"undefined\",bases:[]}\r\n\t\t\tif (expression.substring(0, 1) === \"$\") {\r\n\t\t\t\treply.content=(this._mVars[\"I\"] !== undefined) ? this._mVars[\"I\"][expression] : \"undefined\";\r\n\t\t\t\tresolve(reply);\r\n\t\t\t} else {\r\n\t\t\t\tif (this._mVars[\"V\"] !== undefined) {\r\n\t\t\t\t\tif (this._mVars[\"V\"][expression] !== undefined) {\r\n\t\t\t\t\t\treply.content=this._mVars[\"V\"][expression];\r\n\t\t\t\t\t\tresolve(reply);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._event.on('SingleVarReceived', function SingleVarReceived(event, singleVar, singleVarContent) {\r\n\t\t\t\t\t\t\tevent.removeListener('SingleVarReceived', SingleVarReceived);\r\n\t\t\t\t\t\t\treply.name=singleVar;\r\n\t\t\t\t\t\t\treply.content=singleVarContent;\r\n\t\t\t\t\t\t\tresolve(reply);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.writeln(\"GETVAR;\" + expression);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve(reply);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// private methods\r\n\r\n\tprivate loadSource(file: string) {\r\n\t\tif (this._sourceFile !== file) {\r\n\t\t\tthis._sourceFile = file;\r\n\t\t\tthis._sourceLines = readFileSync(this._sourceFile).toString().split('\\n');\r\n\t\t}\r\n\t}\r\n\r\n\tprivate convertMumpsPosition(positionstring: string) {\r\n\t\tlet parts = positionstring.split(\"^\");\r\n\t\tlet position = parts[0];\r\n\t\tlet program = parts[1].split(\" \", 1)[0];\r\n\t\tlet file = this._localRoutinesPath + program + \".m\";\r\n\t\tlet filecontent = readFileSync(file).toString().split('\\n');\r\n\t\tlet startlabel = position.split(\"+\")[0];\r\n\t\tlet offset = 0;\r\n\t\tif (position.split(\"+\")[1] !== undefined) {\r\n\t\t\toffset = parseInt(position.split(\"+\")[1]);\r\n\t\t}\r\n\t\tlet line = 0;\r\n\t\tif (startlabel !== \"\") {\r\n\t\t\tfor (let ln = 0; ln < filecontent.length; ln++) {\r\n\t\t\t\tif (filecontent[ln].substring(0, startlabel.length) === startlabel) {\r\n\t\t\t\t\tline = ln;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { \"file\": file, \"line\": line + offset - 1 };\r\n\t}\r\n\r\n\tprivate sendEvent(event: string, ...args: any[]) {\r\n\t\tsetImmediate(_ => {\r\n\t\t\tthis.emit(event, ...args);\r\n\t\t});\r\n\t}\r\n}","import * as vscode from 'vscode';\r\nlet Hover = vscode.Hover;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\n\r\nclass MumpsHoverProvider {\r\n    provideHover(document, position) {\r\n        let token = new MumpsToken(document, position);\r\n\r\n        if (!token.mayBeCommand && !token.isIntrinsic && !token.isLabelReference) {\r\n            return;\r\n        }\r\n\r\n        if (token.definition) {\r\n            let definition = token.definition;\r\n            let snippet = { language: 'typescript', value: definition.functionSignature || definition.name };\r\n            return new Hover([snippet, definition.description]);\r\n        }\r\n    }\r\n}\r\n\r\nexport {MumpsHoverProvider}\r\n","let fs = require('fs');\r\nlet path = require('path');\r\nimport * as vscode from 'vscode';\r\nimport * as autoDoc from './mumps-documenter'\r\nlet Position = vscode.Position;\r\nlet Uri = vscode.Uri;\r\n\r\nconst EXTENSIONS = ['.M', '.INT', '.ZWR', '.m', '.int', '.zwr'];\r\n\r\nlet cache: any = {};\r\n\r\nfunction lookupLabelReference(token): MumpsLabel {\r\n\t//console.log(\"here\")\r\n\tlet uri = token.labelProgram ?\r\n\t\tsiblingUri(token.document, token.labelProgram) :\r\n\t\ttoken.document.uri;\r\n\tlet referredTo = findReferredToLabel(getText(uri, token.document), token.label);\r\n\t//console.log(referredTo)\r\n\tif (referredTo) {\r\n\t\treferredTo.position = new Position(referredTo.line + (token.labelOffset || 0), 0);\r\n\t} else {\r\n\t\treferredTo = {\r\n\t\t\ttext: '',\r\n\t\t\tposition: new Position(0, 0)\r\n\t\t};\r\n\t}\r\n\treferredTo.uri = uri;\r\n\treturn referredTo;\r\n}\r\n\r\nfunction siblingUri(document, fileName) {\r\n\tlet siblingPath = path.resolve(document.uri.fsPath, '../' + fileName);\r\n\tif (!fs.existsSync(siblingPath)) {\r\n\t\tif (fileName.charAt(0) === '%') {\r\n\t\t\treturn siblingUri(document, '_' + fileName.substring(1));\r\n\t\t}\r\n\r\n\t\tfor (let extension of EXTENSIONS) {\r\n\t\t\tlet extendedPath = siblingPath + extension;\r\n\t\t\tif (fs.existsSync(extendedPath)) {\r\n\t\t\t\tsiblingPath = extendedPath;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn Uri.file(siblingPath);\r\n}\r\n\r\nfunction getText(uri, document) {\r\n\tif (uri === document.uri) {\r\n\t\treturn document.getText();\r\n\t}\r\n\tif (uri.fsPath === cache.fsPath) {\r\n\t\treturn cache.text;\r\n\t}\r\n\ttry {\r\n\t\tcache.text = fs.readFileSync(uri.fsPath, 'utf8');\r\n\t\tcache.fsPath = uri.fsPath;\r\n\t\treturn cache.text;\r\n\t} catch (e) {\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nfunction findReferredToLabel(text: string, label): MumpsLabel | undefined {\r\n\tlet lines = text.split(\"\\n\");\r\n\tlet commentText = \"\";\r\n\tlet i=0;\r\n\tfor (i = 0; i < lines.length; i++) {\r\n\t\tif (lines[i].match(\"^\" + label) !== null) {\r\n\t\t\tcommentText += lines[i] + \"\\n\";\r\n\t\t\tfor (let j = i - 1; j > 0; j--) {\r\n\t\t\t\tif (lines[j].length === 0 || lines[j].charAt(1) === \";\") {\r\n\t\t\t\t\tcommentText += lines[j] + \"\\n\"\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (commentText.length > 0) {\r\n\t\treturn {\r\n\t\t\ttext: commentText,\r\n\t\t\tline: i\r\n\t\t};\r\n\t}\r\n}\r\n/*\r\nfunction countLines(text, index) {\r\n    if (index >= text.length) {\r\n        index = text.length - 1;\r\n    }\r\n    let re = /[\\r\\n]+/g;\r\n    let result;\r\n    let line = 0;\r\n    while ((result = re.exec(text)) && result.index >= 0 && result.index < index) {\r\n        ++line;\r\n    }\r\n    return line;\r\n}\r\n*/\r\nfunction createDefinitionForLabelReference(referredTo: MumpsLabel) {\r\n\t//console.log(\"CreateLabel\")\r\n\tif (!referredTo.text) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet definitionRegex = /^([%A-Z][A-Z0-9]*)(\\((,?[%A-Z][A-Z0-9]*)+\\))?/i;\r\n\tlet result = definitionRegex.exec(referredTo.text);\r\n\tif (!result) {\r\n\t\treturn;\r\n\t}\r\n\tlet commentText='';\r\n\tif (referredTo.text.indexOf(';')) {\r\n\t\tcommentText=referredTo.text.substring(referredTo.text.indexOf(';')+1);\r\n\t}\r\n\tlet parameters: any = result[2].substring(1, result[2].length - 1).split(',');\r\n\tlet parametersByName = {};\r\n\tfor (let i = 0; i < parameters.length; i++) {\r\n\t\tparameters[i] = {\r\n\t\t\tname: parameters[i],\r\n\t\t\ttype: 'any'\r\n\t\t};\r\n\t\tparametersByName[parameters[i].name] = parameters[i];\r\n\t}\r\n\tlet definition = {\r\n\t\tname: result[1],\r\n\t\ttype: 'function',\r\n\t\tparameters,\r\n\t\tcommentText\r\n\t};\r\n\r\n\t//extractDescriptionFromComments(referredTo, definition, parametersByName);\r\n\tautoDoc.getSigInfo(referredTo, definition, parametersByName);\r\n\r\n\treturn definition;\r\n}\r\n/*\r\nfunction extractDescriptionFromComments(referredTo:MumpsLabel, definition, parametersByName) {\r\n    let commentRegex = /;[ \\t]*(.*)$/gm;\r\n    let commentText = '';\r\n    let result;\r\n    while ((result = commentRegex.exec(referredTo.text)) !== null) {\r\n        commentText += result[1] + '\\n';\r\n    }\r\n    if (!commentText) {\r\n        return;\r\n    }\r\n\r\n    // don't look for parameters in the first line\r\n    let newlineResult = /\\n/m.exec(commentText);\r\n    if (newlineResult) {\r\n        let additionalLines = commentText.substring(newlineResult.index + 1);\r\n        for (let name in parametersByName) {\r\n            let parameterRegex = new RegExp('^((input|output|input/output)[ \\t:\\\\-]+)?' + name + '[ \\t:\\\\-]+(.+)\\n', 'm');\r\n            let result = parameterRegex.exec(additionalLines);\r\n            if (result) {\r\n                parametersByName[name].description = result[3] + \"ss\";\r\n                if (result[2]) {\r\n                    parametersByName[name].description = result[2] + parametersByName[name].description;\r\n                }\r\n                additionalLines = additionalLines.substring(0, result.index) + additionalLines.substring(result.index + result[0].length);\r\n            }\r\n        }\r\n        commentText = commentText.substring(0, newlineResult.index) + '\\n' + additionalLines;\r\n    }\r\n\r\n    definition.description = commentText;\r\n}\r\n*/\r\ninterface MumpsLabel { text: string, line?: number, position?: vscode.Position, uri?: string }\r\nexport { lookupLabelReference, createDefinitionForLabelReference, MumpsLabel };","import * as vscode from 'vscode';\r\nlet Location = vscode.Location;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\nclass MumpsDefinitionProvider {\r\n    provideDefinition(document, position) {\r\n        let token = new MumpsToken(document, position);\r\n        if (token.isLabelReference && token.referredToLabel) {\r\n            let position = token.referredToLabel.position;\r\n            return new Location(token.referredToLabel.uri, position);\r\n        }\r\n    }\r\n}\r\n\r\nexport {MumpsDefinitionProvider};","import * as vscode from 'vscode';\r\nlet ParameterInformation = vscode.ParameterInformation;\r\nlet Position = vscode.Position;\r\nlet SignatureHelp = vscode.SignatureHelp;\r\nlet SignatureInformation = vscode.SignatureInformation;\r\nlet MumpsToken = require('./mumps-language-token').MumpsToken;\r\n\r\nclass MumpsSignatureHelpProvider {\r\n    provideSignatureHelp(document, position) {\r\n        let line = document.lineAt(position);\r\n        if (!line) {\r\n            return;\r\n        }\r\n\r\n        let token = getFunctionToken(document, line, position);\r\n        if (!token || !token.definition) {\r\n            return;\r\n        }\r\n\r\n        let signature = createSignatureInformation(token.definition);\r\n\r\n        let help = new SignatureHelp();\r\n        help.signatures = [signature];\r\n        help.activeSignature = 0;\r\n        help.activeParameter = calculateActiveParameter(line.text, token.position.character + 1, position.character);\r\n        return help;\r\n    }\r\n}\r\nexport {MumpsSignatureHelpProvider};\r\n\r\nfunction getFunctionToken(document, line, position) {\r\n    let depth = 1;\r\n    let index;\r\n    for (index = position.character - 1; index > 0 && depth > 0; index--) {\r\n        let char = line.text.charAt(index);\r\n        if (char === ')') {\r\n            depth++;\r\n        } else if (char === '(') {\r\n            depth--;\r\n        }\r\n    }\r\n    if (depth > 0 || index <= 0) {\r\n        return;\r\n    }\r\n\r\n    return new MumpsToken(document, new Position(position.line, index));\r\n}\r\n\r\nfunction createSignatureInformation(definition) {\r\n    let signature = new SignatureInformation(definition.functionSignature, definition.description);\r\n    if (definition.parameters) {\r\n        signature.parameters = [];\r\n        for (let parameter of definition.parameters) {\r\n            let description = parameter.optional ? '(optional) ' : '';\r\n            description += parameter.description || parameter.name;\r\n            signature.parameters.push(new ParameterInformation(parameter.name, description));\r\n\t\t\t\t}\r\n\t\t\t\tsignature.documentation=definition.commentText;\r\n    }\r\n    return signature;\r\n}\r\n\r\nfunction calculateActiveParameter(lineText, parametersStartIndex, insertIndex) {\r\n    let active = 0;\r\n    let depth = 0;\r\n    for (let i = parametersStartIndex + 1; i < insertIndex; i++) {\r\n        let char = lineText.charAt(i);\r\n        if (char === '(') {\r\n            depth++;\r\n        } else if (char === ')') {\r\n            depth--;\r\n        } else if (char === ',' && depth === 0) {\r\n            active++;\r\n        }\r\n    }\r\n    return active;\r\n}\r\n","import * as vscode from 'vscode';\r\nimport * as parser from './parser/parser';\r\n\r\nexport class MumpsDocumentSymbolProvider implements vscode.DocumentSymbolProvider {\r\n\r\n\tpublic provideDocumentSymbols(document: vscode.TextDocument): Promise<vscode.SymbolInformation[]> {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tlet parsedDoc = parser.parseText(document.getText());\r\n            let symbols: vscode.SymbolInformation[] = [];\r\n\r\n\t\t\tparsedDoc.methods.forEach(method => {\r\n                let kind = vscode.SymbolKind.Function;\r\n\r\n\t\t\t\tlet startPosition = new vscode.Position(method.id.position.line, 0);\r\n\r\n\t\t\t\tlet endPostionLine = (method.endLine === -1) ? document.lineCount - 1 : method.endLine;\r\n                let endPosition = new vscode.Position(endPostionLine, 0);\r\n\r\n                let methodRange = new vscode.Location(document.uri, new vscode.Range(startPosition, endPosition));\r\n\r\n\t\t\t\tsymbols.push(new vscode.SymbolInformation(method.id.value, kind, '', methodRange));\r\n            });\r\n\r\n\t\t\tresolve(symbols);\r\n\t\t})\r\n\t}\r\n}","import { getTokens, Token, Type } from './tokenizer';\r\n\r\n// Code adapted from the vscode-psl extension by ing-bank\r\n\r\n/**\r\n * Used for checking the type of Member at runtime\r\n */\r\nexport enum MemberClass {\r\n\tmethod = 1,\r\n\tparameter = 2,\r\n\t// property = 3,\r\n\tdeclaration = 4,\r\n\tcolumn = 5,\r\n\ttable = 6,\r\n\tproc = 7,\r\n}\r\n\r\n/**\r\n * A generic type that abstracts Method, Parameter, Declaration, etc\r\n */\r\nexport interface IMember {\r\n\r\n\t/**\r\n\t * The Token representing the name of the member.\r\n\t */\r\n\tid: Token\r\n\r\n\tdocumentation?: string;\r\n}\r\n\r\n/**\r\n * Contains information about a Method\r\n */\r\nexport interface IMethod extends IMember {\r\n\r\n\t/**\r\n\t * The Token of the closing parenthesis after the declaration of all the Method's parameters.\r\n\t */\r\n\tcloseParen: Token\r\n\r\n\t/**\r\n\t * The parameters of the Method, each with their own typing and comment information.\r\n\t */\r\n\tparameters: IParameter[]\r\n\r\n\t/**\r\n\t * The zero-based line where the Method begins\r\n\t */\r\n\tline: number\r\n\r\n\t/**\r\n\t * The last line of the Method, right before the start of a new Method\r\n\t */\r\n\tendLine: number\r\n\r\n\t/**\r\n\t * Next Line of a method implementation\r\n\t */\r\n\tnextLine: number\r\n\r\n\t/**\r\n\t * Previous Line of a method implementation\r\n\t */\r\n\tprevLine: number;\r\n\r\n}\r\n\r\n/**\r\n * Represents a parameter, always belonging to a Method\r\n */\r\nexport interface IParameter extends IMember {\r\n\t/**\r\n\t * The contents of the comment for the parameter, i.e.\r\n\t * ```\r\n\t * public String name(\r\n\t * \t\tString p1 // a comment\r\n\t * \t\t)\r\n\t * ```\r\n\t */\r\n\tcomment: Token\r\n}\r\n\r\n/**\r\n * A type declaration, typically found within a method.\r\n */\r\nexport interface IDeclaration extends IMember {\r\n}\r\n\r\n\r\n/**\r\n * An abstract syntax tree of a PSL document\r\n */\r\nexport interface IParsedDocument {\r\n\r\n\t/**\r\n\t * An array of Declarations that are not contained within a method.\r\n\t * This will be empty for valid Profile 7.6 code but is maintained for compatibility.\r\n\t */\r\n\tdeclarations: IDeclaration[]\r\n\r\n\t/**\r\n\t * An array of the methods in the document\r\n\t */\r\n\tmethods: IMethod[]\r\n\r\n\t/**\r\n\t * All the tokens in the document, for reference.\r\n\t */\r\n\ttokens: Token[]\r\n}\r\n\r\nclass Method implements IMethod {\r\n\r\n\tnextLine: number;\r\n\tprevLine: number;\r\n\tcloseParen: Token;\r\n\tid: Token;\r\n\tparameters: Parameter[]\r\n\tdeclarations: IDeclaration[];\r\n\tline: number;\r\n\tendLine: number;\r\n\tmemberClass: MemberClass;\r\n\tdocumentation: string;\r\n\r\n\tconstructor() {\r\n\t\tthis.parameters = [];\r\n\t\tthis.line = -1;\r\n\t\tthis.declarations = [];\r\n\t\tthis.endLine = -1;\r\n\t\tthis.memberClass = MemberClass.method;\r\n\t\tthis.documentation = '';\r\n\t}\r\n}\r\n\r\nclass Parameter implements IParameter {\r\n\tid: Token\r\n\tcomment: Token\r\n\r\n\tconstructor() { }\r\n}\r\n\r\nexport function parseText(sourceText: string): IParsedDocument {\r\n\tlet parser = new Parser();\r\n\treturn parser.parseDocument(sourceText);\r\n}\r\n\r\nclass Parser {\r\n\r\n\tprivate tokenizer: IterableIterator<Token>;\r\n\tprivate activeToken: Token;\r\n\tprivate methods: Method[];\r\n\tprivate declarations: IDeclaration[];\r\n\tprivate activeMethod: Method;\r\n\tprivate tokens: Token[];\r\n\r\n\tconstructor(tokenizer?: IterableIterator<Token>) {\r\n\t\tthis.methods = [];\r\n\t\tthis.declarations = [];\r\n\t\tthis.tokens = [];\r\n\t\tif (tokenizer) { this.tokenizer = tokenizer; }\r\n\t}\r\n\r\n\tprivate next(): boolean {\r\n\t\tthis.activeToken = this.tokenizer.next().value;\r\n\t\tif (this.activeToken) { this.tokens.push(this.activeToken); }\r\n\t\treturn this.activeToken !== undefined;\r\n\t}\r\n\r\n\tparseDocument(documentText: string): IParsedDocument {\r\n\t\tthis.tokenizer = getTokens(documentText);\r\n\t\twhile (this.next()) {\r\n\t\t\tif (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tlet method = this.parseMethod();\r\n\t\t\t\tif (!method) { continue; }\r\n\t\t\t\tthis.methods.push(method);\r\n\t\t\t\tthis.activeMethod = method;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isTab() || this.activeToken.isSpace()) {\r\n\t\t\t\tlet lineNumber = this.activeToken.position.line;\r\n\t\t\t\tlet tokenBuffer = this.loadTokenBuffer();\r\n\t\t\t\tif (this.activeMethod && this.activeMethod.nextLine === lineNumber) {\r\n\t\t\t\t\tlet documentation = this.checkForDocumentation(tokenBuffer);\r\n\t\t\t\t\tif (documentation) { this.activeMethod.documentation = documentation; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isNewLine()) { continue; }\r\n\t\t\telse { this.throwAwayTokensTil(Type.NewLine); }\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tdeclarations: this.declarations,\r\n\t\t\tmethods: this.methods,\r\n\t\t\ttokens: this.tokens\r\n\t\t}\r\n\t}\r\n\r\n\tprivate checkForDocumentation(tokenBuffer: Token[]): string {\r\n\t\tlet i = 0;\r\n\t\twhile (i < tokenBuffer.length) {\r\n\t\t\tlet token = tokenBuffer[i];\r\n\t\t\tif (token.isSpace() || token.isTab()) {\r\n\t\t\t\ti++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (token.isLineCommentInit() && tokenBuffer[i + 1] && tokenBuffer[i + 1].isLineComment()) {\r\n\t\t\t\treturn tokenBuffer[i + 1].value;\r\n\t\t\t}\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tprivate loadTokenBuffer() {\r\n\t\tlet tokenBuffer: Token[] = []\r\n\t\twhile (this.next() && this.activeToken.type !== Type.NewLine) {\r\n\t\t\ttokenBuffer.push(this.activeToken);\r\n\t\t}\r\n\t\treturn tokenBuffer;\r\n\t}\r\n\r\n\tprivate parseMethod(): Method | undefined {\r\n\t\tlet method: Method = new Method();\r\n\t\tdo {\r\n\t\t\tif (!this.activeToken) { continue; }\r\n\t\t\tif (this.activeToken.isTab() || this.activeToken.isSpace()) { continue; }\r\n\t\t\telse if (this.activeToken.isNewLine()) { break; }\r\n\t\t\telse if (this.activeToken.isOpenParen()) {\r\n\t\t\t\tlet processed = this.processParameters(method);\r\n\t\t\t\tif (!processed) { return undefined; }\r\n\t\t\t\tmethod.parameters = processed;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tif (method.line === -1) {\r\n\t\t\t\t\tmethod.line = this.activeToken.position.line;\r\n\t\t\t\t\tmethod.prevLine = this.activeToken.position.line - 1;\r\n\t\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\t\tmethod.id = this.activeToken;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isLineCommentInit() || this.activeToken.isLineComment()) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.value === '\\r') { continue; }\r\n\t\t\telse if (this.activeToken.isCloseParen()) {\r\n\t\t\t\tif (!method.closeParen) {\r\n\t\t\t\t\tmethod.closeParen = this.activeToken;\r\n\t\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.throwAwayTokensTil(Type.NewLine);\r\n\t\t\t\tif (method.id) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\t\t} while (this.next());\r\n\r\n\t\tif (this.activeMethod) {\r\n\t\t\tthis.activeMethod.endLine = method.id.position.line - 1;\r\n\t\t}\r\n\t\tthis.activeMethod = method;\r\n\t\treturn method;\r\n\t}\r\n\r\n\tprivate processParameters(method: Method): Parameter[] | undefined {\r\n\t\tlet args: Parameter[] = [];\r\n\t\tlet param: Parameter | undefined;\r\n\t\tlet open = false;\r\n\t\twhile (this.next()) {\r\n\t\t\tif (this.activeToken.isTab() || this.activeToken.isSpace() || this.activeToken.isNewLine()) { continue; }\r\n\t\t\telse if (this.activeToken.isOpenParen()) {\r\n\t\t\t\topen = true;\r\n\t\t\t\tif (!param) { return undefined; }\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isCloseParen()) {\r\n\t\t\t\topen = false;\r\n\t\t\t\tmethod.closeParen = this.activeToken;\r\n\t\t\t\tmethod.nextLine = this.activeToken.position.line + 1;\r\n\t\t\t\tif (!param) { break; }\r\n\t\t\t\targs.push(param);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isAlphanumeric()) {\r\n\t\t\t\tif (!param) { param = new Parameter(); }\r\n\t\t\t\tparam.id = this.activeToken;\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isLineComment()) {\r\n\t\t\t\tif (param) {\r\n\t\t\t\t\tparam.comment = this.activeToken\r\n\t\t\t\t}\r\n\t\t\t\telse if (args.length >= 1) {\r\n\t\t\t\t\targs[args.length - 1].comment = this.activeToken;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.activeToken.isComma()) {\r\n\t\t\t\tif (!param) { return undefined; }\r\n\t\t\t\targs.push(param)\r\n\t\t\t\tparam = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (open) { return undefined; }\r\n\t\treturn args;\r\n\t}\r\n\r\n\tprivate throwAwayTokensTil(type: Type) {\r\n\t\tdo { } while (this.next() && this.activeToken.type !== type)\r\n\t}\r\n\r\n}","import { Position, Range } from \"vscode\";\r\n\r\n// Code adapted from the vscode-psl extension by ing-bank\r\n\r\nexport function* getTokens(documentContents: string): IterableIterator<Token> {\r\n\tlet tokenizer: Tokenizer = new Tokenizer()\r\n\r\n\tfor (let char of documentContents) {\r\n\t\ttokenizer.charType = getType(char);\r\n\t\tif (tokenizer.tokenType === 0) {\r\n\t\t\ttokenizer.tokenType = tokenizer.charType;\r\n\t\t}\r\n\t\twhile (!tokenizer.parsed) {\r\n\t\t\tif (tokenizer.parseCharacter(char)) {\r\n\t\t\t\tyield tokenizer.finalizedToken;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttokenizer.parsed = false;\r\n\t}\r\n\r\n\t// if there is an unfinished token left\r\n\tif (tokenizer.tokenType !== 0) {\r\n\t\ttokenizer.finalizeToken(0);\r\n\t\tyield tokenizer.finalizedToken;\r\n\t}\r\n}\r\n\r\nexport class Token {\r\n\ttype: Type;\r\n\tvalue: string;\r\n\tposition: Position;\r\n\r\n\tconstructor(type: Type, value: string, position: Position) {\r\n\t\tthis.type = type;\r\n\t\tthis.value = value;\r\n\t\tthis.position = position;\r\n\t}\r\n\r\n\tgetRange() {\r\n\t\tlet start: Position = this.position;\r\n\t\tlet end: Position = new Position(this.position.line, this.position.character + this.value.length);\r\n\t\treturn new Range(start, end);\r\n\t}\r\n\r\n\tisAlphanumeric() {\r\n\t\treturn this.type === Type.Alphanumeric;\r\n\t}\r\n\r\n\tisCloseParen() {\r\n\t\treturn this.type === Type.CloseParen;\r\n\t}\r\n\r\n\tisComma() {\r\n\t\treturn this.type === Type.Comma;\r\n\t}\r\n\r\n\tisLineComment() {\r\n\t\treturn this.type === Type.LineComment;\r\n\t}\r\n\r\n\tisLineCommentInit() {\r\n\t\treturn this.type === Type.LineCommentInit;\r\n\t}\r\n\r\n\tisNewLine() {\r\n\t\treturn this.type === Type.NewLine;\r\n\t}\r\n\r\n\tisNumeric() {\r\n\t\treturn this.type === Type.Numeric;\r\n\t}\r\n\r\n\tisOpenParen() {\r\n\t\treturn this.type === Type.OpenParen;\r\n\t}\r\n\r\n\tisSpace() {\r\n\t\treturn this.type === Type.Space;\r\n\t}\r\n\r\n\tisTab() {\r\n\t\treturn this.type === Type.Tab;\r\n\t}\r\n\r\n\tisWhiteSpace() {\r\n\t\treturn this.type === Type.Space || this.type === Type.Tab || this.type === Type.NewLine || this.type === Type.Undefined;\r\n\t}\r\n}\r\n\r\nclass Tokenizer {\r\n\tdocumentLine: number;\r\n\tdocumentColumn: number;\r\n\r\n\tcharType: number;\r\n\ttokenType: number;\r\n\ttokenValue: string;\r\n\ttokenPosition: Position;\r\n\tfinalizedToken: Token;\r\n\r\n\tparsed: boolean\r\n\tstringOpen: boolean;\r\n\tfirstSlash: boolean;\r\n\tasterisk: boolean;\r\n\r\n\tconstructor() {\r\n\t\tthis.documentLine = 0;\r\n\t\tthis.documentColumn = 0;\r\n\r\n\t\tthis.charType = 0;\r\n\t\tthis.tokenType = 0;\r\n\t\tthis.tokenValue = '';\r\n\t\tthis.tokenPosition = new Position(this.documentLine, this.documentColumn);\r\n\r\n\t\tthis.parsed = false;\r\n\t\tthis.stringOpen = false;\r\n\t\tthis.firstSlash = false;\r\n\t\tthis.asterisk = false;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param char current character being parsed\r\n\t * @returns true if token is finalized\r\n\t */\r\n\tparseCharacter(char: string): boolean {\r\n\t\tif (this.tokenType === Type.Alphanumeric) {\r\n\t\t\tif (this.charType === Type.Alphanumeric || this.charType === Type.Numeric) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(this.charType);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.Numeric) {\r\n\t\t\tif (this.charType === Type.Numeric) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(this.charType);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.LineComment) {\r\n\t\t\tif (this.charType !== Type.NewLine) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(Type.NewLine);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.String) {\r\n\t\t\tif (this.charType !== Type.DoubleQuotes) {\r\n\t\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.finalizeToken(Type.DoubleQuotes);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (this.tokenType === Type.LineCommentInit) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tthis.finalizeToken(Type.LineComment);\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.SemiColon) {\r\n\t\t\tthis.tokenType = Type.LineCommentInit;\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.DoubleQuotes) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tif (this.stringOpen) {\r\n\t\t\t\tthis.stringOpen = false;\r\n\t\t\t\tthis.finalizeToken(0);\r\n\t\t\t} else {\r\n\t\t\t\tthis.stringOpen = true;\r\n\t\t\t\tthis.finalizeToken(Type.String);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t} else if (this.tokenType === Type.NewLine) {\r\n\t\t\tthis.tokenValue = this.tokenValue + char;\r\n\t\t\tthis.parsed = true;\r\n\t\t\tthis.documentLine++;\r\n\t\t\tthis.documentColumn = 0;\r\n\t\t\tthis.finalizeToken(0);\r\n\t\t\treturn true;\r\n\t\t} else if ((this.tokenType > 10) || (this.tokenType === -1)) {\r\n\t\t\tthis.updateTokenAndAdvanceCursor(char);\r\n\t\t\tthis.finalizeToken(0);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tupdateTokenAndAdvanceCursor(char: string) {\r\n\t\tthis.tokenValue = this.tokenValue + char;\r\n\t\tthis.parsed = true;\r\n\t\tthis.documentColumn++;\r\n\t}\r\n\r\n\tfinalizeToken(newType: number): void {\r\n\t\tthis.finalizedToken = new Token(this.tokenType, this.tokenValue, this.tokenPosition);\r\n\t\tthis.tokenType = newType;\r\n\t\tthis.tokenValue = '';\r\n\t\tthis.tokenPosition = new Position(this.documentLine, this.documentColumn);\r\n\t}\r\n}\r\n\r\nfunction getType(c: string): Type {\r\n\tlet charCode: number = c.charCodeAt(0);\r\n\tif (charCode >= 65 && charCode <= 90 || charCode >= 97 && charCode <= 122 || charCode === 37) {\r\n\t\treturn Type.Alphanumeric;\r\n\t} else if (charCode >= 48 && charCode <= 57) {\r\n\t\treturn Type.Numeric;\r\n\t} else if (charCode === 34) {\r\n\t\treturn Type.DoubleQuotes;\r\n\t} else if (charCode === 9) {\r\n\t\treturn Type.Tab;\r\n\t} else if (charCode === 10) {\r\n\t\treturn Type.NewLine;\r\n\t} else if (charCode === 32) {\r\n\t\treturn Type.Space;\r\n\t} else if (charCode === 33) {\r\n\t\treturn Type.ExclamationMark;\r\n\t} else if (charCode === 35) {\r\n\t\treturn Type.NumberSign;\r\n\t} else if (charCode === 36) {\r\n\t\treturn Type.DollarSign;\r\n\t\t// } else if (charCode === 37) {\r\n\t\t// \treturn Type.PercentSign;\r\n\t} else if (charCode === 38) {\r\n\t\treturn Type.Ampersand;\r\n\t} else if (charCode === 39) {\r\n\t\treturn Type.SingleQuote;\r\n\t} else if (charCode === 40) {\r\n\t\treturn Type.OpenParen;\r\n\t} else if (charCode === 41) {\r\n\t\treturn Type.CloseParen;\r\n\t} else if (charCode === 42) {\r\n\t\treturn Type.Asterisk;\r\n\t} else if (charCode === 43) {\r\n\t\treturn Type.PlusSign;\r\n\t} else if (charCode === 44) {\r\n\t\treturn Type.Comma;\r\n\t} else if (charCode === 45) {\r\n\t\treturn Type.MinusSign;\r\n\t} else if (charCode === 46) {\r\n\t\treturn Type.Period;\r\n\t} else if (charCode === 58) {\r\n\t\treturn Type.Colon;\r\n\t} else if (charCode === 59) {\r\n\t\treturn Type.SemiColon;\r\n\t} else if (charCode === 60) {\r\n\t\treturn Type.LessThan;\r\n\t} else if (charCode === 61) {\r\n\t\treturn Type.EqualSign;\r\n\t} else if (charCode === 62) {\r\n\t\treturn Type.GreaterThan;\r\n\t} else if (charCode === 63) {\r\n\t\treturn Type.QuestionMark;\r\n\t} else if (charCode === 64) {\r\n\t\treturn Type.AtSymbol;\r\n\t} else if (charCode === 91) {\r\n\t\treturn Type.OpenBracket;\r\n\t} else if (charCode === 92) {\r\n\t\treturn Type.Backslash;\r\n\t} else if (charCode === 93) {\r\n\t\treturn Type.CloseBracket;\r\n\t} else if (charCode === 94) {\r\n\t\treturn Type.Caret;\r\n\t} else if (charCode === 95) {\r\n\t\treturn Type.Underscore;\r\n\t} else if (charCode === 96) {\r\n\t\treturn Type.BackQuote;\r\n\t} else if (charCode === 123) {\r\n\t\treturn Type.OpenBrace;\r\n\t} else if (charCode === 124) {\r\n\t\treturn Type.Pipe;\r\n\t} else if (charCode === 125) {\r\n\t\treturn Type.CloseBrace;\r\n\t} else if (charCode === 126) {\r\n\t\treturn Type.Tilde;\r\n\t}\r\n\r\n\telse {\r\n\t\treturn -1;\r\n\t}\r\n}\r\n\r\nexport const enum Type {\r\n\tAlphanumeric = 1,\r\n\tNumeric = 2,\r\n\tLineComment = 3,\r\n\tBlockComment = 4,\r\n\tString = 5,\r\n\tLineCommentInit = 6,\r\n\tDoubleQuotes = 9,\r\n\r\n\tTab = 11,\r\n\tNewLine = 13,\r\n\tSpace = 32,\r\n\r\n\tExclamationMark = 33,\r\n\tNumberSign = 35,\r\n\tDollarSign = 36,\r\n\tAmpersand = 38,\r\n\tSingleQuote = 39,\r\n\tOpenParen = 40,\r\n\tCloseParen = 41,\r\n\tAsterisk = 42,\r\n\tPlusSign = 43,\r\n\tComma = 44,\r\n\tMinusSign = 45,\r\n\tPeriod = 46,\r\n\tColon = 58,\r\n\tSemiColon = 59,\r\n\tLessThan = 60,\r\n\tEqualSign = 61,\r\n\tGreaterThan = 62,\r\n\tQuestionMark = 63,\r\n\tAtSymbol = 64,\r\n\tOpenBracket = 91,\r\n\tBackslash = 92,\r\n\tCloseBracket = 93,\r\n\tCaret = 94,\r\n\tUnderscore = 95,\r\n\tBackQuote = 96,\r\n\tOpenBrace = 123,\r\n\tPipe = 124,\r\n\tCloseBrace = 125,\r\n\tTilde = 126,\r\n\r\n\tUndefined = -1\r\n}","import * as vscode from 'vscode';\r\nconst fs = require('fs');\r\n\r\n//let Location = vscode.Location;\r\n//let Position = vscode.Position;\r\ninterface ItemHint {\r\n\tlineStatus: string,\r\n\tstartstring: string\r\n}\r\ninterface LabelItem {\r\n\troutine: string,\r\n\tlabel: string,\r\n\tline: string\r\n}\r\ninterface DbItem {\r\n\tlabels: LabelItem[],\r\n\troutines: {}\r\n}\r\nexport class CompletionItemProvider {\r\n\t/**\r\n * Provides the completion items for the supplied words.\r\n *\r\n * @param {TextDocument} document\r\n * @param {Position} position\r\n * @param {CancellationToken} token\r\n * @returns\r\n */\r\n\tprivate _labelsReady: boolean;\r\n\tprivate _labelDB: DbItem;\r\n\tprivate _filesToCheck: number;\r\n\tprivate _dbfile: string;\r\n\tconstructor(labeldb: string) {\r\n\t\tthis._labelsReady = false;\r\n\t\tthis._dbfile = labeldb;\r\n\t\tthis._refreshLabelDB();\r\n\t}\r\n\tprovideCompletionItems(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken) {\r\n\t\t//let word = document.getText(document.getWordRangeAtPosition(position));\r\n\t\tlet line = document.getText(new vscode.Range(new vscode.Position(position.line, 0), position))\r\n\t\tlet status = getLineStatus(line, position.character);\r\n\t\tlet clean: Array<vscode.CompletionItem> = [];\r\n\r\n\t\tif (this._labelsReady && status.lineStatus === 'jumplabel' && status.startstring.length > 1) {\r\n\t\t\tclean = this._findLabel(status.startstring, clean);\r\n\t\t}\r\n\t\treturn clean;\r\n\t}\r\n\tprivate _refreshLabelDB() { // Look for all Labels in .m-Routines and them + Comments\r\n\t\tif (!fs.existsSync(this._dbfile)) {\r\n\t\t\tlet db = {\r\n\t\t\t\tlabels: [{ routine: '', label: '' }],\r\n\t\t\t\troutines: {}\r\n\t\t\t}\r\n\t\t\tfs.writeFileSync(this._dbfile, JSON.stringify(db));\r\n\t\t}\r\n\t\tfs.readFile(this._dbfile, (err, data) => {\r\n\t\t\tif (!err) {\r\n\t\t\t\tthis._labelDB = JSON.parse(data);\r\n\t\t\t\tlet dbChanged = false;\r\n\t\t\t\tvscode.workspace.findFiles('*.m').then((files) => {\r\n\t\t\t\t\tthis._filesToCheck = files.length;\r\n\t\t\t\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\t\t\t\tlet path = files[i].fsPath;\r\n\t\t\t\t\t\t\tfs.stat(path, false, (err, stats) => {\r\n\t\t\t\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\t\t\t\tlet ms = this._labelDB.routines[path];\r\n\t\t\t\t\t\t\t\t\tif (ms === undefined || stats.mtimeMs > ms) {\r\n\t\t\t\t\t\t\t\t\t\tthis._labelDB.routines[path] = stats.mtimeMs;\r\n\t\t\t\t\t\t\t\t\t\tdbChanged = true;\r\n\t\t\t\t\t\t\t\t\t\tif (stats.size < 50000) {  //parse only Files <50K\r\n\t\t\t\t\t\t\t\t\t\t\tthis._refreshFileLabels(path);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis._checkReady(dbChanged);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._labelsReady = true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tprivate _checkReady(dbChanged: boolean) {\t// Check if all .m Files are processed and save LabelDB then\r\n\t\tif (--this._filesToCheck === 0) {\r\n\t\t\tif (dbChanged) {\r\n\t\t\t\tfs.writeFile(this._dbfile, JSON.stringify(this._labelDB), (err) => {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tvscode.window.showErrorMessage(\"Error writing Label DB\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate _refreshFileLabels(path) {  // Refresh all Labels of a changed .m File\r\n\t\tlet routine = path.replace('\\\\', '/').split('/').pop();\r\n\t\troutine = routine!.split('.')[0].replace('_', '%');\r\n\t\tfs.readFile(path, 'utf8',(err,content)=>{\r\n\t\t\tif (!err) {\r\n\t\t\t\tlet lines=content.split('\\n');\r\n\t\t\t\tlet label = '';\r\n\t\t\t\tthis._labelDB.labels = this._labelDB.labels.filter((label) => {\r\n\t\t\t\t\treturn label.routine !== routine;\r\n\t\t\t\t})\r\n\t\t\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\t\t\tif (i===0) {\r\n\t\t\t\t\t\tthis._labelDB.labels.push({label:'*FL',routine,line:lines[0]});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (label = lines[i].match(/^[%A-Za-z0-9][A-Za-z0-9]{0,31}/)) {\r\n\t\t\t\t\t\tthis._labelDB.labels.push({ label: label[0], routine, line: lines[i] })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._checkReady(true);\r\n\t\t});\r\n\t}\r\n\tprivate _findLabel(startstring, list: Array<vscode.CompletionItem>) {\r\n\t\t//let hits = 0;\r\n\t\tlet hitlist: LabelItem[];\r\n\t\tlet sortText='';\r\n\t\tif (startstring.charAt(0) === '^') {\r\n\t\t\tlet suchstring = startstring.substring(1);\r\n\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\treturn item.routine.startsWith(suchstring);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (startstring.indexOf('^')!==-1) {\r\n\t\t\t\tlet label=startstring.split('^')[0];\r\n\t\t\t\tlet routinepart=startstring.split('^')[1];\r\n\t\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\t\tlet fits = item.label===label && item.routine.startsWith(routinepart);\r\n\t\t\t\t\treturn fits;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\thitlist = this._labelDB.labels.filter((item) => {\r\n\t\t\t\t\tlet fits = item.label.startsWith(startstring);\r\n\t\t\t\t\treturn fits;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < hitlist.length; i++) {\r\n\t\t\tlet item = hitlist[i];\r\n\t\t\tlet label = item.label + '^' + item.routine;\r\n\t\t\tif (item.label===\"*FL\") {\r\n\t\t\t\tif (!startstring.startsWith('^')) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlabel='^'+item.routine;\r\n\t\t\t\tsortText=\"100\";\r\n\t\t\t}\r\n\t\t\tlet detail = ''\r\n\t\t\tif (item.line.charAt(item.label.length) === '(') {\r\n\t\t\t\tif (item.line.indexOf(')') !== -1) {\r\n\t\t\t\t\tdetail = item.line.split(')')[0] + ')';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item.line.indexOf(';') !== -1) {\r\n\t\t\t\tdetail += item.line.substring(item.line.indexOf(';') + 1);\r\n\t\t\t}\r\n\t\t\tif (detail.length>0 && sortText!=='100') {sortText='099';}\r\n\t\t\tlist.push({ label, detail, sortText });\r\n\t\t}\r\n\t\treturn list;\r\n\t}\r\n}\r\nfunction getLineStatus(line: string | undefined, position: number): ItemHint {\r\n\tlet lineStatus = 'lineStart';\r\n\tlet lookPosition = 0;\r\n\tlet lastCommand = '';\r\n\tlet startstring = '';\r\n\tlet isInsidePostcond = false;\r\n\tif (line) {\r\n\t\twhile (lookPosition < position) {\r\n\t\t\tlet char = line.substring(lookPosition, ++lookPosition);\r\n\t\t\tlet isWhiteSpace = (char === \" \" || char === \"\\t\");\r\n\t\t\tlet isBeginOfVariable = char.match(/[A-Za-z%^]/);\r\n\t\t\tlet isAlphaChar = char.match(/[A-Za-z]/);\r\n\t\t\t//let isAlphanumeric=char.match(/[A-Za-z0-9%]/);\r\n\t\t\t//let isOperand = char.match(/[*+-/\\[\\]']/);\r\n\t\t\tif (lineStatus !== 'string' && char === ';') {\r\n\t\t\t\treturn { lineStatus: 'comment', startstring: '' };\r\n\t\t\t}\r\n\t\t\tif (!isBeginOfVariable) {\r\n\t\t\t\tif (startstring !== '' && char.match(/[0-9]/)) {\r\n\t\t\t\t\tstartstring += char\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstartstring = '';\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartstring += char;\r\n\t\t\t}\r\n\t\t\tswitch (lineStatus) {\r\n\t\t\t\tcase 'argument': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t\tif (lastCommand.match(/[D|DO|G|GOTO|J|JOB]/i)) {\r\n\t\t\t\t\t\t\t\tlineStatus = 'jumplabel'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (char === '\"') {\r\n\t\t\t\t\t\tlineStatus = 'string';\r\n\t\t\t\t\t} else if (isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'variable';\r\n\t\t\t\t\t} else if (char === \"$\") {\r\n\t\t\t\t\t\tlineStatus = 'function';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'command': {\r\n\t\t\t\t\tif (char === \":\") {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\tisInsidePostcond = true;\r\n\t\t\t\t\t} else if (isAlphaChar) {\r\n\t\t\t\t\t\tlastCommand += char;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\tif (lastCommand.match(/[D|DO|G|GOTO|J|JOB]/i)) {\r\n\t\t\t\t\t\t\tlineStatus = 'jumplabel'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlineStatus = 'error';\r\n\t\t\t\t\t\treturn { lineStatus: 'error', startstring: '' };\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'function': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (char === \"$\") {\r\n\t\t\t\t\t\tlineStatus = 'jumplabel';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'jumplabel': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t} else if (char === \":\") {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t} else if (char===\"(\") {\r\n\t\t\t\t\t\tlineStatus='argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'label': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t} else if (char = '(') {\r\n\t\t\t\t\t\tlineStatus = 'variable';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'lineStart': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlineStatus = 'label';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'string': {\r\n\t\t\t\t\tif (char === '\"') {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'variable': {\r\n\t\t\t\t\tif (isWhiteSpace) {\r\n\t\t\t\t\t\tif (isInsidePostcond) {\r\n\t\t\t\t\t\t\tisInsidePostcond = false;\r\n\t\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlineStatus = 'command';\r\n\t\t\t\t\t\t\tlastCommand = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (!isBeginOfVariable) {\r\n\t\t\t\t\t\tlineStatus = 'argument';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn { lineStatus, startstring };\r\n}\r\n","import * as vscode from 'vscode';\r\nlet em = require('emcellent');\r\n//let tabSize = vscode.workspace.getConfiguration().get(\"editor.tabSize\")\r\n//var prevfin = true;\r\n\r\nasync function autoSpaceEnter() {\r\n\t//await vscode.commands.executeCommand(\"acceptSelectedSuggestion\");\r\n\tlet editor = vscode.window.activeTextEditor\r\n\tif (editor) {\r\n\t\tlet pos = editor.selection.active\r\n\t\tlet currentLine = editor.document.lineAt(pos.line).text;\r\n\t\tlet parsed = em.parse(currentLine);\r\n\t\tlet newLine = '';\r\n\t\tif (pos.character !== 0) {\r\n\t\t\t//check for removing a trailing .\r\n\t\t\tif ((parsed[0].lineRoutines === undefined || parsed[0].lineRoutines.length === 0) && currentLine.indexOf(\";\") === -1 && parsed[0].lineIndentationArray !== undefined && parsed[0].lineIndentationArray.length > 0) {\r\n\t\t\t\tparsed[0].lineIndentationArray.splice(-1)\r\n\t\t\t\teditor.edit((editBuilder) => {\r\n\t\t\t\t\teditBuilder.replace(new vscode.Range(pos.with(pos.line, 0), pos.with(pos.line, currentLine.length)), em.render(parsed))\r\n\t\t\t\t})\r\n\t\t\t\t//check for adding indentation to the new line\r\n\t\t\t} else {\r\n\t\t\t\tif (parsed[0].lineIndentationArray === undefined) {\r\n\t\t\t\t\tparsed[0].lineIndentationArray = []\r\n\t\t\t\t}\r\n\t\t\t\tif (lineContainsNoParamDo(parsed[0])) {\r\n\t\t\t\t\tparsed[0].lineIndentationArray.push(\" \")\r\n\t\t\t\t}\r\n\t\t\t\tparsed[0].lineRoutines = []\r\n\t\t\t\tdelete parsed[0].lineComment\r\n\t\t\t\tdelete parsed[0].lineLabel\r\n\t\t\t\tnewLine = em.render(parsed);\r\n\t\t\t}\r\n\t\t}\r\n\t\teditor.edit((editBuilder) => {\r\n\t\t\teditBuilder.insert(pos, \"\\n\" + newLine);\r\n\t\t})\r\n\t}\r\n}\r\n\r\nfunction lineContainsNoParamDo(parsed) {\r\n\tlet cmds = parsed.lineRoutines;\r\n\tif (cmds = parsed.lineRoutines) {\r\n\t\tfor (let i = 0; i < cmds.length; i++) {\r\n\t\t\tif (cmds[i].mRoutine.match(/(d|do)/i) && !cmds[i].mArguments) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nasync function autoSpaceTab() {\r\n\r\n\tlet editor = vscode.window.activeTextEditor\r\n\tif (editor) {\r\n\t\tlet pos = editor.selection.active\r\n\t\tlet currentLine = editor.document.lineAt(pos.line).text;\r\n\t\tlet parsed = em.parse(currentLine);\r\n\r\n\t\t//vscode.commands.executeCommand(\"acceptSelectedSuggestion\").then((test)=>{\r\n\t\t//\tconsole.log(test);\r\n\t\t//});\r\n\r\n\t\tif ((parsed[0].lineRoutines === undefined || parsed[0].lineRoutines.length === 0) &&\r\n\t\t\tcurrentLine.indexOf(\";\") === -1 && parsed[0].lineIndentationArray !== undefined &&\r\n\t\t\tparsed[0].lineIndentationArray.length > 0) {\r\n\t\t\tparsed[0].lineIndentationArray.push(\" \")\r\n\t\t\teditor.edit((editBuilder) => {\r\n\t\t\t\tif (currentLine.charAt(pos.character - 1) === \" \") {\r\n\t\t\t\t\teditBuilder.insert(pos.with(pos.line, pos.character), \". \")\r\n\t\t\t\t} else {\r\n\t\t\t\t\teditBuilder.insert(pos.with(pos.line, pos.character), \" . \")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\teditor.edit((eb) => {\r\n\t\t\t\teb.insert(pos, \"\\t\")\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { autoSpaceTab, autoSpaceEnter };","\"use strict\";\n\nvar parser = require('./lib/parse.js');\nvar renderer = require('./lib/render.js');\n\nfunction parseLine(inputString) {\n\n    var tmpObject = {};\n\n    //Parsing must be performed sequentially.\n    tmpObject = parser.extractLabel(inputString, tmpObject);\n    tmpObject = parser.extractComment(tmpObject.lineExpression, tmpObject);\n    tmpObject = parser.extractIndentation(tmpObject.lineExpression, tmpObject);\n    tmpObject = parser.extractRoutines(tmpObject.lineExpression, tmpObject);\n\n    //Line Expression is no longer needed.\n    delete tmpObject.lineExpression;\n    return tmpObject;\n}\n\nfunction renderLine(inputObject) {\n\n    var tmpLine = \"\";\n\n    //Rendering must be performed sequentially.\n    tmpLine = renderer.appendLabel(inputObject, tmpLine);\n    tmpLine = renderer.appendIndentation(inputObject, tmpLine);\n    tmpLine = renderer.appendRoutines(inputObject, tmpLine);\n    tmpLine = renderer.appendComment(inputObject, tmpLine);\n\n    return tmpLine;\n\n}\n\nfunction parse(inputString) {\n\n    //Strip out carriage returns.\n    inputString = inputString.replace(\"\\r\", \"\");\n    var inputArray = inputString.split('\\n');\n    var returnArray = [];\n\n    for (var i = 0; i < inputArray.length; i++) {\n        var tmpLineObject = parseLine(inputArray[i]);\n        tmpLineObject.lineNumber = i + 1;\n        returnArray.push(tmpLineObject);\n    }\n    return returnArray;\n}\n\nfunction render(inputObject) {\n\n    var response = \"\";\n    var parseArray = [];\n\n    if (!Array.isArray(inputObject)) {\n        parseArray.push(inputObject);\n    } else {\n        parseArray = inputObject;\n    }\n\n    for (var i = 0; i < parseArray.length; i++) {\n        var tmpLine = renderLine(parseArray[i]);\n        if (i === (parseArray.length - 1)) {\n            response = response + tmpLine;\n        } else {\n            response = response + tmpLine + \"\\n\";\n        }\n    }\n\n    return response;\n\n}\n\nmodule.exports.parse = parse;\nmodule.exports.render = render;\n","\"use strict\";\n\n//Extract Labels and Lead Spacing.\nfunction extractLabel(inputLine, inputObject) {\n\n    for (var i = 0; i <= inputLine.length; i++) {\n        if (inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\n            //If no leading chars, label.\n            if (i === 0) {\n                inputObject.lineLabel = inputLine.split(/[ \\t]/, 1)[0];\n                for (var ii = inputObject.lineLabel.length; ii <= inputLine.length; ii++) {\n                    //After label spacing.\n                    if (inputLine[ii] !== \" \" && inputLine[ii] !== \"\\t\") {\n                        inputObject.lineLeadSpace = inputLine.substring(inputObject.lineLabel.length, ii);\n                        inputObject.lineExpression = inputLine.substring(ii);\n                        break;\n                    }\n                    //After label spacing for empty lines.\n                    if (ii === (inputLine.length - 1)) {\n                        inputObject.lineLeadSpace = inputLine.substring(inputObject.lineLabel.length);\n                        inputObject.lineExpression = \"\";\n                        break;\n                    }\n                }\n                break;\n                //Unlabeled spacing with code.\n            } else {\n                inputObject.lineLeadSpace = inputLine.substring(0, i);\n                inputObject.lineExpression = inputLine.substring(i);\n                break;\n            }\n        }\n        //Unlabeled spacing without code.\n        if (i === (inputLine.length - 1)) {\n            inputObject.lineLeadSpace = inputLine;\n            inputObject.lineExpression = \"\";\n            break;\n        }\n    }\n    return inputObject;\n}\n\n//Extract Comments.\nfunction extractComment(inputLine, inputObject) {\n\n    //Semicolon identifies comments.\n    if (inputLine.search(\";\") >= 0) {\n        for (var i = 0; i < inputLine.length; i++) {\n            if (inputLine[i] === \";\") {\n                //Check if semicolon is double quoted.\n                if ((inputLine.substring(0, i).split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 !== 0)) {\n                    inputObject.lineExpression = inputLine.substring(0, i);\n                    inputObject.lineComment = inputLine.substring(i).substring(1);\n                    break;\n                } else {\n                    //Check if semicolon has only trailing quote.\n                    if (((inputLine.substring(0, i).replace(\"\").split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 === 0))) {\n                        inputObject.lineExpression = inputLine.substring(0, i);\n                        inputObject.lineComment = inputLine.substring(i).substring(1);\n                        break;\n                    }\n                    //If only quoted semicolons, set expression.\n                    inputObject.lineExpression = inputLine;\n                }\n            }\n        }\n        return inputObject;\n        //If no comments, set expression.\n    } else {\n        inputObject.lineExpression = inputLine;\n        return inputObject;\n    }\n}\n\n//Extract Indentation.\n//Assumes inputLine has extracted comments/spacing.\nfunction extractIndentation(inputLine, inputObject) {\n\n    var lineIndentationArray = [];\n    var lineIndentation = 0;\n    var tmpPosStart = 0;\n    var tmpPosEnd = 0;\n\n    for (var i = 0; i <= inputLine.length; i++) {\n        //Period identifies indentation.\n        if (inputLine[i] === \".\") {\n            //Second period identifies sub-indentation, push to array.\n            if (lineIndentation !== 0) {\n                tmpPosEnd = i;\n                lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n            }\n            //Flag start position and presence.\n            tmpPosStart = i + 1;\n            lineIndentation++;\n        } else {\n            //End of indentation with code.\n            if (inputLine[i] !== \".\" && inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\n                //Make sure a period was found.\n                if (lineIndentation !== 0) {\n                    tmpPosEnd = i;\n                    lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n                    inputObject.lineExpression = inputLine.substring(i);\n                }\n                break;\n            }\n            //End of indentation without code.\n            if (i === (inputLine.length - 1)) {\n                tmpPosEnd = i + 1;\n                lineIndentationArray.push(inputLine.substring(tmpPosStart, tmpPosEnd));\n                inputObject.lineExpression = inputLine.substring(i + 1);\n                break;\n            }\n        }\n    }\n    //Only assign array if present.\n    if (lineIndentationArray.length > 0) {\n        inputObject.lineIndentationArray = lineIndentationArray;\n    } else {\n        inputObject.lineExpression = inputLine;\n    }\n    return inputObject;\n}\n\n//Divide routines and arguments into array, used by extractRoutines.\nfunction splitRoutinesAndArguments(inputLine) {\n\n    var lineCommands = [];\n    var tmpCursor = 0;\n\n    for (var i = 0; i <= inputLine.length; i++) {\n\n        //Flag spaces/tabs as dividers.\n        if (inputLine[i] === \" \" || inputLine[i] === \"\\t\") {\n            //Ensure space isn't quoted.\n            if ((inputLine.substring(0, i).split(\"\\\"\").length % 2 !== 0) && (inputLine.substring(i).split(\"\\\"\").length % 2 !== 0)) {\n                //If has content, push.\n                if (inputLine.substring(tmpCursor, i).length > 0) {\n                    lineCommands.push(inputLine.substring(tmpCursor, i));\n                    //Otherwise, push empty commands.\n                } else if (inputLine.substring(tmpCursor, i).length === 0 && (inputLine.substring(tmpCursor - 1, tmpCursor) === \" \" || inputLine.substring(tmpCursor - 1, tmpCursor) === \"\\t\")) {\n                    lineCommands.push(inputLine.substring(tmpCursor, i));\n                }\n                tmpCursor = i + 1;\n            }\n            //Flag splits at line end.\n        } else if (i === inputLine.length) {\n            //If has content, push.\n            if (inputLine.substring(tmpCursor, i).length > 0) {\n                lineCommands.push(inputLine.substring(tmpCursor, i));\n                //Gather empty commands from end of line.\n            } else if (i === tmpCursor && (inputLine.substring(i - 1, i) === \" \" || inputLine.substring(i - 1, i) === \"/t\")) {\n                lineCommands.push('');\n            }\n            //tmpCursor = 0;\n        }\n    }\n    return lineCommands;\n}\n\n//Extracts Post-Conditionals from Routines, used by extractRoutines.\nfunction extractPostConditional(inputObject) {\n\n    //Assign to new variable to truncate Routines.\n    var tmpObject = inputObject;\n    for (var i = 0; i < tmpObject.length; i++) {\n        if (tmpObject[i].mRoutine) {\n            //Semicolon indicates Post-Conditionals.\n            var tmpIndex = tmpObject[i].mRoutine.indexOf(\":\");\n            if (tmpIndex > -1) {\n                tmpObject[i].mPostConditional = tmpObject[i].mRoutine.substring(tmpIndex + 1);\n                tmpObject[i].mRoutine = tmpObject[i].mRoutine.substring(0, tmpIndex);\n            }\n        }\n    }\n    return tmpObject;\n}\n\n//Extract Routines.\n//Assumes inputLine has extracted comments/spacing/indentation.\nfunction extractRoutines(inputLine, inputObject) {\n\n    var tmpFunction = {};\n    var tmpFunctionArray = [];\n\n    //Divide Routines and Arguments.\n    var splitLine = splitRoutinesAndArguments(inputLine);\n\n    //Loop, even is function, odd is arguments.\n    var i = 0;\n    while (i < splitLine.length) {\n\n        if (i % 2 === 0) {\n            tmpFunction.mRoutine = splitLine[i];\n        } else {\n\n            tmpFunction.mArguments = splitLine[i];\n\n            //Custom handler for trailing argument spacing.\n            //Go until splitline hits a non empty val.\n            var ii = i + 1;\n            while (ii < splitLine.length) {\n                if (splitLine[ii] === \"\") {\n                    splitLine.splice(ii, 1);\n                    tmpFunction.mArguments = tmpFunction.mArguments + \" \";\n                } else {\n                    break;\n                }\n            }\n\n            tmpFunctionArray.push(tmpFunction);\n            tmpFunction = {};\n\n        }\n\n        //Last command doesn't always require parameter, so if odd number of pairs, push it.\n        if (splitLine.length % 2 !== 0 && splitLine.length > 0 && i === (splitLine.length - 1)) {\n            tmpFunction.mRoutine = splitLine[i];\n            tmpFunctionArray.push(tmpFunction);\n            tmpFunction = {};\n        }\n\n        i++;\n\n    }\n\n    //Extract and output Post Conditionals.\n    var postConditionFunctionArray = extractPostConditional(tmpFunctionArray);\n    if (postConditionFunctionArray.length > 0) {\n        inputObject.lineRoutines = postConditionFunctionArray;\n    }\n    return inputObject;\n}\n\n//Export all routines.\nmodule.exports.extractLabel = extractLabel;\nmodule.exports.extractComment = extractComment;\nmodule.exports.extractIndentation = extractIndentation;\nmodule.exports.splitRoutinesAndArguments = splitRoutinesAndArguments;\nmodule.exports.extractPostConditional = extractPostConditional;\nmodule.exports.extractRoutines = extractRoutines;\n","\"use strict\";\n\n//Append Line Label and Lead Spacing.\nfunction appendLabel(inputObject, inputLine) {\n    if (inputObject.lineLabel) {\n        inputLine = inputLine + inputObject.lineLabel;\n    }\n    if (inputObject.lineLeadSpace) {\n        inputLine = inputLine + inputObject.lineLeadSpace;\n    }\n    return inputLine;\n}\n\n//Append Indentation to Label/Spacing.\nfunction appendIndentation(inputObject, inputLine) {\n    var tmpIndentation = \"\";\n    if (inputObject.lineIndentationArray) {\n        if (inputObject.lineIndentationArray.length > 0) {\n            for (var i in inputObject.lineIndentationArray) {\n                tmpIndentation = tmpIndentation + \".\" + inputObject.lineIndentationArray[i];\n            }\n            inputLine = inputLine + tmpIndentation;\n        }\n    }\n    return inputLine;\n}\n\n//Append Routines to Label/Spacing/Indentation.\nfunction appendRoutines(inputObject, inputLine) {\n    if (inputObject.lineRoutines) {\n        for (var i in inputObject.lineRoutines) {\n            if (inputObject.lineRoutines[i].mRoutine || inputObject.lineRoutines[i].mRoutine === \"\") {\n                //Leave off interval spacing for first Routine.\n                if (i === \"0\") {\n                    inputLine = inputLine + inputObject.lineRoutines[i].mRoutine;\n                } else {\n                    inputLine = inputLine + \" \" + inputObject.lineRoutines[i].mRoutine;\n                }\n                //Append Post-Conditional.\n                if (inputObject.lineRoutines[i].mPostConditional) {\n                    inputLine = inputLine + \":\" + inputObject.lineRoutines[i].mPostConditional;\n                }\n                //Append Arguments.\n                if (inputObject.lineRoutines[i].hasOwnProperty(\"mArguments\")) {\n                    inputLine = inputLine + \" \" + inputObject.lineRoutines[i].mArguments;\n                }\n            }\n        }\n    }\n    return inputLine;\n}\n\n//Append Comment.\nfunction appendComment(inputObject, inputLine) {\n    if (inputObject.hasOwnProperty(\"lineComment\")) {\n        inputLine = inputLine + \";\" + inputObject.lineComment;\n    }\n    return inputLine;\n}\n\n//Export all Routines.\nmodule.exports.appendLabel = appendLabel;\nmodule.exports.appendIndentation = appendIndentation;\nmodule.exports.appendRoutines = appendRoutines;\nmodule.exports.appendComment = appendComment;\n","let fs = require('fs');\r\ninterface ErrorInformation {\r\n  text: string,\r\n  position: number,\r\n  line?: number,\r\n  indexFound?: boolean,\r\n  globalFound?: boolean\r\n  indirectionFound?: boolean;\r\n}\r\ninterface NameObject {\r\n  type: \"global\" | \"local\" | \"exfunction\" | \"nonMfunction\" | \"entryref\",\r\n  name: string\r\n}\r\ninterface LineComand {\r\n  command: string,\r\n  position: number\r\n}\r\ninterface LineObject {\r\n  lineComment?: string;\r\n  lineIndentationArray?: string[];\r\n  lineRoutines?: TmpFunction[];\r\n  lineLeadSpace?: string,\r\n  lineLabel?: string,\r\n  lineExpression?: string,\r\n  errorText?: string,\r\n  errorPosition?: number,\r\n  expressionPosition?: number\r\n}\r\ninterface TmpFunction {\r\n  mCommand: string,\r\n  mArguments: string,\r\n  mPostCondition: string,\r\n  cmdPosition: number,\r\n  argPosition: number,\r\n  pcPosition: number\r\n}\r\nconst label = /^[A-Za-z%][A-Za-z0-9]*(\\([A-Za-z%][A-Za-z0-9]*(,[A-Za-z%][A-Za-z0-9]*)*\\))?/\r\nconst lvn = /^[A-Za-z%][A-Za-z0-9]*/\r\nconst gvn = /^\\^[A-Za-z%][A-Za-z0-9]*/\r\nconst isv = /^\\$(DEVICE|ECODE|EC|ESTACK|ES|ETRAP|ET|HALT|HOROLOG|H|IO|I|JOB|J|KEY|K|NAMESPACE|PRINCIPAL|P|QUIT|Q|REFERENCE|R|STACK|ST|STORAGE|S|SYSTEM|TEST|THIS|TLEVEL|TL|T|USERNAME|X|Y|ZALLOCSTOR|ZA|ZB|ZCHSET|ZCLOSE|ZCMDLINE|ZCM|ZCOMPILE|ZCO|ZCSTATUS|ZC|ZDATEFORM|ZDA|ZDIRECTORY|ZD|ZEDITOR|ZED|ZEOF|ZEO|ZE[A-Z]*|ZGBLDIR|ZG|ZHRORLOG|ZH|ZININTERRUPT|ZINI|ZINTERRUPT|ZINT|ZIO|ZJOB|ZJ|ZKEY|ZLEVEL|ZL|ZMAXTPTIME|ZMAXTPTI|ZMODE|ZMO|ZONLNRLBK|ZPATNUMERIC|ZPATN|ZPIN|ZPOSITION|ZPOS|ZPOUT|ZPROMPT|ZQUIT|ZREALSTOR|ZRELDATE|ZRO[A-Z]*|ZSOURCE|ZSO|ZSTA[A-Z]*|ZSTEP|ZSTRP|ZSTRPLLIM|ZST|ZSYSTEM|ZSY|ZS|ZTEXIT|ZTE|ZTIMEOUT|ZTIM|ZTRAP|ZT|ZUSEDSTOR|ZUT|ZVERSION|ZV[A-Z]*|ZYERROR|ZYRELEASE|ZTDATA|ZTDELIM|ZTLEVEL|ZTNAME|ZTOLDVAL|ZTRIGGEROP|ZTSLATE|ZTUPDATE|ZTVALUE|ZTWORMHOLE)/i\r\nconst ifunction = /^\\$(ASCII|A|CHAR|C|DATA|D|EXTRACT|E|FIND|F|FNUMBER|FN|GET|G|INCREMENT|INCR|I|JUSTIFY|J|LENGTH|L|NAME|NA|NEXT|N|ORDER|O|PIECE|P|QLENGTH|QL|QSUBSCRIPT|QS|QUERY|Q|RANDOM|R|REVERSE|RE|SELECT|S|STACK|ST|TEXT|T|TRANSLATE|TR|VIEW|V|ZAHANDLE|ZAH|ZASCII|ZATRANSFORM|ZAT|ZBITAND|ZBITCOUNT|ZBITFIND|ZBITGET|ZBITLEN|ZBITNOT|ZBITOR|ZBITSET|ZBITSTR|ZBITXOR|ZCHAR|ZCH|ZCOLLATE|ZCONVERT|ZCO|ZDATE|ZDATA|ZD|ZEXTRACT|ZE|ZFIND|ZF|ZGETJPI|ZG|ZINCREMENT|ZINCR|ZJOBEXAM|ZJUSTIFY|ZJ|ZLENGTH|ZL|ZMESSAGE|ZPARSE|ZPEEK|ZPIECE|ZPI|ZPREVIOUS|ZP|ZQGBLMOD|ZSEARCH|ZSIGPROC|ZSOCKET|ZSUBSTR|ZSUB|ZSYSLOG|ZTRANSLATE|ZTRIGGER|ZTRI|ZTRNLNM|ZTR|ZWIDTH|ZWRITE|ZW)(?=\\()/i;\r\nconst nonMfunction = /^\\$\\&([A-Za-z%0-9][A-Za-z0-9]*.)?([A-Za-z%0-9][A-Za-z0-9]*)?(\\^[A-Za-z%][A-Za-z0-9]*)?/\r\nconst entryref = /^@?([A-Za-z%0-9][A-Za-z0-9]*)?(\\^@?[A-Za-z%][A-Za-z0-9]*)?/\r\nconst routineref = /^\\^@?[A-Za-z%][A-Za-z0-9]*/\r\nconst numlit = /^(\\d*\\.?\\d*(E-?\\d+)?)/\r\nconst strlit = /^\"([^\"]*(\"\")*)*\"/\r\nconst command = /^[B|BREAK|C|CLOSE|D|DO|E|ELSE|F|FOR|G|GOTO|H|HALT|HANG|I|IF|J|JOB|K|KILL|L|LOCK|M|MERGE|N|NEW|O|OPEN|Q|QUIT|R|READ|S|SET|U|USE|V|VIEW|W|WRITE|X|XECUTE|ZA|ZALLOCATE|ZBR|ZBREAK|ZC|ZCONTINUE|ZD|ZDEALLOCATE|ZE|ZEDIT|ZG|ZGOTO|ZHALT|ZH|ZHELP|ZK|ZKILL|ZL|ZLINK|ZM|ZMESSAGE|ZP|ZPRINT|ZRUPDATE|ZSH|ZSHOW|ZST|ZSTEP|ZSY|ZSYSTEM|ZTC|ZTCOMMIT|ZTR|ZTRIGGER|ZTS|ZTSTART|ZWI|ZWITHDRAW|ZWR|ZWRITE]/i\r\nconst binoperator = /^('=|'>|'<|<=|>=|'&|'!|'\\?|'\\[|'\\]|\\*\\*|\\+|\\-|\\*|\\/|\\\\|#|'|&|!|_|<|>|=|\\[|\\]|\\?|@)/\r\nconst unaryoperator = /(\\-|'|\\+|@)/\r\nconst patcode = /^([A|C|E|L|N|P|U]|^(\"([^\"](\"\")*)*\"))+/i\r\nconst repititionCount = /^\\d*\\.?\\d*/\r\nconst openkeywords = /^APPEND|ATTACH=|BLOCK(SIZE)?=|COMMAND=|CONNECT=|(NO)?DELIM(ITER)?=?|EXC(EPTION)?=|FIFO|(NO)?FIXED|GROUP=|[IO]?CHSET=|KEY|IKEY|INDEPENDANT|IOERROR=|NEW[A-Z]*|MOREREADTIME=|OKEY|OWNER=|(NO)?RCHK|(NO)?READ(ONLY)?|RECORD(SIZE)?=|(NO)?RETRY|REWIND|SEEK=|SHELL=|STDERR=|(NO)?STREAM|SYSTEM=|(NO)?TRUNCATE|UIC=|VARIABLE|WORLD=|Z?(NO)?WRAP|WRITE(ONLY)?|ZBFSIZE|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE|Z?LISTEN=/i\r\nconst usekeywords = /^ATTACH|(NO)?CENABLE|[IO]?CHSET=|CLEAR(SCREEN)?|CONNECT|(NO)?CONVERT|CTRAP=|(NO)?DELIM(ITER)?=?|DETACH|DOWNSCROLL|(NO)?ECHO|(NO)?EDITING|ERASELINE|(NO)?ESC(APE)?|EXC(EPTION)?=|(NO)?FILTER=?|FLUSH|GROUP=|KEY|IKEY|IOERROR=|OKEY|OWNER=|(NO)?PASTHRU|(NO)?RCHK|(NO)?RETRY|REWIND|SEEK=|SKIPFILE=|SOCKET=|SPACE=|TERM(INATOR)?=|(NO)?TRUNCATE|(NO)?TTSNYC|(NO)?TYPEAHEAD|UPSCROLL|Z?LENGTH=|Z?WIDTH=|Z?(NO)?WRAP|WRITELB=|X=|Y=|ZBFSIZE|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE|LISTEN=/i\r\nconst closekeywords = /^DELETE|(NO)?DESTROY|EXCEPTION=|GROUP=|OWNER=|RENAME=|SOCKET=|TIMEOUT=|UIC=|WORLD=/i\r\nconst jobkeywords = /^CMD=|CMDLINE=|DEF=|DEFAULT=|ERR=|ERROR=|GBL=|GBLDIR=|IN=|INPUT=|OUT=|OUTPUT=|PASS|PASSCURLVN|STA=|STARTUP=/i\r\nconst tstartkeywords = /^SERIAL|S|T=|TRANSACTIONID=/i\r\nconst cmdExpansions = {\r\n  'B': 'BREAK', 'C': 'CLOSE', 'D': 'DO', 'E': 'ELSE', 'F': 'FOR', 'G': 'GOTO', 'H': 'HALT', 'I': 'IF', 'J': 'JOB', 'K': 'KILL', 'L': 'LOCK', 'M': 'MERGE', 'N': 'NEW',\r\n  'O': 'OPEN', 'Q': 'QUIT', 'R': 'READ', 'S': 'SET', 'U': 'USE', 'V': 'VIEW', 'W': 'WRITE', 'X': 'XECUTE', 'ZA': 'ZALLOCATE', 'ZB': 'ZBREAK', 'ZC': 'ZCONTINUE',\r\n  'ZD': 'ZDEALLOCATE', 'ZED': 'ZEDIT', 'ZG': 'ZGOTO', 'ZH': 'ZHELP', 'ZK': 'ZKILL', 'ZL': 'ZLINK', 'ZM': 'ZMESSAGE', 'ZP': 'ZPRINT', 'ZSH': 'ZSHOW',\r\n  'ZST': 'ZSTEP', 'ZSY': 'ZSYSTEM', 'ZTC': 'ZTCOMMIT', 'ZTR': 'ZTRIGGER', 'ZTS': 'ZTSTART', 'ZWI': 'ZWITHDRAW', 'ZWR': 'ZWRITE'\r\n}\r\nconst funcExpansions = {\r\n  'A': 'ASCII', 'C': 'CHAR', 'D': 'DATA', 'E': 'EXTRACT', 'F': 'FIND', 'FN': 'FNUMBER', 'G': 'GET', 'I': 'INCREMENT', 'J': 'JUSTIFY', 'L': 'LENGTH', 'NA': 'NAME', 'N': 'NEXT', 'O': 'ORDER',\r\n  'P': 'PIECE', 'QL': 'QLENGTH', 'QS': 'QSUBSCRIPT', 'Q': 'QUERY', 'R': 'RANDOM', 'RE': 'REVERSE', 'S': 'SELECT', 'ST': 'STACK', 'T': 'TEXT', 'TR': 'TRANSLATE', 'V': 'VIEW',\r\n  'ZA': 'ZASCII', 'ZAH': 'ZAHANDLE', 'ZD': 'ZDATE', 'ZE': 'ZEXTRACT', 'ZF': 'ZFIND', 'ZG': 'ZGETJPI', 'ZJ': 'ZJUSTIFY', 'ZL': 'ZLENGTH', 'ZM': 'ZMESSAGE', 'ZPI': 'ZPIECE', 'ZP': 'ZPREVIOUS',\r\n  'ZSUB': 'ZSUBSTR', 'ZTR': 'ZTRANSLATE', 'ZTRI': 'ZTRIGGER', 'ZW': 'ZWIDTH'\r\n}\r\nconst cmdParams = {\r\n  'BREAK': {\r\n    'abbreviation': 'B',\r\n    'postcondition': true,\r\n    'parameter': '[expr[:tvexpr][,...]]'\r\n  },\r\n  'CLOSE': {\r\n    'abbreviation': 'C',\r\n    'postcondition': true,\r\n    'parameter': 'expr[:(keyword[=expr][:...])][,...]'\r\n  },\r\n  'DO': {\r\n    'abbreviation': 'D',\r\n    'postcondition': true,\r\n    'parameter': '[entryref[(expr:.lvn[,...])][:tvexpr][,...]]'\r\n  },\r\n  'ELSE':\r\n  {\r\n    'abbreviation': 'E',\r\n    'postcondition': false,\r\n    'parameter': ''\r\n  },\r\n  'FOR': {\r\n    'abbreviation': 'F',\r\n    'postcondition': false,\r\n    'parameter': '[lvn=expr[:numexpr1[:numexpr2]][,...]]]'\r\n  },\r\n  'GOTO': {\r\n    'abbreviation': 'G',\r\n    'postcondition': true,\r\n    'parameter': 'entryref[:tvexpr][,...]'\r\n  },\r\n  'HALT': {\r\n    'abbreviation': 'H',\r\n    'postcondition': true,\r\n    'parameter': ''\r\n  },\r\n  'HANG': {\r\n    'abbreviation': 'H',\r\n    'postcondition': true,\r\n    'parameter': 'numexpr[,...]'\r\n  },\r\n  'IF': {\r\n    'abbreviation': 'I',\r\n    'postcondition': false,\r\n    'parameter': '[tvexpr[,...]]'\r\n  },\r\n  'JOB': {\r\n    'abbreviation': 'J',\r\n    'postcondition': true,\r\n    'parameter': 'entryref[(expr[,...])][:[(keyword[=value][:...])][:numexpr]][,...]'\r\n  },\r\n  'KILL': {\r\n    'abbreviation': 'K',\r\n    'postcondition': true,\r\n    'parameter': '[glvn | (lvn[,...]) | *lname | *lvn ]'\r\n  },\r\n  'LOCK': {\r\n    'abbreviation': 'L',\r\n    'postcondition': true,\r\n    'parameter': '[[-|+]nref|(nref[,...])[:numexpr] [,...]]'\r\n  },\r\n  'MERGE': {\r\n    'abbreviation': 'M',\r\n    'postcondition': true,\r\n    'parameter': 'glvn=glvn[,...]'\r\n  },\r\n  'NEW': {\r\n    'abbreviation': 'N',\r\n    'postcondition': true,\r\n    'parameter': '[[(]lvn[,...][)][,...]]'\r\n  },\r\n  'OPEN': {\r\n    'abbreviation': 'O',\r\n    'postcondition': true,\r\n    'parameter': 'expr[:[(keyword[=expr][:...])] [:numexpr]][,...]'\r\n  },\r\n  'QUIT': {\r\n    'abbreviation': 'Q',\r\n    'postcondition': true,\r\n    'parameter': '[expr | *lname | *lvn]'\r\n  },\r\n  'READ': {\r\n    'abbreviation': 'R',\r\n    'postcondition': true,\r\n    'parameter': '(glvn|*glvn|glvn#intexpr)[:numexpr]|strlit|fcc[,...]'\r\n  },\r\n  'SET': {\r\n    'abbreviation': 'S',\r\n    'postcondition': true,\r\n    'parameter': 'setleft=expr | (setleft[,...])=expr | *lvn=lname | aliascontainer[,...]'\r\n  },\r\n  'TCOMMIT': {\r\n    'abbreviation': 'TC',\r\n    'postcondition': true,\r\n    'parameter': ''\r\n  },\r\n  'TRESTART': {\r\n    'abbreviation': 'TRE',\r\n    'postcondition': true,\r\n    'parameter': ''\r\n  },\r\n  'TROLLBACK': {\r\n    'abbreviation': 'TRO',\r\n    'postcondition': true,\r\n    'parameter': '[intexpr]'\r\n  },\r\n  'TSTART': {\r\n    'abbreviation': 'TS',\r\n    'postcondition': true,\r\n    'parameter': '[([lvn...])|lvn|*|][:keyword|(keyword...)]'\r\n  },\r\n  'USE': {\r\n    'abbreviation': 'U',\r\n    'postcondition': true,\r\n    'parameter': 'expr[:(keyword[=expr][:...])][,...]'\r\n  },\r\n  'VIEW': {\r\n    'abbreviation': 'V',\r\n    'postcondition': true,\r\n    'parameter': 'keyword[:expr[:...]][,...]'\r\n  },\r\n  'WRITE': {\r\n    'abbreviation': 'W',\r\n    'postcondition': true,\r\n    'parameter': 'expr|*intexpr|fcc[,...]'\r\n  },\r\n  'XECUTE': {\r\n    'abbreviation': 'X',\r\n    'postcondition': true,\r\n    'parameter': 'expr[:tvexpr][,...]'\r\n  },\r\n  'ZALLOCATE': {\r\n    'abbreviation': 'ZA',\r\n    'postcondition': true,\r\n    'parameter': '[(]nref[,...][)][:intexpr][,...]'\r\n  },\r\n  'ZBREAK': {\r\n    'abbreviation': 'ZB',\r\n    'postcondition': true,\r\n    'parameter': '[-]entryref[:[expr][:intexpr]][,...]'\r\n  },\r\n  'ZCOMPILE': {\r\n    'abbreviation': 'ZCOM',\r\n    'postcondition': true,\r\n    'parameter': 'expr[,...]'\r\n  },\r\n  'ZCONTINUE': {\r\n    'abbreviation': 'ZC',\r\n    'postcondition': true,\r\n    'parameter': ''\r\n  },\r\n  'ZDEALLOCATE': {\r\n    'abbreviation': 'ZD',\r\n    'postcondition': true,\r\n    'parameter': '[nref[,...]]'\r\n  },\r\n  'ZEDIT': {\r\n    'abbreviation': 'ZED',\r\n    'postcondition': true,\r\n    'parameter': '[expr[,...]]'\r\n  },\r\n  'ZGOTO': {\r\n    'abbreviation': 'ZG',\r\n    'postcondition': true,\r\n    'parameter': '[[intexpr][:entryref[:tvexpr]],...]'\r\n  },\r\n  'ZHALT': {\r\n    'abbreviation': 'ZHALT',\r\n    'postcondition': true,\r\n    'parameter': '[intexpr]'\r\n  },\r\n  'ZHELP': {\r\n    'abbreviation': 'ZH',\r\n    'postcondition': true,\r\n    'parameter': '[expr1[:expr2],...]'\r\n  },\r\n  'ZKILL': {\r\n    'abbreviation': 'ZK',\r\n    'postcondition': true,\r\n    'parameter': 'glvn'\r\n  },\r\n  'ZLINK': {\r\n    'abbreviation': 'ZL',\r\n    'postcondition': true,\r\n    'parameter': '[expr1[:expr2][,...]]'\r\n  },\r\n  'ZMESSAGE': {\r\n    'abbreviation': 'ZM',\r\n    'postcondition': true,\r\n    'parameter': 'intexpr[:expr2][:...]'\r\n  },\r\n  'ZPRINT': {\r\n    'abbreviation': 'ZP',\r\n    'postcondition': true,\r\n    'parameter': '[entryref[:label[+intexpr]][,...]'\r\n  },\r\n  'ZRUPDATE': {\r\n    'abbreviation': 'ZRUP',\r\n    'postcondition': true,\r\n    'parameter': 'expr[,...]'\r\n  },\r\n  'ZSHOW': {\r\n    'abbreviation': 'ZSH',\r\n    'postcondition': true,\r\n    'parameter': '[expr[:glvn][,...]]'\r\n  },\r\n  'ZSTEP': {\r\n    'abbreviation': 'ZST',\r\n    'postcondition': true,\r\n    'parameter': '[keyword[:expr]][,...]'\r\n  },\r\n  'ZSYSTEM': {\r\n    'abbreviation': 'ZSY',\r\n    'postcondition': true,\r\n    'parameter': '[expr][,...]]'\r\n  },\r\n  'ZTCOMMIT': {\r\n    'abbreviation': 'ZTC',\r\n    'postcondition': true,\r\n    'parameter': '[intexpr]'\r\n  },\r\n  'ZTRIGGER': {\r\n    'abbreviation': 'ZTR',\r\n    'postcondition': true,\r\n    'parameter': 'gvn'\r\n  },\r\n  'ZTSTART': {\r\n    'abbreviation': 'ZTS',\r\n    'postcondition': true,\r\n    'parameter': ''\r\n  },\r\n  'ZWITHDRAW': {\r\n    'abbreviation': 'ZWI',\r\n    'postcondition': true,\r\n    'parameter': 'glvn'\r\n  },\r\n  'ZWRITE': {\r\n    'abbreviation': 'ZWR',\r\n    'postcondition': true,\r\n    'parameter': '[zwrglvn[,...]]'\r\n  }\r\n}\r\nconst funcParams = {\r\n  'ASCII': {\r\n    'maxparams': 2\r\n  },\r\n  'CHAR': {\r\n    'maxparams': 99\r\n  },\r\n  'DATA': {\r\n    'maxparams': 1,\r\n    'format': 'glvn'\r\n  },\r\n  'EXTRACT': {\r\n    'maxparams': 3\r\n  },\r\n  'FIND': {\r\n    'maxparams': 3\r\n  },\r\n  'FNUMBER': {\r\n    'minparams': 2,\r\n    'maxparams': 3\r\n  },\r\n  'GET': {\r\n    'maxparams': 2,\r\n    'format': 'glvn,expr'\r\n  },\r\n  'INCREMENT': {\r\n    'maxparams': 2,\r\n    'format': 'glvn,expr'\r\n  },\r\n  'JUSTIFY': {\r\n    'maxparams': 3\r\n  },\r\n  'LENGTH': {\r\n    'maxparams': 2\r\n  },\r\n  'NAME': {\r\n    'maxparams': 2,\r\n    'format': 'glvn,expr'\r\n  },\r\n  'NEXT': {\r\n    'maxparams': 1,\r\n    'format': 'glvn('\r\n  },\r\n  'ORDER': {\r\n    'maxparams': 2,\r\n    'format': 'glvn,expr'\r\n  },\r\n  'PIECE': {\r\n    'maxparams': 4\r\n  },\r\n  'QLENGTH': {\r\n    'maxparams': 1,\r\n    'format': 'glvn'\r\n  },\r\n  'QSUBSCRIPT': {\r\n    'maxparams': 2,\r\n    'format': 'glvn,expr'\r\n  },\r\n  'QUERY': {\r\n    'maxparams': 1,\r\n    'format': 'glvn'\r\n  },\r\n  'RANDOM': {\r\n    'maxparams': 1\r\n  },\r\n  'REVERSE': {\r\n    'maxparams': 1\r\n  },\r\n  'SELECT': {\r\n    'maxparams': 99,\r\n    'format': 'special'\r\n  },\r\n  'STACK': {\r\n    'maxparams': 2\r\n  },\r\n  'TEXT': {\r\n    'maxparams': 1,\r\n    'format': 'entryref'\r\n  },\r\n  'TRANSLATE': {\r\n    'maxparams': 3\r\n  },\r\n  'VIEW': {\r\n    'maxparams': 2\r\n  },\r\n  'ZASCII': {\r\n    'maxparams': 2\r\n  },\r\n  'ZATRANSFORM': {\r\n    'minparams': 2,\r\n    'maxparams': 4,\r\n    'format': 'expr,expr,bool,bool'\r\n  },\r\n  'ZBITAND': {\r\n    'minparams': 2,\r\n    'maxparams': 2\r\n  },\r\n  'ZBITCOUNT': {\r\n    'maxparams': 1\r\n  },\r\n  'ZBITFIND': {\r\n    'maxparams': 3\r\n  },\r\n  'ZBITGET': {\r\n    'minparams': 2,\r\n    'maxparams': 2\r\n  },\r\n  'ZBITLEN': {\r\n    'maxparams': 1\r\n  },\r\n  'ZBITNOT': {\r\n    'maxparams': 1\r\n  },\r\n  'ZBITOR': {\r\n    'minparams': 2,\r\n    'maxparams': 2\r\n  },\r\n  'ZBITSET': {\r\n    'minparams': 3,\r\n    'maxparams': 3\r\n  },\r\n  'ZBITSTR': {\r\n    'maxparams': 2\r\n  },\r\n  'ZBITXOR': {\r\n    'minparams': 2,\r\n    'maxparams': 2\r\n  },\r\n  'ZCHAR': {\r\n    'maxparams': 99\r\n  },\r\n  'ZCOLLATE': {\r\n    'maxparams': 3,\r\n    'format': 'glvn,expr,bool'\r\n  },\r\n  'ZCONVERT': {\r\n    'maxparams': 3\r\n  },\r\n  'ZDATA': {\r\n    'maxparams': 1,\r\n    'format': 'lvn'\r\n  },\r\n  'ZDATE': {\r\n    'maxparams': 4\r\n  },\r\n  'ZEXTRACT': {\r\n    'maxparams': 3\r\n  },\r\n  'ZFIND': {\r\n    'maxparams': 3\r\n  },\r\n  'ZGETJPI': {\r\n    'minparams': 2,\r\n    'maxparams': 2\r\n  },\r\n  'ZJOBEXAM': {\r\n    'minparams': 0,\r\n    'maxparams': 1\r\n  },\r\n  'ZJUSTIFY': {\r\n    'minparams': 2,\r\n    'maxparams': 3\r\n  },\r\n  'ZLENGTH': {\r\n    'maxparams': 2\r\n  },\r\n  'ZMESSAGE': {\r\n    'maxparams': 1\r\n  },\r\n  'ZPARSE': {\r\n    'maxparams': 5\r\n  },\r\n  'ZPEEK': {\r\n    'maxparams': 4\r\n  },\r\n  'ZPIECE': {\r\n    'maxparams': 4\r\n  },\r\n  'ZPREVIOUS': {\r\n    'maxparams': 1,\r\n    'format': 'glvn'\r\n  },\r\n  'ZQGBLMOD': {\r\n    'maxparams': 1,\r\n    'format': 'gvn'\r\n  },\r\n  'ZSEARCH': {\r\n    'maxparams': 2\r\n  },\r\n  'ZSIGPROC': {\r\n    'maxparams': 2\r\n  },\r\n  'ZSOCKET': {\r\n    'minparams': 2,\r\n    'maxparams': 4\r\n  },\r\n  'ZSUBSTR': {\r\n    'minparams': 2,\r\n    'maxparams': 3\r\n  },\r\n  'ZSYSLOG': {\r\n    'maxparams': 1\r\n  },\r\n  'ZTRANSLATE': {\r\n    'maxparams': 3\r\n  },\r\n  'ZTRIGGER': {\r\n    'maxparams': 2\r\n  },\r\n  'ZTRNLNM': {\r\n    'maxparams': 6\r\n  },\r\n  'ZWIDTH': {\r\n    'maxparams': 1\r\n  },\r\n  'ZWRITE': {\r\n    'maxparams': 2\r\n  }\r\n}\r\nconst expressiontype = {\r\n  \"Standard\": 0,\r\n  \"Index\": 1,\r\n  \"eArgument\": 2,\r\n  \"iArgument\": 3,\r\n  \"Atom\": 4\r\n}\r\n\r\nexport class MumpsLineParser {\r\n  names: NameObject[] = [];\r\n  private _insertName(name: NameObject) {\r\n    /*\r\n    if (this.names.indexOf(name) === -1) {\r\n      this.names.push(name);\r\n    }\r\n    */\r\n  }\r\n  private _evaluatePattern(pattern: string, position: number, level?: number): ErrorInformation {\r\n    let result = { text: '', position }\r\n    let patternComplete = false;\r\n    if (level === undefined) {\r\n      level = 0;\r\n    }\r\n    do {\r\n      if (pattern[position] === '@') {\r\n        result = this.evaluateExpression(expressiontype.Standard, pattern, ++position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        patternComplete = true;\r\n        break;\r\n      }\r\n      if (pattern.substring(result.position).match(repititionCount)) {\r\n        let repCount = pattern.substring(result.position).match(repititionCount)![0];\r\n        if (repCount !== '') {\r\n          patternComplete = false;\r\n          result.position += repCount.length;\r\n          if (pattern.substring(result.position).match(patcode)) {\r\n            patternComplete = true;\r\n            result.position += pattern.substring(result.position).match(patcode)![0].length;\r\n            continue;\r\n          } else if (pattern[result.position] === '(') {\r\n            result = this._evaluatePattern(pattern, ++result.position, level + 1);\r\n            if (result.text !== '') {\r\n              return result;\r\n            }\r\n            patternComplete = true;\r\n            continue;\r\n          }\r\n        } else if (pattern[result.position] === ')') {\r\n          if (!patternComplete) {\r\n            result.text = 'Incomplete pattern';\r\n          }\r\n          if (level > 0) {\r\n            result.position++;\r\n          }\r\n          return result;\r\n        } else if (pattern[result.position] === ',' && level > 0) {\r\n          result.position++;\r\n          continue;\r\n        } else {\r\n          break;\r\n        }\r\n      } else if (pattern[result.position] === ')') {\r\n        if (!patternComplete) {\r\n          result.text = 'Incomplete pattern';\r\n        } else {\r\n          result.position++;\r\n        }\r\n        return result;\r\n      } else if (pattern[result.position] === ',' && level > 0) {\r\n        if (!patternComplete) {\r\n          result.text = 'Incomplete pattern';\r\n          return result;\r\n        } else {\r\n          result.position++;\r\n        }\r\n        continue;\r\n      } else {\r\n        break;\r\n      }\r\n    } while (position < pattern.length)\r\n    if (!patternComplete) {\r\n      result.text = 'Incomplete pattern';\r\n    }\r\n    if (level > 0) {\r\n      result.text = 'Missing \")\"';\r\n    }\r\n    return result;\r\n\r\n  }\r\n  public evaluateExpression(exType: number, line: string, position: number, level?: number | undefined): ErrorInformation {\r\n    let expressionComplete = false;\r\n    let startposition = position;\r\n    if (level === undefined) {\r\n      level = 0;\r\n    }\r\n    let lastExpression = '';\r\n    while (position < line.length) {\r\n      let char = line.charAt(position);\r\n      if (char === '(') {\r\n        let subExType = expressiontype.Standard\r\n        switch (lastExpression) {\r\n          case 'ifunction':\r\n            subExType = expressiontype.iArgument;\r\n            break;\r\n          case 'exfunction':\r\n            subExType = expressiontype.eArgument;\r\n            break;\r\n          case 'pattern':\r\n            return { text: 'Unecpected \"(\"', position };\r\n        }\r\n        let result = this.evaluateExpression(subExType, line, ++position, level + 1);\r\n        if (result.text !== '' || exType === expressiontype.Atom) {\r\n          return result;\r\n        }\r\n        expressionComplete = true;\r\n        position = result.position;\r\n        continue;\r\n      }\r\n      lastExpression = '';\r\n      if (char === ')') {\r\n        if (!expressionComplete) {\r\n          if (position === startposition && exType === expressiontype.eArgument) {\r\n            return { text: '', position: ++position }\r\n          }\r\n          return { text: 'Incomplete Expression', position };\r\n        }\r\n        if (level > 0) {\r\n          position++;\r\n        }\r\n        return { text: '', position: position };\r\n      }\r\n      if (char === '.' && exType === expressiontype.eArgument) {\r\n        position++;\r\n        let evalString = line.substring(position);\r\n        if (evalString.match(lvn)) {\r\n          let localname = evalString.match(lvn)![0];\r\n          position += localname.length;\r\n          this._insertName({ type: \"local\", name: localname });\r\n          char = line.charAt(position);\r\n          if (char !== ',' && char !== ')') {\r\n            return { text: 'Variablereference must stand alone', position }\r\n          } else {\r\n            expressionComplete = true;\r\n            continue;\r\n          }\r\n        }\r\n      }\r\n      if (char === ',') {\r\n        if (!expressionComplete) {\r\n          if (position === startposition && exType === expressiontype.eArgument) {\r\n            if (level === 0) {\r\n              return { text: '', position: ++position }\r\n            } else {\r\n              position++\r\n              expressionComplete = false;\r\n              startposition = position;\r\n              continue;\r\n            }\r\n          }\r\n          return { text: 'Incomplete Expression', position };\r\n        }\r\n        if (exType === expressiontype.Standard || exType === expressiontype.Atom) {\r\n          return { text: '', position }\r\n        }\r\n        position++\r\n        expressionComplete = false;\r\n        startposition = position;\r\n        continue;\r\n      }\r\n      if (expressionComplete) {\r\n        if (exType === expressiontype.Atom) {\r\n          return { text: '', position }\r\n        }\r\n        if (line.substring(position).match(binoperator)) {\r\n          let operator = line.substring(position).match(binoperator)![0];\r\n          position += operator.length;\r\n          expressionComplete = false;\r\n          if (operator === '?' || operator === \"'?\") {\r\n            let result = this._evaluatePattern(line, position);\r\n            if (result.text !== '') {\r\n              return result;\r\n            } else {\r\n              position = result.position;\r\n              expressionComplete = true;\r\n              lastExpression = 'pattern';\r\n            }\r\n          }\r\n          continue;\r\n        } else {\r\n          return { text: '', position }\r\n        }\r\n      }\r\n      let evalString = line.substring(position);\r\n      let provResult = this._checkVar(line, position);\r\n      if (provResult.text === '') {\r\n        expressionComplete = true;\r\n        position = provResult.position;\r\n      } else if (evalString.substring(0, 2) === '$$') {\r\n        position += 2;\r\n        provResult = this._checkEntryRef(line, position, true);\r\n        if (provResult.text !== '') {\r\n          return provResult;\r\n        } else {\r\n          expressionComplete = true;\r\n          position = provResult.position;\r\n          expressionComplete = true;\r\n        }\r\n      } else if (evalString.match(nonMfunction)) {\r\n        let functionname = evalString.match(nonMfunction)![0];\r\n        position += functionname.length;\r\n        this._insertName({ type: \"nonMfunction\", name: functionname });\r\n        lastExpression = 'exfunction'\r\n        expressionComplete = true;\r\n      } else if (evalString.match(ifunction)) {\r\n        let functionname = evalString.match(ifunction)![0].substring(1).toUpperCase();\r\n        position += functionname.length + 2\r\n        if (funcExpansions[functionname] !== undefined) {\r\n          functionname = funcExpansions[functionname];\r\n        }\r\n        let result = this._checkFunction(functionname, line, position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        } else {\r\n          position = result.position;\r\n        }\r\n        lastExpression = '';\r\n        expressionComplete = true;\r\n      } else if (evalString.match(isv)) {\r\n        let specialvarname = evalString.match(isv)![0];\r\n        position += specialvarname.length\r\n        //this.ergObject.push({ type: \"isv\", value: specialvarname });\r\n        expressionComplete = true;\r\n      } else if (evalString.match(numlit) && evalString.match(numlit)![0] !== '') {\r\n        let numericliteral = evalString.match(numlit)![0];\r\n        position += numericliteral.length;\r\n        //this.names.push({ type: \"numlit\", value: numericliteral });\r\n        expressionComplete = true;\r\n      } else if (evalString.match(strlit)) {\r\n        let stringlit = evalString.match(strlit)![0];\r\n        position += stringlit.length;\r\n        expressionComplete = true;\r\n      } else if (char.match(unaryoperator)) {\r\n        //this.ergObject.push({ type: 'unaryoperator', value: char });\r\n        position++;\r\n      } else {\r\n        return { text: 'Unexpected Character ' + char, position }\r\n      }\r\n    }\r\n    if (expressionComplete) {\r\n      if (level > 0) {\r\n        return { text: 'Missing \")\"', position }\r\n      }\r\n      return { text: '', position }\r\n    } else {\r\n      return { text: 'Incomplete Expression', position };\r\n    }\r\n  }\r\n  private _extractLabel(inputLine: string, inputObject: LineObject): LineObject {\r\n    inputObject.lineLabel = '';\r\n    inputObject.lineExpression = '';\r\n    inputObject.expressionPosition = 0;\r\n    if (inputLine.match(label)) {\r\n      inputObject.lineLabel = inputLine.match(label)![0];\r\n    }\r\n    let position = inputObject.lineLabel.length;\r\n    if (position === inputLine.length) {\r\n      return inputObject\r\n    }\r\n    if (!inputLine.charAt(position).match(/[\\s|;]/)) {\r\n      inputObject.errorText = 'Unexpected Character' + inputLine.charAt(position);\r\n      inputObject.errorPosition = position;\r\n      return inputObject;\r\n\t\t}\r\n\t\tlet i=0;\r\n    for (i = position; i <= inputLine.length; i++) {\r\n      if (inputLine[i] !== \" \" && inputLine[i] !== \"\\t\") {\r\n        break;\r\n      }\r\n    }\r\n    inputObject.lineLeadSpace = inputLine.substring(position, i);\r\n    if (i !== (inputLine.length - 1)) {\r\n      inputObject.lineExpression = inputLine.substring(i);\r\n      inputObject.expressionPosition = i;\r\n    }\r\n    return inputObject;\r\n  }\r\n\r\n  //Extract Comments.\r\n  private _extractComment(inputObject: LineObject): LineObject {\r\n    let inputLine = inputObject.lineExpression!;\r\n    //Semicolon identifies comments.\r\n    if (inputLine.search(\";\") >= 0) {\r\n      let isInsideString = false;\r\n      for (let i = 0; i < inputLine.length; i++) {\r\n        if (inputLine[i] === \";\") {\r\n          if (!isInsideString) {\r\n            inputObject.lineExpression = inputLine.substring(0, i);\r\n            inputObject.lineComment = inputLine.substring(i).substring(1);\r\n            return inputObject;\r\n          }\r\n        }\r\n        if (inputLine[i] === '\"') {\r\n          isInsideString = !isInsideString;\r\n        }\r\n      }\r\n    }\r\n    return inputObject;\r\n  }\r\n\r\n  //Extract Indentation.\r\n  //Assumes inputLine has extracted comments/spacing.\r\n  private _extractIndentation(inputObject: LineObject): LineObject {\r\n\r\n    let lineIndentationArray: string[] = [];\r\n    let lineIndentation = 0;\r\n    let inputLine = inputObject.lineExpression!;\r\n\t\tlet spacer = '';\r\n\t\tlet i=0;\r\n    for (i = 0; i <= inputLine.length; i++) {\r\n      let char = inputLine[i];\r\n      if (char === \".\") {\r\n        if (lineIndentation > 0) {\r\n          lineIndentationArray.push(spacer);\r\n        }\r\n        lineIndentation++;\r\n        spacer = '';\r\n        continue;\r\n      }\r\n      if (char === \" \" || char === \"\\t\") {\r\n        spacer += char;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n    if (lineIndentation > 0) {\r\n      lineIndentationArray.push(spacer);\r\n      inputObject.lineExpression = inputLine.substring(i);\r\n      inputObject.expressionPosition! += i;\r\n      inputObject.lineIndentationArray = lineIndentationArray;\r\n    }\r\n    return inputObject;\r\n  }\r\n\r\n  //Extract M-Commands.\r\n  //Assumes inputLine has extracted comments/spacing/indentation.\r\n  private _extractCommands(inputObject: LineObject): LineObject {\r\n\r\n    let tmpFunction: TmpFunction;\r\n    let tmpFunctionArray: Array<TmpFunction> = [];\r\n    //Divide Routines and Arguments.\r\n    let splitLine = this._splitCommandsAndArguments(inputObject);\r\n    //Loop, even is function, odd is arguments.\r\n    let i = 0;\r\n    tmpFunction = { mCommand: '', mPostCondition: '', mArguments: '', cmdPosition: 0, argPosition: 0, pcPosition: 0 }\r\n    while (i < splitLine.length) {\r\n      if (i % 2 === 0) {\r\n        tmpFunction.mCommand = splitLine[i].command;\r\n        tmpFunction.cmdPosition = splitLine[i].position;\r\n      } else {\r\n\r\n        tmpFunction.mArguments = splitLine[i].command;\r\n        tmpFunction.argPosition = splitLine[i].position;\r\n\r\n        //Custom handler for trailing argument spacing.\r\n        //Go until splitline hits a non empty val.\r\n        let ii = i + 1;\r\n        while (ii < splitLine.length) {\r\n          if (splitLine[ii].command === \"\") {\r\n            splitLine.splice(ii, 1);\r\n            //tmpFunction.mArguments = tmpFunction.mArguments + \" \";\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        tmpFunctionArray.push(tmpFunction);\r\n        tmpFunction = { mCommand: '', mPostCondition: '', mArguments: '', cmdPosition: 0, argPosition: 0, pcPosition: 0 }\r\n      }\r\n      i++\r\n    }\r\n    //Last command doesn't always require parameter, so if odd number of pairs, push it.\r\n    if (splitLine.length % 2 !== 0) {\r\n      tmpFunction.mCommand = splitLine[splitLine.length - 1].command;\r\n      tmpFunction.cmdPosition = splitLine[splitLine.length - 1].position;\r\n      tmpFunction.mArguments = '';\r\n      tmpFunction.argPosition = inputObject.lineExpression!.length;\r\n      tmpFunctionArray.push(tmpFunction);\r\n    }\r\n\r\n\r\n    //Extract and output Post Conditionals.\r\n    let postConditionFunctionArray = this._extractPostConditional(tmpFunctionArray);\r\n    if (postConditionFunctionArray.length > 0) {\r\n      inputObject.lineRoutines = postConditionFunctionArray;\r\n    }\r\n    return inputObject;\r\n  }\r\n\r\n  //Divide commands and arguments into array, used by extractRoutines.\r\n  private _splitCommandsAndArguments(inputObject: LineObject): LineComand[] {\r\n\r\n    let lineCommands: LineComand[] = [];\r\n    let tmpCursor = 0;\r\n    let isInsideString = false;\r\n    let inputLine = inputObject.lineExpression!;\r\n    let start = inputObject.expressionPosition!;\r\n    for (let i = 0; i < inputLine.length; i++) {\r\n\r\n      //Ensure space isn't quoted.\r\n      if (inputLine[i] === '\"') {\r\n        isInsideString = !isInsideString;\r\n      }\r\n      //Flag spaces/tabs as dividers.\r\n      if ((inputLine[i] === \" \" || inputLine[i] === \"\\t\") && !isInsideString) {\r\n        //If has content, push.\r\n        if (inputLine.substring(tmpCursor, i).length > 0) {\r\n          lineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n          //Otherwise, push empty commands.\r\n        } else if (inputLine.substring(tmpCursor, i).length === 0 && (inputLine.substring(tmpCursor - 1, tmpCursor) === \" \" || inputLine.substring(tmpCursor - 1, tmpCursor) === \"\\t\")) {\r\n          lineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n        }\r\n        tmpCursor = i + 1;\r\n      }\r\n    }\r\n    let i = inputLine.length;\r\n    if (inputLine.substring(tmpCursor, i).length > 0) {\r\n      lineCommands.push({ command: inputLine.substring(tmpCursor, i), position: start + tmpCursor });\r\n      //Gather empty commands from end of line.\r\n    } else if (i === tmpCursor && (inputLine.substring(i - 1, i) === \" \" || inputLine.substring(i - 1, i) === \"/t\")) {\r\n      lineCommands.push({ command: '', position: start + tmpCursor });\r\n    }\r\n    return lineCommands;\r\n  }\r\n\r\n  //Extracts Post-Conditionals from Routines, used by extractRoutines.\r\n  private _extractPostConditional(tmpFunctionArray: TmpFunction[]): TmpFunction[] {\r\n\r\n    //Assign to new variable to truncate Routines.\r\n    let tmpObject = tmpFunctionArray;\r\n    for (let i = 0; i < tmpObject.length; i++) {\r\n      //Colon indicates Post-Conditionals.\r\n      let tmpIndex = tmpObject[i].mCommand!.indexOf(\":\");\r\n      if (tmpIndex > -1) {\r\n        tmpObject[i].mPostCondition = tmpObject[i].mCommand.substring(tmpIndex + 1);\r\n        tmpObject[i].mCommand = tmpObject[i].mCommand.substring(0, tmpIndex);\r\n        tmpObject[i].pcPosition = tmpObject[i].cmdPosition + tmpIndex + 1;\r\n      }\r\n    }\r\n    return tmpObject;\r\n  }\r\n\r\n  public parseLine(inputString): LineObject {\r\n\r\n    let tmpObject: LineObject = {};\r\n\r\n    //Parsing must be performed sequentially.\r\n    tmpObject = this._extractLabel(inputString, tmpObject);\r\n    if (tmpObject.errorText) {\r\n      return tmpObject;\r\n    }\r\n    tmpObject = this._extractComment(tmpObject);\r\n    tmpObject = this._extractIndentation(tmpObject);\r\n    tmpObject = this._extractCommands(tmpObject);\r\n\r\n    //Line Expression is no longer needed.\r\n    delete tmpObject.lineExpression;\r\n    return tmpObject;\r\n  }\r\n  public checkFile(filename: string): ErrorInformation[] {\r\n    let errlist: ErrorInformation[] = [];\r\n    let content: string;\r\n    try {\r\n      content = fs.readFileSync(filename, \"utf8\");\r\n    } catch (err) {\r\n      errlist.push({ text: 'File read error: ' + filename, position: 0, line: 0 });\r\n      return errlist;\r\n    }\r\n    let lines = content.split('\\n');\r\n    for (let i = 0; i < lines.length; i++) {\r\n      lines[i] = lines[i].replace('\\r', '');\r\n      let info = this.checkLine(lines[i]);\r\n      if (info.text !== '') {\r\n        info.line = i + 1;\r\n        errlist.push(info);\r\n      }\r\n    }\r\n    return errlist;\r\n  }\r\n  public checkLine(line: string): ErrorInformation {\r\n    let parsed = this.parseLine(line);\r\n    let result: ErrorInformation = { text: '', position: 0 }\r\n    if (parsed.lineRoutines) {\r\n      for (let i = 0; i < parsed.lineRoutines.length; i++) {\r\n        let code = parsed.lineRoutines[i];\r\n        if (code.mCommand.length > 0) {\r\n          let cmd = code.mCommand.toUpperCase();\r\n          if (cmd === 'H') {\r\n            if (code.mArguments === '') {\r\n              cmd = 'HALT';\r\n            } else {\r\n              cmd = 'HANG';\r\n            }\r\n          }\r\n          if (cmd.match(command)) {\r\n            let longcmd = cmd;\r\n            if (cmdParams[cmd] === undefined) {\r\n              longcmd = cmdExpansions[cmd];\r\n            }\r\n            if (longcmd === undefined) {\r\n\t\t\t\t\t\t\tresult.text='Unknown Command';\r\n\t\t\t\t\t\t\tresult.position=code.cmdPosition;\r\n\t\t\t\t\t\t\treturn result;\r\n            }\r\n            result = this._checkCommand(longcmd, code);\r\n            if (result.text !== '') {\r\n              return result;\r\n            }\r\n          } else {\r\n            return { text: 'Invalid Command', position: code.cmdPosition }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  private _checkEntryRefAndPostcondition(arg: string, position: number, withParams: boolean): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position };\r\n    result = this._checkEntryRef(arg, result.position, withParams);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkEntryRef(arg: string, position: number, withParams: boolean): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (arg[result.position] === '@') {\r\n      result = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n      if (result.text !== '') {\r\n        return result;\r\n      }\r\n      if (arg[result.position] === '+') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      }\r\n      if (arg[result.position] === '^') {\r\n        if (arg[result.position + 1] === '@') {\r\n          result = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n        } else {\r\n          if (arg.substring(result.position).match(entryref)) {\r\n            let ref = arg.substring(result.position).match(entryref)![0];\r\n            result.position += ref.length;\r\n          } else {\r\n            result.text = 'Invalid EntryRef';\r\n            return result;\r\n          }\r\n        }\r\n      }\r\n      if (arg.substring(result.position, result.position + 2) === '@(') {\r\n        result.position++;\r\n      }\r\n    } else if (arg.substring(result.position).match(entryref)) {\r\n      let ref = arg.substring(result.position).match(entryref)![0];\r\n      result.position += ref.length;\r\n      let char = arg[result.position];\r\n      if (result.position >= arg.length) {\r\n        if (ref.length > 0) {\r\n          this._insertName({ 'type': 'entryref', name: ref });\r\n          return result;\r\n        } else {\r\n          result.text = 'Missing Entryref';\r\n          return result;\r\n        }\r\n      }\r\n      if (ref.indexOf('^') === -1 && char === '+') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        ref += \"+X\";\r\n        if (result.position >= arg.length) {\r\n          this._insertName({ 'type': 'entryref', name: ref });\r\n          return result\r\n        }\r\n        if (arg.substring(result.position).match(routineref)) {\r\n          let routine = arg.substring(result.position).match(routineref)![0];\r\n          ref += routine;\r\n          result.position += routine.length;\r\n        }\r\n      }\r\n      this._insertName({ 'type': 'entryref', name: ref });\r\n    } else {\r\n      result.text = 'Invalid Entryref';\r\n    }\r\n    if (arg[result.position] === '(' && withParams) {\r\n      result = this.evaluateExpression(expressiontype.eArgument, arg, ++result.position, 1);\r\n      if (result.text !== '') {\r\n        return result;\r\n      }\r\n    }\r\n    return result\r\n  }\r\n  private _checkVar(arg: string, position: number, globalOk?: boolean, indexOk?: boolean): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position, indexFound: false, globalFound: false, indirectionFound: false };\r\n    let varFound = false;\r\n    if (globalOk === undefined) {\r\n      globalOk = true;\r\n    }\r\n    if (indexOk === undefined) {\r\n      indexOk = true;\r\n    }\r\n    if (arg[result.position] === '@') {\r\n      result = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n      result.indirectionFound = true;\r\n      if (result.text !== '') {\r\n        return result;\r\n      }\r\n      varFound = true;\r\n      if (arg.substring(result.position, result.position + 2) === '@(') {\r\n        result.position++;\r\n      }\r\n    } else {\r\n      if (arg.substring(result.position).match(gvn) || arg.substring(result.position, result.position + 2) === '^|') {\r\n        if (!globalOk) {\r\n          result.text = 'Global not allowed here';\r\n          return result;\r\n        }\r\n        result.globalFound = true;\r\n        if (arg.substring(result.position, result.position + 2) === '^|') {\r\n          result.position += 2\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          result.globalFound = true;\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          if (arg[result.position] === ',') {\r\n            result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n            result.globalFound = true;\r\n            if (result.text !== '') {\r\n              return result;\r\n            }\r\n          }\r\n          if (arg[result.position] !== '|') {\r\n            result.text = 'Missing \"|\"';\r\n            return result;\r\n          }\r\n          result.position++;\r\n          if (arg.substring(result.position).match(lvn)) {\r\n            let global = arg.substring(result.position).match(lvn)![0];\r\n            this._insertName({ name: global, type: 'global' });\r\n            varFound = true;\r\n            result.position += global.length;\r\n          }\r\n        } else {\r\n          let global = arg.substring(result.position).match(gvn)![0];\r\n          this._insertName({ name: global, type: 'global' });\r\n          varFound = true;\r\n          result.position += global.length;\r\n        }\r\n      } else if (arg.substring(result.position).match(lvn)) {\r\n        let local = arg.substring(result.position).match(lvn)![0];\r\n        this._insertName({ name: local, type: 'local' });\r\n        varFound = true;\r\n        result.position += local.length;\r\n      } else if (arg.substring(result.position, result.position + 2) === '^(') {\r\n        result.globalFound = true;\r\n        if (!globalOk) {\r\n          result.text = 'Global not allowed here';\r\n          varFound = false;\r\n          return result;\r\n        }\r\n        varFound = true;\r\n        result.position++;\r\n      }\r\n    }\r\n    if (varFound && arg[result.position] === '(') {\r\n      if (!indexOk) {\r\n        result.text = 'Index not allowed here';\r\n        return result;\r\n      }\r\n      let provResult = this.evaluateExpression(expressiontype.Index, arg, ++result.position, 1);\r\n      if (provResult.text !== '') {\r\n        return provResult;\r\n      }\r\n      result.position = provResult.position;\r\n      result.indexFound = true;\r\n    }\r\n    if (!varFound) {\r\n      result.text = 'Name missing';\r\n    }\r\n    return result;\r\n  }\r\n  private _checkBreak(arg: string, position: number): ErrorInformation {\r\n    //[expr[:tvexpr][,...]]\r\n    let result = this.evaluateExpression(expressiontype.Standard, arg, position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkKeyword(keywords: RegExp, arg: string, position: number): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (arg.substring(result.position).match(keywords)) {\r\n      let keyword = arg.substring(result.position).match(keywords)![0];\r\n      result.position += keyword.length;\r\n      if (keyword.slice(-1) === '=') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      }\r\n    } else {\r\n      result.text = 'No valid Keyword for command found';\r\n    }\r\n    return result;\r\n  }\r\n  private _checkOUC(keywords: RegExp, arg: string, position: number): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position };\r\n    //expr[:(keyword[=expr][:...])][,...]\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result.position++;\r\n      if (arg[result.position] === '(') {\r\n        result.position++;\r\n        let braceComplete = false;\r\n        do {\r\n          result = this._checkKeyword(keywords, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          braceComplete = true;\r\n          if (arg[result.position] === ')') {\r\n            result.position++;\r\n            break;\r\n          }\r\n          if (arg[result.position] !== ':') {\r\n            result.text = 'Unecpected Character';\r\n            return result;\r\n          } else {\r\n            result.position++;\r\n          }\r\n          braceComplete = false;\r\n        } while (result.position < arg.length)\r\n        if (!braceComplete) {\r\n          result.text = 'Missing \")\" or Keyword';\r\n          return result;\r\n        }\r\n      } else {\r\n        if (arg[result.position] !== ':') {\r\n          result = this._checkKeyword(keywords, arg, result.position);\r\n        }\r\n      }\r\n    }\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (keywords === openkeywords && arg[result.position] === ':') {\r\n      result.position++;\r\n      if (arg[result.position] !== ':') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      }\r\n    }\r\n    if (keywords === openkeywords && arg[result.position] === ':') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkFor(arg: string, position: number, argNumber: number): ErrorInformation {\r\n    //[lvn=expr[:numexpr1[:numexpr2]][,...]]]\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (argNumber > 1) { //If it's not the first Argument the Options are possible: F I=1:2:3,4 or F I=1:2:3,I=4:1:6\r\n      let provResult = this._checkVar(arg, result.position, false);\r\n      if (provResult.text === '' && arg[provResult.position] === '\"') {\r\n        result.position = provResult.position + 1;\r\n      }\r\n    } else {\r\n      result = this._checkVar(arg, result.position, false);\r\n      if (result.text !== '') {\r\n        return result;\r\n      }\r\n      if (arg[result.position] !== '=') {\r\n        result.text = 'Missing equal-sign';\r\n        return result;\r\n      }\r\n      result.position++;\r\n    }\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] !== ':') {\r\n      return result;\r\n    }\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] !== ':') {\r\n      return result;\r\n    }\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    return result;\r\n  }\r\n  private _checkJobKeyword(arg: string, position: number): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (arg.substring(result.position).match(jobkeywords)) {\r\n      let keyword = arg.substring(result.position).match(jobkeywords)![0];\r\n      result.position += keyword.length;\r\n      if (keyword[keyword.length - 1] === '=') {\r\n        if (arg.substring(result.position).match(strlit)) {\r\n          let stringlit = arg.substring(result.position).match(strlit)![0];\r\n          result.position += stringlit.length;\r\n          if (stringlit.length === 0) {\r\n            result.text = 'String literal expected';\r\n            return result;\r\n          }\r\n        } else {\r\n          result.text = 'String literal expected';\r\n          return result;\r\n        }\r\n      }\r\n    } else {\r\n      result.text = 'No valid Keyword for JOB Command';\r\n    }\r\n    return result;\r\n  }\r\n  private _checkJob(arg: string, position: number): ErrorInformation {\r\n    //entryref[(expr[,...])][:[(keyword[=value][:...])][:numexpr]][,...]\r\n    let result = this._checkEntryRef(arg, position, true);\r\n    if (arg[result.position] === ':') {\r\n      result.position++;\r\n      if (arg[result.position] === '(') {\r\n        result.position++;\r\n        let braceComplete = false;\r\n        do {\r\n          result = this._checkJobKeyword(arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          braceComplete = true;\r\n          if (arg[result.position] === ')') {\r\n            result.position++;\r\n            break;\r\n          }\r\n          if (arg[result.position] !== ':') {\r\n            result.text = 'Unecpected Character';\r\n            return result;\r\n          } else {\r\n            result.position++;\r\n          }\r\n          braceComplete = false;\r\n        } while (result.position < arg.length)\r\n        if (!braceComplete) {\r\n          result.text = 'Missing \")\" or Keyword';\r\n          return result;\r\n        }\r\n      } else {\r\n        if (arg[result.position] !== ':') {\r\n          result = this._checkJobKeyword(arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (arg[result.position] === ':') { //Numeric expression for Job-Timeout\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkKill(arg: string, position: number): ErrorInformation {\r\n    //[glvn | (lvn[,...]) | *lname | *lvn ]\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (arg[result.position] === '(') {\r\n      result.position++;\r\n      let braceComplete = false;\r\n      do {\r\n        result = this._checkVar(arg, result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        braceComplete = true;\r\n        if (arg[result.position] === ')') {\r\n          result.position++;\r\n          break;\r\n        }\r\n        if (arg[result.position] !== ',') {\r\n          result.text = 'Unecpected Character';\r\n          return result;\r\n        } else {\r\n          result.position++;\r\n        }\r\n        braceComplete = false;\r\n      } while (result.position < arg.length)\r\n      if (!braceComplete) {\r\n        result.text = 'Missing \")\" or Name';\r\n        return result;\r\n      }\r\n    } else {\r\n      result = this._checkVar(arg, result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkLock(arg: string, position: number, isLock: boolean): ErrorInformation {\r\n    //[[-|+]nref|(nref[,...])[:numexpr] [,...]]\r\n    let result: ErrorInformation = { text: '', position };\r\n    if ((arg[result.position] === '+' || arg[result.position] === '-') && isLock) {\r\n      result.position++;\r\n    }\r\n    if (arg[result.position] === '(') {\r\n      result.position++;\r\n      let braceComplete = false;\r\n      do {\r\n        result = this._checkVar(arg, result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        braceComplete = true;\r\n        if (arg[result.position] === ')') {\r\n          result.position++;\r\n          break;\r\n        }\r\n        if (arg[result.position] !== ',') {\r\n          result.text = 'Unecpected Character';\r\n          return result;\r\n        } else {\r\n          result.position++;\r\n        }\r\n        braceComplete = false;\r\n      } while (result.position < arg.length)\r\n      if (!braceComplete) {\r\n        result.text = 'Missing \")\" or Name';\r\n        return result;\r\n      }\r\n    } else {\r\n      result = this._checkVar(arg, result.position);\r\n      if (result.text !== '') {\r\n        return result;\r\n      }\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkMerge(arg: string, position: number): ErrorInformation {\r\n    //glvn=glvn[,...]\r\n    let result: ErrorInformation = { text: '', position };\r\n    result = this._checkVar(arg, result.position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] !== '=') {\r\n      result.text = 'Equal-Sign expected';\r\n      return result;\r\n    }\r\n    result = this._checkVar(arg, ++result.position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    return result;\r\n  }\r\n  private _checkNew(arg: string, position: number): ErrorInformation {\r\n    //[[(]lvn[,...][)][,...]]\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (arg[result.position] === '(') {\r\n      result.position++;\r\n      let braceComplete = false;\r\n      do {\r\n        if (arg.substring(result.position).match(isv)) {\r\n          result.position += arg.substring(result.position).match(isv)![0].length;\r\n        } else {\r\n          result = this._checkVar(arg, result.position, false);\r\n        }\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        braceComplete = true;\r\n        if (arg[result.position] === ')') {\r\n          result.position++;\r\n          break;\r\n        }\r\n        if (arg[result.position] !== ',') {\r\n          result.text = 'Unecpected Character';\r\n          return result;\r\n        } else {\r\n          result.position++;\r\n        }\r\n        braceComplete = false;\r\n      } while (result.position < arg.length)\r\n      if (!braceComplete) {\r\n        result.text = 'Missing \")\" or Name';\r\n        return result;\r\n      }\r\n    } else {\r\n      if (arg.substring(result.position).match(isv)) {\r\n        result.position += arg.substring(result.position).match(isv)![0].length;\r\n      } else {\r\n        result = this._checkVar(arg, result.position, false);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  private _checkRead(arg: string, position: number): ErrorInformation {\r\n    //(glvn|*glvn|glvn#intexpr)[:numexpr]|strlit|fcc[,...]\r\n    let result: ErrorInformation = { text: '', position };\r\n    let starDetected = false;\r\n    let mat: string[] | null;\r\n    if (arg[result.position] === '*') {\r\n      result.position++;\r\n      starDetected = true;\r\n    }\r\n    let provResult = this._checkVar(arg, result.position);\r\n    if (provResult.text === '') {\r\n      result.position = provResult.position;\r\n      if (arg[result.position] === '#') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      }\r\n      if (arg[result.position] === ':') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n      }\r\n      return result;\r\n    } else {\r\n      if (starDetected) {\r\n        result.text = 'Variable expected';\r\n        return result;\r\n      }\r\n      if (mat = arg.substring(result.position).match(strlit)) {\r\n        result.position += mat[0].length;\r\n        return result;\r\n      } else if (mat = arg.substring(result.position).match(/^(#|!)+/)) {\r\n        result.position += mat[0].length;\r\n      }\r\n      if (arg[result.position] === '?') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n        return result;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  private _checkSet(arg: string, position: number): ErrorInformation {\r\n    //setleft=expr | (setleft[,...])=expr | *lvn=lname | aliascontainer[,...]\r\n    let result: ErrorInformation = { text: '', position };\r\n    let mat: string[] | null;\r\n    let isBraced = false;\r\n    if (arg[result.position] === '*') { //*lvn=lname\r\n      result = this._checkVar(arg, ++result.position, false);\r\n      if (result.text !== '') {\r\n        return result;\r\n      }\r\n      if (arg[result.position] !== '=') {\r\n        result.text = 'Equal-Sign expected';\r\n        return result;\r\n      }\r\n      result = this._checkVar(arg, ++result.position, false);\r\n      return result;\r\n    }\r\n    if (arg[result.position] === '(') {\r\n      isBraced = true;\r\n      result.position++;\r\n    }\r\n    do {\r\n      if (arg[result.position] === '@') {\r\n        let provResult = this._checkVar(arg, result.position);\r\n        if (result.text === '') {\r\n          result.position = provResult.position;\r\n          if (result.position === arg.length || arg[result.position] === ',') {\r\n            return result;\r\n          }\r\n        } else {\r\n          result = this.evaluateExpression(expressiontype.Atom, arg, ++result.position);\r\n          if (result.text !== '' || result.position === arg.length || arg[result.position] === ',') {\r\n            return result;\r\n          }\r\n        }\r\n      } else if (mat = arg.substring(result.position).match(/^\\$Z?(PIECE|P|EXTRACT|E)\\(/i)) {\r\n        let functionname = mat[0].substring(1, mat[0].length - 1).toUpperCase();\r\n        result.position += functionname.length + 2\r\n        if (funcExpansions[functionname] !== undefined) {\r\n          functionname = funcExpansions[functionname];\r\n        }\r\n        result = this._checkFunction(functionname, arg, result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      } else if (mat = arg.substring(result.position).match(isv)) {\r\n        result.position += mat[0].length;\r\n      } else {\r\n        result = this._checkVar(arg, result.position, true);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      }\r\n      if (arg[result.position] === ',' && isBraced) {\r\n        result.position++;\r\n        continue;\r\n      }\r\n      if (arg[result.position] === ')' && isBraced) {\r\n        isBraced = false;\r\n        result.position++;\r\n      }\r\n    } while (result.position < arg.length && isBraced);\r\n    if (arg[result.position] !== '=') {\r\n      result.text = 'Equal-Sign expected';\r\n      return result;\r\n    }\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    return result;\r\n  }\r\n  private _checkTstart(arg: string, position: number): ErrorInformation {\r\n    //[([lvn...])|lvn|*|][:keyword|(keyword...)]\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (arg[result.position] === '(') {\r\n      result.position++;\r\n      if (arg[result.position] !== ')') {\r\n        let braceComplete = false;\r\n        do {\r\n          braceComplete = true;\r\n          result = this._checkVar(arg, result.position, false, false);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          if (arg[result.position] === ')') {\r\n            result.position++;\r\n            break;\r\n          }\r\n          if (arg[result.position] !== ',') {\r\n            result.text = 'Unecpected Character';\r\n            return result;\r\n          } else {\r\n            result.position++;\r\n          }\r\n          braceComplete = false;\r\n        } while (result.position < arg.length)\r\n        if (!braceComplete) {\r\n          result.text = 'Missing \")\" or Name';\r\n          return result;\r\n        }\r\n      }\r\n    } else {\r\n      if (arg[result.position] !== '*') {\r\n        result = this._checkVar(arg, result.position, false, false);\r\n      }\r\n    }\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result.position++;\r\n      if (arg[result.position] === '(') {\r\n        result.position++;\r\n        let braceComplete = false;\r\n        do {\r\n          result = this._checkKeyword(tstartkeywords, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          braceComplete = true;\r\n          if (arg[result.position] === ')') {\r\n            result.position++;\r\n            break;\r\n          }\r\n          if (arg[result.position] !== ':') {\r\n            result.text = 'Unecpected Character';\r\n            return result;\r\n          } else {\r\n            result.position++;\r\n          }\r\n          braceComplete = false;\r\n        } while (result.position < arg.length)\r\n        if (!braceComplete) {\r\n          result.text = 'Missing \")\" or Keyword';\r\n          return result;\r\n        }\r\n      } else {\r\n        result = this._checkKeyword(tstartkeywords, arg, result.position);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n  private _checkView(arg: string, position: number): ErrorInformation {\r\n    //keyword[:expr[:...]][,...]\r\n    let result: ErrorInformation = { text: '', position };\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    while (arg[result.position] === ':') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n      if (result.text !== '') {\r\n        return result;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  private _checkWrite(arg: string, position: number): ErrorInformation {\r\n    //expr|*intexpr|fcc[,...]\r\n    let result: ErrorInformation = { text: '', position };\r\n    let mat: string[] | null;\r\n    if (arg[result.position] === '*') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n      return result;\r\n    }\r\n    if (arg.substring(result.position).match(/^\\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)) {\r\n      result = this._checkWriteSocket(arg, result.position);\r\n      return result;\r\n    }\r\n    if (mat = arg.substring(result.position).match(/^(#|!)+/)) {\r\n      result.position += mat[0].length;\r\n      if (arg[result.position] === '?') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n      }\r\n      return result;\r\n    }\r\n    if (arg[result.position] === '?') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n      return result;\r\n    }\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n    return result;\r\n  }\r\n  private _checkWriteSocket(arg: string, position: number): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position };\r\n    let mat: string[] | null;\r\n    if (mat = arg.substring(result.position).match(/^\\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)) {\r\n      result.position += mat[0].length;\r\n      let fname = mat![0].toUpperCase();\r\n      if (fname === '/EOF') {\r\n        return result;\r\n      }\r\n      if (arg[result.position] !== '(') {\r\n        if (!fname.match(/^\\/(LISTEN|L|WAIT|W)/)) {\r\n          result.text = fname + ' needs Parameter(s)';\r\n        }\r\n        return result;\r\n      }\r\n      result.position++;\r\n      let maxparams = 99;\r\n      if (fname === '/LISTEN' || fname === '/L' || fname === '/WAIT' || fname === '/W') {\r\n        maxparams = 1;\r\n      } else if (fname === '/TLS') {\r\n        maxparams = 4;\r\n      }\r\n      let paramCount = 0;\r\n      let braceComplete = false;\r\n      do {\r\n        paramCount++;\r\n        if (paramCount > maxparams) {\r\n          result.text = 'More Parameters than expected';\r\n          return result;\r\n        }\r\n        if (fname === '/ACCEPT' && paramCount === 1) {\r\n          if (arg[result.position] !== '.') {\r\n            result.text = 'Local Variablereference expected (.lvn)';\r\n            return result\r\n          }\r\n          result = this._checkVar(arg, ++result.position, false, false);\r\n        } else {\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n        }\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        braceComplete = true;\r\n        if (arg[result.position] === ',') {\r\n          braceComplete = false;\r\n          continue;\r\n        }\r\n        if (arg[result.position] === ')') {\r\n          result.position++;\r\n          break;\r\n        }\r\n      } while (result.position < arg.length)\r\n      if (!braceComplete) {\r\n        result.text = 'Missing Parameter or \")\"';\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  private _checkXecute(arg: string, position: number): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position };\r\n    result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkZbreak(arg: string, position: number): ErrorInformation {\r\n    //[-]entryref[:[expr][:intexpr]][,...]\r\n    let result: ErrorInformation = { text: '', position };\r\n    if (arg[result.position] === '-') {\r\n      result.position++;\r\n      if (arg[result.position] === '*') {\r\n        result.position++;\r\n        return result;\r\n      }\r\n    }\r\n    result = this._checkEntryRef(arg, result.position, false);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result.position++;\r\n      if (arg[result.position] === ':') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n      } else {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        if (arg[result.position] === ':') {\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  private _checkZprint(arg: string, position: number): ErrorInformation {\r\n    // 'parameter': '[entryref[:label[+intexpr]][,...]'\r\n    let result: ErrorInformation = { text: '', position };\r\n    result = this._checkEntryRef(arg, result.position, false);\r\n    if (result.text !== '') {\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result = this._checkEntryRef(arg, ++result.position, false);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkZstep(arg: string, position: number): ErrorInformation {\r\n    // 'parameter': '[keyword[:expr]][,...]'\r\n    let result: ErrorInformation = { text: '', position };\r\n    let mat: string[] | null;\r\n\r\n    if (mat = arg.substring(result.position).match(/^(INTO|OUTOF|OU|OVER|OV)/i)) {\r\n      result.position += mat.length;\r\n    } else {\r\n      result.text = 'Invalid ZSTEP Qualifier';\r\n      return result;\r\n    }\r\n    if (arg[result.position] === ':') {\r\n      result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n    }\r\n    return result;\r\n  }\r\n  private _checkCommand(longcmd: string, code: TmpFunction): ErrorInformation {\r\n    let para = cmdParams[longcmd];\r\n    let postcondPossible = para.postcondition;\r\n    let argFormat = para.parameter;\r\n    let arg = code.mArguments;\r\n    let result: ErrorInformation = { text: '', position: 0 }\r\n    if (!postcondPossible && code.mPostCondition !== '') {\r\n      return { text: 'Poscondition not allowed', position: code.pcPosition }\r\n    } else if (code.mPostCondition !== '') {\r\n      result = this.evaluateExpression(expressiontype.Standard, code.mPostCondition, 0);\r\n      if (result.text !== '') {\r\n        result.position += code.pcPosition;\r\n        return result;\r\n      }\r\n    }\r\n    if (arg === '') {\r\n      if (argFormat === '' || argFormat[0] === '[') {\r\n        return { text: '', position: code.argPosition }\r\n      } else {\r\n        return { text: 'Argument for command ' + code.mCommand + \" required\", position: code.argPosition }\r\n      }\r\n    }\r\n    result.position = 0;\r\n    let argCount = 0;\r\n    do {\r\n      argCount++;\r\n      switch (longcmd) {\r\n        case 'BREAK':\r\n          result = this._checkBreak(arg, result.position);\r\n          break;\r\n        case 'CLOSE':\r\n          result = this._checkOUC(closekeywords, arg, result.position);\r\n          break;\r\n        case 'DO':\r\n          result = this._checkEntryRefAndPostcondition(arg, result.position, true);\r\n          break;\r\n        case 'ELSE':\r\n          if (arg !== '') {\r\n            return { text: 'No Argument expected', position: code.argPosition }\r\n          }\r\n          break;\r\n        case 'FOR':\r\n          result = this._checkFor(arg, result.position, argCount);\r\n          break;\r\n        case 'GOTO':\r\n          result = this._checkEntryRefAndPostcondition(arg, result.position, false);\r\n          break;\r\n        case 'HANG':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          break;\r\n        case 'IF':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          break;\r\n        case 'JOB':\r\n          result = this._checkJob(arg, result.position);\r\n          break;\r\n        case 'KILL':\r\n          result = this._checkKill(arg, result.position);\r\n          break;\r\n        case 'LOCK':\r\n          result = this._checkLock(arg, result.position, true);\r\n          break;\r\n        case 'MERGE':\r\n          result = this._checkMerge(arg, result.position);\r\n          break;\r\n        case 'NEW':\r\n          result = this._checkNew(arg, result.position);\r\n          break;\r\n        case 'OPEN':\r\n          result = this._checkOUC(openkeywords, arg, result.position);\r\n          break;\r\n        case 'QUIT':\r\n          if (argCount > 1) {\r\n            result.text = 'Quit allows only one Argument'\r\n          } else {\r\n            if (arg[result.position] === '*') {\r\n              result = this._checkVar(arg, ++result.position, false);\r\n            } else {\r\n              result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n            }\r\n          }\r\n          break;\r\n        case 'READ':\r\n          result = this._checkRead(arg, result.position);\r\n          break;\r\n        case 'SET':\r\n          result = this._checkSet(arg, result.position);\r\n          break;\r\n        case 'TROLLBACK':\r\n          if (argCount > 1) {\r\n            result.text = 'TROLLBACK allows only one Argument'\r\n          } else {\r\n            result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          }\r\n          break;\r\n        case 'TSTART':\r\n          result = this._checkTstart(arg, result.position);\r\n          break;\r\n\r\n        case 'USE':\r\n          result = this._checkOUC(usekeywords, arg, result.position);\r\n          break;\r\n        case 'VIEW':\r\n          result = this._checkView(arg, result.position);\r\n          break;\r\n        case 'WRITE':\r\n          result = this._checkWrite(arg, result.position);\r\n          break;\r\n        case 'XECUTE':\r\n          result = this._checkXecute(arg, result.position);\r\n          break;\r\n        case 'ZALLOCATE':\r\n          result = this._checkLock(arg, result.position, false);\r\n          break;\r\n        case 'ZBREAK':\r\n          result = this._checkZbreak(arg, result.position);\r\n          break;\r\n        case 'ZCOMPILE':\r\n          // 'abbreviation': 'ZCOM',\r\n          // 'postcondition': true,\r\n          // 'parameter': 'expr[,...]'\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          break;\r\n        case 'ZDEALLOCATE':\r\n          result = this._checkVar(arg, result.position);\r\n          // 'abbreviation': 'ZD',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[nref[,...]]'\r\n          break;\r\n        case 'ZEDIT':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          // 'abbreviation': 'ZED',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[expr[,...]]'\r\n          break;\r\n        case 'ZGOTO':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          if (arg[result.position] === ':') {\r\n            result = this._checkEntryRefAndPostcondition(arg, ++result.position, false);\r\n          }\r\n          // 'abbreviation': 'ZG',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[[intexpr][:entryref[:tvexpr]],...]'\r\n          break;\r\n        case 'ZHALT':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          // 'abbreviation': 'ZHALT',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[intexpr]'\r\n          break;\r\n        case 'ZHELP':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          if (arg[result.position] === ':') {\r\n            result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n          }\r\n          // 'abbreviation': 'ZH',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[expr1[:expr2],...]'\r\n          break;\r\n        case 'ZKILL':\r\n          result = this._checkVar(arg, result.position);\r\n          // 'abbreviation': 'ZK',\r\n          // 'postcondition': true,\r\n          // 'parameter': 'glvn'\r\n          break;\r\n        case 'ZLINK':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          if (arg[result.position] === ':') {\r\n            result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n          }\r\n          // 'abbreviation': 'ZL',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[expr1[:expr2][,...]]'\r\n          break;\r\n        case 'ZMESSAGE':\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          while (arg[result.position] === ':') {\r\n            result = this.evaluateExpression(expressiontype.Standard, arg, ++result.position);\r\n            if (result.text !== '') {\r\n              return result;\r\n            }\r\n          }\r\n          // 'abbreviation': 'ZM',\r\n          // 'postcondition': true,\r\n          // 'parameter': 'intexpr[:expr2][:...]'\r\n          break;\r\n        case 'ZPRINT':\r\n          // 'abbreviation': 'ZP',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[entryref[:label[+intexpr]][,...]'\r\n          result = this._checkZprint(arg, result.position);\r\n          break;\r\n        case 'ZRUPDATE':\r\n          // 'abbreviation': 'ZRUP',\r\n          // 'postcondition': true,\r\n          // 'parameter': 'expr[,...]'\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          break;\r\n        case 'ZSHOW':\r\n          // 'abbreviation': 'ZSH',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[expr[:glvn][,...]]'\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          if (arg[result.position] === ':') {\r\n            result = this._checkVar(arg, ++result.position);\r\n          }\r\n          break;\r\n        case 'ZSTEP':\r\n          // 'abbreviation': 'ZST',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[keyword[:expr]][,...]'\r\n          result = this._checkZstep(arg, result.position);\r\n          break;\r\n        case 'ZSYSTEM':\r\n          // 'abbreviation': 'ZSY',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[expr][,...]]'\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          break;\r\n        case 'ZTCOMMIT':\r\n          // 'abbreviation': 'ZTC',\r\n          // 'postcondition': true,\r\n          // 'parameter': '[intexpr]'\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          break;\r\n        case 'ZTRIGGER':\r\n          // 'abbreviation': 'ZTR',\r\n          // 'postcondition': true,\r\n          // 'parameter': 'gvn'\r\n          result = this._checkVar(arg, result.position, true, false);\r\n          if (!result.globalFound) {\r\n            result.text = 'Global Variable expected';\r\n            return result\r\n          }\r\n          break;\r\n        case 'ZWITHDRAW':\r\n          // 'abbreviation': 'ZWI',\r\n          // 'postcondition': true,\r\n          // 'parameter': 'glvn'\r\n          result = this._checkVar(arg, result.position);\r\n          break;\r\n        case 'ZWRITE':\r\n          //'abbreviation': 'ZWR',\r\n          //'postcondition': true,\r\n          //'parameter': '[zwrglvn[,...]]'\r\n          //not separately tested because ZWRITE is for debugging and should not appear in normal code\r\n          result.position += arg.length;\r\n          break;\r\n        default:\r\n          result.position = arg.length;\r\n          break;\r\n      }\r\n      if (arg[result.position] === ',') {\r\n        result.position++;\r\n        continue;\r\n      } else if (arg[result.position] !== undefined) {\r\n        result.text = 'Unexpected Character \"' + arg[result.position] + '\"';\r\n        break;\r\n      }\r\n    } while (result.position < arg.length && result.text === '')\r\n    result.position += code.argPosition;\r\n    return result;\r\n  }\r\n  private _checkFunction(longfunc: string, arg: string, position: number): ErrorInformation {\r\n    let result: ErrorInformation = { text: '', position: position };\r\n    let params = funcParams[longfunc];\r\n    let minArguments = params.minparams !== undefined ? params.minparams : 1;\r\n    let formats = params.format !== undefined ? params.format.split(',') : undefined;\r\n    let argCount = 0;\r\n    longfunc = '$' + longfunc;\r\n    if (minArguments === 0 && arg[result.position] === ')') {\r\n      result.position++;\r\n      return result;\r\n    }\r\n    do {\r\n      let format = (formats !== undefined && formats[argCount] !== undefined) ? formats[argCount] : 'expr';\r\n      if (longfunc === '$SELECT') {\r\n        format = 'special';\r\n      }\r\n      if (format === 'glvn' || format === 'gvn' || format === 'glvn(' || format === 'lvn') {\r\n        result = this._checkVar(arg, result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n        if (format === 'glvn(' && (!result.indexFound && !result.indirectionFound)) {\r\n          result.text = 'Variable with Index expected for ' + longfunc;\r\n          return result;\r\n        }\r\n        if (format === 'lvn' && result.globalFound) {\r\n          result.text = 'Local variable expected';\r\n          return result;\r\n        }\r\n      } else if (format === 'entryref') {\r\n        result = this._checkEntryRef(arg, result.position, false);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      } else if (format === 'expr') {\r\n        result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n        if (result.text !== '') {\r\n          return result;\r\n        }\r\n      } else if (format === 'bool') {\r\n        if (arg[result.position] !== '0' && arg[result.position] !== '1') {\r\n          result.text = '0/1 expected';\r\n          return result;\r\n        } else {\r\n          result.position++;\r\n        }\r\n      } else if (format === 'special') {\r\n        if (longfunc === '$SELECT') {\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n          if (arg[result.position] !== ':') {\r\n            result.text = 'Missing Expression';\r\n            return result;\r\n          }\r\n          result.position++\r\n          result = this.evaluateExpression(expressiontype.Standard, arg, result.position);\r\n          if (result.text !== '') {\r\n            return result;\r\n          }\r\n        }\r\n      }\r\n      argCount++;\r\n      let char = arg[result.position];\r\n      if (char === ',') {\r\n        if (argCount > params.maxparams) {\r\n          result.text = 'More Arguments for ' + longfunc + ' than expected';\r\n          return result;\r\n        }\r\n        result.position++;\r\n        continue;\r\n      } else if (char === ')') {\r\n        if (argCount < minArguments) {\r\n          result.text = 'Less Arguments for ' + longfunc + ' than expected';\r\n          return result;\r\n        }\r\n        result.position++;\r\n        break;\r\n      } else {\r\n        result.text = 'Unxepected character ';\r\n        return result;\r\n      }\r\n    } while (result.position < arg.length);\r\n\r\n    return result;\r\n  }\r\n}\r\n"],"sourceRoot":""}